/*
 * DO NOT EDIT THIS FILE - it is generated by Glade.
 */

#ifdef HAVE_CONFIG_H
#  include <config.h>
#endif

#include <sys/types.h>
#include <sys/stat.h>
#ifndef _MSC_VER
#include <unistd.h>
#endif
#include <string.h>

#include <gdk/gdkkeysyms.h>
#include <gtk/gtk.h>

#include "callbacks.h"
#include "interface.h"
#include "support.h"

#if (GTK_MAJOR_VERSION == 1) || defined (GTK_ENABLE_BROKEN)

GtkWidget*
create_window1 (void)
{
  GtkWidget *window1;
  GtkWidget *main_window_hbox;
  GtkWidget *vbox1;
  GtkWidget *menubar1;
  guint tmp_key;
  GtkWidget *file1;
  GtkWidget *file1_menu;
  GtkAccelGroup *file1_menu_accels;
  GtkWidget *open_coordinates1;
  GtkWidget *auto_open_mtz;
  GtkWidget *open_dataset1;
  GtkWidget *open_map1;
  GtkWidget *close_molecule1;
  GtkWidget *import_cif_dictionary1;
  GtkWidget *get_monomer1;
  GtkWidget *search_monomer_library1;
  GtkWidget *smiles1;
  GtkWidget *get_pdb_using_code1;
  GtkWidget *get_pdb_and_map_using_eds1;
  GtkWidget *save_coordinates1;
  GtkWidget *save_symmetry_coordinates1;
  GtkWidget *save_state1;
  GtkWidget *recover_session1;
  GtkWidget *exit1;
  GtkWidget *edit1;
  GtkWidget *edit1_menu;
  GtkAccelGroup *edit1_menu_accels;
  GtkWidget *map_colour1;
  GtkWidget *density_size1;
  GtkWidget *bond_colours1;
  GtkWidget *bond_parameters1;
  GtkWidget *skeleton_parameters1;
  GtkWidget *skeleton_parameters1_menu;
  GtkAccelGroup *skeleton_parameters1_menu_accels;
  GtkWidget *skeleton_colour1;
  GtkWidget *skeleton_box_radius1;
  GtkWidget *skeletonization_level1;
  GtkWidget *residue_info2;
  GtkWidget *font_size1;
  GtkWidget *pink_pointer_size1;
  GtkWidget *background_colour1;
  GtkWidget *background_colour1_menu;
  GtkAccelGroup *background_colour1_menu_accels;
  GSList *background_group = NULL;
  GtkWidget *background_black1;
  GtkWidget *background_white1;
  GtkWidget *calculate1;
  GtkWidget *calculate1_menu;
  GtkAccelGroup *calculate1_menu_accels;
  GtkWidget *regularize1;
  GtkWidget *other_modelling_tools1;
  GtkWidget *ssm_superposition1;
  GtkWidget *lsq_superpose1;
  GtkWidget *merge_molecules1;
  GtkWidget *mutate_molecule1;
  GtkWidget *align___mutate1;
  GtkWidget *renumber_residues1;
  GtkWidget *change_chain_ids2;
  GtkWidget *move_molecule_here1;
  GtkWidget *fit_loop1;
  GtkWidget *cowtan_foadi_skeleton1;
  GtkWidget *ncs_maps1;
  GtkWidget *frames_sec1;
  GtkWidget *scripting_testing1;
  GtkWidget *run_script1;
  GtkWidget *draw1;
  GtkWidget *draw1_menu;
  GtkAccelGroup *draw1_menu_accels;
  GtkWidget *go_to_atom1;
  GtkWidget *undo_last_navigation1;
  GtkWidget *centre_atom_label1;
  GtkWidget *sequence_view1;
  GtkWidget *anisotropic_atoms1;
  GtkWidget *show_symmetry1;
  GtkWidget *ncs_ghost_control1;
  GtkWidget *spin_view_on_off1;
  GtkWidget *screenshot1;
  GtkWidget *screenshot1_menu;
  GtkAccelGroup *screenshot1_menu_accels;
  GtkWidget *simple1;
  GtkWidget *povray1;
  GtkWidget *raster3d1;
  GtkWidget *generic_display_objects1;
  GtkWidget *antialiasing1;
  GtkWidget *stereo1;
  GtkWidget *clipping1;
  GtkWidget *crosshairs1;
  GtkWidget *zoom1;
  GtkWidget *dragged_map1;
  GtkWidget *recentring1;
  GtkWidget *coordinates_recentring1;
  GtkWidget *map_and_mol_control1;
  GtkWidget *main_menu_info;
  GtkWidget *main_menu_info_menu;
  GtkAccelGroup *main_menu_info_menu_accels;
  GtkWidget *residue_info1;
  GtkWidget *distances___angles1;
  GtkWidget *environment_distances1;
  GtkWidget *plane_distances1;
  GtkWidget *pointer_distances1;
  GtkWidget *clear_atom_labels1;
  GtkWidget *validate1;
  GtkWidget *validate1_menu;
  GtkAccelGroup *validate1_menu_accels;
  GtkWidget *ramachandran_plot1;
  GtkWidget *ramachandran_differences_plot1;
  GtkWidget *incorrect_chiral_volumes1;
  GtkWidget *unmodelled_blobs1;
  GtkWidget *difference_map_peaks1;
  GtkWidget *check_waters1;
  GtkWidget *check_waters_by_difference_map_variance1;
  GtkWidget *geometry_analysis1;
  GtkWidget *peptide_omega_analysis1;
  GtkWidget *temp_fact_variance_analysis1;
  GtkWidget *gln_and_asn_b_factor_outliers1;
  GtkWidget *rotamer_analysis1;
  GtkWidget *density_fit_analysis1;
  GtkWidget *probe_clashes1;
  GtkWidget *hid1;
  GtkWidget *hid1_menu;
  GtkAccelGroup *hid1_menu_accels;
  GtkWidget *scrollwheel1;
  GtkWidget *scrollwheel1_menu;
  GtkAccelGroup *scrollwheel1_menu_accels;
  GtkWidget *attach_scroll_wheel_to_which_map_1;
  GtkWidget *virtual_trackball1;
  GtkWidget *virtual_trackball1_menu;
  GtkAccelGroup *virtual_trackball1_menu_accels;
  GSList *vtrack_group = NULL;
  GtkWidget *flat1;
  GtkWidget *spherical_surface1;
  GtkWidget *reset_view1;
  GtkWidget *help1;
  GtkWidget *help1_menu;
  GtkAccelGroup *help1_menu_accels;
  GtkWidget *on_line_docs_url1;
  GtkWidget *about1;
  GtkWidget *hints1;
  GtkWidget *accept_reject_dialog_frame;
  GtkWidget *main_window_graphics_hbox;
  GtkWidget *main_window_statusbar;
  GtkWidget *main_window_model_fit_dialog_frame;
  GtkWidget *gtkhtml_frame;
  GtkAccelGroup *accel_group;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  accel_group = gtk_accel_group_new ();

  window1 = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (window1), "window1", window1);
  gtk_window_set_title (GTK_WINDOW (window1), _("Coot"));

  main_window_hbox = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (main_window_hbox);
  gtk_object_set_data_full (GTK_OBJECT (window1), "main_window_hbox", main_window_hbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (main_window_hbox);
  gtk_container_add (GTK_CONTAINER (window1), main_window_hbox);

  vbox1 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "vbox1", vbox1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox1);
  gtk_box_pack_start (GTK_BOX (main_window_hbox), vbox1, TRUE, TRUE, 0);

  menubar1 = gtk_menu_bar_new ();
  gtk_widget_ref (menubar1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "menubar1", menubar1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (menubar1);
  gtk_box_pack_start (GTK_BOX (vbox1), menubar1, FALSE, FALSE, 0);

  file1 = gtk_menu_item_new_with_label ("");
  tmp_key = gtk_label_parse_uline (GTK_LABEL (GTK_BIN (file1)->child),
                                   _("_File"));
  gtk_widget_add_accelerator (file1, "activate_item", accel_group,
                              tmp_key, GDK_MOD1_MASK, (GtkAccelFlags) 0);
  gtk_widget_ref (file1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "file1", file1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (file1);
  gtk_container_add (GTK_CONTAINER (menubar1), file1);

  file1_menu = gtk_menu_new ();
  gtk_widget_ref (file1_menu);
  gtk_object_set_data_full (GTK_OBJECT (window1), "file1_menu", file1_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (file1), file1_menu);
  file1_menu_accels = gtk_menu_ensure_uline_accel_group (GTK_MENU (file1_menu));

  open_coordinates1 = gtk_menu_item_new_with_label (_("Open Coordinates..."));
  gtk_widget_ref (open_coordinates1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "open_coordinates1", open_coordinates1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (open_coordinates1);
  gtk_container_add (GTK_CONTAINER (file1_menu), open_coordinates1);
  gtk_tooltips_set_tip (tooltips, open_coordinates1, _("pdb, cif or shelx res format"), NULL);

  auto_open_mtz = gtk_menu_item_new_with_label (_("Auto Open MTZ..."));
  gtk_widget_ref (auto_open_mtz);
  gtk_object_set_data_full (GTK_OBJECT (window1), "auto_open_mtz", auto_open_mtz,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (auto_open_mtz);
  gtk_container_add (GTK_CONTAINER (file1_menu), auto_open_mtz);

  open_dataset1 = gtk_menu_item_new_with_label (_("Open MTZ, mmCIF, fcf or phs..."));
  gtk_widget_ref (open_dataset1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "open_dataset1", open_dataset1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (open_dataset1);
  gtk_container_add (GTK_CONTAINER (file1_menu), open_dataset1);
  gtk_tooltips_set_tip (tooltips, open_dataset1, _("Create a map \"on the fly\" from mtz, phs or mmCIF data"), NULL);

  open_map1 = gtk_menu_item_new_with_label (_("Open Map..."));
  gtk_widget_ref (open_map1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "open_map1", open_map1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (open_map1);
  gtk_container_add (GTK_CONTAINER (file1_menu), open_map1);
  gtk_tooltips_set_tip (tooltips, open_map1, _("Open a pre-calculated CCP4 map or CNS (\".cns\") map"), NULL);

  close_molecule1 = gtk_menu_item_new_with_label (_("Close molecule/map..."));
  gtk_widget_ref (close_molecule1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "close_molecule1", close_molecule1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (close_molecule1);
  gtk_container_add (GTK_CONTAINER (file1_menu), close_molecule1);

  import_cif_dictionary1 = gtk_menu_item_new_with_label (_("Import CIF dictionary..."));
  gtk_widget_ref (import_cif_dictionary1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "import_cif_dictionary1", import_cif_dictionary1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (import_cif_dictionary1);
  gtk_container_add (GTK_CONTAINER (file1_menu), import_cif_dictionary1);

  get_monomer1 = gtk_menu_item_new_with_label (_("Get Monomer..."));
  gtk_widget_ref (get_monomer1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "get_monomer1", get_monomer1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (get_monomer1);
  gtk_container_add (GTK_CONTAINER (file1_menu), get_monomer1);
  gtk_tooltips_set_tip (tooltips, get_monomer1, _("Give a 3-letter code and use libcheck to generate coordinates from REFMAC monomer library"), NULL);

  search_monomer_library1 = gtk_menu_item_new_with_label (_("Search Monomer Library..."));
  gtk_widget_ref (search_monomer_library1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "search_monomer_library1", search_monomer_library1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (search_monomer_library1);
  gtk_container_add (GTK_CONTAINER (file1_menu), search_monomer_library1);
  gtk_tooltips_set_tip (tooltips, search_monomer_library1, _("Search monomer names to find 3-letter code"), NULL);

  smiles1 = gtk_menu_item_new_with_label (_("SMILES..."));
  gtk_widget_ref (smiles1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "smiles1", smiles1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (smiles1);
  gtk_container_add (GTK_CONTAINER (file1_menu), smiles1);

  get_pdb_using_code1 = gtk_menu_item_new_with_label (_("Get PDB using Accession Code..."));
  gtk_widget_ref (get_pdb_using_code1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "get_pdb_using_code1", get_pdb_using_code1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (get_pdb_using_code1);
  gtk_container_add (GTK_CONTAINER (file1_menu), get_pdb_using_code1);
  gtk_tooltips_set_tip (tooltips, get_pdb_using_code1, _("Get PDB Coordinates file from server using accession code"), NULL);

  get_pdb_and_map_using_eds1 = gtk_menu_item_new_with_label (_("Get PDB & Map using EDS..."));
  gtk_widget_ref (get_pdb_and_map_using_eds1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "get_pdb_and_map_using_eds1", get_pdb_and_map_using_eds1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (get_pdb_and_map_using_eds1);
  gtk_container_add (GTK_CONTAINER (file1_menu), get_pdb_and_map_using_eds1);
  gtk_tooltips_set_tip (tooltips, get_pdb_and_map_using_eds1, _("Use the Electron Density Server at Uppsala University to get coords and map... (Long live the EDS!)"), NULL);

  save_coordinates1 = gtk_menu_item_new_with_label (_("Save Coordinates..."));
  gtk_widget_ref (save_coordinates1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "save_coordinates1", save_coordinates1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (save_coordinates1);
  gtk_container_add (GTK_CONTAINER (file1_menu), save_coordinates1);

  save_symmetry_coordinates1 = gtk_menu_item_new_with_label (_("Save Symmetry Coordinates..."));
  gtk_widget_ref (save_symmetry_coordinates1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "save_symmetry_coordinates1", save_symmetry_coordinates1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (save_symmetry_coordinates1);
  gtk_container_add (GTK_CONTAINER (file1_menu), save_symmetry_coordinates1);

  save_state1 = gtk_menu_item_new_with_label (_("Save State..."));
  gtk_widget_ref (save_state1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "save_state1", save_state1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (save_state1);
  gtk_container_add (GTK_CONTAINER (file1_menu), save_state1);

  recover_session1 = gtk_menu_item_new_with_label (_("Recover Session..."));
  gtk_widget_ref (recover_session1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "recover_session1", recover_session1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (recover_session1);
  gtk_container_add (GTK_CONTAINER (file1_menu), recover_session1);

  exit1 = gtk_menu_item_new_with_label (_("Exit"));
  gtk_widget_ref (exit1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "exit1", exit1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (exit1);
  gtk_container_add (GTK_CONTAINER (file1_menu), exit1);
  gtk_tooltips_set_tip (tooltips, exit1, _("bye"), NULL);

  edit1 = gtk_menu_item_new_with_label ("");
  tmp_key = gtk_label_parse_uline (GTK_LABEL (GTK_BIN (edit1)->child),
                                   _("_Edit"));
  gtk_widget_add_accelerator (edit1, "activate_item", accel_group,
                              tmp_key, GDK_MOD1_MASK, (GtkAccelFlags) 0);
  gtk_widget_ref (edit1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "edit1", edit1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (edit1);
  gtk_container_add (GTK_CONTAINER (menubar1), edit1);

  edit1_menu = gtk_menu_new ();
  gtk_widget_ref (edit1_menu);
  gtk_object_set_data_full (GTK_OBJECT (window1), "edit1_menu", edit1_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (edit1), edit1_menu);
  edit1_menu_accels = gtk_menu_ensure_uline_accel_group (GTK_MENU (edit1_menu));

  map_colour1 = gtk_menu_item_new_with_label (_("Map Colour..."));
  gtk_widget_ref (map_colour1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "map_colour1", map_colour1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (map_colour1);
  gtk_container_add (GTK_CONTAINER (edit1_menu), map_colour1);

  density_size1 = gtk_menu_item_new_with_label (_("Map Parameters..."));
  gtk_widget_ref (density_size1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "density_size1", density_size1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (density_size1);
  gtk_container_add (GTK_CONTAINER (edit1_menu), density_size1);

  bond_colours1 = gtk_menu_item_new_with_label (_("Bond Colours..."));
  gtk_widget_ref (bond_colours1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "bond_colours1", bond_colours1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (bond_colours1);
  gtk_container_add (GTK_CONTAINER (edit1_menu), bond_colours1);

  bond_parameters1 = gtk_menu_item_new_with_label (_("Bond Parameters..."));
  gtk_widget_ref (bond_parameters1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "bond_parameters1", bond_parameters1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (bond_parameters1);
  gtk_container_add (GTK_CONTAINER (edit1_menu), bond_parameters1);

  skeleton_parameters1 = gtk_menu_item_new_with_label (_("Skeleton Parameters"));
  gtk_widget_ref (skeleton_parameters1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "skeleton_parameters1", skeleton_parameters1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeleton_parameters1);
  gtk_container_add (GTK_CONTAINER (edit1_menu), skeleton_parameters1);

  skeleton_parameters1_menu = gtk_menu_new ();
  gtk_widget_ref (skeleton_parameters1_menu);
  gtk_object_set_data_full (GTK_OBJECT (window1), "skeleton_parameters1_menu", skeleton_parameters1_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (skeleton_parameters1), skeleton_parameters1_menu);
  skeleton_parameters1_menu_accels = gtk_menu_ensure_uline_accel_group (GTK_MENU (skeleton_parameters1_menu));

  skeleton_colour1 = gtk_menu_item_new_with_label (_("Skeleton Colour..."));
  gtk_widget_ref (skeleton_colour1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "skeleton_colour1", skeleton_colour1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeleton_colour1);
  gtk_container_add (GTK_CONTAINER (skeleton_parameters1_menu), skeleton_colour1);

  skeleton_box_radius1 = gtk_menu_item_new_with_label (_("Skeleton Box Radius..."));
  gtk_widget_ref (skeleton_box_radius1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "skeleton_box_radius1", skeleton_box_radius1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeleton_box_radius1);
  gtk_container_add (GTK_CONTAINER (skeleton_parameters1_menu), skeleton_box_radius1);

  skeletonization_level1 = gtk_menu_item_new_with_label (_("Skeletonization Level..."));
  gtk_widget_ref (skeletonization_level1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "skeletonization_level1", skeletonization_level1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeletonization_level1);
  gtk_container_add (GTK_CONTAINER (skeleton_parameters1_menu), skeletonization_level1);

  residue_info2 = gtk_menu_item_new_with_label (_("Residue Info..."));
  gtk_widget_ref (residue_info2);
  gtk_object_set_data_full (GTK_OBJECT (window1), "residue_info2", residue_info2,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_info2);
  gtk_container_add (GTK_CONTAINER (edit1_menu), residue_info2);

  font_size1 = gtk_menu_item_new_with_label (_("Font Size..."));
  gtk_widget_ref (font_size1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "font_size1", font_size1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (font_size1);
  gtk_container_add (GTK_CONTAINER (edit1_menu), font_size1);

  pink_pointer_size1 = gtk_menu_item_new_with_label (_("Pink Pointer Size..."));
  gtk_widget_ref (pink_pointer_size1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "pink_pointer_size1", pink_pointer_size1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pink_pointer_size1);
  gtk_container_add (GTK_CONTAINER (edit1_menu), pink_pointer_size1);

  background_colour1 = gtk_menu_item_new_with_label (_("Background Colour..."));
  gtk_widget_ref (background_colour1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "background_colour1", background_colour1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (background_colour1);
  gtk_container_add (GTK_CONTAINER (edit1_menu), background_colour1);

  background_colour1_menu = gtk_menu_new ();
  gtk_widget_ref (background_colour1_menu);
  gtk_object_set_data_full (GTK_OBJECT (window1), "background_colour1_menu", background_colour1_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (background_colour1), background_colour1_menu);
  background_colour1_menu_accels = gtk_menu_ensure_uline_accel_group (GTK_MENU (background_colour1_menu));

  background_black1 = gtk_radio_menu_item_new_with_label (background_group, _("Black"));
  background_group = gtk_radio_menu_item_group (GTK_RADIO_MENU_ITEM (background_black1));
  gtk_widget_ref (background_black1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "background_black1", background_black1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (background_black1);
  gtk_container_add (GTK_CONTAINER (background_colour1_menu), background_black1);
  gtk_check_menu_item_set_show_toggle (GTK_CHECK_MENU_ITEM (background_black1), TRUE);

  background_white1 = gtk_radio_menu_item_new_with_label (background_group, _("White"));
  background_group = gtk_radio_menu_item_group (GTK_RADIO_MENU_ITEM (background_white1));
  gtk_widget_ref (background_white1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "background_white1", background_white1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (background_white1);
  gtk_container_add (GTK_CONTAINER (background_colour1_menu), background_white1);
  gtk_check_menu_item_set_active (GTK_CHECK_MENU_ITEM (background_white1), TRUE);
  gtk_check_menu_item_set_show_toggle (GTK_CHECK_MENU_ITEM (background_white1), TRUE);

  calculate1 = gtk_menu_item_new_with_label ("");
  tmp_key = gtk_label_parse_uline (GTK_LABEL (GTK_BIN (calculate1)->child),
                                   _("_Calculate"));
  gtk_widget_add_accelerator (calculate1, "activate_item", accel_group,
                              tmp_key, GDK_MOD1_MASK, (GtkAccelFlags) 0);
  gtk_widget_ref (calculate1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "calculate1", calculate1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (calculate1);
  gtk_container_add (GTK_CONTAINER (menubar1), calculate1);

  calculate1_menu = gtk_menu_new ();
  gtk_widget_ref (calculate1_menu);
  gtk_object_set_data_full (GTK_OBJECT (window1), "calculate1_menu", calculate1_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (calculate1), calculate1_menu);
  calculate1_menu_accels = gtk_menu_ensure_uline_accel_group (GTK_MENU (calculate1_menu));

  regularize1 = gtk_menu_item_new_with_label (_("Model/Fit/Refine..."));
  gtk_widget_ref (regularize1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "regularize1", regularize1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (regularize1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), regularize1);

  other_modelling_tools1 = gtk_menu_item_new_with_label (_("Other Modelling Tools..."));
  gtk_widget_ref (other_modelling_tools1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "other_modelling_tools1", other_modelling_tools1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (other_modelling_tools1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), other_modelling_tools1);

  ssm_superposition1 = gtk_menu_item_new_with_label (_("SSM Superpose..."));
  gtk_widget_ref (ssm_superposition1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "ssm_superposition1", ssm_superposition1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ssm_superposition1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), ssm_superposition1);

  lsq_superpose1 = gtk_menu_item_new_with_label (_("LSQ Superpose..."));
  gtk_widget_ref (lsq_superpose1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "lsq_superpose1", lsq_superpose1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (lsq_superpose1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), lsq_superpose1);
  gtk_tooltips_set_tip (tooltips, lsq_superpose1, _("Least squares fit structures using residue range"), NULL);

  merge_molecules1 = gtk_menu_item_new_with_label (_("Merge Molecules..."));
  gtk_widget_ref (merge_molecules1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "merge_molecules1", merge_molecules1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (merge_molecules1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), merge_molecules1);

  mutate_molecule1 = gtk_menu_item_new_with_label (_("Mutate Residue Range..."));
  gtk_widget_ref (mutate_molecule1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "mutate_molecule1", mutate_molecule1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (mutate_molecule1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), mutate_molecule1);

  align___mutate1 = gtk_menu_item_new_with_label (_("Align & Mutate..."));
  gtk_widget_ref (align___mutate1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "align___mutate1", align___mutate1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (align___mutate1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), align___mutate1);

  renumber_residues1 = gtk_menu_item_new_with_label (_("Renumber Residues..."));
  gtk_widget_ref (renumber_residues1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "renumber_residues1", renumber_residues1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (renumber_residues1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), renumber_residues1);

  change_chain_ids2 = gtk_menu_item_new_with_label (_("Change Chain IDs..."));
  gtk_widget_ref (change_chain_ids2);
  gtk_object_set_data_full (GTK_OBJECT (window1), "change_chain_ids2", change_chain_ids2,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (change_chain_ids2);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), change_chain_ids2);

  move_molecule_here1 = gtk_menu_item_new_with_label (_("Move Molecule Here..."));
  gtk_widget_ref (move_molecule_here1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "move_molecule_here1", move_molecule_here1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (move_molecule_here1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), move_molecule_here1);

  fit_loop1 = gtk_menu_item_new_with_label (_("Fit Loop..."));
  gtk_widget_ref (fit_loop1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "fit_loop1", fit_loop1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (fit_loop1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), fit_loop1);

  cowtan_foadi_skeleton1 = gtk_menu_item_new_with_label (_("Map Skeleton..."));
  gtk_widget_ref (cowtan_foadi_skeleton1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "cowtan_foadi_skeleton1", cowtan_foadi_skeleton1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (cowtan_foadi_skeleton1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), cowtan_foadi_skeleton1);

  ncs_maps1 = gtk_menu_item_new_with_label (_("NCS Maps..."));
  gtk_widget_ref (ncs_maps1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "ncs_maps1", ncs_maps1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ncs_maps1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), ncs_maps1);

  frames_sec1 = gtk_menu_item_new_with_label (_("Frames/Sec..."));
  gtk_widget_ref (frames_sec1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "frames_sec1", frames_sec1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frames_sec1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), frames_sec1);

  scripting_testing1 = gtk_menu_item_new_with_label (_("Scripting..."));
  gtk_widget_ref (scripting_testing1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "scripting_testing1", scripting_testing1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scripting_testing1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), scripting_testing1);

  run_script1 = gtk_menu_item_new_with_label (_("Run Script..."));
  gtk_widget_ref (run_script1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "run_script1", run_script1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (run_script1);
  gtk_container_add (GTK_CONTAINER (calculate1_menu), run_script1);

  draw1 = gtk_menu_item_new_with_label ("");
  tmp_key = gtk_label_parse_uline (GTK_LABEL (GTK_BIN (draw1)->child),
                                   _("_Draw"));
  gtk_widget_add_accelerator (draw1, "activate_item", accel_group,
                              tmp_key, GDK_MOD1_MASK, (GtkAccelFlags) 0);
  gtk_widget_ref (draw1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "draw1", draw1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (draw1);
  gtk_container_add (GTK_CONTAINER (menubar1), draw1);

  draw1_menu = gtk_menu_new ();
  gtk_widget_ref (draw1_menu);
  gtk_object_set_data_full (GTK_OBJECT (window1), "draw1_menu", draw1_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (draw1), draw1_menu);
  draw1_menu_accels = gtk_menu_ensure_uline_accel_group (GTK_MENU (draw1_menu));

  go_to_atom1 = gtk_menu_item_new_with_label (_("Go To Atom..."));
  gtk_widget_ref (go_to_atom1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "go_to_atom1", go_to_atom1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (go_to_atom1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), go_to_atom1);

  undo_last_navigation1 = gtk_menu_item_new_with_label (_("Undo Last Navigation"));
  gtk_widget_ref (undo_last_navigation1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "undo_last_navigation1", undo_last_navigation1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (undo_last_navigation1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), undo_last_navigation1);

  centre_atom_label1 = gtk_menu_item_new_with_label (_("Centre Atom Label..."));
  gtk_widget_ref (centre_atom_label1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "centre_atom_label1", centre_atom_label1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (centre_atom_label1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), centre_atom_label1);

  sequence_view1 = gtk_menu_item_new_with_label (_("Sequence View"));
  gtk_widget_ref (sequence_view1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "sequence_view1", sequence_view1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (sequence_view1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), sequence_view1);

  anisotropic_atoms1 = gtk_menu_item_new_with_label (_("Anisotropic Atoms..."));
  gtk_widget_ref (anisotropic_atoms1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "anisotropic_atoms1", anisotropic_atoms1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (anisotropic_atoms1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), anisotropic_atoms1);

  show_symmetry1 = gtk_menu_item_new_with_label (_("Cell & Symmetry..."));
  gtk_widget_ref (show_symmetry1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "show_symmetry1", show_symmetry1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (show_symmetry1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), show_symmetry1);

  ncs_ghost_control1 = gtk_menu_item_new_with_label (_("NCS Ghost Control..."));
  gtk_widget_ref (ncs_ghost_control1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "ncs_ghost_control1", ncs_ghost_control1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ncs_ghost_control1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), ncs_ghost_control1);
  gtk_tooltips_set_tip (tooltips, ncs_ghost_control1, _("Non-crystallographic Ghost Controller"), NULL);

  spin_view_on_off1 = gtk_menu_item_new_with_label (_("Spin View On/Off"));
  gtk_widget_ref (spin_view_on_off1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "spin_view_on_off1", spin_view_on_off1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (spin_view_on_off1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), spin_view_on_off1);

  screenshot1 = gtk_menu_item_new_with_label (_("Screenshot"));
  gtk_widget_ref (screenshot1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "screenshot1", screenshot1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (screenshot1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), screenshot1);

  screenshot1_menu = gtk_menu_new ();
  gtk_widget_ref (screenshot1_menu);
  gtk_object_set_data_full (GTK_OBJECT (window1), "screenshot1_menu", screenshot1_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (screenshot1), screenshot1_menu);
  screenshot1_menu_accels = gtk_menu_ensure_uline_accel_group (GTK_MENU (screenshot1_menu));

  simple1 = gtk_menu_item_new_with_label (_("Simple..."));
  gtk_widget_ref (simple1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "simple1", simple1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (simple1);
  gtk_container_add (GTK_CONTAINER (screenshot1_menu), simple1);

  povray1 = gtk_menu_item_new_with_label (_("Povray..."));
  gtk_widget_ref (povray1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "povray1", povray1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (povray1);
  gtk_container_add (GTK_CONTAINER (screenshot1_menu), povray1);

  raster3d1 = gtk_menu_item_new_with_label (_("Raster3D..."));
  gtk_widget_ref (raster3d1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "raster3d1", raster3d1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (raster3d1);
  gtk_container_add (GTK_CONTAINER (screenshot1_menu), raster3d1);

  generic_display_objects1 = gtk_menu_item_new_with_label (_("Generic Display Objects..."));
  gtk_widget_ref (generic_display_objects1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "generic_display_objects1", generic_display_objects1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (generic_display_objects1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), generic_display_objects1);

  antialiasing1 = gtk_menu_item_new_with_label (_("Antialiasing..."));
  gtk_widget_ref (antialiasing1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "antialiasing1", antialiasing1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (antialiasing1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), antialiasing1);

  stereo1 = gtk_menu_item_new_with_label (_("Stereo..."));
  gtk_widget_ref (stereo1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "stereo1", stereo1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (stereo1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), stereo1);

  clipping1 = gtk_menu_item_new_with_label (_("Clipping..."));
  gtk_widget_ref (clipping1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "clipping1", clipping1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (clipping1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), clipping1);

  crosshairs1 = gtk_menu_item_new_with_label (_("Crosshairs..."));
  gtk_widget_ref (crosshairs1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "crosshairs1", crosshairs1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (crosshairs1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), crosshairs1);

  zoom1 = gtk_menu_item_new_with_label (_("Zoom..."));
  gtk_widget_ref (zoom1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "zoom1", zoom1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (zoom1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), zoom1);

  dragged_map1 = gtk_menu_item_new_with_label (_("Dragged Map..."));
  gtk_widget_ref (dragged_map1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "dragged_map1", dragged_map1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (dragged_map1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), dragged_map1);

  recentring1 = gtk_menu_item_new_with_label (_("Smooth Recentring..."));
  gtk_widget_ref (recentring1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "recentring1", recentring1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (recentring1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), recentring1);

  coordinates_recentring1 = gtk_menu_item_new_with_label (_("Coordinates Recentring..."));
  gtk_widget_ref (coordinates_recentring1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "coordinates_recentring1", coordinates_recentring1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (coordinates_recentring1);
  gtk_container_add (GTK_CONTAINER (draw1_menu), coordinates_recentring1);

  map_and_mol_control1 = gtk_menu_item_new_with_label ("");
  tmp_key = gtk_label_parse_uline (GTK_LABEL (GTK_BIN (map_and_mol_control1)->child),
                                   _("D_isplay Manager"));
  gtk_widget_add_accelerator (map_and_mol_control1, "activate_item", accel_group,
                              tmp_key, GDK_MOD1_MASK, (GtkAccelFlags) 0);
  gtk_widget_ref (map_and_mol_control1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "map_and_mol_control1", map_and_mol_control1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (map_and_mol_control1);
  gtk_container_add (GTK_CONTAINER (menubar1), map_and_mol_control1);
  gtk_tooltips_set_tip (tooltips, map_and_mol_control1, _("Control display and activity of maps and molecules"), NULL);

  main_menu_info = gtk_menu_item_new_with_label ("");
  tmp_key = gtk_label_parse_uline (GTK_LABEL (GTK_BIN (main_menu_info)->child),
                                   _("_Measures"));
  gtk_widget_add_accelerator (main_menu_info, "activate_item", accel_group,
                              tmp_key, GDK_MOD1_MASK, (GtkAccelFlags) 0);
  gtk_widget_ref (main_menu_info);
  gtk_object_set_data_full (GTK_OBJECT (window1), "main_menu_info", main_menu_info,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (main_menu_info);
  gtk_container_add (GTK_CONTAINER (menubar1), main_menu_info);

  main_menu_info_menu = gtk_menu_new ();
  gtk_widget_ref (main_menu_info_menu);
  gtk_object_set_data_full (GTK_OBJECT (window1), "main_menu_info_menu", main_menu_info_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (main_menu_info), main_menu_info_menu);
  main_menu_info_menu_accels = gtk_menu_ensure_uline_accel_group (GTK_MENU (main_menu_info_menu));

  residue_info1 = gtk_menu_item_new_with_label (_("Residue Info..."));
  gtk_widget_ref (residue_info1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "residue_info1", residue_info1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_info1);
  gtk_container_add (GTK_CONTAINER (main_menu_info_menu), residue_info1);
  gtk_tooltips_set_tip (tooltips, residue_info1, _("Display atom names, temperature factors and occupances of all atoms in the residue"), NULL);

  distances___angles1 = gtk_menu_item_new_with_label (_("Distances & Angles..."));
  gtk_widget_ref (distances___angles1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "distances___angles1", distances___angles1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (distances___angles1);
  gtk_container_add (GTK_CONTAINER (main_menu_info_menu), distances___angles1);

  environment_distances1 = gtk_menu_item_new_with_label (_("Environment Distances..."));
  gtk_widget_ref (environment_distances1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "environment_distances1", environment_distances1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (environment_distances1);
  gtk_container_add (GTK_CONTAINER (main_menu_info_menu), environment_distances1);

  plane_distances1 = gtk_menu_item_new_with_label (_("Plane Distances..."));
  gtk_widget_ref (plane_distances1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "plane_distances1", plane_distances1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (plane_distances1);
  gtk_container_add (GTK_CONTAINER (main_menu_info_menu), plane_distances1);

  pointer_distances1 = gtk_menu_item_new_with_label (_("Pointer Distances..."));
  gtk_widget_ref (pointer_distances1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "pointer_distances1", pointer_distances1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_distances1);
  gtk_container_add (GTK_CONTAINER (main_menu_info_menu), pointer_distances1);

  clear_atom_labels1 = gtk_menu_item_new_with_label (_("Clear Atom Labels"));
  gtk_widget_ref (clear_atom_labels1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "clear_atom_labels1", clear_atom_labels1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (clear_atom_labels1);
  gtk_container_add (GTK_CONTAINER (main_menu_info_menu), clear_atom_labels1);

  validate1 = gtk_menu_item_new_with_label ("");
  tmp_key = gtk_label_parse_uline (GTK_LABEL (GTK_BIN (validate1)->child),
                                   _("_Validate"));
  gtk_widget_add_accelerator (validate1, "activate_item", accel_group,
                              tmp_key, GDK_MOD1_MASK, (GtkAccelFlags) 0);
  gtk_widget_ref (validate1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "validate1", validate1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (validate1);
  gtk_container_add (GTK_CONTAINER (menubar1), validate1);

  validate1_menu = gtk_menu_new ();
  gtk_widget_ref (validate1_menu);
  gtk_object_set_data_full (GTK_OBJECT (window1), "validate1_menu", validate1_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (validate1), validate1_menu);
  validate1_menu_accels = gtk_menu_ensure_uline_accel_group (GTK_MENU (validate1_menu));

  ramachandran_plot1 = gtk_menu_item_new_with_label (_("Ramachandran Plot"));
  gtk_widget_ref (ramachandran_plot1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "ramachandran_plot1", ramachandran_plot1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ramachandran_plot1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), ramachandran_plot1);

  ramachandran_differences_plot1 = gtk_menu_item_new_with_label (_("Kleywegt Plot..."));
  gtk_widget_ref (ramachandran_differences_plot1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "ramachandran_differences_plot1", ramachandran_differences_plot1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ramachandran_differences_plot1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), ramachandran_differences_plot1);
  gtk_tooltips_set_tip (tooltips, ramachandran_differences_plot1, _("Ramachandran Difference Plot"), NULL);

  incorrect_chiral_volumes1 = gtk_menu_item_new_with_label (_("Incorrect Chiral Volumes..."));
  gtk_widget_ref (incorrect_chiral_volumes1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "incorrect_chiral_volumes1", incorrect_chiral_volumes1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (incorrect_chiral_volumes1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), incorrect_chiral_volumes1);

  unmodelled_blobs1 = gtk_menu_item_new_with_label (_("Unmodelled blobs..."));
  gtk_widget_ref (unmodelled_blobs1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "unmodelled_blobs1", unmodelled_blobs1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (unmodelled_blobs1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), unmodelled_blobs1);

  difference_map_peaks1 = gtk_menu_item_new_with_label (_("Difference Map Peaks..."));
  gtk_widget_ref (difference_map_peaks1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "difference_map_peaks1", difference_map_peaks1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (difference_map_peaks1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), difference_map_peaks1);

  check_waters1 = gtk_menu_item_new_with_label (_("Check/Delete Waters..."));
  gtk_widget_ref (check_waters1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "check_waters1", check_waters1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), check_waters1);

  check_waters_by_difference_map_variance1 = gtk_menu_item_new_with_label (_("Check waters by Difference Map Variance..."));
  gtk_widget_ref (check_waters_by_difference_map_variance1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "check_waters_by_difference_map_variance1", check_waters_by_difference_map_variance1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_by_difference_map_variance1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), check_waters_by_difference_map_variance1);

  geometry_analysis1 = gtk_menu_item_new_with_label (_("Geometry analysis"));
  gtk_widget_ref (geometry_analysis1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "geometry_analysis1", geometry_analysis1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (geometry_analysis1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), geometry_analysis1);
  gtk_tooltips_set_tip (tooltips, geometry_analysis1, _("Flags distortions in Bond, Angles and Planes"), NULL);

  peptide_omega_analysis1 = gtk_menu_item_new_with_label (_("Peptide omega analysis"));
  gtk_widget_ref (peptide_omega_analysis1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "peptide_omega_analysis1", peptide_omega_analysis1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (peptide_omega_analysis1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), peptide_omega_analysis1);
  gtk_tooltips_set_tip (tooltips, peptide_omega_analysis1, _("Flags deviations from Trans Peptide"), NULL);

  temp_fact_variance_analysis1 = gtk_menu_item_new_with_label (_("Temp. fact. variance analysis"));
  gtk_widget_ref (temp_fact_variance_analysis1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "temp_fact_variance_analysis1", temp_fact_variance_analysis1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (temp_fact_variance_analysis1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), temp_fact_variance_analysis1);
  gtk_tooltips_set_tip (tooltips, temp_fact_variance_analysis1, _("Flags Residues with Large Variance in Atom B factors"), NULL);

  gln_and_asn_b_factor_outliers1 = gtk_menu_item_new_with_label (_("GLN and ASN B-factor Outliers"));
  gtk_widget_ref (gln_and_asn_b_factor_outliers1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "gln_and_asn_b_factor_outliers1", gln_and_asn_b_factor_outliers1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (gln_and_asn_b_factor_outliers1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), gln_and_asn_b_factor_outliers1);
  gtk_tooltips_set_tip (tooltips, gln_and_asn_b_factor_outliers1, _("Nakagawa's Bees (probable flips):  identify OE1 and NE2 B-factor outliers in GLNs (similarly ASNs are analysed)"), NULL);

  rotamer_analysis1 = gtk_menu_item_new_with_label (_("Rotamer analysis"));
  gtk_widget_ref (rotamer_analysis1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "rotamer_analysis1", rotamer_analysis1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotamer_analysis1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), rotamer_analysis1);
  gtk_tooltips_set_tip (tooltips, rotamer_analysis1, _("Flags Unusual Rotamers, Missing Atoms and Nomenclature Errors"), NULL);

  density_fit_analysis1 = gtk_menu_item_new_with_label (_("Density fit analysis"));
  gtk_widget_ref (density_fit_analysis1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "density_fit_analysis1", density_fit_analysis1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (density_fit_analysis1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), density_fit_analysis1);

  probe_clashes1 = gtk_menu_item_new_with_label (_("Probe clashes"));
  gtk_widget_ref (probe_clashes1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "probe_clashes1", probe_clashes1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (probe_clashes1);
  gtk_container_add (GTK_CONTAINER (validate1_menu), probe_clashes1);

  hid1 = gtk_menu_item_new_with_label (_("HID"));
  gtk_widget_ref (hid1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "hid1", hid1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hid1);
  gtk_container_add (GTK_CONTAINER (menubar1), hid1);

  hid1_menu = gtk_menu_new ();
  gtk_widget_ref (hid1_menu);
  gtk_object_set_data_full (GTK_OBJECT (window1), "hid1_menu", hid1_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (hid1), hid1_menu);
  hid1_menu_accels = gtk_menu_ensure_uline_accel_group (GTK_MENU (hid1_menu));

  scrollwheel1 = gtk_menu_item_new_with_label (_("ScrollWheel"));
  gtk_widget_ref (scrollwheel1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "scrollwheel1", scrollwheel1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrollwheel1);
  gtk_container_add (GTK_CONTAINER (hid1_menu), scrollwheel1);

  scrollwheel1_menu = gtk_menu_new ();
  gtk_widget_ref (scrollwheel1_menu);
  gtk_object_set_data_full (GTK_OBJECT (window1), "scrollwheel1_menu", scrollwheel1_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (scrollwheel1), scrollwheel1_menu);
  scrollwheel1_menu_accels = gtk_menu_ensure_uline_accel_group (GTK_MENU (scrollwheel1_menu));

  attach_scroll_wheel_to_which_map_1 = gtk_menu_item_new_with_label (_("Attach scroll wheel to which map?"));
  gtk_widget_ref (attach_scroll_wheel_to_which_map_1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "attach_scroll_wheel_to_which_map_1", attach_scroll_wheel_to_which_map_1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (attach_scroll_wheel_to_which_map_1);
  gtk_container_add (GTK_CONTAINER (scrollwheel1_menu), attach_scroll_wheel_to_which_map_1);

  virtual_trackball1 = gtk_menu_item_new_with_label (_("Virtual Trackball"));
  gtk_widget_ref (virtual_trackball1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "virtual_trackball1", virtual_trackball1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (virtual_trackball1);
  gtk_container_add (GTK_CONTAINER (hid1_menu), virtual_trackball1);

  virtual_trackball1_menu = gtk_menu_new ();
  gtk_widget_ref (virtual_trackball1_menu);
  gtk_object_set_data_full (GTK_OBJECT (window1), "virtual_trackball1_menu", virtual_trackball1_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (virtual_trackball1), virtual_trackball1_menu);
  virtual_trackball1_menu_accels = gtk_menu_ensure_uline_accel_group (GTK_MENU (virtual_trackball1_menu));

  flat1 = gtk_radio_menu_item_new_with_label (vtrack_group, _("Flat"));
  vtrack_group = gtk_radio_menu_item_group (GTK_RADIO_MENU_ITEM (flat1));
  gtk_widget_ref (flat1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "flat1", flat1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (flat1);
  gtk_container_add (GTK_CONTAINER (virtual_trackball1_menu), flat1);
  gtk_check_menu_item_set_show_toggle (GTK_CHECK_MENU_ITEM (flat1), TRUE);

  spherical_surface1 = gtk_radio_menu_item_new_with_label (vtrack_group, _("Spherical Surface"));
  vtrack_group = gtk_radio_menu_item_group (GTK_RADIO_MENU_ITEM (spherical_surface1));
  gtk_widget_ref (spherical_surface1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "spherical_surface1", spherical_surface1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (spherical_surface1);
  gtk_container_add (GTK_CONTAINER (virtual_trackball1_menu), spherical_surface1);
  gtk_check_menu_item_set_active (GTK_CHECK_MENU_ITEM (spherical_surface1), TRUE);
  gtk_check_menu_item_set_show_toggle (GTK_CHECK_MENU_ITEM (spherical_surface1), TRUE);

  reset_view1 = gtk_menu_item_new_with_label ("");
  tmp_key = gtk_label_parse_uline (GTK_LABEL (GTK_BIN (reset_view1)->child),
                                   _("_Reset View"));
  gtk_widget_add_accelerator (reset_view1, "activate_item", accel_group,
                              tmp_key, GDK_MOD1_MASK, (GtkAccelFlags) 0);
  gtk_widget_ref (reset_view1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "reset_view1", reset_view1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (reset_view1);
  gtk_container_add (GTK_CONTAINER (menubar1), reset_view1);
  gtk_tooltips_set_tip (tooltips, reset_view1, _("Recentre of the last read molecule that is displayed"), NULL);

  help1 = gtk_menu_item_new_with_label (_("About"));
  gtk_widget_ref (help1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "help1", help1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (help1);
  gtk_container_add (GTK_CONTAINER (menubar1), help1);

  help1_menu = gtk_menu_new ();
  gtk_widget_ref (help1_menu);
  gtk_object_set_data_full (GTK_OBJECT (window1), "help1_menu", help1_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_menu_item_set_submenu (GTK_MENU_ITEM (help1), help1_menu);
  help1_menu_accels = gtk_menu_ensure_uline_accel_group (GTK_MENU (help1_menu));

  on_line_docs_url1 = gtk_menu_item_new_with_label (_("On Line Docs URL..."));
  gtk_widget_ref (on_line_docs_url1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "on_line_docs_url1", on_line_docs_url1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (on_line_docs_url1);
  gtk_container_add (GTK_CONTAINER (help1_menu), on_line_docs_url1);

  about1 = gtk_menu_item_new_with_label (_("About..."));
  gtk_widget_ref (about1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "about1", about1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (about1);
  gtk_container_add (GTK_CONTAINER (help1_menu), about1);

  hints1 = gtk_menu_item_new_with_label (_("Hints..."));
  gtk_widget_ref (hints1);
  gtk_object_set_data_full (GTK_OBJECT (window1), "hints1", hints1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hints1);
  gtk_container_add (GTK_CONTAINER (help1_menu), hints1);

  accept_reject_dialog_frame = gtk_frame_new (NULL);
  gtk_widget_ref (accept_reject_dialog_frame);
  gtk_object_set_data_full (GTK_OBJECT (window1), "accept_reject_dialog_frame", accept_reject_dialog_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (vbox1), accept_reject_dialog_frame, TRUE, TRUE, 0);

  main_window_graphics_hbox = gtk_hbox_new (TRUE, 0);
  gtk_widget_ref (main_window_graphics_hbox);
  gtk_object_set_data_full (GTK_OBJECT (window1), "main_window_graphics_hbox", main_window_graphics_hbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (main_window_graphics_hbox);
  gtk_box_pack_start (GTK_BOX (vbox1), main_window_graphics_hbox, TRUE, TRUE, 0);

  main_window_statusbar = gtk_statusbar_new ();
  gtk_widget_ref (main_window_statusbar);
  gtk_object_set_data_full (GTK_OBJECT (window1), "main_window_statusbar", main_window_statusbar,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (main_window_statusbar);
  gtk_box_pack_start (GTK_BOX (vbox1), main_window_statusbar, FALSE, FALSE, 0);

  main_window_model_fit_dialog_frame = gtk_frame_new (NULL);
  gtk_widget_ref (main_window_model_fit_dialog_frame);
  gtk_object_set_data_full (GTK_OBJECT (window1), "main_window_model_fit_dialog_frame", main_window_model_fit_dialog_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (main_window_hbox), main_window_model_fit_dialog_frame, FALSE, FALSE, 0);

  gtkhtml_frame = gtk_frame_new (NULL);
  gtk_widget_ref (gtkhtml_frame);
  gtk_object_set_data_full (GTK_OBJECT (window1), "gtkhtml_frame", gtkhtml_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (main_window_hbox), gtkhtml_frame, TRUE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (window1), "destroy",
                      GTK_SIGNAL_FUNC (on_window1_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (window1), "configure_event",
                      GTK_SIGNAL_FUNC (on_window1_configure_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (window1), "delete_event",
                      GTK_SIGNAL_FUNC (on_window1_delete_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (file1), "activate",
                      GTK_SIGNAL_FUNC (on_file1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (open_coordinates1), "activate",
                      GTK_SIGNAL_FUNC (on_open_coordinates1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (auto_open_mtz), "activate",
                      GTK_SIGNAL_FUNC (on_auto_open_mtz_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (open_dataset1), "activate",
                      GTK_SIGNAL_FUNC (on_open_dataset1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (open_map1), "activate",
                      GTK_SIGNAL_FUNC (on_open_map1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (close_molecule1), "activate",
                      GTK_SIGNAL_FUNC (on_close_molecule1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (import_cif_dictionary1), "activate",
                      GTK_SIGNAL_FUNC (on_import_cif_dictionary1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (get_monomer1), "activate",
                      GTK_SIGNAL_FUNC (on_get_monomer1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (search_monomer_library1), "activate",
                      GTK_SIGNAL_FUNC (on_search_monomer_library1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (smiles1), "activate",
                      GTK_SIGNAL_FUNC (on_smiles1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (get_pdb_using_code1), "activate",
                      GTK_SIGNAL_FUNC (on_get_pdb_using_code1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (get_pdb_and_map_using_eds1), "activate",
                      GTK_SIGNAL_FUNC (on_get_pdb_and_map_using_eds1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (save_coordinates1), "activate",
                      GTK_SIGNAL_FUNC (on_save_coordinates1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (save_symmetry_coordinates1), "activate",
                      GTK_SIGNAL_FUNC (on_save_symmetry_coordinates1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (save_state1), "activate",
                      GTK_SIGNAL_FUNC (on_save_state1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (recover_session1), "activate",
                      GTK_SIGNAL_FUNC (on_recover_session1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (exit1), "activate",
                      GTK_SIGNAL_FUNC (on_exit1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (map_colour1), "activate",
                      GTK_SIGNAL_FUNC (on_map_colour1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (density_size1), "activate",
                      GTK_SIGNAL_FUNC (on_density_size1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (bond_colours1), "activate",
                      GTK_SIGNAL_FUNC (on_bond_colours1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (bond_parameters1), "activate",
                      GTK_SIGNAL_FUNC (on_bond_parameters1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (skeleton_colour1), "activate",
                      GTK_SIGNAL_FUNC (on_skeleton_colour1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (skeleton_box_radius1), "activate",
                      GTK_SIGNAL_FUNC (on_skeleton_box_radius1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (skeletonization_level1), "activate",
                      GTK_SIGNAL_FUNC (on_skeletonization_level1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_info2), "activate",
                      GTK_SIGNAL_FUNC (on_residue_info2_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (font_size1), "activate",
                      GTK_SIGNAL_FUNC (on_font_size1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (pink_pointer_size1), "activate",
                      GTK_SIGNAL_FUNC (on_pink_pointer_size1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (background_colour1), "activate",
                      GTK_SIGNAL_FUNC (on_background_colour1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (background_black1), "activate",
                      GTK_SIGNAL_FUNC (on_background_black1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (background_white1), "activate",
                      GTK_SIGNAL_FUNC (on_background_white1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (regularize1), "activate",
                      GTK_SIGNAL_FUNC (on_model_refine_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (other_modelling_tools1), "activate",
                      GTK_SIGNAL_FUNC (on_other_modelling_tools1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ssm_superposition1), "activate",
                      GTK_SIGNAL_FUNC (on_ssm_superposition1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (lsq_superpose1), "activate",
                      GTK_SIGNAL_FUNC (on_lsq_superpose1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (merge_molecules1), "activate",
                      GTK_SIGNAL_FUNC (on_merge_molecules1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (mutate_molecule1), "activate",
                      GTK_SIGNAL_FUNC (on_mutate_molecule1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (align___mutate1), "activate",
                      GTK_SIGNAL_FUNC (on_align___mutate1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (renumber_residues1), "activate",
                      GTK_SIGNAL_FUNC (on_renumber_residues1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (change_chain_ids2), "activate",
                      GTK_SIGNAL_FUNC (on_change_chain_ids2_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (move_molecule_here1), "activate",
                      GTK_SIGNAL_FUNC (on_move_molecule_here1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (fit_loop1), "activate",
                      GTK_SIGNAL_FUNC (on_fit_loop1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (cowtan_foadi_skeleton1), "activate",
                      GTK_SIGNAL_FUNC (on_skeleton1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ncs_maps1), "activate",
                      GTK_SIGNAL_FUNC (on_ncs_maps1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (frames_sec1), "activate",
                      GTK_SIGNAL_FUNC (on_fps1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (scripting_testing1), "activate",
                      GTK_SIGNAL_FUNC (on_scripting_window_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (run_script1), "activate",
                      GTK_SIGNAL_FUNC (on_run_script1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (go_to_atom1), "activate",
                      GTK_SIGNAL_FUNC (on_go_to_atom1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (undo_last_navigation1), "activate",
                      GTK_SIGNAL_FUNC (on_undo_last_navigation1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (centre_atom_label1), "activate",
                      GTK_SIGNAL_FUNC (on_centre_atom_label1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (sequence_view1), "activate",
                      GTK_SIGNAL_FUNC (on_sequence_view1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (anisotropic_atoms1), "activate",
                      GTK_SIGNAL_FUNC (on_anisotropic_atoms1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (show_symmetry1), "activate",
                      GTK_SIGNAL_FUNC (on_show_symmetry1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ncs_ghost_control1), "activate",
                      GTK_SIGNAL_FUNC (on_ncs_ghost_control1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (spin_view_on_off1), "activate",
                      GTK_SIGNAL_FUNC (on_spin_view_on_off1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (simple1), "activate",
                      GTK_SIGNAL_FUNC (on_simple1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (povray1), "activate",
                      GTK_SIGNAL_FUNC (on_povray1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (raster3d1), "activate",
                      GTK_SIGNAL_FUNC (on_raster3d1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (generic_display_objects1), "activate",
                      GTK_SIGNAL_FUNC (on_generic_display_objects1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (antialiasing1), "activate",
                      GTK_SIGNAL_FUNC (on_antialiasing1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (stereo1), "activate",
                      GTK_SIGNAL_FUNC (on_stereo1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (clipping1), "activate",
                      GTK_SIGNAL_FUNC (on_clipping1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (crosshairs1), "activate",
                      GTK_SIGNAL_FUNC (on_crosshairs1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (zoom1), "activate",
                      GTK_SIGNAL_FUNC (on_zoom1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (dragged_map1), "activate",
                      GTK_SIGNAL_FUNC (on_dragged_map1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (recentring1), "activate",
                      GTK_SIGNAL_FUNC (on_recentring1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (coordinates_recentring1), "activate",
                      GTK_SIGNAL_FUNC (on_coordinates_recentring1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (map_and_mol_control1), "activate",
                      GTK_SIGNAL_FUNC (on_map_and_mol_control1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_info1), "activate",
                      GTK_SIGNAL_FUNC (on_residue_info1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (distances___angles1), "activate",
                      GTK_SIGNAL_FUNC (on_distances_and_angles1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (environment_distances1), "activate",
                      GTK_SIGNAL_FUNC (on_environment_distances1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (plane_distances1), "activate",
                      GTK_SIGNAL_FUNC (on_plane_distances1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (pointer_distances1), "activate",
                      GTK_SIGNAL_FUNC (on_pointer_distances1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (clear_atom_labels1), "activate",
                      GTK_SIGNAL_FUNC (on_clear_atom_labels1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (validate1), "activate",
                      GTK_SIGNAL_FUNC (on_validate1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ramachandran_plot1), "activate",
                      GTK_SIGNAL_FUNC (on_ramachandran_plot1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ramachandran_differences_plot1), "activate",
                      GTK_SIGNAL_FUNC (on_ramachandran_differences_plot1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (incorrect_chiral_volumes1), "activate",
                      GTK_SIGNAL_FUNC (on_incorrect_chiral_volumes1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (unmodelled_blobs1), "activate",
                      GTK_SIGNAL_FUNC (on_unmodelled_blobs1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (difference_map_peaks1), "activate",
                      GTK_SIGNAL_FUNC (on_difference_map_peaks1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (check_waters1), "activate",
                      GTK_SIGNAL_FUNC (on_check_waters1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (check_waters_by_difference_map_variance1), "activate",
                      GTK_SIGNAL_FUNC (on_check_waters_by_difference_map_variance1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (geometry_analysis1), "activate",
                      GTK_SIGNAL_FUNC (on_geometry_analysis1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (peptide_omega_analysis1), "activate",
                      GTK_SIGNAL_FUNC (on_peptide_omega_analysis1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (temp_fact_variance_analysis1), "activate",
                      GTK_SIGNAL_FUNC (on_temp_fact_variance_analysis1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (gln_and_asn_b_factor_outliers1), "activate",
                      GTK_SIGNAL_FUNC (on_gln_and_asn_b_factor_outliers1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (rotamer_analysis1), "activate",
                      GTK_SIGNAL_FUNC (on_rotamer_analysis1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (density_fit_analysis1), "activate",
                      GTK_SIGNAL_FUNC (on_density_fit_analysis1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (probe_clashes1), "activate",
                      GTK_SIGNAL_FUNC (on_probe_clashes1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (attach_scroll_wheel_to_which_map_1), "activate",
                      GTK_SIGNAL_FUNC (on_attach_scroll_wheel_to_which_map_1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (virtual_trackball1), "activate",
                      GTK_SIGNAL_FUNC (on_virtual_trackball_menu_pops),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (flat1), "activate",
                      GTK_SIGNAL_FUNC (on_vt_flat1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (spherical_surface1), "activate",
                      GTK_SIGNAL_FUNC (on_vt_spherical_surface1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (reset_view1), "activate",
                      GTK_SIGNAL_FUNC (on_reset_view1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (on_line_docs_url1), "activate",
                      GTK_SIGNAL_FUNC (on_on_line_docs_url1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (about1), "activate",
                      GTK_SIGNAL_FUNC (on_about1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (hints1), "activate",
                      GTK_SIGNAL_FUNC (on_hints1_activate),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (main_window_statusbar), "text_popped",
                      GTK_SIGNAL_FUNC (on_main_window_statusbar_text_popped),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (main_window_statusbar), "text_pushed",
                      GTK_SIGNAL_FUNC (on_main_window_statusbar_text_pushed),
                      NULL);

  gtk_object_set_data (GTK_OBJECT (window1), "tooltips", tooltips);

  gtk_window_add_accel_group (GTK_WINDOW (window1), accel_group);

  return window1;
}

GtkWidget*
create_coords_fileselection1 (void)
{
  GtkWidget *coords_fileselection1;
  GtkWidget *ok_button_coordinates;
  GtkWidget *cancel_coords_button1;

  coords_fileselection1 = gtk_file_selection_new (_("Select Coordinates File"));
  gtk_object_set_data (GTK_OBJECT (coords_fileselection1), "coords_fileselection1", coords_fileselection1);
  gtk_container_set_border_width (GTK_CONTAINER (coords_fileselection1), 10);

  ok_button_coordinates = GTK_FILE_SELECTION (coords_fileselection1)->ok_button;
  gtk_object_set_data (GTK_OBJECT (coords_fileselection1), "ok_button_coordinates", ok_button_coordinates);
  gtk_widget_show (ok_button_coordinates);
  GTK_WIDGET_SET_FLAGS (ok_button_coordinates, GTK_CAN_DEFAULT);

  cancel_coords_button1 = GTK_FILE_SELECTION (coords_fileselection1)->cancel_button;
  gtk_object_set_data (GTK_OBJECT (coords_fileselection1), "cancel_coords_button1", cancel_coords_button1);
  gtk_widget_show (cancel_coords_button1);
  GTK_WIDGET_SET_FLAGS (cancel_coords_button1, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (coords_fileselection1), "destroy",
                      GTK_SIGNAL_FUNC (on_coords_fileselection1_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ok_button_coordinates), "clicked",
                      GTK_SIGNAL_FUNC (on_ok_button_coordinates_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (cancel_coords_button1), "clicked",
                      GTK_SIGNAL_FUNC (on_cancel_coords_button1_clicked),
                      NULL);

  return coords_fileselection1;
}

GtkWidget*
create_dataset_fileselection1 (void)
{
  GtkWidget *dataset_fileselection1;
  GtkWidget *ok_button_dataset;
  GtkWidget *cancel_dataset_button1;

  dataset_fileselection1 = gtk_file_selection_new (_("Select Dataset File"));
  gtk_object_set_data (GTK_OBJECT (dataset_fileselection1), "dataset_fileselection1", dataset_fileselection1);
  gtk_container_set_border_width (GTK_CONTAINER (dataset_fileselection1), 10);

  ok_button_dataset = GTK_FILE_SELECTION (dataset_fileselection1)->ok_button;
  gtk_object_set_data (GTK_OBJECT (dataset_fileselection1), "ok_button_dataset", ok_button_dataset);
  gtk_widget_show (ok_button_dataset);
  GTK_WIDGET_SET_FLAGS (ok_button_dataset, GTK_CAN_DEFAULT);

  cancel_dataset_button1 = GTK_FILE_SELECTION (dataset_fileselection1)->cancel_button;
  gtk_object_set_data (GTK_OBJECT (dataset_fileselection1), "cancel_dataset_button1", cancel_dataset_button1);
  gtk_widget_show (cancel_dataset_button1);
  GTK_WIDGET_SET_FLAGS (cancel_dataset_button1, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (dataset_fileselection1), "destroy",
                      GTK_SIGNAL_FUNC (on_dataset_fileselection1_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ok_button_dataset), "clicked",
                      GTK_SIGNAL_FUNC (on_ok_button_dataset_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (cancel_dataset_button1), "clicked",
                      GTK_SIGNAL_FUNC (on_cancel_dataset_button1_clicked),
                      NULL);

  return dataset_fileselection1;
}

GtkWidget*
create_column_label_window (void)
{
  GtkWidget *column_label_window;
  GtkWidget *vbox2;
  GtkWidget *hbox88;
  GtkWidget *label177;
  GtkWidget *column_label_expert_mode_button;
  GtkWidget *label1;
  GtkWidget *vbox3;
  GtkWidget *frame1;
  GtkWidget *hbox1;
  GtkWidget *label2;
  GtkWidget *optionmenu1;
  GtkWidget *optionmenu1_menu;
  GtkWidget *glade_menuitem;
  GtkWidget *frame2;
  GtkWidget *hbox4;
  GtkWidget *label3;
  GtkWidget *optionmenu2;
  GtkWidget *optionmenu2_menu;
  GtkWidget *frame23;
  GtkWidget *vbox28;
  GtkWidget *hbox15;
  GtkWidget *label30;
  GtkWidget *use_weights_checkbutton;
  GtkWidget *column_label_window_weights_hbox;
  GtkWidget *label31;
  GtkWidget *optionmenu3;
  GtkWidget *optionmenu3_menu;
  GtkWidget *column_labels_resolution_limit_frame;
  GtkWidget *vbox113;
  GtkWidget *column_labels_use_resolution_limits_checkbutton;
  GtkWidget *resolution_limits_hbox;
  GtkWidget *label175;
  GtkWidget *column_labels_reso_low_entry;
  GtkWidget *label174;
  GtkWidget *label176;
  GtkWidget *column_labels_reso_high_entry;
  GtkWidget *difference_map_checkbutton;
  GtkWidget *hseparator9;
  GtkWidget *refmac_column_labels_checkbutton;
  GtkWidget *column_label_refmac_frame;
  GtkWidget *vbox79;
  GtkWidget *hbox53;
  GtkWidget *label105;
  GtkWidget *refmac_fobs_optionmenu;
  GtkWidget *refmac_fobs_optionmenu_menu;
  GtkWidget *hbox54;
  GtkWidget *label106;
  GtkWidget *refmac_sigfobs_optionmenu;
  GtkWidget *refmac_sigfobs_optionmenu_menu;
  GtkWidget *hbox55;
  GtkWidget *label107;
  GtkWidget *refmac_rfree_optionmenu;
  GtkWidget *refmac_rfree_optionmenu_menu;
  GtkWidget *hbox3;
  GtkWidget *column_label_ok_button;
  GtkWidget *column_label_cancel_button;
  GtkWidget *label8;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  column_label_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (column_label_window), "column_label_window", column_label_window);
  gtk_window_set_title (GTK_WINDOW (column_label_window), _("Column Label Assignment"));

  vbox2 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox2);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "vbox2", vbox2,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox2);
  gtk_container_add (GTK_CONTAINER (column_label_window), vbox2);
  gtk_container_set_border_width (GTK_CONTAINER (vbox2), 6);

  hbox88 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox88);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "hbox88", hbox88,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox88);
  gtk_box_pack_start (GTK_BOX (vbox2), hbox88, TRUE, TRUE, 0);

  label177 = gtk_label_new (_("                                        "));
  gtk_widget_ref (label177);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "label177", label177,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label177);
  gtk_box_pack_start (GTK_BOX (hbox88), label177, FALSE, FALSE, 0);

  column_label_expert_mode_button = gtk_button_new_with_label (_("Expert Mode?"));
  gtk_widget_ref (column_label_expert_mode_button);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "column_label_expert_mode_button", column_label_expert_mode_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (column_label_expert_mode_button);
  gtk_box_pack_start (GTK_BOX (hbox88), column_label_expert_mode_button, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, column_label_expert_mode_button, _("When clicked, add anomalous and resolution limit options (generally not needed)"), NULL);

  label1 = gtk_label_new (_("Column Labels for Map Synthesis:"));
  gtk_widget_ref (label1);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "label1", label1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label1);
  gtk_box_pack_start (GTK_BOX (vbox2), label1, FALSE, FALSE, 7);

  vbox3 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox3);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "vbox3", vbox3,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox3);
  gtk_box_pack_start (GTK_BOX (vbox2), vbox3, TRUE, TRUE, 0);

  frame1 = gtk_frame_new (NULL);
  gtk_widget_ref (frame1);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "frame1", frame1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame1);
  gtk_box_pack_start (GTK_BOX (vbox3), frame1, TRUE, TRUE, 0);

  hbox1 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox1);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "hbox1", hbox1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox1);
  gtk_container_add (GTK_CONTAINER (frame1), hbox1);
  gtk_container_set_border_width (GTK_CONTAINER (hbox1), 5);

  label2 = gtk_label_new (_("Amplitudes"));
  gtk_widget_ref (label2);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "label2", label2,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label2);
  gtk_box_pack_start (GTK_BOX (hbox1), label2, FALSE, FALSE, 3);

  optionmenu1 = gtk_option_menu_new ();
  gtk_widget_ref (optionmenu1);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "optionmenu1", optionmenu1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (optionmenu1);
  gtk_box_pack_start (GTK_BOX (hbox1), optionmenu1, FALSE, FALSE, 0);
  optionmenu1_menu = gtk_menu_new ();
  glade_menuitem = gtk_menu_item_new_with_label (_("-"));
  gtk_widget_show (glade_menuitem);
  gtk_menu_append (GTK_MENU (optionmenu1_menu), glade_menuitem);
  gtk_option_menu_set_menu (GTK_OPTION_MENU (optionmenu1), optionmenu1_menu);

  frame2 = gtk_frame_new (NULL);
  gtk_widget_ref (frame2);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "frame2", frame2,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame2);
  gtk_box_pack_start (GTK_BOX (vbox3), frame2, TRUE, TRUE, 0);

  hbox4 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox4);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "hbox4", hbox4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox4);
  gtk_container_add (GTK_CONTAINER (frame2), hbox4);
  gtk_container_set_border_width (GTK_CONTAINER (hbox4), 5);

  label3 = gtk_label_new (_("Phases"));
  gtk_widget_ref (label3);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "label3", label3,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label3);
  gtk_box_pack_start (GTK_BOX (hbox4), label3, FALSE, FALSE, 3);

  optionmenu2 = gtk_option_menu_new ();
  gtk_widget_ref (optionmenu2);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "optionmenu2", optionmenu2,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (optionmenu2);
  gtk_box_pack_start (GTK_BOX (hbox4), optionmenu2, FALSE, FALSE, 0);
  optionmenu2_menu = gtk_menu_new ();
  glade_menuitem = gtk_menu_item_new_with_label (_("-"));
  gtk_widget_show (glade_menuitem);
  gtk_menu_append (GTK_MENU (optionmenu2_menu), glade_menuitem);
  gtk_option_menu_set_menu (GTK_OPTION_MENU (optionmenu2), optionmenu2_menu);

  frame23 = gtk_frame_new (NULL);
  gtk_widget_ref (frame23);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "frame23", frame23,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame23);
  gtk_box_pack_start (GTK_BOX (vbox3), frame23, TRUE, TRUE, 0);

  vbox28 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox28);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "vbox28", vbox28,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox28);
  gtk_container_add (GTK_CONTAINER (frame23), vbox28);

  hbox15 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox15);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "hbox15", hbox15,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox15);
  gtk_box_pack_start (GTK_BOX (vbox28), hbox15, TRUE, TRUE, 0);

  label30 = gtk_label_new (_("   "));
  gtk_widget_ref (label30);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "label30", label30,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label30);
  gtk_box_pack_start (GTK_BOX (hbox15), label30, FALSE, FALSE, 0);

  use_weights_checkbutton = gtk_check_button_new_with_label (_("Use Weights?"));
  gtk_widget_ref (use_weights_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "use_weights_checkbutton", use_weights_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (use_weights_checkbutton);
  gtk_box_pack_start (GTK_BOX (hbox15), use_weights_checkbutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (use_weights_checkbutton), 4);
  gtk_tooltips_set_tip (tooltips, use_weights_checkbutton, _("Weights are usually used for experimental phasing.  When making a map from REFMAC output one (almost) never needs Weights."), NULL);

  column_label_window_weights_hbox = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (column_label_window_weights_hbox);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "column_label_window_weights_hbox", column_label_window_weights_hbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (column_label_window_weights_hbox);
  gtk_box_pack_start (GTK_BOX (vbox28), column_label_window_weights_hbox, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (column_label_window_weights_hbox), 6);
  gtk_widget_set_sensitive (column_label_window_weights_hbox, FALSE);

  label31 = gtk_label_new (_("Weights"));
  gtk_widget_ref (label31);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "label31", label31,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label31);
  gtk_box_pack_start (GTK_BOX (column_label_window_weights_hbox), label31, FALSE, FALSE, 3);

  optionmenu3 = gtk_option_menu_new ();
  gtk_widget_ref (optionmenu3);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "optionmenu3", optionmenu3,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (optionmenu3);
  gtk_box_pack_start (GTK_BOX (column_label_window_weights_hbox), optionmenu3, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, optionmenu3, _("Usually not needed for map from refmac..."), NULL);
  optionmenu3_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (optionmenu3), optionmenu3_menu);

  column_labels_resolution_limit_frame = gtk_frame_new (_("Resolution limits"));
  gtk_widget_ref (column_labels_resolution_limit_frame);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "column_labels_resolution_limit_frame", column_labels_resolution_limit_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (vbox3), column_labels_resolution_limit_frame, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (column_labels_resolution_limit_frame), 3);

  vbox113 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox113);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "vbox113", vbox113,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox113);
  gtk_container_add (GTK_CONTAINER (column_labels_resolution_limit_frame), vbox113);
  gtk_container_set_border_width (GTK_CONTAINER (vbox113), 10);

  column_labels_use_resolution_limits_checkbutton = gtk_check_button_new_with_label (_("Use Resolution Limits"));
  gtk_widget_ref (column_labels_use_resolution_limits_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "column_labels_use_resolution_limits_checkbutton", column_labels_use_resolution_limits_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (column_labels_use_resolution_limits_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox113), column_labels_use_resolution_limits_checkbutton, FALSE, FALSE, 0);

  resolution_limits_hbox = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (resolution_limits_hbox);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "resolution_limits_hbox", resolution_limits_hbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (resolution_limits_hbox);
  gtk_box_pack_start (GTK_BOX (vbox113), resolution_limits_hbox, TRUE, TRUE, 0);
  gtk_widget_set_sensitive (resolution_limits_hbox, FALSE);

  label175 = gtk_label_new (_("Low:"));
  gtk_widget_ref (label175);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "label175", label175,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label175);
  gtk_box_pack_start (GTK_BOX (resolution_limits_hbox), label175, FALSE, FALSE, 0);

  column_labels_reso_low_entry = gtk_entry_new ();
  gtk_widget_ref (column_labels_reso_low_entry);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "column_labels_reso_low_entry", column_labels_reso_low_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (column_labels_reso_low_entry);
  gtk_box_pack_start (GTK_BOX (resolution_limits_hbox), column_labels_reso_low_entry, FALSE, FALSE, 0);
  gtk_widget_set_usize (column_labels_reso_low_entry, 60, -2);

  label174 = gtk_label_new (_("   "));
  gtk_widget_ref (label174);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "label174", label174,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label174);
  gtk_box_pack_start (GTK_BOX (resolution_limits_hbox), label174, FALSE, FALSE, 0);

  label176 = gtk_label_new (_("High:"));
  gtk_widget_ref (label176);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "label176", label176,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label176);
  gtk_box_pack_start (GTK_BOX (resolution_limits_hbox), label176, FALSE, FALSE, 0);

  column_labels_reso_high_entry = gtk_entry_new ();
  gtk_widget_ref (column_labels_reso_high_entry);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "column_labels_reso_high_entry", column_labels_reso_high_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (column_labels_reso_high_entry);
  gtk_box_pack_start (GTK_BOX (resolution_limits_hbox), column_labels_reso_high_entry, FALSE, FALSE, 0);
  gtk_widget_set_usize (column_labels_reso_high_entry, 60, -2);

  difference_map_checkbutton = gtk_check_button_new_with_label (_("Is a Difference Map"));
  gtk_widget_ref (difference_map_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "difference_map_checkbutton", difference_map_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (difference_map_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox3), difference_map_checkbutton, FALSE, FALSE, 7);
  gtk_tooltips_set_tip (tooltips, difference_map_checkbutton, _("See Section 6.5 of the User Manual for default Diference Map colouring."), NULL);

  hseparator9 = gtk_hseparator_new ();
  gtk_widget_ref (hseparator9);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "hseparator9", hseparator9,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hseparator9);
  gtk_box_pack_start (GTK_BOX (vbox3), hseparator9, TRUE, TRUE, 10);

  refmac_column_labels_checkbutton = gtk_check_button_new_with_label (_("Assign Labels for Refmac?"));
  gtk_widget_ref (refmac_column_labels_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "refmac_column_labels_checkbutton", refmac_column_labels_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (refmac_column_labels_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox3), refmac_column_labels_checkbutton, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, refmac_column_labels_checkbutton, _("If you want to use these data to run refmac, you will need to assign the columns for the observations, the sigmas thereof and the R free..."), NULL);

  column_label_refmac_frame = gtk_frame_new (NULL);
  gtk_widget_ref (column_label_refmac_frame);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "column_label_refmac_frame", column_label_refmac_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (column_label_refmac_frame);
  gtk_box_pack_start (GTK_BOX (vbox3), column_label_refmac_frame, TRUE, TRUE, 0);
  gtk_widget_set_sensitive (column_label_refmac_frame, FALSE);

  vbox79 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox79);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "vbox79", vbox79,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox79);
  gtk_container_add (GTK_CONTAINER (column_label_refmac_frame), vbox79);

  hbox53 = gtk_hbox_new (FALSE, 26);
  gtk_widget_ref (hbox53);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "hbox53", hbox53,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox53);
  gtk_box_pack_start (GTK_BOX (vbox79), hbox53, TRUE, TRUE, 2);

  label105 = gtk_label_new (_("Fobs"));
  gtk_widget_ref (label105);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "label105", label105,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label105);
  gtk_box_pack_start (GTK_BOX (hbox53), label105, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label105), 6, 0);

  refmac_fobs_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (refmac_fobs_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "refmac_fobs_optionmenu", refmac_fobs_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (refmac_fobs_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox53), refmac_fobs_optionmenu, FALSE, FALSE, 0);
  refmac_fobs_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (refmac_fobs_optionmenu), refmac_fobs_optionmenu_menu);

  hbox54 = gtk_hbox_new (FALSE, 4);
  gtk_widget_ref (hbox54);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "hbox54", hbox54,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox54);
  gtk_box_pack_start (GTK_BOX (vbox79), hbox54, TRUE, TRUE, 2);

  label106 = gtk_label_new (_("Sig Fobs"));
  gtk_widget_ref (label106);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "label106", label106,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label106);
  gtk_box_pack_start (GTK_BOX (hbox54), label106, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label106), 6, 0);

  refmac_sigfobs_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (refmac_sigfobs_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "refmac_sigfobs_optionmenu", refmac_sigfobs_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (refmac_sigfobs_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox54), refmac_sigfobs_optionmenu, FALSE, FALSE, 0);
  refmac_sigfobs_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (refmac_sigfobs_optionmenu), refmac_sigfobs_optionmenu_menu);

  hbox55 = gtk_hbox_new (FALSE, 21);
  gtk_widget_ref (hbox55);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "hbox55", hbox55,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox55);
  gtk_box_pack_start (GTK_BOX (vbox79), hbox55, TRUE, TRUE, 2);

  label107 = gtk_label_new (_("R free"));
  gtk_widget_ref (label107);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "label107", label107,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label107);
  gtk_box_pack_start (GTK_BOX (hbox55), label107, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label107), 6, 0);

  refmac_rfree_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (refmac_rfree_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "refmac_rfree_optionmenu", refmac_rfree_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (refmac_rfree_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox55), refmac_rfree_optionmenu, FALSE, FALSE, 0);
  refmac_rfree_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (refmac_rfree_optionmenu), refmac_rfree_optionmenu_menu);

  hbox3 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox3);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "hbox3", hbox3,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox3);
  gtk_box_pack_start (GTK_BOX (vbox2), hbox3, TRUE, TRUE, 11);
  gtk_container_set_border_width (GTK_CONTAINER (hbox3), 2);

  column_label_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (column_label_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "column_label_ok_button", column_label_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (column_label_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox3), column_label_ok_button, TRUE, TRUE, 6);
  GTK_WIDGET_SET_FLAGS (column_label_ok_button, GTK_CAN_DEFAULT);

  column_label_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (column_label_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "column_label_cancel_button", column_label_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (column_label_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox3), column_label_cancel_button, TRUE, TRUE, 6);
  GTK_WIDGET_SET_FLAGS (column_label_cancel_button, GTK_CAN_DEFAULT);

  label8 = gtk_label_new (_("(Thinking, not crashing)"));
  gtk_widget_ref (label8);
  gtk_object_set_data_full (GTK_OBJECT (column_label_window), "label8", label8,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label8);
  gtk_box_pack_start (GTK_BOX (vbox2), label8, FALSE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (column_label_expert_mode_button), "clicked",
                      GTK_SIGNAL_FUNC (on_column_label_expert_mode_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (use_weights_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_use_weights_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (column_labels_use_resolution_limits_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_column_labels_use_resolution_limits_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (refmac_column_labels_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_refmac_column_labels_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (column_label_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_column_label_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (column_label_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_column_label_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_default (column_label_ok_button);
  gtk_object_set_data (GTK_OBJECT (column_label_window), "tooltips", tooltips);

  return column_label_window;
}

GtkWidget*
create_clipping_window (void)
{
  GtkWidget *clipping_window;
  GtkWidget *vbox4;
  GtkWidget *label4;
  GtkWidget *frame3;
  GtkWidget *hscale1;
  GtkWidget *clipping_button;

  clipping_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (clipping_window), "clipping_window", clipping_window);
  gtk_window_set_title (GTK_WINDOW (clipping_window), _("Clipping Window"));

  vbox4 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox4);
  gtk_object_set_data_full (GTK_OBJECT (clipping_window), "vbox4", vbox4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox4);
  gtk_container_add (GTK_CONTAINER (clipping_window), vbox4);

  label4 = gtk_label_new (_("Clipping Adjustment"));
  gtk_widget_ref (label4);
  gtk_object_set_data_full (GTK_OBJECT (clipping_window), "label4", label4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label4);
  gtk_box_pack_start (GTK_BOX (vbox4), label4, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label4), 0, 7.45058e-09);
  gtk_misc_set_padding (GTK_MISC (label4), 5, 5);

  frame3 = gtk_frame_new (NULL);
  gtk_widget_ref (frame3);
  gtk_object_set_data_full (GTK_OBJECT (clipping_window), "frame3", frame3,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame3);
  gtk_box_pack_start (GTK_BOX (vbox4), frame3, TRUE, TRUE, 8);
  gtk_container_set_border_width (GTK_CONTAINER (frame3), 9);

  hscale1 = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (hscale1);
  gtk_object_set_data_full (GTK_OBJECT (clipping_window), "hscale1", hscale1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hscale1);
  gtk_container_add (GTK_CONTAINER (frame3), hscale1);
  gtk_widget_set_usize (hscale1, 197, -2);

  clipping_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (clipping_button);
  gtk_object_set_data_full (GTK_OBJECT (clipping_window), "clipping_button", clipping_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (clipping_button);
  gtk_box_pack_start (GTK_BOX (vbox4), clipping_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (clipping_button), 6);
  GTK_WIDGET_SET_FLAGS (clipping_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (clipping_button), "clicked",
                      GTK_SIGNAL_FUNC (on_clipping_button_clicked),
                      NULL);

  gtk_widget_grab_default (clipping_button);
  return clipping_window;
}

GtkWidget*
create_global_map_properties_window (void)
{
  GtkWidget *global_map_properties_window;
  GtkWidget *map_properties_vbox;
  GtkWidget *label5;
  GtkWidget *frame4;
  GtkWidget *hbox5;
  GtkWidget *label6;
  GtkWidget *entry1;
  GtkWidget *label7;
  GtkWidget *map_radius_apply_button;
  GtkWidget *label275;
  GtkWidget *frame24;
  GtkWidget *hbox17;
  GtkWidget *label32;
  GtkWidget *iso_level_increment_entry;
  GtkWidget *label33;
  GtkWidget *frame25;
  GtkWidget *hbox18;
  GtkWidget *label34;
  GtkWidget *diff_map_iso_level_increment_entry;
  GtkWidget *label35;
  GtkWidget *frame43;
  GtkWidget *hbox42;
  GtkWidget *label84;
  GtkWidget *map_sampling_rate_entry;
  GtkWidget *frame49;
  GtkWidget *vbox61;
  GtkWidget *map_dynamic_map_sampling_checkbutton;
  GtkWidget *map_dynamic_map_size_display_checkbutton;
  GtkWidget *hseparator3;
  GtkWidget *hbox6;
  GtkWidget *density_ok_button;
  GtkWidget *density_cancel;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  global_map_properties_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (global_map_properties_window), "global_map_properties_window", global_map_properties_window);
  gtk_window_set_title (GTK_WINDOW (global_map_properties_window), _("Global map properties window"));

  map_properties_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (map_properties_vbox);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "map_properties_vbox", map_properties_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (map_properties_vbox);
  gtk_container_add (GTK_CONTAINER (global_map_properties_window), map_properties_vbox);

  label5 = gtk_label_new (_("Density Settings"));
  gtk_widget_ref (label5);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "label5", label5,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label5);
  gtk_box_pack_start (GTK_BOX (map_properties_vbox), label5, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label5), 2, 6);

  frame4 = gtk_frame_new (NULL);
  gtk_widget_ref (frame4);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "frame4", frame4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame4);
  gtk_box_pack_start (GTK_BOX (map_properties_vbox), frame4, TRUE, TRUE, 0);

  hbox5 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox5);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "hbox5", hbox5,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox5);
  gtk_container_add (GTK_CONTAINER (frame4), hbox5);

  label6 = gtk_label_new (_("Map Radius: "));
  gtk_widget_ref (label6);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "label6", label6,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label6);
  gtk_box_pack_start (GTK_BOX (hbox5), label6, FALSE, FALSE, 7);

  entry1 = gtk_entry_new ();
  gtk_widget_ref (entry1);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "entry1", entry1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (entry1);
  gtk_box_pack_start (GTK_BOX (hbox5), entry1, FALSE, TRUE, 11);
  gtk_widget_set_usize (entry1, 78, -2);

  label7 = gtk_label_new (_("Angstroems"));
  gtk_widget_ref (label7);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "label7", label7,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label7);
  gtk_box_pack_start (GTK_BOX (hbox5), label7, FALSE, FALSE, 18);

  map_radius_apply_button = gtk_button_new_with_label (_("  Apply  "));
  gtk_widget_ref (map_radius_apply_button);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "map_radius_apply_button", map_radius_apply_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (map_radius_apply_button);
  gtk_box_pack_start (GTK_BOX (hbox5), map_radius_apply_button, FALSE, FALSE, 0);

  label275 = gtk_label_new (_("  "));
  gtk_widget_ref (label275);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "label275", label275,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label275);
  gtk_box_pack_start (GTK_BOX (hbox5), label275, FALSE, FALSE, 0);

  frame24 = gtk_frame_new (NULL);
  gtk_widget_ref (frame24);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "frame24", frame24,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame24);
  gtk_box_pack_start (GTK_BOX (map_properties_vbox), frame24, TRUE, TRUE, 0);

  hbox17 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox17);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "hbox17", hbox17,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox17);
  gtk_container_add (GTK_CONTAINER (frame24), hbox17);

  label32 = gtk_label_new (_("Increment Size"));
  gtk_widget_ref (label32);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "label32", label32,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label32);
  gtk_box_pack_start (GTK_BOX (hbox17), label32, FALSE, FALSE, 6);

  iso_level_increment_entry = gtk_entry_new ();
  gtk_widget_ref (iso_level_increment_entry);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "iso_level_increment_entry", iso_level_increment_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (iso_level_increment_entry);
  gtk_box_pack_start (GTK_BOX (hbox17), iso_level_increment_entry, FALSE, TRUE, 6);
  gtk_widget_set_usize (iso_level_increment_entry, 46, -2);

  label33 = gtk_label_new (_("e/A^3"));
  gtk_widget_ref (label33);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "label33", label33,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label33);
  gtk_box_pack_start (GTK_BOX (hbox17), label33, FALSE, FALSE, 6);

  frame25 = gtk_frame_new (NULL);
  gtk_widget_ref (frame25);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "frame25", frame25,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame25);
  gtk_box_pack_start (GTK_BOX (map_properties_vbox), frame25, TRUE, TRUE, 0);

  hbox18 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox18);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "hbox18", hbox18,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox18);
  gtk_container_add (GTK_CONTAINER (frame25), hbox18);

  label34 = gtk_label_new (_("Diff Map Increment"));
  gtk_widget_ref (label34);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "label34", label34,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label34);
  gtk_box_pack_start (GTK_BOX (hbox18), label34, FALSE, FALSE, 6);

  diff_map_iso_level_increment_entry = gtk_entry_new ();
  gtk_widget_ref (diff_map_iso_level_increment_entry);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "diff_map_iso_level_increment_entry", diff_map_iso_level_increment_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (diff_map_iso_level_increment_entry);
  gtk_box_pack_start (GTK_BOX (hbox18), diff_map_iso_level_increment_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (diff_map_iso_level_increment_entry, 95, -2);

  label35 = gtk_label_new (_("e/A^3"));
  gtk_widget_ref (label35);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "label35", label35,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label35);
  gtk_box_pack_start (GTK_BOX (hbox18), label35, FALSE, FALSE, 6);

  frame43 = gtk_frame_new (NULL);
  gtk_widget_ref (frame43);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "frame43", frame43,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame43);
  gtk_box_pack_start (GTK_BOX (map_properties_vbox), frame43, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame43), 6);

  hbox42 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox42);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "hbox42", hbox42,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox42);
  gtk_container_add (GTK_CONTAINER (frame43), hbox42);

  label84 = gtk_label_new (_("Sampling Rate: "));
  gtk_widget_ref (label84);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "label84", label84,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label84);
  gtk_box_pack_start (GTK_BOX (hbox42), label84, FALSE, FALSE, 0);

  map_sampling_rate_entry = gtk_entry_new ();
  gtk_widget_ref (map_sampling_rate_entry);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "map_sampling_rate_entry", map_sampling_rate_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (map_sampling_rate_entry);
  gtk_box_pack_start (GTK_BOX (hbox42), map_sampling_rate_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (map_sampling_rate_entry, 52, -2);
  gtk_tooltips_set_tip (tooltips, map_sampling_rate_entry, _("Shannon Sampling multiplier. 1.5 is the standard value. Use larger numbers for smoother maps"), NULL);

  frame49 = gtk_frame_new (NULL);
  gtk_widget_ref (frame49);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "frame49", frame49,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame49);
  gtk_box_pack_start (GTK_BOX (map_properties_vbox), frame49, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame49), 5);

  vbox61 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox61);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "vbox61", vbox61,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox61);
  gtk_container_add (GTK_CONTAINER (frame49), vbox61);

  map_dynamic_map_sampling_checkbutton = gtk_check_button_new_with_label (_("Dynamic Map Sampling"));
  gtk_widget_ref (map_dynamic_map_sampling_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "map_dynamic_map_sampling_checkbutton", map_dynamic_map_sampling_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (map_dynamic_map_sampling_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox61), map_dynamic_map_sampling_checkbutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (map_dynamic_map_sampling_checkbutton), 1);

  map_dynamic_map_size_display_checkbutton = gtk_check_button_new_with_label (_("Dynamic Map Display Size"));
  gtk_widget_ref (map_dynamic_map_size_display_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "map_dynamic_map_size_display_checkbutton", map_dynamic_map_size_display_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (map_dynamic_map_size_display_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox61), map_dynamic_map_size_display_checkbutton, FALSE, FALSE, 0);

  hseparator3 = gtk_hseparator_new ();
  gtk_widget_ref (hseparator3);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "hseparator3", hseparator3,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hseparator3);
  gtk_box_pack_start (GTK_BOX (map_properties_vbox), hseparator3, TRUE, TRUE, 6);

  hbox6 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox6);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "hbox6", hbox6,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox6);
  gtk_box_pack_start (GTK_BOX (map_properties_vbox), hbox6, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox6), 10);

  density_ok_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (density_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "density_ok_button", density_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (density_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox6), density_ok_button, TRUE, TRUE, 10);
  GTK_WIDGET_SET_FLAGS (density_ok_button, GTK_CAN_DEFAULT);

  density_cancel = gtk_button_new_with_label (_("Cancel"));
  gtk_widget_ref (density_cancel);
  gtk_object_set_data_full (GTK_OBJECT (global_map_properties_window), "density_cancel", density_cancel,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (density_cancel);
  gtk_box_pack_start (GTK_BOX (hbox6), density_cancel, TRUE, TRUE, 10);
  GTK_WIDGET_SET_FLAGS (density_cancel, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (entry1), "key_press_event",
                      GTK_SIGNAL_FUNC (on_entry1_key_press_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (map_radius_apply_button), "clicked",
                      GTK_SIGNAL_FUNC (on_map_radius_apply_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (map_dynamic_map_sampling_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_map_dynamic_map_sampling_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (map_dynamic_map_size_display_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_map_dynamic_map_size_display_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (density_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_density_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (density_cancel), "clicked",
                      GTK_SIGNAL_FUNC (on_density_cancel_clicked),
                      NULL);

  gtk_widget_grab_focus (density_ok_button);
  gtk_widget_grab_default (density_ok_button);
  gtk_object_set_data (GTK_OBJECT (global_map_properties_window), "tooltips", tooltips);

  return global_map_properties_window;
}

GtkWidget*
create_fps_window (void)
{
  GtkWidget *fps_window;
  GtkWidget *vbox6;
  GtkWidget *label9;
  GtkWidget *frame5;
  GtkWidget *vbox7;
  GSList *gr_group = NULL;
  GtkWidget *radiobutton1;
  GtkWidget *radiobutton2;
  GtkWidget *fps_window_ok_button;

  fps_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (fps_window), "fps_window", fps_window);
  gtk_window_set_title (GTK_WINDOW (fps_window), _("fps_window"));

  vbox6 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox6);
  gtk_object_set_data_full (GTK_OBJECT (fps_window), "vbox6", vbox6,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox6);
  gtk_container_add (GTK_CONTAINER (fps_window), vbox6);

  label9 = gtk_label_new (_("Show Frames Per Second?"));
  gtk_widget_ref (label9);
  gtk_object_set_data_full (GTK_OBJECT (fps_window), "label9", label9,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label9);
  gtk_box_pack_start (GTK_BOX (vbox6), label9, FALSE, FALSE, 4);
  gtk_misc_set_padding (GTK_MISC (label9), 6, 5);

  frame5 = gtk_frame_new (NULL);
  gtk_widget_ref (frame5);
  gtk_object_set_data_full (GTK_OBJECT (fps_window), "frame5", frame5,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame5);
  gtk_box_pack_start (GTK_BOX (vbox6), frame5, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame5), 6);

  vbox7 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox7);
  gtk_object_set_data_full (GTK_OBJECT (fps_window), "vbox7", vbox7,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox7);
  gtk_container_add (GTK_CONTAINER (frame5), vbox7);

  radiobutton1 = gtk_radio_button_new_with_label (gr_group, _("Yes"));
  gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (radiobutton1));
  gtk_widget_ref (radiobutton1);
  gtk_object_set_data_full (GTK_OBJECT (fps_window), "radiobutton1", radiobutton1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (radiobutton1);
  gtk_box_pack_start (GTK_BOX (vbox7), radiobutton1, FALSE, FALSE, 0);

  radiobutton2 = gtk_radio_button_new_with_label (gr_group, _("No"));
  gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (radiobutton2));
  gtk_widget_ref (radiobutton2);
  gtk_object_set_data_full (GTK_OBJECT (fps_window), "radiobutton2", radiobutton2,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (radiobutton2);
  gtk_box_pack_start (GTK_BOX (vbox7), radiobutton2, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (radiobutton2), TRUE);

  fps_window_ok_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (fps_window_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (fps_window), "fps_window_ok_button", fps_window_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (fps_window_ok_button);
  gtk_box_pack_start (GTK_BOX (vbox6), fps_window_ok_button, FALSE, FALSE, 6);
  gtk_container_set_border_width (GTK_CONTAINER (fps_window_ok_button), 8);
  GTK_WIDGET_SET_FLAGS (fps_window_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (fps_window_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_fps_window_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (fps_window_ok_button);
  gtk_widget_grab_default (fps_window_ok_button);
  return fps_window;
}

GtkWidget*
create_active_map_window (void)
{
  GtkWidget *active_map_window;
  GtkWidget *vbox8;
  GtkWidget *label10;
  GtkWidget *frame6;
  GtkWidget *vbox9;
  GSList *map_group = NULL;
  GtkWidget *active_map_radiobutton_yes;
  GtkWidget *active_map_radiobutton_no;
  GtkWidget *active_map_ok_button;

  active_map_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (active_map_window), "active_map_window", active_map_window);
  gtk_window_set_title (GTK_WINDOW (active_map_window), _("Active Map on Dragging?"));

  vbox8 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox8);
  gtk_object_set_data_full (GTK_OBJECT (active_map_window), "vbox8", vbox8,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox8);
  gtk_container_add (GTK_CONTAINER (active_map_window), vbox8);

  label10 = gtk_label_new (_("Active Map on Dragging?"));
  gtk_widget_ref (label10);
  gtk_object_set_data_full (GTK_OBJECT (active_map_window), "label10", label10,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label10);
  gtk_box_pack_start (GTK_BOX (vbox8), label10, FALSE, FALSE, 9);
  gtk_misc_set_padding (GTK_MISC (label10), 4, 5);

  frame6 = gtk_frame_new (NULL);
  gtk_widget_ref (frame6);
  gtk_object_set_data_full (GTK_OBJECT (active_map_window), "frame6", frame6,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame6);
  gtk_box_pack_start (GTK_BOX (vbox8), frame6, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame6), 5);

  vbox9 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox9);
  gtk_object_set_data_full (GTK_OBJECT (active_map_window), "vbox9", vbox9,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox9);
  gtk_container_add (GTK_CONTAINER (frame6), vbox9);

  active_map_radiobutton_yes = gtk_radio_button_new_with_label (map_group, _("Yes"));
  map_group = gtk_radio_button_group (GTK_RADIO_BUTTON (active_map_radiobutton_yes));
  gtk_widget_ref (active_map_radiobutton_yes);
  gtk_object_set_data_full (GTK_OBJECT (active_map_window), "active_map_radiobutton_yes", active_map_radiobutton_yes,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (active_map_radiobutton_yes);
  gtk_box_pack_start (GTK_BOX (vbox9), active_map_radiobutton_yes, FALSE, FALSE, 0);

  active_map_radiobutton_no = gtk_radio_button_new_with_label (map_group, _("No"));
  map_group = gtk_radio_button_group (GTK_RADIO_BUTTON (active_map_radiobutton_no));
  gtk_widget_ref (active_map_radiobutton_no);
  gtk_object_set_data_full (GTK_OBJECT (active_map_window), "active_map_radiobutton_no", active_map_radiobutton_no,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (active_map_radiobutton_no);
  gtk_box_pack_start (GTK_BOX (vbox9), active_map_radiobutton_no, FALSE, FALSE, 0);

  active_map_ok_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (active_map_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (active_map_window), "active_map_ok_button", active_map_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (active_map_ok_button);
  gtk_box_pack_start (GTK_BOX (vbox8), active_map_ok_button, FALSE, FALSE, 9);
  gtk_container_set_border_width (GTK_CONTAINER (active_map_ok_button), 10);
  GTK_WIDGET_SET_FLAGS (active_map_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (active_map_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_active_map_ok_button_clicked),
                      NULL);

  gtk_widget_grab_default (active_map_ok_button);
  return active_map_window;
}

GtkWidget*
create_show_symmetry_window (void)
{
  GtkWidget *show_symmetry_window;
  GtkWidget *vbox10;
  GtkWidget *label11;
  GtkWidget *frame163;
  GtkWidget *vbox169;
  GtkWidget *frame7;
  GtkWidget *vbox11;
  GSList *symm_gr_group = NULL;
  GtkWidget *show_symmetry_yes_radiobutton;
  GtkWidget *show_symmetry_no_radiobutton;
  GtkWidget *show_symmetry_molecule_control_button;
  GtkWidget *frame8;
  GtkWidget *vbox12;
  GtkWidget *label12;
  GtkWidget *hbox7;
  GtkWidget *label13;
  GtkWidget *symmetry_radius_entry;
  GtkWidget *label14;
  GtkWidget *frame9;
  GtkWidget *vbox13;
  GtkWidget *hbox8;
  GtkWidget *label15;
  GtkWidget *symmetry_colour_patch_button;
  GtkWidget *hbox33;
  GtkWidget *frame33;
  GtkWidget *label68;
  GtkWidget *hbox9;
  GtkWidget *frame10;
  GtkWidget *hbox10;
  GtkWidget *label16;
  GtkWidget *hscale_symmetry_colour;
  GtkWidget *show_symmetry_expanded_labels_checkbutton;
  GtkWidget *frame11;
  GtkWidget *vbox15;
  GSList *unit_cell_gr_group = NULL;
  GtkWidget *unit_cell_yes_radiobutton;
  GtkWidget *unit_cell_no_radiobutton;
  GtkWidget *hbox133;
  GtkWidget *show_symmetry_apply_button;
  GtkWidget *show_symmetry_ok_button;

  show_symmetry_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (show_symmetry_window), "show_symmetry_window", show_symmetry_window);
  gtk_window_set_title (GTK_WINDOW (show_symmetry_window), _("Show Symmetry?"));

  vbox10 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox10);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "vbox10", vbox10,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox10);
  gtk_container_add (GTK_CONTAINER (show_symmetry_window), vbox10);

  label11 = gtk_label_new (_("Symmetry & Unit Cell"));
  gtk_widget_ref (label11);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "label11", label11,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label11);
  gtk_box_pack_start (GTK_BOX (vbox10), label11, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label11), 3, 5);

  frame163 = gtk_frame_new (_("Symmetry"));
  gtk_widget_ref (frame163);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "frame163", frame163,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame163);
  gtk_box_pack_start (GTK_BOX (vbox10), frame163, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame163), 6);

  vbox169 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox169);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "vbox169", vbox169,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox169);
  gtk_container_add (GTK_CONTAINER (frame163), vbox169);

  frame7 = gtk_frame_new (_("Master Switch: Show Symmetry Atoms?"));
  gtk_widget_ref (frame7);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "frame7", frame7,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame7);
  gtk_box_pack_start (GTK_BOX (vbox169), frame7, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame7), 4);

  vbox11 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox11);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "vbox11", vbox11,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox11);
  gtk_container_add (GTK_CONTAINER (frame7), vbox11);

  show_symmetry_yes_radiobutton = gtk_radio_button_new_with_label (symm_gr_group, _("Yes"));
  symm_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (show_symmetry_yes_radiobutton));
  gtk_widget_ref (show_symmetry_yes_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "show_symmetry_yes_radiobutton", show_symmetry_yes_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (show_symmetry_yes_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox11), show_symmetry_yes_radiobutton, FALSE, FALSE, 0);

  show_symmetry_no_radiobutton = gtk_radio_button_new_with_label (symm_gr_group, _("No"));
  symm_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (show_symmetry_no_radiobutton));
  gtk_widget_ref (show_symmetry_no_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "show_symmetry_no_radiobutton", show_symmetry_no_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (show_symmetry_no_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox11), show_symmetry_no_radiobutton, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (show_symmetry_no_radiobutton), TRUE);

  show_symmetry_molecule_control_button = gtk_button_new_with_label (_("Symmetry by Molecule..."));
  gtk_widget_ref (show_symmetry_molecule_control_button);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "show_symmetry_molecule_control_button", show_symmetry_molecule_control_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (show_symmetry_molecule_control_button);
  gtk_box_pack_start (GTK_BOX (vbox169), show_symmetry_molecule_control_button, FALSE, FALSE, 4);
  gtk_container_set_border_width (GTK_CONTAINER (show_symmetry_molecule_control_button), 4);

  frame8 = gtk_frame_new (NULL);
  gtk_widget_ref (frame8);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "frame8", frame8,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame8);
  gtk_box_pack_start (GTK_BOX (vbox169), frame8, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame8), 4);

  vbox12 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox12);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "vbox12", vbox12,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox12);
  gtk_container_add (GTK_CONTAINER (frame8), vbox12);

  label12 = gtk_label_new (_("Symmetry Atom Display Radius:"));
  gtk_widget_ref (label12);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "label12", label12,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label12);
  gtk_box_pack_start (GTK_BOX (vbox12), label12, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label12), 12, 2);

  hbox7 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox7);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "hbox7", hbox7,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox7);
  gtk_box_pack_start (GTK_BOX (vbox12), hbox7, TRUE, TRUE, 0);

  label13 = gtk_label_new (_("Radius:"));
  gtk_widget_ref (label13);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "label13", label13,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label13);
  gtk_box_pack_start (GTK_BOX (hbox7), label13, FALSE, FALSE, 0);

  symmetry_radius_entry = gtk_entry_new ();
  gtk_widget_ref (symmetry_radius_entry);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "symmetry_radius_entry", symmetry_radius_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (symmetry_radius_entry);
  gtk_box_pack_start (GTK_BOX (hbox7), symmetry_radius_entry, TRUE, TRUE, 0);
  gtk_widget_set_usize (symmetry_radius_entry, 42, -2);

  label14 = gtk_label_new (_("A"));
  gtk_widget_ref (label14);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "label14", label14,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label14);
  gtk_box_pack_start (GTK_BOX (hbox7), label14, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label14), 5, 0);

  frame9 = gtk_frame_new (NULL);
  gtk_widget_ref (frame9);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "frame9", frame9,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame9);
  gtk_box_pack_start (GTK_BOX (vbox169), frame9, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame9), 4);

  vbox13 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox13);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "vbox13", vbox13,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox13);
  gtk_container_add (GTK_CONTAINER (frame9), vbox13);

  hbox8 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox8);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "hbox8", hbox8,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox8);
  gtk_box_pack_start (GTK_BOX (vbox13), hbox8, TRUE, TRUE, 6);

  label15 = gtk_label_new (_("Symmetry Colour"));
  gtk_widget_ref (label15);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "label15", label15,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label15);
  gtk_box_pack_start (GTK_BOX (hbox8), label15, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label15), 10, 0);

  symmetry_colour_patch_button = gtk_button_new ();
  gtk_widget_ref (symmetry_colour_patch_button);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "symmetry_colour_patch_button", symmetry_colour_patch_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (symmetry_colour_patch_button);
  gtk_box_pack_start (GTK_BOX (hbox8), symmetry_colour_patch_button, FALSE, FALSE, 4);

  hbox33 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox33);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "hbox33", hbox33,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox33);
  gtk_container_add (GTK_CONTAINER (symmetry_colour_patch_button), hbox33);

  frame33 = gtk_frame_new (NULL);
  gtk_widget_ref (frame33);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "frame33", frame33,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame33);
  gtk_box_pack_start (GTK_BOX (hbox33), frame33, TRUE, TRUE, 0);

  label68 = gtk_label_new (_("Sym Colour"));
  gtk_widget_ref (label68);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "label68", label68,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label68);
  gtk_box_pack_start (GTK_BOX (hbox33), label68, FALSE, FALSE, 2);

  hbox9 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox9);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "hbox9", hbox9,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox9);
  gtk_box_pack_start (GTK_BOX (vbox13), hbox9, TRUE, TRUE, 0);

  frame10 = gtk_frame_new (NULL);
  gtk_widget_ref (frame10);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "frame10", frame10,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame10);
  gtk_box_pack_start (GTK_BOX (hbox9), frame10, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame10), 4);

  hbox10 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox10);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "hbox10", hbox10,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox10);
  gtk_container_add (GTK_CONTAINER (frame10), hbox10);
  gtk_container_set_border_width (GTK_CONTAINER (hbox10), 4);

  label16 = gtk_label_new (_("Colour Merge:"));
  gtk_widget_ref (label16);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "label16", label16,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label16);
  gtk_box_pack_start (GTK_BOX (hbox10), label16, FALSE, FALSE, 4);

  hscale_symmetry_colour = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (hscale_symmetry_colour);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "hscale_symmetry_colour", hscale_symmetry_colour,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hscale_symmetry_colour);
  gtk_box_pack_start (GTK_BOX (hbox10), hscale_symmetry_colour, TRUE, TRUE, 0);
  gtk_widget_set_usize (hscale_symmetry_colour, 112, -2);

  show_symmetry_expanded_labels_checkbutton = gtk_check_button_new_with_label (_("Expanded Symmetry Atom Labels?"));
  gtk_widget_ref (show_symmetry_expanded_labels_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "show_symmetry_expanded_labels_checkbutton", show_symmetry_expanded_labels_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (show_symmetry_expanded_labels_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox169), show_symmetry_expanded_labels_checkbutton, FALSE, FALSE, 0);

  frame11 = gtk_frame_new (_("Show Unit Cells?"));
  gtk_widget_ref (frame11);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "frame11", frame11,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame11);
  gtk_box_pack_start (GTK_BOX (vbox10), frame11, TRUE, TRUE, 0);

  vbox15 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox15);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "vbox15", vbox15,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox15);
  gtk_container_add (GTK_CONTAINER (frame11), vbox15);

  unit_cell_yes_radiobutton = gtk_radio_button_new_with_label (unit_cell_gr_group, _("Yes"));
  unit_cell_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (unit_cell_yes_radiobutton));
  gtk_widget_ref (unit_cell_yes_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "unit_cell_yes_radiobutton", unit_cell_yes_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (unit_cell_yes_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox15), unit_cell_yes_radiobutton, FALSE, FALSE, 0);

  unit_cell_no_radiobutton = gtk_radio_button_new_with_label (unit_cell_gr_group, _("No"));
  unit_cell_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (unit_cell_no_radiobutton));
  gtk_widget_ref (unit_cell_no_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "unit_cell_no_radiobutton", unit_cell_no_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (unit_cell_no_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox15), unit_cell_no_radiobutton, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (unit_cell_no_radiobutton), TRUE);

  hbox133 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox133);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "hbox133", hbox133,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox133);
  gtk_box_pack_start (GTK_BOX (vbox10), hbox133, FALSE, FALSE, 9);

  show_symmetry_apply_button = gtk_button_new_with_label (_("  Apply  "));
  gtk_widget_ref (show_symmetry_apply_button);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "show_symmetry_apply_button", show_symmetry_apply_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (show_symmetry_apply_button);
  gtk_box_pack_start (GTK_BOX (hbox133), show_symmetry_apply_button, TRUE, TRUE, 4);
  GTK_WIDGET_SET_FLAGS (show_symmetry_apply_button, GTK_CAN_DEFAULT);

  show_symmetry_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (show_symmetry_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (show_symmetry_window), "show_symmetry_ok_button", show_symmetry_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (show_symmetry_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox133), show_symmetry_ok_button, TRUE, TRUE, 4);
  GTK_WIDGET_SET_FLAGS (show_symmetry_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (show_symmetry_molecule_control_button), "clicked",
                      GTK_SIGNAL_FUNC (on_show_symmetry_molecule_control_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (symmetry_colour_patch_button), "clicked",
                      GTK_SIGNAL_FUNC (on_symmetry_colour_patch_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (unit_cell_yes_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_unit_cell_yes_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (unit_cell_no_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_unit_cell_no_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (show_symmetry_apply_button), "clicked",
                      GTK_SIGNAL_FUNC (on_show_symmetry_apply_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (show_symmetry_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_show_symmetry_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (show_symmetry_apply_button);
  gtk_widget_grab_default (show_symmetry_apply_button);
  return show_symmetry_window;
}

GtkWidget*
create_about_window (void)
{
  GtkWidget *about_window;
  GtkWidget *vbox14;
  GtkWidget *scrolledwindow1;
  GtkWidget *about_window_text;
  GtkWidget *hbox123;
  GtkWidget *about_ok_button;
  GtkWidget *about_other_button;

  about_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (about_window), "about_window", about_window);
  gtk_window_set_title (GTK_WINDOW (about_window), _("About..."));

  vbox14 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox14);
  gtk_object_set_data_full (GTK_OBJECT (about_window), "vbox14", vbox14,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox14);
  gtk_container_add (GTK_CONTAINER (about_window), vbox14);

  scrolledwindow1 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow1);
  gtk_object_set_data_full (GTK_OBJECT (about_window), "scrolledwindow1", scrolledwindow1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow1);
  gtk_box_pack_start (GTK_BOX (vbox14), scrolledwindow1, TRUE, TRUE, 0);
  gtk_scrolled_window_set_policy (GTK_SCROLLED_WINDOW (scrolledwindow1), GTK_POLICY_NEVER, GTK_POLICY_ALWAYS);

  about_window_text = gtk_text_new (NULL, NULL);
  gtk_widget_ref (about_window_text);
  gtk_object_set_data_full (GTK_OBJECT (about_window), "about_window_text", about_window_text,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (about_window_text);
  gtk_container_add (GTK_CONTAINER (scrolledwindow1), about_window_text);
  gtk_widget_set_usize (about_window_text, 283, 236);

  hbox123 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox123);
  gtk_object_set_data_full (GTK_OBJECT (about_window), "hbox123", hbox123,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox123);
  gtk_box_pack_start (GTK_BOX (vbox14), hbox123, FALSE, FALSE, 0);

  about_ok_button = gtk_button_new_with_label (_("   OK   "));
  gtk_widget_ref (about_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (about_window), "about_ok_button", about_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (about_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox123), about_ok_button, TRUE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (about_ok_button), 8);
  GTK_WIDGET_SET_FLAGS (about_ok_button, GTK_CAN_DEFAULT);

  about_other_button = gtk_button_new_with_label (_("  Other...   "));
  gtk_widget_ref (about_other_button);
  gtk_object_set_data_full (GTK_OBJECT (about_window), "about_other_button", about_other_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (hbox123), about_other_button, TRUE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (about_other_button), 8);
  GTK_WIDGET_SET_FLAGS (about_other_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (about_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_about_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (about_other_button), "clicked",
                      GTK_SIGNAL_FUNC (on_about_other_button_clicked),
                      NULL);

  gtk_widget_grab_focus (about_ok_button);
  gtk_widget_grab_default (about_ok_button);
  return about_window;
}

GtkWidget*
create_aniso_window (void)
{
  GtkWidget *aniso_window;
  GtkWidget *vbox16;
  GtkWidget *frame12;
  GtkWidget *vbox17;
  GtkWidget *frame13;
  GtkWidget *vbox18;
  GtkWidget *label19;
  GSList *sa_group = NULL;
  GtkWidget *show_aniso_yes_radiobutton;
  GtkWidget *show_aniso_no_radiobutton;
  GtkWidget *frame14;
  GtkWidget *vbox19;
  GtkWidget *label20;
  GtkWidget *frame15;
  GtkWidget *vbox20;
  GSList *laa_group = NULL;
  GtkWidget *limit_display_radius_yes_radiobutton;
  GtkWidget *limit_display_radius_no_radiobutton;
  GtkWidget *frame16;
  GtkWidget *vbox21;
  GtkWidget *label21;
  GtkWidget *hbox11;
  GtkWidget *limit_display_radius_entry;
  GtkWidget *label22;
  GtkWidget *frame17;
  GtkWidget *vbox22;
  GtkWidget *label23;
  GtkWidget *hbox12;
  GtkWidget *aniso_probability_hscale;
  GtkWidget *label24;
  GtkWidget *hbox150;
  GtkWidget *show_aniso_ok_button;
  GtkWidget *show_aniso_close_button;

  aniso_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (aniso_window), "aniso_window", aniso_window);
  gtk_window_set_title (GTK_WINDOW (aniso_window), _("Anisotripic Atoms"));

  vbox16 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox16);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "vbox16", vbox16,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox16);
  gtk_container_add (GTK_CONTAINER (aniso_window), vbox16);

  frame12 = gtk_frame_new (NULL);
  gtk_widget_ref (frame12);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "frame12", frame12,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame12);
  gtk_box_pack_start (GTK_BOX (vbox16), frame12, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame12), 5);

  vbox17 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox17);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "vbox17", vbox17,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox17);
  gtk_container_add (GTK_CONTAINER (frame12), vbox17);

  frame13 = gtk_frame_new (NULL);
  gtk_widget_ref (frame13);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "frame13", frame13,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame13);
  gtk_box_pack_start (GTK_BOX (vbox17), frame13, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame13), 5);

  vbox18 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox18);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "vbox18", vbox18,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox18);
  gtk_container_add (GTK_CONTAINER (frame13), vbox18);

  label19 = gtk_label_new (_("Show Anisotropic Atoms?"));
  gtk_widget_ref (label19);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "label19", label19,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label19);
  gtk_box_pack_start (GTK_BOX (vbox18), label19, FALSE, FALSE, 0);

  show_aniso_yes_radiobutton = gtk_radio_button_new_with_label (sa_group, _("Yes"));
  sa_group = gtk_radio_button_group (GTK_RADIO_BUTTON (show_aniso_yes_radiobutton));
  gtk_widget_ref (show_aniso_yes_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "show_aniso_yes_radiobutton", show_aniso_yes_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (show_aniso_yes_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox18), show_aniso_yes_radiobutton, FALSE, FALSE, 0);

  show_aniso_no_radiobutton = gtk_radio_button_new_with_label (sa_group, _("No"));
  sa_group = gtk_radio_button_group (GTK_RADIO_BUTTON (show_aniso_no_radiobutton));
  gtk_widget_ref (show_aniso_no_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "show_aniso_no_radiobutton", show_aniso_no_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (show_aniso_no_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox18), show_aniso_no_radiobutton, FALSE, FALSE, 0);

  frame14 = gtk_frame_new (NULL);
  gtk_widget_ref (frame14);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "frame14", frame14,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame14);
  gtk_box_pack_start (GTK_BOX (vbox17), frame14, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame14), 5);

  vbox19 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox19);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "vbox19", vbox19,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox19);
  gtk_container_add (GTK_CONTAINER (frame14), vbox19);

  label20 = gtk_label_new (_("Limit Display Radius of Anisotropic Atoms?"));
  gtk_widget_ref (label20);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "label20", label20,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label20);
  gtk_box_pack_start (GTK_BOX (vbox19), label20, FALSE, FALSE, 2);
  gtk_misc_set_padding (GTK_MISC (label20), 6, 0);

  frame15 = gtk_frame_new (NULL);
  gtk_widget_ref (frame15);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "frame15", frame15,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame15);
  gtk_box_pack_start (GTK_BOX (vbox19), frame15, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame15), 5);

  vbox20 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox20);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "vbox20", vbox20,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox20);
  gtk_container_add (GTK_CONTAINER (frame15), vbox20);

  limit_display_radius_yes_radiobutton = gtk_radio_button_new_with_label (laa_group, _("Yes"));
  laa_group = gtk_radio_button_group (GTK_RADIO_BUTTON (limit_display_radius_yes_radiobutton));
  gtk_widget_ref (limit_display_radius_yes_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "limit_display_radius_yes_radiobutton", limit_display_radius_yes_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (limit_display_radius_yes_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox20), limit_display_radius_yes_radiobutton, FALSE, FALSE, 0);

  limit_display_radius_no_radiobutton = gtk_radio_button_new_with_label (laa_group, _("No"));
  laa_group = gtk_radio_button_group (GTK_RADIO_BUTTON (limit_display_radius_no_radiobutton));
  gtk_widget_ref (limit_display_radius_no_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "limit_display_radius_no_radiobutton", limit_display_radius_no_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (limit_display_radius_no_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox20), limit_display_radius_no_radiobutton, FALSE, FALSE, 0);

  frame16 = gtk_frame_new (NULL);
  gtk_widget_ref (frame16);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "frame16", frame16,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame16);
  gtk_box_pack_start (GTK_BOX (vbox19), frame16, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame16), 5);

  vbox21 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox21);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "vbox21", vbox21,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox21);
  gtk_container_add (GTK_CONTAINER (frame16), vbox21);

  label21 = gtk_label_new (_("Display Limit Radius"));
  gtk_widget_ref (label21);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "label21", label21,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label21);
  gtk_box_pack_start (GTK_BOX (vbox21), label21, FALSE, FALSE, 0);

  hbox11 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox11);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "hbox11", hbox11,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox11);
  gtk_box_pack_start (GTK_BOX (vbox21), hbox11, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox11), 5);

  limit_display_radius_entry = gtk_entry_new ();
  gtk_widget_ref (limit_display_radius_entry);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "limit_display_radius_entry", limit_display_radius_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (limit_display_radius_entry);
  gtk_box_pack_start (GTK_BOX (hbox11), limit_display_radius_entry, TRUE, TRUE, 3);

  label22 = gtk_label_new (_("A"));
  gtk_widget_ref (label22);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "label22", label22,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label22);
  gtk_box_pack_start (GTK_BOX (hbox11), label22, FALSE, FALSE, 3);

  frame17 = gtk_frame_new (NULL);
  gtk_widget_ref (frame17);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "frame17", frame17,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame17);
  gtk_box_pack_start (GTK_BOX (vbox17), frame17, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame17), 5);

  vbox22 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox22);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "vbox22", vbox22,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox22);
  gtk_container_add (GTK_CONTAINER (frame17), vbox22);

  label23 = gtk_label_new (_("Probability "));
  gtk_widget_ref (label23);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "label23", label23,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label23);
  gtk_box_pack_start (GTK_BOX (vbox22), label23, FALSE, FALSE, 2);

  hbox12 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox12);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "hbox12", hbox12,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox12);
  gtk_box_pack_start (GTK_BOX (vbox22), hbox12, TRUE, TRUE, 0);

  aniso_probability_hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (aniso_probability_hscale);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "aniso_probability_hscale", aniso_probability_hscale,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (aniso_probability_hscale);
  gtk_box_pack_start (GTK_BOX (hbox12), aniso_probability_hscale, TRUE, TRUE, 6);

  label24 = gtk_label_new (_("%"));
  gtk_widget_ref (label24);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "label24", label24,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label24);
  gtk_box_pack_start (GTK_BOX (hbox12), label24, FALSE, FALSE, 3);

  hbox150 = gtk_hbox_new (TRUE, 0);
  gtk_widget_ref (hbox150);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "hbox150", hbox150,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox150);
  gtk_box_pack_start (GTK_BOX (vbox16), hbox150, FALSE, FALSE, 1);
  gtk_container_set_border_width (GTK_CONTAINER (hbox150), 2);

  show_aniso_ok_button = gtk_button_new_with_label (_("  Apply  "));
  gtk_widget_ref (show_aniso_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "show_aniso_ok_button", show_aniso_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (show_aniso_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox150), show_aniso_ok_button, FALSE, FALSE, 0);
  GTK_WIDGET_SET_FLAGS (show_aniso_ok_button, GTK_CAN_DEFAULT);

  show_aniso_close_button = gtk_button_new_with_label (_("  Close  "));
  gtk_widget_ref (show_aniso_close_button);
  gtk_object_set_data_full (GTK_OBJECT (aniso_window), "show_aniso_close_button", show_aniso_close_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (show_aniso_close_button);
  gtk_box_pack_start (GTK_BOX (hbox150), show_aniso_close_button, FALSE, FALSE, 0);
  GTK_WIDGET_SET_FLAGS (show_aniso_close_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (show_aniso_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_show_aniso_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (show_aniso_close_button), "clicked",
                      GTK_SIGNAL_FUNC (on_show_aniso_close_button_clicked),
                      NULL);

  gtk_widget_grab_focus (show_aniso_ok_button);
  gtk_widget_grab_default (show_aniso_ok_button);
  return aniso_window;
}

GtkWidget*
create_smooth_scroll_window (void)
{
  GtkWidget *smooth_scroll_window;
  GtkWidget *vbox23;
  GtkWidget *label25;
  GtkWidget *vbox24;
  GtkWidget *frame18;
  GtkWidget *vbox25;
  GSList *ss_group = NULL;
  GtkWidget *smooth_scroll_yes_radiobutton;
  GtkWidget *smooth_scroll_no_radiobutton;
  GtkWidget *frame19;
  GtkWidget *hbox13;
  GtkWidget *label26;
  GtkWidget *smooth_scroll_steps_entry;
  GtkWidget *frame20;
  GtkWidget *hbox14;
  GtkWidget *label27;
  GtkWidget *smooth_scroll_limit_entry;
  GtkWidget *label28;
  GtkWidget *smooth_scrolling_window_ok_button;

  smooth_scroll_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (smooth_scroll_window), "smooth_scroll_window", smooth_scroll_window);
  gtk_window_set_title (GTK_WINDOW (smooth_scroll_window), _("window2"));

  vbox23 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox23);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "vbox23", vbox23,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox23);
  gtk_container_add (GTK_CONTAINER (smooth_scroll_window), vbox23);

  label25 = gtk_label_new (_("Recentring Smooth Scrolling"));
  gtk_widget_ref (label25);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "label25", label25,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label25);
  gtk_box_pack_start (GTK_BOX (vbox23), label25, FALSE, FALSE, 5);

  vbox24 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox24);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "vbox24", vbox24,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox24);
  gtk_box_pack_start (GTK_BOX (vbox23), vbox24, TRUE, TRUE, 0);

  frame18 = gtk_frame_new (NULL);
  gtk_widget_ref (frame18);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "frame18", frame18,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame18);
  gtk_box_pack_start (GTK_BOX (vbox24), frame18, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame18), 5);

  vbox25 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox25);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "vbox25", vbox25,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox25);
  gtk_container_add (GTK_CONTAINER (frame18), vbox25);

  smooth_scroll_yes_radiobutton = gtk_radio_button_new_with_label (ss_group, _("Yes"));
  ss_group = gtk_radio_button_group (GTK_RADIO_BUTTON (smooth_scroll_yes_radiobutton));
  gtk_widget_ref (smooth_scroll_yes_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "smooth_scroll_yes_radiobutton", smooth_scroll_yes_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (smooth_scroll_yes_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox25), smooth_scroll_yes_radiobutton, FALSE, FALSE, 0);

  smooth_scroll_no_radiobutton = gtk_radio_button_new_with_label (ss_group, _("No"));
  ss_group = gtk_radio_button_group (GTK_RADIO_BUTTON (smooth_scroll_no_radiobutton));
  gtk_widget_ref (smooth_scroll_no_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "smooth_scroll_no_radiobutton", smooth_scroll_no_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (smooth_scroll_no_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox25), smooth_scroll_no_radiobutton, FALSE, FALSE, 0);

  frame19 = gtk_frame_new (NULL);
  gtk_widget_ref (frame19);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "frame19", frame19,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame19);
  gtk_box_pack_start (GTK_BOX (vbox24), frame19, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame19), 5);

  hbox13 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox13);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "hbox13", hbox13,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox13);
  gtk_container_add (GTK_CONTAINER (frame19), hbox13);

  label26 = gtk_label_new (_("Number of Steps:"));
  gtk_widget_ref (label26);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "label26", label26,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label26);
  gtk_box_pack_start (GTK_BOX (hbox13), label26, FALSE, FALSE, 5);
  gtk_misc_set_padding (GTK_MISC (label26), 0, 10);

  smooth_scroll_steps_entry = gtk_entry_new ();
  gtk_widget_ref (smooth_scroll_steps_entry);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "smooth_scroll_steps_entry", smooth_scroll_steps_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (smooth_scroll_steps_entry);
  gtk_box_pack_start (GTK_BOX (hbox13), smooth_scroll_steps_entry, TRUE, TRUE, 10);
  gtk_widget_set_usize (smooth_scroll_steps_entry, 30, -2);

  frame20 = gtk_frame_new (NULL);
  gtk_widget_ref (frame20);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "frame20", frame20,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame20);
  gtk_box_pack_start (GTK_BOX (vbox24), frame20, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame20), 5);

  hbox14 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox14);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "hbox14", hbox14,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox14);
  gtk_container_add (GTK_CONTAINER (frame20), hbox14);

  label27 = gtk_label_new (_("Do Not Scroll for \ndistances more than:"));
  gtk_widget_ref (label27);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "label27", label27,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label27);
  gtk_box_pack_start (GTK_BOX (hbox14), label27, FALSE, FALSE, 5);
  gtk_misc_set_padding (GTK_MISC (label27), 0, 4);

  smooth_scroll_limit_entry = gtk_entry_new ();
  gtk_widget_ref (smooth_scroll_limit_entry);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "smooth_scroll_limit_entry", smooth_scroll_limit_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (smooth_scroll_limit_entry);
  gtk_box_pack_start (GTK_BOX (hbox14), smooth_scroll_limit_entry, TRUE, TRUE, 7);

  label28 = gtk_label_new (_("A"));
  gtk_widget_ref (label28);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "label28", label28,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label28);
  gtk_box_pack_start (GTK_BOX (hbox14), label28, FALSE, FALSE, 5);

  smooth_scrolling_window_ok_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (smooth_scrolling_window_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (smooth_scroll_window), "smooth_scrolling_window_ok_button", smooth_scrolling_window_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (smooth_scrolling_window_ok_button);
  gtk_box_pack_start (GTK_BOX (vbox23), smooth_scrolling_window_ok_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (smooth_scrolling_window_ok_button), 5);
  GTK_WIDGET_SET_FLAGS (smooth_scrolling_window_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (smooth_scrolling_window_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_smooth_scrolling_window_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (smooth_scrolling_window_ok_button);
  gtk_widget_grab_default (smooth_scrolling_window_ok_button);
  return smooth_scroll_window;
}

GtkWidget*
create_font_size_window (void)
{
  GtkWidget *font_size_window;
  GtkWidget *vbox26;
  GtkWidget *label29;
  GtkWidget *frame22;
  GtkWidget *vbox27;
  GSList *fs_group = NULL;
  GtkWidget *font_size_small_radiobutton;
  GtkWidget *font_size_medium_radiobutton;
  GtkWidget *font_size_large_radiobutton;
  GtkWidget *frame21;
  GtkWidget *font_size_ok_button;

  font_size_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (font_size_window), "font_size_window", font_size_window);
  gtk_window_set_title (GTK_WINDOW (font_size_window), _("window2"));

  vbox26 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox26);
  gtk_object_set_data_full (GTK_OBJECT (font_size_window), "vbox26", vbox26,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox26);
  gtk_container_add (GTK_CONTAINER (font_size_window), vbox26);

  label29 = gtk_label_new (_("Atom Label Font Size"));
  gtk_widget_ref (label29);
  gtk_object_set_data_full (GTK_OBJECT (font_size_window), "label29", label29,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label29);
  gtk_box_pack_start (GTK_BOX (vbox26), label29, FALSE, FALSE, 5);
  gtk_misc_set_padding (GTK_MISC (label29), 4, 2);

  frame22 = gtk_frame_new (NULL);
  gtk_widget_ref (frame22);
  gtk_object_set_data_full (GTK_OBJECT (font_size_window), "frame22", frame22,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame22);
  gtk_box_pack_start (GTK_BOX (vbox26), frame22, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame22), 5);

  vbox27 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox27);
  gtk_object_set_data_full (GTK_OBJECT (font_size_window), "vbox27", vbox27,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox27);
  gtk_container_add (GTK_CONTAINER (frame22), vbox27);

  font_size_small_radiobutton = gtk_radio_button_new_with_label (fs_group, _("Small"));
  fs_group = gtk_radio_button_group (GTK_RADIO_BUTTON (font_size_small_radiobutton));
  gtk_widget_ref (font_size_small_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (font_size_window), "font_size_small_radiobutton", font_size_small_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (font_size_small_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox27), font_size_small_radiobutton, FALSE, FALSE, 0);

  font_size_medium_radiobutton = gtk_radio_button_new_with_label (fs_group, _("Medium"));
  fs_group = gtk_radio_button_group (GTK_RADIO_BUTTON (font_size_medium_radiobutton));
  gtk_widget_ref (font_size_medium_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (font_size_window), "font_size_medium_radiobutton", font_size_medium_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (font_size_medium_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox27), font_size_medium_radiobutton, FALSE, FALSE, 0);

  font_size_large_radiobutton = gtk_radio_button_new_with_label (fs_group, _("Large"));
  fs_group = gtk_radio_button_group (GTK_RADIO_BUTTON (font_size_large_radiobutton));
  gtk_widget_ref (font_size_large_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (font_size_window), "font_size_large_radiobutton", font_size_large_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (font_size_large_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox27), font_size_large_radiobutton, FALSE, FALSE, 0);

  frame21 = gtk_frame_new (NULL);
  gtk_widget_ref (frame21);
  gtk_object_set_data_full (GTK_OBJECT (font_size_window), "frame21", frame21,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame21);
  gtk_box_pack_start (GTK_BOX (vbox26), frame21, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame21), 5);

  font_size_ok_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (font_size_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (font_size_window), "font_size_ok_button", font_size_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (font_size_ok_button);
  gtk_container_add (GTK_CONTAINER (frame21), font_size_ok_button);
  GTK_WIDGET_SET_FLAGS (font_size_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (font_size_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_font_size_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (font_size_ok_button);
  gtk_widget_grab_default (font_size_ok_button);
  return font_size_window;
}

GtkWidget*
create_map_name_fileselection1 (void)
{
  GtkWidget *map_name_fileselection1;
  GtkWidget *ok_button_map_name;
  GtkWidget *cancel_button_map_name;

  map_name_fileselection1 = gtk_file_selection_new (_("Select CCP4 Map"));
  gtk_object_set_data (GTK_OBJECT (map_name_fileselection1), "map_name_fileselection1", map_name_fileselection1);
  gtk_container_set_border_width (GTK_CONTAINER (map_name_fileselection1), 10);

  ok_button_map_name = GTK_FILE_SELECTION (map_name_fileselection1)->ok_button;
  gtk_object_set_data (GTK_OBJECT (map_name_fileselection1), "ok_button_map_name", ok_button_map_name);
  gtk_widget_show (ok_button_map_name);
  GTK_WIDGET_SET_FLAGS (ok_button_map_name, GTK_CAN_DEFAULT);

  cancel_button_map_name = GTK_FILE_SELECTION (map_name_fileselection1)->cancel_button;
  gtk_object_set_data (GTK_OBJECT (map_name_fileselection1), "cancel_button_map_name", cancel_button_map_name);
  gtk_widget_show (cancel_button_map_name);
  GTK_WIDGET_SET_FLAGS (cancel_button_map_name, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (map_name_fileselection1), "destroy",
                      GTK_SIGNAL_FUNC (on_map_name_fileselection1_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ok_button_map_name), "clicked",
                      GTK_SIGNAL_FUNC (on_ok_button_map_name_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (cancel_button_map_name), "clicked",
                      GTK_SIGNAL_FUNC (on_cancel_button_map_name_clicked),
                      NULL);

  return map_name_fileselection1;
}

GtkWidget*
create_phs_info_box (void)
{
  GtkWidget *phs_info_box;
  GtkWidget *vbox29;
  GtkWidget *frame26;
  GtkWidget *label36;
  GtkWidget *frame27;
  GtkWidget *hbox19;
  GtkWidget *phs_info_ok_button;
  GtkWidget *phs_info_cancel_button;

  phs_info_box = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (phs_info_box), "phs_info_box", phs_info_box);
  gtk_window_set_title (GTK_WINDOW (phs_info_box), _(".phs Info"));

  vbox29 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox29);
  gtk_object_set_data_full (GTK_OBJECT (phs_info_box), "vbox29", vbox29,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox29);
  gtk_container_add (GTK_CONTAINER (phs_info_box), vbox29);

  frame26 = gtk_frame_new (NULL);
  gtk_widget_ref (frame26);
  gtk_object_set_data_full (GTK_OBJECT (phs_info_box), "frame26", frame26,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame26);
  gtk_box_pack_start (GTK_BOX (vbox29), frame26, TRUE, TRUE, 2);
  gtk_container_set_border_width (GTK_CONTAINER (frame26), 5);

  label36 = gtk_label_new (_(".phs files additionally need cell and symmetry. \n We need a pdb file to assign them.\n\n(Note that this will not read coordinates - \njust the cell and symmetry)\n"));
  gtk_widget_ref (label36);
  gtk_object_set_data_full (GTK_OBJECT (phs_info_box), "label36", label36,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label36);
  gtk_container_add (GTK_CONTAINER (frame26), label36);
  gtk_misc_set_padding (GTK_MISC (label36), 5, 5);

  frame27 = gtk_frame_new (NULL);
  gtk_widget_ref (frame27);
  gtk_object_set_data_full (GTK_OBJECT (phs_info_box), "frame27", frame27,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame27);
  gtk_box_pack_start (GTK_BOX (vbox29), frame27, TRUE, TRUE, 0);

  hbox19 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox19);
  gtk_object_set_data_full (GTK_OBJECT (phs_info_box), "hbox19", hbox19,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox19);
  gtk_container_add (GTK_CONTAINER (frame27), hbox19);

  phs_info_ok_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (phs_info_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (phs_info_box), "phs_info_ok_button", phs_info_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (phs_info_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox19), phs_info_ok_button, TRUE, TRUE, 5);
  gtk_container_set_border_width (GTK_CONTAINER (phs_info_ok_button), 6);
  GTK_WIDGET_SET_FLAGS (phs_info_ok_button, GTK_CAN_DEFAULT);

  phs_info_cancel_button = gtk_button_new_with_label (_("Cancel"));
  gtk_widget_ref (phs_info_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (phs_info_box), "phs_info_cancel_button", phs_info_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (phs_info_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox19), phs_info_cancel_button, TRUE, TRUE, 5);
  gtk_container_set_border_width (GTK_CONTAINER (phs_info_cancel_button), 6);

  gtk_signal_connect (GTK_OBJECT (phs_info_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_phs_info_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (phs_info_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_phs_info_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (phs_info_ok_button);
  gtk_widget_grab_default (phs_info_ok_button);
  return phs_info_box;
}

GtkWidget*
create_phs_coordinates_fileselection (void)
{
  GtkWidget *phs_coordinates_fileselection;
  GtkWidget *ok_phs_coord_button;
  GtkWidget *cancel_phs_coord_button;

  phs_coordinates_fileselection = gtk_file_selection_new (_("Select Coordinates File for .phs symm/cell"));
  gtk_object_set_data (GTK_OBJECT (phs_coordinates_fileselection), "phs_coordinates_fileselection", phs_coordinates_fileselection);
  gtk_container_set_border_width (GTK_CONTAINER (phs_coordinates_fileselection), 10);

  ok_phs_coord_button = GTK_FILE_SELECTION (phs_coordinates_fileselection)->ok_button;
  gtk_object_set_data (GTK_OBJECT (phs_coordinates_fileselection), "ok_phs_coord_button", ok_phs_coord_button);
  gtk_widget_show (ok_phs_coord_button);
  GTK_WIDGET_SET_FLAGS (ok_phs_coord_button, GTK_CAN_DEFAULT);

  cancel_phs_coord_button = GTK_FILE_SELECTION (phs_coordinates_fileselection)->cancel_button;
  gtk_object_set_data (GTK_OBJECT (phs_coordinates_fileselection), "cancel_phs_coord_button", cancel_phs_coord_button);
  gtk_widget_show (cancel_phs_coord_button);
  GTK_WIDGET_SET_FLAGS (cancel_phs_coord_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (phs_coordinates_fileselection), "destroy",
                      GTK_SIGNAL_FUNC (on_phs_coordinates_fileselection_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ok_phs_coord_button), "clicked",
                      GTK_SIGNAL_FUNC (on_ok_phs_coord_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (cancel_phs_coord_button), "clicked",
                      GTK_SIGNAL_FUNC (on_cancel_phs_coord_button_clicked),
                      NULL);

  return phs_coordinates_fileselection;
}

GtkWidget*
create_display_control_window_glade (void)
{
  GtkWidget *display_control_window_glade;
  GtkWidget *vbox30;
  GtkWidget *display_control_vpaned;
  GtkWidget *paned_maps_vbox;
  GtkWidget *label257;
  GtkWidget *scrolledwindow21;
  GtkWidget *viewport13;
  GtkWidget *display_map_vbox;
  GtkWidget *paned_molecules_vbox;
  GtkWidget *label258;
  GtkWidget *scrolledwindow22;
  GtkWidget *viewport14;
  GtkWidget *display_molecule_vbox;
  GtkWidget *frame32;
  GtkWidget *display_control_ok_button;

  display_control_window_glade = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (display_control_window_glade), "display_control_window_glade", display_control_window_glade);
  gtk_widget_set_usize (display_control_window_glade, 390, 250);
  gtk_window_set_title (GTK_WINDOW (display_control_window_glade), _("Display Control"));

  vbox30 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox30);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "vbox30", vbox30,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox30);
  gtk_container_add (GTK_CONTAINER (display_control_window_glade), vbox30);
  gtk_container_set_border_width (GTK_CONTAINER (vbox30), 4);

  display_control_vpaned = gtk_vpaned_new ();
  gtk_widget_ref (display_control_vpaned);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "display_control_vpaned", display_control_vpaned,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (display_control_vpaned);
  gtk_box_pack_start (GTK_BOX (vbox30), display_control_vpaned, TRUE, TRUE, 0);

  paned_maps_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (paned_maps_vbox);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "paned_maps_vbox", paned_maps_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (paned_maps_vbox);
  gtk_paned_pack1 (GTK_PANED (display_control_vpaned), paned_maps_vbox, TRUE, TRUE);

  label257 = gtk_label_new (_("Maps"));
  gtk_widget_ref (label257);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "label257", label257,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label257);
  gtk_box_pack_start (GTK_BOX (paned_maps_vbox), label257, FALSE, FALSE, 0);

  scrolledwindow21 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow21);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "scrolledwindow21", scrolledwindow21,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow21);
  gtk_box_pack_start (GTK_BOX (paned_maps_vbox), scrolledwindow21, TRUE, TRUE, 0);

  viewport13 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport13);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "viewport13", viewport13,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport13);
  gtk_container_add (GTK_CONTAINER (scrolledwindow21), viewport13);

  display_map_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (display_map_vbox);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "display_map_vbox", display_map_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (display_map_vbox);
  gtk_container_add (GTK_CONTAINER (viewport13), display_map_vbox);

  paned_molecules_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (paned_molecules_vbox);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "paned_molecules_vbox", paned_molecules_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (paned_molecules_vbox);
  gtk_paned_pack2 (GTK_PANED (display_control_vpaned), paned_molecules_vbox, TRUE, TRUE);

  label258 = gtk_label_new (_("Molecules"));
  gtk_widget_ref (label258);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "label258", label258,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label258);
  gtk_box_pack_start (GTK_BOX (paned_molecules_vbox), label258, FALSE, FALSE, 0);

  scrolledwindow22 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow22);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "scrolledwindow22", scrolledwindow22,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow22);
  gtk_box_pack_start (GTK_BOX (paned_molecules_vbox), scrolledwindow22, TRUE, TRUE, 0);

  viewport14 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport14);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "viewport14", viewport14,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport14);
  gtk_container_add (GTK_CONTAINER (scrolledwindow22), viewport14);

  display_molecule_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (display_molecule_vbox);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "display_molecule_vbox", display_molecule_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (display_molecule_vbox);
  gtk_container_add (GTK_CONTAINER (viewport14), display_molecule_vbox);

  frame32 = gtk_frame_new (NULL);
  gtk_widget_ref (frame32);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "frame32", frame32,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame32);
  gtk_box_pack_start (GTK_BOX (vbox30), frame32, FALSE, TRUE, 2);
  gtk_widget_set_usize (frame32, -2, 36);
  gtk_container_set_border_width (GTK_CONTAINER (frame32), 2);
  GTK_WIDGET_SET_FLAGS (frame32, GTK_CAN_FOCUS);
  GTK_WIDGET_SET_FLAGS (frame32, GTK_CAN_DEFAULT);

  display_control_ok_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (display_control_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (display_control_window_glade), "display_control_ok_button", display_control_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (display_control_ok_button);
  gtk_container_add (GTK_CONTAINER (frame32), display_control_ok_button);

  gtk_signal_connect (GTK_OBJECT (display_control_window_glade), "destroy",
                      GTK_SIGNAL_FUNC (on_display_control_window_glade_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (display_control_window_glade), "configure_event",
                      GTK_SIGNAL_FUNC (on_display_control_window_glade_configure_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (display_control_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_display_control_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (frame32);
  gtk_widget_grab_default (frame32);
  return display_control_window_glade;
}

GtkWidget*
create_goto_atom_window (void)
{
  GtkWidget *goto_atom_window;
  GtkWidget *vbox33;
  GtkWidget *frame30;
  GtkWidget *vbox34;
  GtkWidget *label39;
  GtkWidget *vbox35;
  GtkWidget *hbox23;
  GtkWidget *go_to_atom_molecule_optionmenu;
  GtkWidget *go_to_atom_molecule_optionmenu_menu;
  GtkWidget *label40;
  GtkWidget *table5;
  GtkWidget *hbox24;
  GtkWidget *go_to_atom_chain_entry;
  GtkWidget *label41;
  GtkWidget *hbox25;
  GtkWidget *go_to_atom_residue_entry;
  GtkWidget *label42;
  GtkWidget *hbox26;
  GtkWidget *go_to_atom_atom_name_entry;
  GtkWidget *label43;
  GtkWidget *update_go_to_atom_from_current_position_button;
  GtkWidget *hseparator1;
  GtkWidget *go_to_atom_next_residue_button;
  GtkWidget *go_to_atom_previous_residue_button;
  GtkWidget *frame59;
  GtkWidget *go_to_atom_model_view_hbox;
  GtkWidget *go_to_atom_residue_scrolledwindow;
  GtkWidget *go_to_atom_atom_scrolledwindow;
  GtkWidget *hbox22;
  GtkWidget *go_to_atom_apply_button;
  GtkWidget *go_to_atom_cancel_button;

  goto_atom_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (goto_atom_window), "goto_atom_window", goto_atom_window);
  gtk_window_set_title (GTK_WINDOW (goto_atom_window), _("Go To Atom..."));

  vbox33 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox33);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "vbox33", vbox33,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox33);
  gtk_container_add (GTK_CONTAINER (goto_atom_window), vbox33);

  frame30 = gtk_frame_new (NULL);
  gtk_widget_ref (frame30);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "frame30", frame30,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame30);
  gtk_box_pack_start (GTK_BOX (vbox33), frame30, FALSE, TRUE, 0);

  vbox34 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox34);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "vbox34", vbox34,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox34);
  gtk_container_add (GTK_CONTAINER (frame30), vbox34);

  label39 = gtk_label_new (_("Define an Atom for Centering:"));
  gtk_widget_ref (label39);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "label39", label39,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label39);
  gtk_box_pack_start (GTK_BOX (vbox34), label39, FALSE, FALSE, 6);
  gtk_misc_set_padding (GTK_MISC (label39), 6, 5);

  vbox35 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox35);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "vbox35", vbox35,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox35);
  gtk_box_pack_start (GTK_BOX (vbox34), vbox35, FALSE, TRUE, 0);

  hbox23 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox23);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "hbox23", hbox23,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox23);
  gtk_box_pack_start (GTK_BOX (vbox35), hbox23, FALSE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox23), 3);

  go_to_atom_molecule_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (go_to_atom_molecule_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "go_to_atom_molecule_optionmenu", go_to_atom_molecule_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (go_to_atom_molecule_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox23), go_to_atom_molecule_optionmenu, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (go_to_atom_molecule_optionmenu), 2);
  go_to_atom_molecule_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (go_to_atom_molecule_optionmenu), go_to_atom_molecule_optionmenu_menu);

  label40 = gtk_label_new (_("  Molecule"));
  gtk_widget_ref (label40);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "label40", label40,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label40);
  gtk_box_pack_start (GTK_BOX (hbox23), label40, FALSE, FALSE, 0);

  table5 = gtk_table_new (3, 2, FALSE);
  gtk_widget_ref (table5);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "table5", table5,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (table5);
  gtk_box_pack_start (GTK_BOX (vbox35), table5, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (table5), 2);

  hbox24 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox24);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "hbox24", hbox24,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox24);
  gtk_table_attach (GTK_TABLE (table5), hbox24, 0, 1, 0, 1,
                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL), 0, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox24), 2);

  go_to_atom_chain_entry = gtk_entry_new ();
  gtk_widget_ref (go_to_atom_chain_entry);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "go_to_atom_chain_entry", go_to_atom_chain_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (go_to_atom_chain_entry);
  gtk_box_pack_start (GTK_BOX (hbox24), go_to_atom_chain_entry, FALSE, FALSE, 0);
  gtk_widget_set_usize (go_to_atom_chain_entry, 60, -2);

  label41 = gtk_label_new (_("Chain"));
  gtk_widget_ref (label41);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "label41", label41,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label41);
  gtk_box_pack_start (GTK_BOX (hbox24), label41, FALSE, FALSE, 6);

  hbox25 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox25);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "hbox25", hbox25,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox25);
  gtk_table_attach (GTK_TABLE (table5), hbox25, 0, 1, 1, 2,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL), 0, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox25), 2);

  go_to_atom_residue_entry = gtk_entry_new ();
  gtk_widget_ref (go_to_atom_residue_entry);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "go_to_atom_residue_entry", go_to_atom_residue_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (go_to_atom_residue_entry);
  gtk_box_pack_start (GTK_BOX (hbox25), go_to_atom_residue_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (go_to_atom_residue_entry, 60, -2);

  label42 = gtk_label_new (_("Residue Number"));
  gtk_widget_ref (label42);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "label42", label42,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label42);
  gtk_box_pack_start (GTK_BOX (hbox25), label42, FALSE, FALSE, 6);

  hbox26 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox26);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "hbox26", hbox26,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox26);
  gtk_table_attach (GTK_TABLE (table5), hbox26, 0, 1, 2, 3,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL), 0, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox26), 2);

  go_to_atom_atom_name_entry = gtk_entry_new ();
  gtk_widget_ref (go_to_atom_atom_name_entry);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "go_to_atom_atom_name_entry", go_to_atom_atom_name_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (go_to_atom_atom_name_entry);
  gtk_box_pack_start (GTK_BOX (hbox26), go_to_atom_atom_name_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (go_to_atom_atom_name_entry, 60, -2);

  label43 = gtk_label_new (_("Atom Name"));
  gtk_widget_ref (label43);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "label43", label43,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label43);
  gtk_box_pack_start (GTK_BOX (hbox26), label43, FALSE, FALSE, 6);

  update_go_to_atom_from_current_position_button = gtk_button_new_with_label (_(" Update from Current Postion "));
  gtk_widget_ref (update_go_to_atom_from_current_position_button);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "update_go_to_atom_from_current_position_button", update_go_to_atom_from_current_position_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (update_go_to_atom_from_current_position_button);
  gtk_table_attach (GTK_TABLE (table5), update_go_to_atom_from_current_position_button, 1, 2, 0, 1,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);

  hseparator1 = gtk_hseparator_new ();
  gtk_widget_ref (hseparator1);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "hseparator1", hseparator1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hseparator1);
  gtk_box_pack_start (GTK_BOX (vbox33), hseparator1, FALSE, TRUE, 0);

  go_to_atom_next_residue_button = gtk_button_new_with_label (_("Next Residue"));
  gtk_widget_ref (go_to_atom_next_residue_button);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "go_to_atom_next_residue_button", go_to_atom_next_residue_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (go_to_atom_next_residue_button);
  gtk_box_pack_start (GTK_BOX (vbox33), go_to_atom_next_residue_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (go_to_atom_next_residue_button), 8);

  go_to_atom_previous_residue_button = gtk_button_new_with_label (_("Previous Residue"));
  gtk_widget_ref (go_to_atom_previous_residue_button);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "go_to_atom_previous_residue_button", go_to_atom_previous_residue_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (go_to_atom_previous_residue_button);
  gtk_box_pack_start (GTK_BOX (vbox33), go_to_atom_previous_residue_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (go_to_atom_previous_residue_button), 8);

  frame59 = gtk_frame_new (NULL);
  gtk_widget_ref (frame59);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "frame59", frame59,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame59);
  gtk_box_pack_start (GTK_BOX (vbox33), frame59, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame59), 6);

  go_to_atom_model_view_hbox = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (go_to_atom_model_view_hbox);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "go_to_atom_model_view_hbox", go_to_atom_model_view_hbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (go_to_atom_model_view_hbox);
  gtk_container_add (GTK_CONTAINER (frame59), go_to_atom_model_view_hbox);

  go_to_atom_residue_scrolledwindow = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (go_to_atom_residue_scrolledwindow);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "go_to_atom_residue_scrolledwindow", go_to_atom_residue_scrolledwindow,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (go_to_atom_residue_scrolledwindow);
  gtk_box_pack_start (GTK_BOX (go_to_atom_model_view_hbox), go_to_atom_residue_scrolledwindow, TRUE, TRUE, 0);
  gtk_widget_set_usize (go_to_atom_residue_scrolledwindow, 113, 172);

  go_to_atom_atom_scrolledwindow = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (go_to_atom_atom_scrolledwindow);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "go_to_atom_atom_scrolledwindow", go_to_atom_atom_scrolledwindow,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (go_to_atom_atom_scrolledwindow);
  gtk_box_pack_start (GTK_BOX (go_to_atom_model_view_hbox), go_to_atom_atom_scrolledwindow, TRUE, TRUE, 0);
  gtk_widget_set_usize (go_to_atom_atom_scrolledwindow, 150, 172);

  hbox22 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox22);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "hbox22", hbox22,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox22);
  gtk_box_pack_start (GTK_BOX (vbox33), hbox22, FALSE, TRUE, 0);

  go_to_atom_apply_button = gtk_button_new_with_label (_("  Apply  "));
  gtk_widget_ref (go_to_atom_apply_button);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "go_to_atom_apply_button", go_to_atom_apply_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (go_to_atom_apply_button);
  gtk_box_pack_start (GTK_BOX (hbox22), go_to_atom_apply_button, TRUE, TRUE, 5);
  gtk_container_set_border_width (GTK_CONTAINER (go_to_atom_apply_button), 3);
  GTK_WIDGET_SET_FLAGS (go_to_atom_apply_button, GTK_CAN_DEFAULT);

  go_to_atom_cancel_button = gtk_button_new_with_label (_("  Close  "));
  gtk_widget_ref (go_to_atom_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (goto_atom_window), "go_to_atom_cancel_button", go_to_atom_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (go_to_atom_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox22), go_to_atom_cancel_button, TRUE, TRUE, 6);
  gtk_container_set_border_width (GTK_CONTAINER (go_to_atom_cancel_button), 3);
  GTK_WIDGET_SET_FLAGS (go_to_atom_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (goto_atom_window), "destroy",
                      GTK_SIGNAL_FUNC (on_goto_atom_window_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (goto_atom_window), "configure_event",
                      GTK_SIGNAL_FUNC (on_goto_atom_window_configure_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (go_to_atom_chain_entry), "key_press_event",
                      GTK_SIGNAL_FUNC (on_go_to_atom_chain_entry_key_press_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (go_to_atom_residue_entry), "key_press_event",
                      GTK_SIGNAL_FUNC (on_go_to_atom_residue_entry_key_press_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (go_to_atom_atom_name_entry), "key_press_event",
                      GTK_SIGNAL_FUNC (on_go_to_atom_atom_name_entry_key_press_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (update_go_to_atom_from_current_position_button), "clicked",
                      GTK_SIGNAL_FUNC (on_update_go_to_atom_from_current_position_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (go_to_atom_next_residue_button), "clicked",
                      GTK_SIGNAL_FUNC (on_go_to_atom_next_residue_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (go_to_atom_previous_residue_button), "clicked",
                      GTK_SIGNAL_FUNC (on_go_to_atom_previous_residue_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (go_to_atom_apply_button), "clicked",
                      GTK_SIGNAL_FUNC (on_go_to_atom_apply_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (go_to_atom_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_go_to_atom_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_default (go_to_atom_apply_button);
  return goto_atom_window;
}

GtkWidget*
create_skeletonization_box_radius_window (void)
{
  GtkWidget *skeletonization_box_radius_window;
  GtkWidget *vbox36;
  GtkWidget *label46;
  GtkWidget *hbox28;
  GtkWidget *label44;
  GtkWidget *skeleton_box_size_entry;
  GtkWidget *label45;
  GtkWidget *frame31;
  GtkWidget *hbox27;
  GtkWidget *skel_box_radius_ok_button;
  GtkWidget *skel_box_radius_cancel_button;

  skeletonization_box_radius_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (skeletonization_box_radius_window), "skeletonization_box_radius_window", skeletonization_box_radius_window);
  gtk_window_set_title (GTK_WINDOW (skeletonization_box_radius_window), _("Skeleton Box Size"));

  vbox36 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox36);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_box_radius_window), "vbox36", vbox36,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox36);
  gtk_container_add (GTK_CONTAINER (skeletonization_box_radius_window), vbox36);

  label46 = gtk_label_new (_("Skeleton Box Size"));
  gtk_widget_ref (label46);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_box_radius_window), "label46", label46,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label46);
  gtk_box_pack_start (GTK_BOX (vbox36), label46, FALSE, FALSE, 8);

  hbox28 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox28);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_box_radius_window), "hbox28", hbox28,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox28);
  gtk_box_pack_start (GTK_BOX (vbox36), hbox28, TRUE, TRUE, 6);

  label44 = gtk_label_new (_("Size"));
  gtk_widget_ref (label44);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_box_radius_window), "label44", label44,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label44);
  gtk_box_pack_start (GTK_BOX (hbox28), label44, FALSE, FALSE, 4);

  skeleton_box_size_entry = gtk_entry_new ();
  gtk_widget_ref (skeleton_box_size_entry);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_box_radius_window), "skeleton_box_size_entry", skeleton_box_size_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeleton_box_size_entry);
  gtk_box_pack_start (GTK_BOX (hbox28), skeleton_box_size_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (skeleton_box_size_entry, 60, -2);

  label45 = gtk_label_new (_("Angstoms"));
  gtk_widget_ref (label45);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_box_radius_window), "label45", label45,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label45);
  gtk_box_pack_start (GTK_BOX (hbox28), label45, FALSE, FALSE, 6);

  frame31 = gtk_frame_new (NULL);
  gtk_widget_ref (frame31);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_box_radius_window), "frame31", frame31,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame31);
  gtk_box_pack_start (GTK_BOX (vbox36), frame31, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame31), 6);

  hbox27 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox27);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_box_radius_window), "hbox27", hbox27,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox27);
  gtk_container_add (GTK_CONTAINER (frame31), hbox27);

  skel_box_radius_ok_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (skel_box_radius_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_box_radius_window), "skel_box_radius_ok_button", skel_box_radius_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skel_box_radius_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox27), skel_box_radius_ok_button, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (skel_box_radius_ok_button), 4);
  GTK_WIDGET_SET_FLAGS (skel_box_radius_ok_button, GTK_CAN_DEFAULT);

  skel_box_radius_cancel_button = gtk_button_new_with_label (_("Cancel"));
  gtk_widget_ref (skel_box_radius_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_box_radius_window), "skel_box_radius_cancel_button", skel_box_radius_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skel_box_radius_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox27), skel_box_radius_cancel_button, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (skel_box_radius_cancel_button), 4);
  GTK_WIDGET_SET_FLAGS (skel_box_radius_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (skel_box_radius_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_skel_box_radius_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (skel_box_radius_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_skel_box_radius_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_default (skel_box_radius_ok_button);
  return skeletonization_box_radius_window;
}

GtkWidget*
create_skeletonization_level_window (void)
{
  GtkWidget *skeletonization_level_window;
  GtkWidget *vbox37;
  GtkWidget *label47;
  GtkWidget *hbox29;
  GtkWidget *label48;
  GtkWidget *skeleton_level_entry;
  GtkWidget *label49;
  GtkWidget *hbox30;
  GtkWidget *skeletonization_level_ok_button;
  GtkWidget *skeletonization_level_apply_button;
  GtkWidget *skeletonization_level_cancel_button;

  skeletonization_level_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (skeletonization_level_window), "skeletonization_level_window", skeletonization_level_window);
  gtk_window_set_title (GTK_WINDOW (skeletonization_level_window), _("Skeletonization Level"));

  vbox37 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox37);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_level_window), "vbox37", vbox37,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox37);
  gtk_container_add (GTK_CONTAINER (skeletonization_level_window), vbox37);

  label47 = gtk_label_new (_("Skeletonization Level"));
  gtk_widget_ref (label47);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_level_window), "label47", label47,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label47);
  gtk_box_pack_start (GTK_BOX (vbox37), label47, FALSE, FALSE, 6);

  hbox29 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox29);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_level_window), "hbox29", hbox29,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox29);
  gtk_box_pack_start (GTK_BOX (vbox37), hbox29, TRUE, TRUE, 0);

  label48 = gtk_label_new (_("Level"));
  gtk_widget_ref (label48);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_level_window), "label48", label48,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label48);
  gtk_box_pack_start (GTK_BOX (hbox29), label48, FALSE, FALSE, 6);

  skeleton_level_entry = gtk_entry_new ();
  gtk_widget_ref (skeleton_level_entry);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_level_window), "skeleton_level_entry", skeleton_level_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeleton_level_entry);
  gtk_box_pack_start (GTK_BOX (hbox29), skeleton_level_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (skeleton_level_entry, 68, -2);

  label49 = gtk_label_new (_("  electrons/A^3  "));
  gtk_widget_ref (label49);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_level_window), "label49", label49,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label49);
  gtk_box_pack_start (GTK_BOX (hbox29), label49, FALSE, FALSE, 6);

  hbox30 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox30);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_level_window), "hbox30", hbox30,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox30);
  gtk_box_pack_start (GTK_BOX (vbox37), hbox30, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox30), 6);

  skeletonization_level_ok_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (skeletonization_level_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_level_window), "skeletonization_level_ok_button", skeletonization_level_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeletonization_level_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox30), skeletonization_level_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (skeletonization_level_ok_button, GTK_CAN_DEFAULT);

  skeletonization_level_apply_button = gtk_button_new_with_label (_("Apply"));
  gtk_widget_ref (skeletonization_level_apply_button);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_level_window), "skeletonization_level_apply_button", skeletonization_level_apply_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeletonization_level_apply_button);
  gtk_box_pack_start (GTK_BOX (hbox30), skeletonization_level_apply_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (skeletonization_level_apply_button, GTK_CAN_DEFAULT);

  skeletonization_level_cancel_button = gtk_button_new_with_label (_("Cancel"));
  gtk_widget_ref (skeletonization_level_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (skeletonization_level_window), "skeletonization_level_cancel_button", skeletonization_level_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeletonization_level_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox30), skeletonization_level_cancel_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (skeletonization_level_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (skeletonization_level_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_skeletonization_level_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (skeletonization_level_apply_button), "clicked",
                      GTK_SIGNAL_FUNC (on_skeletonization_level_apply_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (skeletonization_level_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_skeletonization_level_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_default (skeletonization_level_ok_button);
  return skeletonization_level_window;
}

GtkWidget*
create_rotation_centre_cube_size_window (void)
{
  GtkWidget *rotation_centre_cube_size_window;
  GtkWidget *vbox38;
  GtkWidget *label50;
  GtkWidget *hbox31;
  GtkWidget *label51;
  GtkWidget *rotation_centre_cube_size_entry;
  GtkWidget *label52;
  GtkWidget *rotation_centre_size_ok_button;

  rotation_centre_cube_size_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (rotation_centre_cube_size_window), "rotation_centre_cube_size_window", rotation_centre_cube_size_window);
  gtk_window_set_title (GTK_WINDOW (rotation_centre_cube_size_window), _("window2"));

  vbox38 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox38);
  gtk_object_set_data_full (GTK_OBJECT (rotation_centre_cube_size_window), "vbox38", vbox38,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox38);
  gtk_container_add (GTK_CONTAINER (rotation_centre_cube_size_window), vbox38);

  label50 = gtk_label_new (_("Rotation Centre Cube Size"));
  gtk_widget_ref (label50);
  gtk_object_set_data_full (GTK_OBJECT (rotation_centre_cube_size_window), "label50", label50,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label50);
  gtk_box_pack_start (GTK_BOX (vbox38), label50, FALSE, FALSE, 5);

  hbox31 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox31);
  gtk_object_set_data_full (GTK_OBJECT (rotation_centre_cube_size_window), "hbox31", hbox31,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox31);
  gtk_box_pack_start (GTK_BOX (vbox38), hbox31, TRUE, TRUE, 2);

  label51 = gtk_label_new (_("Size:"));
  gtk_widget_ref (label51);
  gtk_object_set_data_full (GTK_OBJECT (rotation_centre_cube_size_window), "label51", label51,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label51);
  gtk_box_pack_start (GTK_BOX (hbox31), label51, FALSE, FALSE, 7);

  rotation_centre_cube_size_entry = gtk_entry_new ();
  gtk_widget_ref (rotation_centre_cube_size_entry);
  gtk_object_set_data_full (GTK_OBJECT (rotation_centre_cube_size_window), "rotation_centre_cube_size_entry", rotation_centre_cube_size_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotation_centre_cube_size_entry);
  gtk_box_pack_start (GTK_BOX (hbox31), rotation_centre_cube_size_entry, TRUE, TRUE, 0);
  gtk_widget_set_usize (rotation_centre_cube_size_entry, 66, -2);

  label52 = gtk_label_new (_("Angstroems"));
  gtk_widget_ref (label52);
  gtk_object_set_data_full (GTK_OBJECT (rotation_centre_cube_size_window), "label52", label52,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label52);
  gtk_box_pack_start (GTK_BOX (hbox31), label52, FALSE, FALSE, 6);

  rotation_centre_size_ok_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (rotation_centre_size_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (rotation_centre_cube_size_window), "rotation_centre_size_ok_button", rotation_centre_size_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotation_centre_size_ok_button);
  gtk_box_pack_start (GTK_BOX (vbox38), rotation_centre_size_ok_button, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (rotation_centre_size_ok_button), 6);
  GTK_WIDGET_SET_FLAGS (rotation_centre_size_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (rotation_centre_size_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_rotation_centre_size_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (rotation_centre_size_ok_button);
  gtk_widget_grab_default (rotation_centre_size_ok_button);
  return rotation_centre_cube_size_window;
}

GtkWidget*
create_phs_cell_choice_window (void)
{
  GtkWidget *phs_cell_choice_window;
  GtkWidget *vbox39;
  GtkWidget *label67;
  GtkWidget *phs_cell_chooser_vbox;
  GtkWidget *hbox32;
  GtkWidget *phs_cell_choice_ok_button;
  GtkWidget *phs_cell_choice_cancel_button;

  phs_cell_choice_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (phs_cell_choice_window), "phs_cell_choice_window", phs_cell_choice_window);
  gtk_window_set_title (GTK_WINDOW (phs_cell_choice_window), _("Choose Cell for PHS file:"));

  vbox39 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox39);
  gtk_object_set_data_full (GTK_OBJECT (phs_cell_choice_window), "vbox39", vbox39,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox39);
  gtk_container_add (GTK_CONTAINER (phs_cell_choice_window), vbox39);

  label67 = gtk_label_new (_("Choose a Symmetry and Cell for the Phases file"));
  gtk_widget_ref (label67);
  gtk_object_set_data_full (GTK_OBJECT (phs_cell_choice_window), "label67", label67,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label67);
  gtk_box_pack_start (GTK_BOX (vbox39), label67, FALSE, FALSE, 6);

  phs_cell_chooser_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (phs_cell_chooser_vbox);
  gtk_object_set_data_full (GTK_OBJECT (phs_cell_choice_window), "phs_cell_chooser_vbox", phs_cell_chooser_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (phs_cell_chooser_vbox);
  gtk_box_pack_start (GTK_BOX (vbox39), phs_cell_chooser_vbox, TRUE, TRUE, 0);

  hbox32 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox32);
  gtk_object_set_data_full (GTK_OBJECT (phs_cell_choice_window), "hbox32", hbox32,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox32);
  gtk_box_pack_start (GTK_BOX (vbox39), hbox32, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox32), 6);

  phs_cell_choice_ok_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (phs_cell_choice_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (phs_cell_choice_window), "phs_cell_choice_ok_button", phs_cell_choice_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (phs_cell_choice_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox32), phs_cell_choice_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (phs_cell_choice_ok_button, GTK_CAN_DEFAULT);

  phs_cell_choice_cancel_button = gtk_button_new_with_label (_("Cancel"));
  gtk_widget_ref (phs_cell_choice_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (phs_cell_choice_window), "phs_cell_choice_cancel_button", phs_cell_choice_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (phs_cell_choice_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox32), phs_cell_choice_cancel_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (phs_cell_choice_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (phs_cell_choice_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_phs_cell_choice_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (phs_cell_choice_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_phs_cell_choice_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_default (phs_cell_choice_ok_button);
  return phs_cell_choice_window;
}

GtkWidget*
create_accession_code_window (void)
{
  GtkWidget *accession_code_window;
  GtkWidget *frame34;
  GtkWidget *vbox40;
  GtkWidget *label69;
  GtkWidget *accession_code_entry;

  accession_code_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (accession_code_window), "accession_code_window", accession_code_window);
  gtk_window_set_title (GTK_WINDOW (accession_code_window), _("PDB Accession Code "));

  frame34 = gtk_frame_new (NULL);
  gtk_widget_ref (frame34);
  gtk_object_set_data_full (GTK_OBJECT (accession_code_window), "frame34", frame34,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame34);
  gtk_container_add (GTK_CONTAINER (accession_code_window), frame34);
  gtk_container_set_border_width (GTK_CONTAINER (frame34), 7);

  vbox40 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox40);
  gtk_object_set_data_full (GTK_OBJECT (accession_code_window), "vbox40", vbox40,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox40);
  gtk_container_add (GTK_CONTAINER (frame34), vbox40);

  label69 = gtk_label_new (_("PDB Accession Code:"));
  gtk_widget_ref (label69);
  gtk_object_set_data_full (GTK_OBJECT (accession_code_window), "label69", label69,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label69);
  gtk_box_pack_start (GTK_BOX (vbox40), label69, FALSE, FALSE, 0);

  accession_code_entry = gtk_entry_new ();
  gtk_widget_ref (accession_code_entry);
  gtk_object_set_data_full (GTK_OBJECT (accession_code_window), "accession_code_entry", accession_code_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (accession_code_entry);
  gtk_box_pack_start (GTK_BOX (vbox40), accession_code_entry, FALSE, FALSE, 2);

  gtk_signal_connect (GTK_OBJECT (accession_code_entry), "key_press_event",
                      GTK_SIGNAL_FUNC (on_accession_code_entry_key_press_event),
                      NULL);

  return accession_code_window;
}

GtkWidget*
create_dynarama_window (void)
{
  GtkWidget *dynarama_window;
  GtkWidget *dynarama_vbox;
  GtkWidget *dynarama_scrolledwindow;
  GtkWidget *dynarama_viewport;
  GtkWidget *rama_stats_frame;
  GtkWidget *rama_stats_vbox;
  GtkWidget *rama_stats_label_1;
  GtkWidget *rama_stats_label_2;
  GtkWidget *rama_stats_label_3;
  GtkWidget *hbox65;
  GtkWidget *dynarama_ok_button;
  GtkWidget *dynarama_cancel_button;

  dynarama_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (dynarama_window), "dynarama_window", dynarama_window);
  gtk_container_set_border_width (GTK_CONTAINER (dynarama_window), 2);
  gtk_window_set_title (GTK_WINDOW (dynarama_window), _("Dynarama"));

  dynarama_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (dynarama_vbox);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_window), "dynarama_vbox", dynarama_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (dynarama_vbox);
  gtk_container_add (GTK_CONTAINER (dynarama_window), dynarama_vbox);

  dynarama_scrolledwindow = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (dynarama_scrolledwindow);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_window), "dynarama_scrolledwindow", dynarama_scrolledwindow,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (dynarama_scrolledwindow);
  gtk_box_pack_start (GTK_BOX (dynarama_vbox), dynarama_scrolledwindow, TRUE, TRUE, 0);

  dynarama_viewport = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (dynarama_viewport);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_window), "dynarama_viewport", dynarama_viewport,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (dynarama_viewport);
  gtk_container_add (GTK_CONTAINER (dynarama_scrolledwindow), dynarama_viewport);

  rama_stats_frame = gtk_frame_new (NULL);
  gtk_widget_ref (rama_stats_frame);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_window), "rama_stats_frame", rama_stats_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rama_stats_frame);
  gtk_box_pack_start (GTK_BOX (dynarama_vbox), rama_stats_frame, FALSE, FALSE, 2);
  gtk_container_set_border_width (GTK_CONTAINER (rama_stats_frame), 6);

  rama_stats_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (rama_stats_vbox);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_window), "rama_stats_vbox", rama_stats_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rama_stats_vbox);
  gtk_container_add (GTK_CONTAINER (rama_stats_frame), rama_stats_vbox);
  gtk_container_set_border_width (GTK_CONTAINER (rama_stats_vbox), 4);

  rama_stats_label_1 = gtk_label_new (_("In Prefered Regions:  239  (85.02%)"));
  gtk_widget_ref (rama_stats_label_1);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_window), "rama_stats_label_1", rama_stats_label_1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rama_stats_label_1);
  gtk_box_pack_start (GTK_BOX (rama_stats_vbox), rama_stats_label_1, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (rama_stats_label_1), 0, 0.5);
  gtk_misc_set_padding (GTK_MISC (rama_stats_label_1), 6, 0);

  rama_stats_label_2 = gtk_label_new (_("In Allowed Regions:  365  (23.45%)"));
  gtk_widget_ref (rama_stats_label_2);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_window), "rama_stats_label_2", rama_stats_label_2,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rama_stats_label_2);
  gtk_box_pack_start (GTK_BOX (rama_stats_vbox), rama_stats_label_2, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (rama_stats_label_2), 0, 0.5);
  gtk_misc_set_padding (GTK_MISC (rama_stats_label_2), 6, 0);

  rama_stats_label_3 = gtk_label_new (_("Outliers:  34 (0.23%) "));
  gtk_widget_ref (rama_stats_label_3);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_window), "rama_stats_label_3", rama_stats_label_3,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rama_stats_label_3);
  gtk_box_pack_start (GTK_BOX (rama_stats_vbox), rama_stats_label_3, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (rama_stats_label_3), 0, 0.5);
  gtk_misc_set_padding (GTK_MISC (rama_stats_label_3), 6, 0);

  hbox65 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox65);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_window), "hbox65", hbox65,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox65);
  gtk_box_pack_start (GTK_BOX (dynarama_vbox), hbox65, FALSE, FALSE, 0);

  dynarama_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (dynarama_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_window), "dynarama_ok_button", dynarama_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (dynarama_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox65), dynarama_ok_button, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (dynarama_ok_button), 6);
  GTK_WIDGET_SET_FLAGS (dynarama_ok_button, GTK_CAN_DEFAULT);

  dynarama_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (dynarama_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_window), "dynarama_cancel_button", dynarama_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (dynarama_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox65), dynarama_cancel_button, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (dynarama_cancel_button), 6);
  GTK_WIDGET_SET_FLAGS (dynarama_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (dynarama_window), "destroy",
                      GTK_SIGNAL_FUNC (on_dynarama_window_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (dynarama_window), "configure_event",
                      GTK_SIGNAL_FUNC (on_dynarama_window_configure_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (dynarama_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_dynarama_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (dynarama_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_dynarama_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (dynarama_ok_button);
  gtk_widget_grab_default (dynarama_ok_button);
  return dynarama_window;
}

GtkWidget*
create_dynarama_properties_window (void)
{
  GtkWidget *dynarama_properties_window;
  GtkWidget *vbox2;
  GtkWidget *notebook2;
  GtkWidget *vbox3;
  GtkWidget *checkbutton1;
  GtkWidget *checkbutton2;
  GtkWidget *label4;
  GtkWidget *hseparator1;
  GtkWidget *dynarama_properties_ok_button;

  dynarama_properties_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (dynarama_properties_window), "dynarama_properties_window", dynarama_properties_window);
  gtk_window_set_title (GTK_WINDOW (dynarama_properties_window), _("Properies"));

  vbox2 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox2);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_properties_window), "vbox2", vbox2,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox2);
  gtk_container_add (GTK_CONTAINER (dynarama_properties_window), vbox2);

  notebook2 = gtk_notebook_new ();
  gtk_widget_ref (notebook2);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_properties_window), "notebook2", notebook2,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (notebook2);
  gtk_box_pack_start (GTK_BOX (vbox2), notebook2, TRUE, TRUE, 0);

  vbox3 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox3);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_properties_window), "vbox3", vbox3,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox3);
  gtk_container_add (GTK_CONTAINER (notebook2), vbox3);

  checkbutton1 = gtk_check_button_new_with_label (_("Labels"));
  gtk_widget_ref (checkbutton1);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_properties_window), "checkbutton1", checkbutton1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (checkbutton1);
  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton1, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbutton1), TRUE);

  checkbutton2 = gtk_check_button_new_with_label (_("Sticky Labels"));
  gtk_widget_ref (checkbutton2);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_properties_window), "checkbutton2", checkbutton2,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (checkbutton2);
  gtk_box_pack_start (GTK_BOX (vbox3), checkbutton2, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (checkbutton2), TRUE);

  label4 = gtk_label_new (_("Labels"));
  gtk_widget_ref (label4);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_properties_window), "label4", label4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label4);
  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook2), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook2), 0), label4);

  hseparator1 = gtk_hseparator_new ();
  gtk_widget_ref (hseparator1);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_properties_window), "hseparator1", hseparator1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hseparator1);
  gtk_box_pack_start (GTK_BOX (vbox2), hseparator1, TRUE, TRUE, 0);

  dynarama_properties_ok_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (dynarama_properties_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (dynarama_properties_window), "dynarama_properties_ok_button", dynarama_properties_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (dynarama_properties_ok_button);
  gtk_box_pack_start (GTK_BOX (vbox2), dynarama_properties_ok_button, FALSE, FALSE, 0);
  GTK_WIDGET_SET_FLAGS (dynarama_properties_ok_button, GTK_CAN_DEFAULT);

  gtk_widget_grab_default (dynarama_properties_ok_button);
  return dynarama_properties_window;
}

GtkWidget*
create_python_window (void)
{
  GtkWidget *python_window;
  GtkWidget *vbox41;
  GtkWidget *scrolledwindow4;
  GtkWidget *python_window_text;
  GtkWidget *python_window_entry;

  python_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (python_window), "python_window", python_window);
  gtk_container_set_border_width (GTK_CONTAINER (python_window), 10);
  gtk_window_set_title (GTK_WINDOW (python_window), _("window2"));

  vbox41 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox41);
  gtk_object_set_data_full (GTK_OBJECT (python_window), "vbox41", vbox41,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox41);
  gtk_container_add (GTK_CONTAINER (python_window), vbox41);

  scrolledwindow4 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow4);
  gtk_object_set_data_full (GTK_OBJECT (python_window), "scrolledwindow4", scrolledwindow4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow4);
  gtk_box_pack_start (GTK_BOX (vbox41), scrolledwindow4, TRUE, TRUE, 0);

  python_window_text = gtk_text_new (NULL, NULL);
  gtk_widget_ref (python_window_text);
  gtk_object_set_data_full (GTK_OBJECT (python_window), "python_window_text", python_window_text,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (python_window_text);
  gtk_container_add (GTK_CONTAINER (scrolledwindow4), python_window_text);

  python_window_entry = gtk_entry_new ();
  gtk_widget_ref (python_window_entry);
  gtk_object_set_data_full (GTK_OBJECT (python_window), "python_window_entry", python_window_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (python_window_entry);
  gtk_box_pack_start (GTK_BOX (vbox41), python_window_entry, FALSE, FALSE, 5);
  gtk_widget_set_usize (python_window_entry, 220, -2);

  return python_window;
}

GtkWidget*
create_find_ligand_dialog (void)
{
  GtkWidget *find_ligand_dialog;
  GtkWidget *dialog_vbox2;
  GtkWidget *vbox44;
  GtkWidget *vbox45;
  GtkWidget *label73;
  GtkWidget *frame35;
  GtkWidget *find_ligands_map_scrolledwindow;
  GtkWidget *viewport17;
  GtkWidget *find_ligand_map_vbox;
  GtkWidget *vbox46;
  GtkWidget *label74;
  GtkWidget *frame36;
  GtkWidget *find_ligands_coords_scrolledwindow;
  GtkWidget *viewport15;
  GtkWidget *find_ligand_protein_vbox;
  GtkWidget *frame108;
  GtkWidget *vbox112;
  GSList *mask_waters_group = NULL;
  GtkWidget *find_ligand_mask_waters_yes_radiobutton;
  GtkWidget *find_ligand_mask_waters_no_radiobutton;
  GtkWidget *vbox47;
  GtkWidget *label75;
  GtkWidget *frame37;
  GtkWidget *find_ligands_ligands_scrolledwindow;
  GtkWidget *viewport16;
  GtkWidget *find_ligand_ligands_vbox;
  GtkWidget *frame85;
  GtkWidget *hbox79;
  GtkWidget *find_ligand_sigma_level_entry;
  GtkWidget *label145;
  GtkWidget *ligand_expert_frame;
  GtkWidget *vbox166;
  GtkWidget *hbox131;
  GtkWidget *label261;
  GtkWidget *ligand_n_samples_entry;
  GtkWidget *hbox132;
  GtkWidget *label262;
  GtkWidget *ligand_n_top_ligands_entry;
  GtkWidget *dialog_action_area2;
  GtkWidget *hbox35;
  GtkWidget *hbox36;
  GtkWidget *find_ligand_ok_button;
  GtkWidget *button4;

  find_ligand_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (find_ligand_dialog), "find_ligand_dialog", find_ligand_dialog);
  gtk_widget_set_usize (find_ligand_dialog, 450, -2);
  gtk_container_set_border_width (GTK_CONTAINER (find_ligand_dialog), 2);
  gtk_window_set_title (GTK_WINDOW (find_ligand_dialog), _("Find Ligands"));
  gtk_window_set_policy (GTK_WINDOW (find_ligand_dialog), TRUE, TRUE, FALSE);

  dialog_vbox2 = GTK_DIALOG (find_ligand_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (find_ligand_dialog), "dialog_vbox2", dialog_vbox2);
  gtk_widget_show (dialog_vbox2);

  vbox44 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox44);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "vbox44", vbox44,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox44);
  gtk_box_pack_start (GTK_BOX (dialog_vbox2), vbox44, TRUE, TRUE, 0);

  vbox45 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox45);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "vbox45", vbox45,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox45);
  gtk_box_pack_start (GTK_BOX (vbox44), vbox45, FALSE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (vbox45), 5);

  label73 = gtk_label_new (_("Select Map:"));
  gtk_widget_ref (label73);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "label73", label73,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label73);
  gtk_box_pack_start (GTK_BOX (vbox45), label73, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label73), GTK_JUSTIFY_LEFT);
  gtk_misc_set_padding (GTK_MISC (label73), 5, 0);

  frame35 = gtk_frame_new (NULL);
  gtk_widget_ref (frame35);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "frame35", frame35,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame35);
  gtk_box_pack_start (GTK_BOX (vbox45), frame35, TRUE, TRUE, 0);

  find_ligands_map_scrolledwindow = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (find_ligands_map_scrolledwindow);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "find_ligands_map_scrolledwindow", find_ligands_map_scrolledwindow,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_ligands_map_scrolledwindow);
  gtk_container_add (GTK_CONTAINER (frame35), find_ligands_map_scrolledwindow);
  gtk_widget_set_usize (find_ligands_map_scrolledwindow, -2, 70);

  viewport17 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport17);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "viewport17", viewport17,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport17);
  gtk_container_add (GTK_CONTAINER (find_ligands_map_scrolledwindow), viewport17);

  find_ligand_map_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (find_ligand_map_vbox);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "find_ligand_map_vbox", find_ligand_map_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_ligand_map_vbox);
  gtk_container_add (GTK_CONTAINER (viewport17), find_ligand_map_vbox);

  vbox46 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox46);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "vbox46", vbox46,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox46);
  gtk_box_pack_start (GTK_BOX (vbox44), vbox46, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (vbox46), 5);

  label74 = gtk_label_new (_("Select Protein (Masks Map):"));
  gtk_widget_ref (label74);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "label74", label74,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label74);
  gtk_box_pack_start (GTK_BOX (vbox46), label74, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label74), 5, 0);

  frame36 = gtk_frame_new (NULL);
  gtk_widget_ref (frame36);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "frame36", frame36,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame36);
  gtk_box_pack_start (GTK_BOX (vbox46), frame36, TRUE, TRUE, 0);

  find_ligands_coords_scrolledwindow = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (find_ligands_coords_scrolledwindow);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "find_ligands_coords_scrolledwindow", find_ligands_coords_scrolledwindow,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_ligands_coords_scrolledwindow);
  gtk_container_add (GTK_CONTAINER (frame36), find_ligands_coords_scrolledwindow);
  gtk_widget_set_usize (find_ligands_coords_scrolledwindow, -2, 100);

  viewport15 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport15);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "viewport15", viewport15,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport15);
  gtk_container_add (GTK_CONTAINER (find_ligands_coords_scrolledwindow), viewport15);

  find_ligand_protein_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (find_ligand_protein_vbox);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "find_ligand_protein_vbox", find_ligand_protein_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_ligand_protein_vbox);
  gtk_container_add (GTK_CONTAINER (viewport15), find_ligand_protein_vbox);

  frame108 = gtk_frame_new (_("Mask Waters?"));
  gtk_widget_ref (frame108);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "frame108", frame108,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame108);
  gtk_box_pack_start (GTK_BOX (vbox44), frame108, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame108), 5);

  vbox112 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox112);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "vbox112", vbox112,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox112);
  gtk_container_add (GTK_CONTAINER (frame108), vbox112);

  find_ligand_mask_waters_yes_radiobutton = gtk_radio_button_new_with_label (mask_waters_group, _("Treat waters like protein (mask) atoms"));
  mask_waters_group = gtk_radio_button_group (GTK_RADIO_BUTTON (find_ligand_mask_waters_yes_radiobutton));
  gtk_widget_ref (find_ligand_mask_waters_yes_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "find_ligand_mask_waters_yes_radiobutton", find_ligand_mask_waters_yes_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_ligand_mask_waters_yes_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox112), find_ligand_mask_waters_yes_radiobutton, FALSE, FALSE, 0);

  find_ligand_mask_waters_no_radiobutton = gtk_radio_button_new_with_label (mask_waters_group, _("Ignore waters for mask"));
  mask_waters_group = gtk_radio_button_group (GTK_RADIO_BUTTON (find_ligand_mask_waters_no_radiobutton));
  gtk_widget_ref (find_ligand_mask_waters_no_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "find_ligand_mask_waters_no_radiobutton", find_ligand_mask_waters_no_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_ligand_mask_waters_no_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox112), find_ligand_mask_waters_no_radiobutton, FALSE, FALSE, 0);

  vbox47 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox47);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "vbox47", vbox47,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox47);
  gtk_box_pack_start (GTK_BOX (vbox44), vbox47, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (vbox47), 5);

  label75 = gtk_label_new (_("Select Ligands to Search for:"));
  gtk_widget_ref (label75);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "label75", label75,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label75);
  gtk_box_pack_start (GTK_BOX (vbox47), label75, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label75), 5, 0);

  frame37 = gtk_frame_new (NULL);
  gtk_widget_ref (frame37);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "frame37", frame37,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame37);
  gtk_box_pack_start (GTK_BOX (vbox47), frame37, TRUE, TRUE, 0);

  find_ligands_ligands_scrolledwindow = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (find_ligands_ligands_scrolledwindow);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "find_ligands_ligands_scrolledwindow", find_ligands_ligands_scrolledwindow,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_ligands_ligands_scrolledwindow);
  gtk_container_add (GTK_CONTAINER (frame37), find_ligands_ligands_scrolledwindow);
  gtk_widget_set_usize (find_ligands_ligands_scrolledwindow, -2, 100);

  viewport16 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport16);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "viewport16", viewport16,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport16);
  gtk_container_add (GTK_CONTAINER (find_ligands_ligands_scrolledwindow), viewport16);

  find_ligand_ligands_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (find_ligand_ligands_vbox);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "find_ligand_ligands_vbox", find_ligand_ligands_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_ligand_ligands_vbox);
  gtk_container_add (GTK_CONTAINER (viewport16), find_ligand_ligands_vbox);

  frame85 = gtk_frame_new (_("Sigma Level"));
  gtk_widget_ref (frame85);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "frame85", frame85,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame85);
  gtk_box_pack_start (GTK_BOX (vbox44), frame85, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame85), 5);

  hbox79 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox79);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "hbox79", hbox79,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox79);
  gtk_container_add (GTK_CONTAINER (frame85), hbox79);

  find_ligand_sigma_level_entry = gtk_entry_new ();
  gtk_widget_ref (find_ligand_sigma_level_entry);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "find_ligand_sigma_level_entry", find_ligand_sigma_level_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_ligand_sigma_level_entry);
  gtk_box_pack_start (GTK_BOX (hbox79), find_ligand_sigma_level_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (find_ligand_sigma_level_entry, 60, -2);

  label145 = gtk_label_new (_("  sigma  "));
  gtk_widget_ref (label145);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "label145", label145,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label145);
  gtk_box_pack_start (GTK_BOX (hbox79), label145, FALSE, FALSE, 0);

  ligand_expert_frame = gtk_frame_new (_("Expert Options"));
  gtk_widget_ref (ligand_expert_frame);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "ligand_expert_frame", ligand_expert_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ligand_expert_frame);
  gtk_box_pack_start (GTK_BOX (vbox44), ligand_expert_frame, TRUE, TRUE, 0);

  vbox166 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox166);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "vbox166", vbox166,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox166);
  gtk_container_add (GTK_CONTAINER (ligand_expert_frame), vbox166);

  hbox131 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox131);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "hbox131", hbox131,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox131);
  gtk_box_pack_start (GTK_BOX (vbox166), hbox131, TRUE, TRUE, 0);

  label261 = gtk_label_new (_("  Number of Conformers to Search:  "));
  gtk_widget_ref (label261);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "label261", label261,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label261);
  gtk_box_pack_start (GTK_BOX (hbox131), label261, FALSE, FALSE, 0);

  ligand_n_samples_entry = gtk_entry_new ();
  gtk_widget_ref (ligand_n_samples_entry);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "ligand_n_samples_entry", ligand_n_samples_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ligand_n_samples_entry);
  gtk_box_pack_start (GTK_BOX (hbox131), ligand_n_samples_entry, FALSE, FALSE, 0);
  gtk_widget_set_usize (ligand_n_samples_entry, 50, -2);

  hbox132 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox132);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "hbox132", hbox132,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox132);
  gtk_box_pack_start (GTK_BOX (vbox166), hbox132, TRUE, TRUE, 0);

  label262 = gtk_label_new (_("  Search Number of Top Sites:        "));
  gtk_widget_ref (label262);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "label262", label262,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label262);
  gtk_box_pack_start (GTK_BOX (hbox132), label262, FALSE, FALSE, 0);

  ligand_n_top_ligands_entry = gtk_entry_new ();
  gtk_widget_ref (ligand_n_top_ligands_entry);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "ligand_n_top_ligands_entry", ligand_n_top_ligands_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ligand_n_top_ligands_entry);
  gtk_box_pack_start (GTK_BOX (hbox132), ligand_n_top_ligands_entry, FALSE, FALSE, 0);
  gtk_widget_set_usize (ligand_n_top_ligands_entry, 51, -2);

  dialog_action_area2 = GTK_DIALOG (find_ligand_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (find_ligand_dialog), "dialog_action_area2", dialog_action_area2);
  gtk_widget_show (dialog_action_area2);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area2), 6);

  hbox35 = gtk_hbox_new (TRUE, 0);
  gtk_widget_ref (hbox35);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "hbox35", hbox35,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox35);
  gtk_box_pack_start (GTK_BOX (dialog_action_area2), hbox35, TRUE, TRUE, 0);

  hbox36 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox36);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "hbox36", hbox36,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox36);
  gtk_box_pack_start (GTK_BOX (hbox35), hbox36, TRUE, TRUE, 0);

  find_ligand_ok_button = gtk_button_new_with_label (_("Find 'em!"));
  gtk_widget_ref (find_ligand_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "find_ligand_ok_button", find_ligand_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_ligand_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox36), find_ligand_ok_button, TRUE, TRUE, 2);
  GTK_WIDGET_SET_FLAGS (find_ligand_ok_button, GTK_CAN_DEFAULT);

  button4 = gtk_button_new_with_label (_("Cancel"));
  gtk_widget_ref (button4);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_dialog), "button4", button4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (button4);
  gtk_box_pack_start (GTK_BOX (hbox36), button4, TRUE, TRUE, 2);
  GTK_WIDGET_SET_FLAGS (button4, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (find_ligand_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_find_ligand_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (button4), "clicked",
                      GTK_SIGNAL_FUNC (on_find_ligand_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (find_ligand_ok_button);
  gtk_widget_grab_default (find_ligand_ok_button);
  return find_ligand_dialog;
}

GtkWidget*
create_find_ligand_many_atoms_dialog (void)
{
  GtkWidget *find_ligand_many_atoms_dialog;
  GtkWidget *dialog_vbox3;
  GtkWidget *frame38;
  GtkWidget *label76;
  GtkWidget *dialog_action_area3;
  GtkWidget *hbox37;
  GtkWidget *find_ligand_many_atoms_continue_button;
  GtkWidget *find_ligand_many_atoms_cancel_button;

  find_ligand_many_atoms_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (find_ligand_many_atoms_dialog), "find_ligand_many_atoms_dialog", find_ligand_many_atoms_dialog);
  gtk_window_set_title (GTK_WINDOW (find_ligand_many_atoms_dialog), _("May Atoms in Ligand Check"));
  gtk_window_set_policy (GTK_WINDOW (find_ligand_many_atoms_dialog), TRUE, TRUE, FALSE);

  dialog_vbox3 = GTK_DIALOG (find_ligand_many_atoms_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (find_ligand_many_atoms_dialog), "dialog_vbox3", dialog_vbox3);
  gtk_widget_show (dialog_vbox3);

  frame38 = gtk_frame_new (NULL);
  gtk_widget_ref (frame38);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_many_atoms_dialog), "frame38", frame38,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame38);
  gtk_box_pack_start (GTK_BOX (dialog_vbox3), frame38, FALSE, FALSE, 5);
  gtk_container_set_border_width (GTK_CONTAINER (frame38), 6);

  label76 = gtk_label_new (_("\nOne or more of the selected ligands has \nunexpectedly many atoms.\n\nThis is an opportunity for you to reflect on that...\n\nDo you want to continue?\n"));
  gtk_widget_ref (label76);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_many_atoms_dialog), "label76", label76,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label76);
  gtk_container_add (GTK_CONTAINER (frame38), label76);

  dialog_action_area3 = GTK_DIALOG (find_ligand_many_atoms_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (find_ligand_many_atoms_dialog), "dialog_action_area3", dialog_action_area3);
  gtk_widget_show (dialog_action_area3);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area3), 10);

  hbox37 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox37);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_many_atoms_dialog), "hbox37", hbox37,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox37);
  gtk_box_pack_start (GTK_BOX (dialog_action_area3), hbox37, TRUE, TRUE, 0);

  find_ligand_many_atoms_continue_button = gtk_button_new_with_label (_("Continue"));
  gtk_widget_ref (find_ligand_many_atoms_continue_button);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_many_atoms_dialog), "find_ligand_many_atoms_continue_button", find_ligand_many_atoms_continue_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_ligand_many_atoms_continue_button);
  gtk_box_pack_start (GTK_BOX (hbox37), find_ligand_many_atoms_continue_button, TRUE, TRUE, 6);
  gtk_container_set_border_width (GTK_CONTAINER (find_ligand_many_atoms_continue_button), 2);

  find_ligand_many_atoms_cancel_button = gtk_button_new_with_label (_("Cancel"));
  gtk_widget_ref (find_ligand_many_atoms_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (find_ligand_many_atoms_dialog), "find_ligand_many_atoms_cancel_button", find_ligand_many_atoms_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_ligand_many_atoms_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox37), find_ligand_many_atoms_cancel_button, TRUE, TRUE, 6);
  gtk_container_set_border_width (GTK_CONTAINER (find_ligand_many_atoms_cancel_button), 2);

  gtk_signal_connect (GTK_OBJECT (find_ligand_many_atoms_continue_button), "clicked",
                      GTK_SIGNAL_FUNC (on_find_ligand_many_atoms_continue_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (find_ligand_many_atoms_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_find_ligand_many_atoms_cancel_button_clicked),
                      NULL);

  return find_ligand_many_atoms_dialog;
}

GtkWidget*
create_model_refine_dialog (void)
{
  GtkWidget *model_refine_dialog;
  GtkWidget *model_fit_refine_dialog_vbox;
  GtkWidget *frame39;
  GtkWidget *model_fit_refine_vbox;
  GtkWidget *model_refine_dialog_refine_params_button;
  GtkWidget *model_refine_dialog_map_select_button;
  GtkWidget *hseparator5;
  GtkWidget *model_refine_dialog_refine_togglebutton;
  GtkWidget *model_refine_dialog_regularize_zone_togglebutton;
  GtkWidget *model_refine_dialog_rigid_body_togglebutton;
  GtkWidget *model_refine_dialog_rot_trans_togglebutton;
  GtkWidget *model_refine_dialog_auto_fit_rotamer_togglebutton;
  GtkWidget *model_refine_dialog_rotamer_togglebutton;
  GtkWidget *model_refine_dialog_edit_chi_angles_togglebutton;
  GtkWidget *model_refine_dialog_pepflip_togglebutton;
  GtkWidget *model_refine_dialog_do_180_degree_sidechain_flip_togglebutton;
  GtkWidget *model_refine_dialog_edit_phi_psi_togglebutton;
  GtkWidget *model_refine_dialog_edit_backbone_torsions_togglebutton;
  GtkWidget *hseparator6;
  GtkWidget *model_refine_dialog_mutate_auto_fit_togglebutton;
  GtkWidget *model_refine_dialog_mutate_togglebutton;
  GtkWidget *model_refine_dialog_find_waters_button;
  GtkWidget *model_refine_dialog_fit_terminal_residue_togglebutton;
  GtkWidget *model_refine_dialog_add_alt_conf_button;
  GtkWidget *model_refine_dialog_pointer_atom_button;
  GtkWidget *hseparator8;
  GtkWidget *model_refine_dialog_clear_pending_button;
  GtkWidget *model_refine_dialog_delete_button;
  GtkWidget *model_refine_dialog_undo_button;
  GtkWidget *model_refine_dialog_redo_button;
  GtkWidget *hseparator7;
  GtkWidget *model_refine_dialog_refmac_button;
  GtkWidget *dialog_action_area4;
  GtkWidget *model_refine_dialog_dismiss_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  model_refine_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (model_refine_dialog), "model_refine_dialog", model_refine_dialog);
  gtk_window_set_title (GTK_WINDOW (model_refine_dialog), _("Model/Fit/Refine"));
  gtk_window_set_policy (GTK_WINDOW (model_refine_dialog), TRUE, FALSE, TRUE);

  model_fit_refine_dialog_vbox = GTK_DIALOG (model_refine_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (model_refine_dialog), "model_fit_refine_dialog_vbox", model_fit_refine_dialog_vbox);
  gtk_widget_show (model_fit_refine_dialog_vbox);

  frame39 = gtk_frame_new (NULL);
  gtk_widget_ref (frame39);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "frame39", frame39,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame39);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_dialog_vbox), frame39, FALSE, FALSE, 0);

  model_fit_refine_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (model_fit_refine_vbox);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_fit_refine_vbox", model_fit_refine_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_fit_refine_vbox);
  gtk_container_add (GTK_CONTAINER (frame39), model_fit_refine_vbox);
  gtk_container_set_border_width (GTK_CONTAINER (model_fit_refine_vbox), 6);

  model_refine_dialog_refine_params_button = gtk_button_new_with_label (_("  Refine/Regularize Control...  "));
  gtk_widget_ref (model_refine_dialog_refine_params_button);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_refine_params_button", model_refine_dialog_refine_params_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_refine_params_button);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_refine_params_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_refine_params_button), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_refine_params_button, _("Set Parameters for fitting, refinement, regularization, etc."), NULL);

  model_refine_dialog_map_select_button = gtk_button_new_with_label (_(" Select Map..."));
  gtk_widget_ref (model_refine_dialog_map_select_button);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_map_select_button", model_refine_dialog_map_select_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_map_select_button);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_map_select_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_map_select_button), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_map_select_button, _("Select the map that will be used for refinement, rigid body refinement, terminal residue fit and autofitting"), NULL);

  hseparator5 = gtk_hseparator_new ();
  gtk_widget_ref (hseparator5);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "hseparator5", hseparator5,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hseparator5);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), hseparator5, FALSE, FALSE, 3);

  model_refine_dialog_refine_togglebutton = gtk_toggle_button_new_with_label (_("Real Space Refine Zone"));
  gtk_widget_ref (model_refine_dialog_refine_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_refine_togglebutton", model_refine_dialog_refine_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_refine_togglebutton);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_refine_togglebutton, FALSE, FALSE, 0);
  gtk_widget_set_usize (model_refine_dialog_refine_togglebutton, -2, 30);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_refine_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_refine_togglebutton, _("Real Space Refinement: Improve geometry and fit to map"), NULL);

  model_refine_dialog_regularize_zone_togglebutton = gtk_toggle_button_new_with_label (_("Regularize Zone"));
  gtk_widget_ref (model_refine_dialog_regularize_zone_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_regularize_zone_togglebutton", model_refine_dialog_regularize_zone_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_regularize_zone_togglebutton);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_regularize_zone_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_regularize_zone_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_regularize_zone_togglebutton, _("Idealize model geometry"), NULL);

  model_refine_dialog_rigid_body_togglebutton = gtk_toggle_button_new_with_label (_("Rigid Body Fit Zone"));
  gtk_widget_ref (model_refine_dialog_rigid_body_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_rigid_body_togglebutton", model_refine_dialog_rigid_body_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_rigid_body_togglebutton);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_rigid_body_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_rigid_body_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_rigid_body_togglebutton, _("Rearrange to find the name of a popular health club"), NULL);

  model_refine_dialog_rot_trans_togglebutton = gtk_toggle_button_new_with_label (_("Rotate/Translate Zone"));
  gtk_widget_ref (model_refine_dialog_rot_trans_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_rot_trans_togglebutton", model_refine_dialog_rot_trans_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_rot_trans_togglebutton);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_rot_trans_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_rot_trans_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_rot_trans_togglebutton, _("Click and Drag across the rotation/translation buttons.  Use Ctrl-click to move a single atom [but make sure that you have graphics window focus!]"), NULL);

  model_refine_dialog_auto_fit_rotamer_togglebutton = gtk_toggle_button_new_with_label (_("Auto Fit Rotamer"));
  gtk_widget_ref (model_refine_dialog_auto_fit_rotamer_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_auto_fit_rotamer_togglebutton", model_refine_dialog_auto_fit_rotamer_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_auto_fit_rotamer_togglebutton);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_auto_fit_rotamer_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_auto_fit_rotamer_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_auto_fit_rotamer_togglebutton, _("Click on an atom in a residue to find the best fit rotamer"), NULL);

  model_refine_dialog_rotamer_togglebutton = gtk_toggle_button_new_with_label (_("Rotamers..."));
  gtk_widget_ref (model_refine_dialog_rotamer_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_rotamer_togglebutton", model_refine_dialog_rotamer_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_rotamer_togglebutton);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_rotamer_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_rotamer_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_rotamer_togglebutton, _("Select Different Conformations for a Residue Sidechan"), NULL);

  model_refine_dialog_edit_chi_angles_togglebutton = gtk_toggle_button_new_with_label (_("Edit Chi Angles"));
  gtk_widget_ref (model_refine_dialog_edit_chi_angles_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_edit_chi_angles_togglebutton", model_refine_dialog_edit_chi_angles_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_edit_chi_angles_togglebutton);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_edit_chi_angles_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_edit_chi_angles_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_edit_chi_angles_togglebutton, _("Edit the Chi angles (torsions) of an amino acid residue \"by hand\"  (by mouse, that is)"), NULL);

  model_refine_dialog_pepflip_togglebutton = gtk_toggle_button_new_with_label (_("Flip Peptide "));
  gtk_widget_ref (model_refine_dialog_pepflip_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_pepflip_togglebutton", model_refine_dialog_pepflip_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_pepflip_togglebutton);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_pepflip_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_pepflip_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_pepflip_togglebutton, _("Peptide flip"), NULL);

  model_refine_dialog_do_180_degree_sidechain_flip_togglebutton = gtk_toggle_button_new_with_label (_("Sidechain180 Degree Flip"));
  gtk_widget_ref (model_refine_dialog_do_180_degree_sidechain_flip_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_do_180_degree_sidechain_flip_togglebutton", model_refine_dialog_do_180_degree_sidechain_flip_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_do_180_degree_sidechain_flip_togglebutton);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_do_180_degree_sidechain_flip_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_do_180_degree_sidechain_flip_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_do_180_degree_sidechain_flip_togglebutton, _("Flip the last chi angle of the sidechain by 180 degrees"), NULL);

  model_refine_dialog_edit_phi_psi_togglebutton = gtk_toggle_button_new_with_label (_("Edit Phi/Psi..."));
  gtk_widget_ref (model_refine_dialog_edit_phi_psi_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_edit_phi_psi_togglebutton", model_refine_dialog_edit_phi_psi_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_edit_phi_psi_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_edit_phi_psi_togglebutton), 1);

  model_refine_dialog_edit_backbone_torsions_togglebutton = gtk_toggle_button_new_with_label (_(" Edit Backbone Torsions"));
  gtk_widget_ref (model_refine_dialog_edit_backbone_torsions_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_edit_backbone_torsions_togglebutton", model_refine_dialog_edit_backbone_torsions_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_edit_backbone_torsions_togglebutton);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_edit_backbone_torsions_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_edit_backbone_torsions_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_edit_backbone_torsions_togglebutton, _("Change Residue's Phi and Psi"), NULL);

  hseparator6 = gtk_hseparator_new ();
  gtk_widget_ref (hseparator6);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "hseparator6", hseparator6,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hseparator6);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), hseparator6, FALSE, FALSE, 3);

  model_refine_dialog_mutate_auto_fit_togglebutton = gtk_toggle_button_new_with_label (_("Mutate & Auto Fit..."));
  gtk_widget_ref (model_refine_dialog_mutate_auto_fit_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_mutate_auto_fit_togglebutton", model_refine_dialog_mutate_auto_fit_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_mutate_auto_fit_togglebutton);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_mutate_auto_fit_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_mutate_auto_fit_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_mutate_auto_fit_togglebutton, _("Where \"Fit\" means fit to the Selected Map"), NULL);

  model_refine_dialog_mutate_togglebutton = gtk_toggle_button_new_with_label (_("Simple Mutate..."));
  gtk_widget_ref (model_refine_dialog_mutate_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_mutate_togglebutton", model_refine_dialog_mutate_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_mutate_togglebutton);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_mutate_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_mutate_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_mutate_togglebutton, _("Mutate amino acid residues or nucleotides [no crystallographic map fitting is happens]"), NULL);

  model_refine_dialog_find_waters_button = gtk_button_new_with_label (_("Find Waters..."));
  gtk_widget_ref (model_refine_dialog_find_waters_button);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_find_waters_button", model_refine_dialog_find_waters_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_find_waters_button);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_find_waters_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_find_waters_button), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_find_waters_button, _("Solvate..."), NULL);

  model_refine_dialog_fit_terminal_residue_togglebutton = gtk_toggle_button_new_with_label (_("Add Terminal Residue..."));
  gtk_widget_ref (model_refine_dialog_fit_terminal_residue_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_fit_terminal_residue_togglebutton", model_refine_dialog_fit_terminal_residue_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_fit_terminal_residue_togglebutton);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_fit_terminal_residue_togglebutton, FALSE, FALSE, 0);
  gtk_widget_set_usize (model_refine_dialog_fit_terminal_residue_togglebutton, -2, 30);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_fit_terminal_residue_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_fit_terminal_residue_togglebutton, _("[You need a map to do this] Create a new residue at the C or N terminus. The angles are selected at random sample from the phi/psi probability distribution (then fitted to the map), so if at first you don't succeed, give it another bash..."), NULL);

  model_refine_dialog_add_alt_conf_button = gtk_button_new_with_label (_("Add Alt Conf..."));
  gtk_widget_ref (model_refine_dialog_add_alt_conf_button);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_add_alt_conf_button", model_refine_dialog_add_alt_conf_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_add_alt_conf_button);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_add_alt_conf_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_add_alt_conf_button), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_add_alt_conf_button, _("Add Alternate (Alternative) Conformation to a Residue"), NULL);

  model_refine_dialog_pointer_atom_button = gtk_button_new_with_label (_("Place Atom At Pointer"));
  gtk_widget_ref (model_refine_dialog_pointer_atom_button);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_pointer_atom_button", model_refine_dialog_pointer_atom_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_pointer_atom_button);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_pointer_atom_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_pointer_atom_button), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_pointer_atom_button, _("Put an atom at current pink pointer position"), NULL);

  hseparator8 = gtk_hseparator_new ();
  gtk_widget_ref (hseparator8);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "hseparator8", hseparator8,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hseparator8);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), hseparator8, TRUE, TRUE, 3);

  model_refine_dialog_clear_pending_button = gtk_button_new_with_label (_("Clear Pending Picks"));
  gtk_widget_ref (model_refine_dialog_clear_pending_button);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_clear_pending_button", model_refine_dialog_clear_pending_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_clear_pending_button);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_clear_pending_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_clear_pending_button), 1);

  model_refine_dialog_delete_button = gtk_button_new_with_label (_("Delete..."));
  gtk_widget_ref (model_refine_dialog_delete_button);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_delete_button", model_refine_dialog_delete_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_delete_button);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_delete_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_delete_button), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_delete_button, _("Delete Residue or Atom"), NULL);

  model_refine_dialog_undo_button = gtk_button_new_with_label (_("  Undo  "));
  gtk_widget_ref (model_refine_dialog_undo_button);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_undo_button", model_refine_dialog_undo_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_undo_button);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_undo_button, FALSE, FALSE, 0);
  gtk_widget_set_usize (model_refine_dialog_undo_button, -2, 30);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_undo_button), 1);

  model_refine_dialog_redo_button = gtk_button_new_with_label (_("  Redo  "));
  gtk_widget_ref (model_refine_dialog_redo_button);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_redo_button", model_refine_dialog_redo_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_redo_button);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_redo_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_redo_button), 1);
  gtk_widget_set_sensitive (model_refine_dialog_redo_button, FALSE);

  hseparator7 = gtk_hseparator_new ();
  gtk_widget_ref (hseparator7);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "hseparator7", hseparator7,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hseparator7);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), hseparator7, FALSE, FALSE, 3);

  model_refine_dialog_refmac_button = gtk_button_new_with_label (_("Run Refmac..."));
  gtk_widget_ref (model_refine_dialog_refmac_button);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_refmac_button", model_refine_dialog_refmac_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_refmac_button);
  gtk_box_pack_start (GTK_BOX (model_fit_refine_vbox), model_refine_dialog_refmac_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_refmac_button), 1);

  dialog_action_area4 = GTK_DIALOG (model_refine_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (model_refine_dialog), "dialog_action_area4", dialog_action_area4);
  gtk_widget_show (dialog_action_area4);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area4), 10);

  model_refine_dialog_dismiss_button = gtk_button_new_with_label (_("   Close   "));
  gtk_widget_ref (model_refine_dialog_dismiss_button);
  gtk_object_set_data_full (GTK_OBJECT (model_refine_dialog), "model_refine_dialog_dismiss_button", model_refine_dialog_dismiss_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_dismiss_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area4), model_refine_dialog_dismiss_button, FALSE, FALSE, 0);
  GTK_WIDGET_SET_FLAGS (model_refine_dialog_dismiss_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (model_refine_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog), "configure_event",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_configure_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_refine_params_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_refine_params_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_map_select_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_map_select_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_refine_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_refine_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_regularize_zone_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_regularize_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_rigid_body_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_rigid_body_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_rot_trans_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_rot_trans_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_auto_fit_rotamer_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_auto_fit_rotamer_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_rotamer_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_rotamer_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_edit_chi_angles_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_edit_chi_angles_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_pepflip_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_pepflip_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_do_180_degree_sidechain_flip_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_do_180_degree_sidechain_flip_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_do_180_degree_sidechain_flip_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_do_180_degree_sidechain_flip_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_edit_phi_psi_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_edit_phi_psi_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_edit_backbone_torsions_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_edit_backbone_torsions_button_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_mutate_auto_fit_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_mutate_auto_fit_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_mutate_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_mutate_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_find_waters_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_find_waters_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_fit_terminal_residue_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_fit_terminal_residue_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_add_alt_conf_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_add_alt_conf_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_pointer_atom_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_pointer_atom_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_clear_pending_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_clear_pending_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_delete_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_delete_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_undo_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_undo_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_redo_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_redo_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_refmac_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_refmac_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_dismiss_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_dismiss_button_clicked),
                      NULL);

  gtk_widget_grab_focus (model_refine_dialog_dismiss_button);
  gtk_widget_grab_default (model_refine_dialog_dismiss_button);
  gtk_object_set_data (GTK_OBJECT (model_refine_dialog), "tooltips", tooltips);

  return model_refine_dialog;
}

GtkWidget*
create_rotate_translate_obj_dialog (void)
{
  GtkWidget *rotate_translate_obj_dialog;
  GtkWidget *dialog_vbox6;
  GtkWidget *frame40;
  GtkWidget *vbox49;
  GtkWidget *frame90;
  GtkWidget *rotate_translate_obj_xtrans_hscale;
  GtkWidget *frame91;
  GtkWidget *rotate_translate_obj_ytrans_hscale;
  GtkWidget *frame92;
  GtkWidget *rotate_translate_obj_ztrans_hscale;
  GtkWidget *frame93;
  GtkWidget *rotate_translate_obj_xrot_hscale;
  GtkWidget *frame94;
  GtkWidget *rotate_translate_obj_yrot_hscale;
  GtkWidget *frame95;
  GtkWidget *rotate_translate_obj_zrot_hscale;
  GtkWidget *dialog_action_area6;
  GtkWidget *hbox40;
  GtkWidget *rotate_translate_obj_ok_button;
  GtkWidget *rotate_translate_obj_cancel_button;

  rotate_translate_obj_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (rotate_translate_obj_dialog), "rotate_translate_obj_dialog", rotate_translate_obj_dialog);
  gtk_window_set_title (GTK_WINDOW (rotate_translate_obj_dialog), _("Rotation & Translation"));
  gtk_window_set_policy (GTK_WINDOW (rotate_translate_obj_dialog), TRUE, TRUE, FALSE);

  dialog_vbox6 = GTK_DIALOG (rotate_translate_obj_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (rotate_translate_obj_dialog), "dialog_vbox6", dialog_vbox6);
  gtk_widget_show (dialog_vbox6);

  frame40 = gtk_frame_new (NULL);
  gtk_widget_ref (frame40);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "frame40", frame40,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame40);
  gtk_box_pack_start (GTK_BOX (dialog_vbox6), frame40, TRUE, TRUE, 0);
  gtk_widget_set_usize (frame40, 170, -2);
  gtk_container_set_border_width (GTK_CONTAINER (frame40), 6);

  vbox49 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox49);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "vbox49", vbox49,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox49);
  gtk_container_add (GTK_CONTAINER (frame40), vbox49);

  frame90 = gtk_frame_new (_("X translation"));
  gtk_widget_ref (frame90);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "frame90", frame90,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame90);
  gtk_box_pack_start (GTK_BOX (vbox49), frame90, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame90), 2);

  rotate_translate_obj_xtrans_hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (rotate_translate_obj_xtrans_hscale);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "rotate_translate_obj_xtrans_hscale", rotate_translate_obj_xtrans_hscale,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotate_translate_obj_xtrans_hscale);
  gtk_container_add (GTK_CONTAINER (frame90), rotate_translate_obj_xtrans_hscale);

  frame91 = gtk_frame_new (_("Y translation"));
  gtk_widget_ref (frame91);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "frame91", frame91,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame91);
  gtk_box_pack_start (GTK_BOX (vbox49), frame91, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame91), 2);

  rotate_translate_obj_ytrans_hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (rotate_translate_obj_ytrans_hscale);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "rotate_translate_obj_ytrans_hscale", rotate_translate_obj_ytrans_hscale,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotate_translate_obj_ytrans_hscale);
  gtk_container_add (GTK_CONTAINER (frame91), rotate_translate_obj_ytrans_hscale);

  frame92 = gtk_frame_new (_("Z translation"));
  gtk_widget_ref (frame92);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "frame92", frame92,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame92);
  gtk_box_pack_start (GTK_BOX (vbox49), frame92, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame92), 2);

  rotate_translate_obj_ztrans_hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (rotate_translate_obj_ztrans_hscale);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "rotate_translate_obj_ztrans_hscale", rotate_translate_obj_ztrans_hscale,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotate_translate_obj_ztrans_hscale);
  gtk_container_add (GTK_CONTAINER (frame92), rotate_translate_obj_ztrans_hscale);

  frame93 = gtk_frame_new (_("X rotate"));
  gtk_widget_ref (frame93);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "frame93", frame93,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame93);
  gtk_box_pack_start (GTK_BOX (vbox49), frame93, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame93), 2);

  rotate_translate_obj_xrot_hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (rotate_translate_obj_xrot_hscale);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "rotate_translate_obj_xrot_hscale", rotate_translate_obj_xrot_hscale,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotate_translate_obj_xrot_hscale);
  gtk_container_add (GTK_CONTAINER (frame93), rotate_translate_obj_xrot_hscale);

  frame94 = gtk_frame_new (_("Y rotate"));
  gtk_widget_ref (frame94);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "frame94", frame94,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame94);
  gtk_box_pack_start (GTK_BOX (vbox49), frame94, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame94), 2);

  rotate_translate_obj_yrot_hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (rotate_translate_obj_yrot_hscale);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "rotate_translate_obj_yrot_hscale", rotate_translate_obj_yrot_hscale,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotate_translate_obj_yrot_hscale);
  gtk_container_add (GTK_CONTAINER (frame94), rotate_translate_obj_yrot_hscale);

  frame95 = gtk_frame_new (_("Z rotate"));
  gtk_widget_ref (frame95);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "frame95", frame95,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame95);
  gtk_box_pack_start (GTK_BOX (vbox49), frame95, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame95), 2);

  rotate_translate_obj_zrot_hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (rotate_translate_obj_zrot_hscale);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "rotate_translate_obj_zrot_hscale", rotate_translate_obj_zrot_hscale,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotate_translate_obj_zrot_hscale);
  gtk_container_add (GTK_CONTAINER (frame95), rotate_translate_obj_zrot_hscale);

  dialog_action_area6 = GTK_DIALOG (rotate_translate_obj_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (rotate_translate_obj_dialog), "dialog_action_area6", dialog_action_area6);
  gtk_widget_show (dialog_action_area6);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area6), 10);

  hbox40 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox40);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "hbox40", hbox40,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox40);
  gtk_box_pack_start (GTK_BOX (dialog_action_area6), hbox40, TRUE, TRUE, 0);

  rotate_translate_obj_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (rotate_translate_obj_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "rotate_translate_obj_ok_button", rotate_translate_obj_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotate_translate_obj_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox40), rotate_translate_obj_ok_button, TRUE, TRUE, 2);
  gtk_container_set_border_width (GTK_CONTAINER (rotate_translate_obj_ok_button), 2);
  GTK_WIDGET_SET_FLAGS (rotate_translate_obj_ok_button, GTK_CAN_DEFAULT);

  rotate_translate_obj_cancel_button = gtk_button_new_with_label (_("  Cancel "));
  gtk_widget_ref (rotate_translate_obj_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (rotate_translate_obj_dialog), "rotate_translate_obj_cancel_button", rotate_translate_obj_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotate_translate_obj_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox40), rotate_translate_obj_cancel_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (rotate_translate_obj_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (rotate_translate_obj_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_rotate_translate_obj_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (rotate_translate_obj_dialog), "configure_event",
                      GTK_SIGNAL_FUNC (on_rotate_translate_obj_dialog_configure_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (rotate_translate_obj_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_rotate_translate_obj_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (rotate_translate_obj_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_rotate_translate_obj_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (rotate_translate_obj_ok_button);
  gtk_widget_grab_default (rotate_translate_obj_ok_button);
  return rotate_translate_obj_dialog;
}

GtkWidget*
create_save_coords_dialog (void)
{
  GtkWidget *save_coords_dialog;
  GtkWidget *dialog_vbox7;
  GtkWidget *frame41;
  GtkWidget *vbox50;
  GtkWidget *label78;
  GtkWidget *save_coords_optionmenu;
  GtkWidget *save_coords_optionmenu_menu;
  GtkWidget *dialog_action_area7;
  GtkWidget *save_coords_dialog_save_button;

  save_coords_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (save_coords_dialog), "save_coords_dialog", save_coords_dialog);
  gtk_window_set_title (GTK_WINDOW (save_coords_dialog), _("Save Coordinates Molecule Selector"));
  gtk_window_set_policy (GTK_WINDOW (save_coords_dialog), TRUE, TRUE, FALSE);

  dialog_vbox7 = GTK_DIALOG (save_coords_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (save_coords_dialog), "dialog_vbox7", dialog_vbox7);
  gtk_widget_show (dialog_vbox7);

  frame41 = gtk_frame_new (NULL);
  gtk_widget_ref (frame41);
  gtk_object_set_data_full (GTK_OBJECT (save_coords_dialog), "frame41", frame41,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame41);
  gtk_box_pack_start (GTK_BOX (dialog_vbox7), frame41, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame41), 6);

  vbox50 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox50);
  gtk_object_set_data_full (GTK_OBJECT (save_coords_dialog), "vbox50", vbox50,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox50);
  gtk_container_add (GTK_CONTAINER (frame41), vbox50);

  label78 = gtk_label_new (_("Select Molecule Number to Save:"));
  gtk_widget_ref (label78);
  gtk_object_set_data_full (GTK_OBJECT (save_coords_dialog), "label78", label78,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label78);
  gtk_box_pack_start (GTK_BOX (vbox50), label78, FALSE, FALSE, 3);
  gtk_misc_set_padding (GTK_MISC (label78), 60, 9);

  save_coords_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (save_coords_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (save_coords_dialog), "save_coords_optionmenu", save_coords_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (save_coords_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox50), save_coords_optionmenu, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (save_coords_optionmenu), 1);
  save_coords_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (save_coords_optionmenu), save_coords_optionmenu_menu);

  dialog_action_area7 = GTK_DIALOG (save_coords_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (save_coords_dialog), "dialog_action_area7", dialog_action_area7);
  gtk_widget_show (dialog_action_area7);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area7), 10);

  save_coords_dialog_save_button = gtk_button_new_with_label (_("  Select Filename...  "));
  gtk_widget_ref (save_coords_dialog_save_button);
  gtk_object_set_data_full (GTK_OBJECT (save_coords_dialog), "save_coords_dialog_save_button", save_coords_dialog_save_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (save_coords_dialog_save_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area7), save_coords_dialog_save_button, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (save_coords_dialog_save_button), 6);
  GTK_WIDGET_SET_FLAGS (save_coords_dialog_save_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (save_coords_dialog_save_button), "clicked",
                      GTK_SIGNAL_FUNC (on_save_coords_dialog_save_button_clicked),
                      NULL);

  gtk_widget_grab_default (save_coords_dialog_save_button);
  return save_coords_dialog;
}

GtkWidget*
create_save_coords_fileselection1 (void)
{
  GtkWidget *save_coords_fileselection1;
  GtkWidget *save_coord_ok_button;
  GtkWidget *save_coords_cancel_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  save_coords_fileselection1 = gtk_file_selection_new (_("Select Filename for Saved Coordinates "));
  gtk_object_set_data (GTK_OBJECT (save_coords_fileselection1), "save_coords_fileselection1", save_coords_fileselection1);
  gtk_container_set_border_width (GTK_CONTAINER (save_coords_fileselection1), 10);
  gtk_tooltips_set_tip (tooltips, save_coords_fileselection1, _("Saved File type: By extension"), NULL);

  save_coord_ok_button = GTK_FILE_SELECTION (save_coords_fileselection1)->ok_button;
  gtk_object_set_data (GTK_OBJECT (save_coords_fileselection1), "save_coord_ok_button", save_coord_ok_button);
  gtk_widget_show (save_coord_ok_button);
  GTK_WIDGET_SET_FLAGS (save_coord_ok_button, GTK_CAN_DEFAULT);

  save_coords_cancel_button = GTK_FILE_SELECTION (save_coords_fileselection1)->cancel_button;
  gtk_object_set_data (GTK_OBJECT (save_coords_fileselection1), "save_coords_cancel_button", save_coords_cancel_button);
  gtk_widget_show (save_coords_cancel_button);
  GTK_WIDGET_SET_FLAGS (save_coords_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (save_coords_fileselection1), "destroy",
                      GTK_SIGNAL_FUNC (on_save_coords_fileselection1_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (save_coord_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_save_coord_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (save_coords_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_save_coords_cancel_button_clicked),
                      NULL);

  gtk_object_set_data (GTK_OBJECT (save_coords_fileselection1), "tooltips", tooltips);

  return save_coords_fileselection1;
}

GtkWidget*
create_refine_params_dialog (void)
{
  GtkWidget *refine_params_dialog;
  GtkWidget *dialog_vbox8;
  GtkWidget *frame42;
  GtkWidget *vbox51;
  GtkWidget *vbox52;
  GtkWidget *label281;
  GtkWidget *label79;
  GtkWidget *vbox60;
  GtkWidget *refine_params_use_torsions_checkbutton;
  GtkWidget *phi_psi_restraints_vbox;
  GtkWidget *hbox140;
  GtkWidget *label279;
  GtkWidget *refine_params_use_peptide_torsions_checkbutton;
  GtkWidget *peptide_torsions_restraints_vbox;
  GtkWidget *hbox137;
  GtkWidget *label276;
  GSList *link_torsion_restraints_group = NULL;
  GtkWidget *refine_params_use_helix_peptide_torsions_radiobutton;
  GtkWidget *hbox138;
  GtkWidget *label277;
  GtkWidget *refine_params_use_beta_strand_peptide_torsions_radiobutton;
  GtkWidget *hbox139;
  GtkWidget *label278;
  GtkWidget *refine_params_use_ramachandran_goodness_torsions_radiobutton;
  GtkWidget *hbox141;
  GtkWidget *label280;
  GtkWidget *refine_params_use_peptide_omegas_checkbutton;
  GtkWidget *refine_params_use_initial_pos_checkbutton;
  GtkWidget *frame174;
  GtkWidget *sec_struct_restraints_vbox;
  GSList *ss_rest_gr_group = NULL;
  GtkWidget *sec_str_rest_no_rest_radiobutton;
  GtkWidget *sec_str_rest_helix_rest_radiobutton;
  GtkWidget *sec_str_rest_strand_rest_radiobutton;
  GtkWidget *dialog_action_area8;
  GtkWidget *refine_params_dialog_ok_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  refine_params_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (refine_params_dialog), "refine_params_dialog", refine_params_dialog);
  gtk_window_set_title (GTK_WINDOW (refine_params_dialog), _("Refinement and Regularization Parameters"));
  gtk_window_set_policy (GTK_WINDOW (refine_params_dialog), TRUE, TRUE, FALSE);

  dialog_vbox8 = GTK_DIALOG (refine_params_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (refine_params_dialog), "dialog_vbox8", dialog_vbox8);
  gtk_widget_show (dialog_vbox8);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_vbox8), 6);

  frame42 = gtk_frame_new (NULL);
  gtk_widget_ref (frame42);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "frame42", frame42,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame42);
  gtk_box_pack_start (GTK_BOX (dialog_vbox8), frame42, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame42), 2);

  vbox51 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox51);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "vbox51", vbox51,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox51);
  gtk_container_add (GTK_CONTAINER (frame42), vbox51);

  vbox52 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox52);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "vbox52", vbox52,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox52);
  gtk_box_pack_start (GTK_BOX (vbox51), vbox52, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (vbox52), 5);

  label281 = gtk_label_new (_("\n  LINK TORSION RESTRAINTS \n  CURRENTLY DON'T WORK!   \n"));
  gtk_widget_ref (label281);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "label281", label281,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (vbox52), label281, FALSE, FALSE, 0);

  label79 = gtk_label_new (_("For Regularization and Refinement:"));
  gtk_widget_ref (label79);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "label79", label79,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label79);
  gtk_box_pack_start (GTK_BOX (vbox52), label79, FALSE, FALSE, 4);
  gtk_label_set_justify (GTK_LABEL (label79), GTK_JUSTIFY_LEFT);
  gtk_misc_set_alignment (GTK_MISC (label79), 0, 0.5);

  vbox60 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox60);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "vbox60", vbox60,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox60);
  gtk_box_pack_start (GTK_BOX (vbox52), vbox60, FALSE, FALSE, 0);

  refine_params_use_torsions_checkbutton = gtk_check_button_new_with_label (_("Use Torsion Restraints"));
  gtk_widget_ref (refine_params_use_torsions_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "refine_params_use_torsions_checkbutton", refine_params_use_torsions_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (refine_params_use_torsions_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox60), refine_params_use_torsions_checkbutton, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, refine_params_use_torsions_checkbutton, _("Optimize torsion angles too"), NULL);

  phi_psi_restraints_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (phi_psi_restraints_vbox);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "phi_psi_restraints_vbox", phi_psi_restraints_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (vbox60), phi_psi_restraints_vbox, TRUE, TRUE, 0);

  hbox140 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox140);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "hbox140", hbox140,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox140);
  gtk_box_pack_start (GTK_BOX (phi_psi_restraints_vbox), hbox140, TRUE, TRUE, 0);

  label279 = gtk_label_new (_("    "));
  gtk_widget_ref (label279);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "label279", label279,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label279);
  gtk_box_pack_start (GTK_BOX (hbox140), label279, FALSE, FALSE, 0);

  refine_params_use_peptide_torsions_checkbutton = gtk_check_button_new_with_label (_("Use Phi/Psi Restraints"));
  gtk_widget_ref (refine_params_use_peptide_torsions_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "refine_params_use_peptide_torsions_checkbutton", refine_params_use_peptide_torsions_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (refine_params_use_peptide_torsions_checkbutton);
  gtk_box_pack_start (GTK_BOX (hbox140), refine_params_use_peptide_torsions_checkbutton, FALSE, FALSE, 0);

  peptide_torsions_restraints_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (peptide_torsions_restraints_vbox);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "peptide_torsions_restraints_vbox", peptide_torsions_restraints_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (peptide_torsions_restraints_vbox);
  gtk_box_pack_start (GTK_BOX (phi_psi_restraints_vbox), peptide_torsions_restraints_vbox, TRUE, TRUE, 0);
  gtk_widget_set_sensitive (peptide_torsions_restraints_vbox, FALSE);

  hbox137 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox137);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "hbox137", hbox137,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox137);
  gtk_box_pack_start (GTK_BOX (peptide_torsions_restraints_vbox), hbox137, TRUE, TRUE, 0);

  label276 = gtk_label_new (_("         "));
  gtk_widget_ref (label276);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "label276", label276,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label276);
  gtk_box_pack_start (GTK_BOX (hbox137), label276, FALSE, FALSE, 0);

  refine_params_use_helix_peptide_torsions_radiobutton = gtk_radio_button_new_with_label (link_torsion_restraints_group, _("Use Alpha Helix Restraints"));
  link_torsion_restraints_group = gtk_radio_button_group (GTK_RADIO_BUTTON (refine_params_use_helix_peptide_torsions_radiobutton));
  gtk_widget_ref (refine_params_use_helix_peptide_torsions_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "refine_params_use_helix_peptide_torsions_radiobutton", refine_params_use_helix_peptide_torsions_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (refine_params_use_helix_peptide_torsions_radiobutton);
  gtk_box_pack_start (GTK_BOX (hbox137), refine_params_use_helix_peptide_torsions_radiobutton, FALSE, FALSE, 0);

  hbox138 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox138);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "hbox138", hbox138,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox138);
  gtk_box_pack_start (GTK_BOX (peptide_torsions_restraints_vbox), hbox138, TRUE, TRUE, 0);

  label277 = gtk_label_new (_("         "));
  gtk_widget_ref (label277);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "label277", label277,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label277);
  gtk_box_pack_start (GTK_BOX (hbox138), label277, FALSE, FALSE, 0);

  refine_params_use_beta_strand_peptide_torsions_radiobutton = gtk_radio_button_new_with_label (link_torsion_restraints_group, _("Use Beta Strand Restraints"));
  link_torsion_restraints_group = gtk_radio_button_group (GTK_RADIO_BUTTON (refine_params_use_beta_strand_peptide_torsions_radiobutton));
  gtk_widget_ref (refine_params_use_beta_strand_peptide_torsions_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "refine_params_use_beta_strand_peptide_torsions_radiobutton", refine_params_use_beta_strand_peptide_torsions_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (refine_params_use_beta_strand_peptide_torsions_radiobutton);
  gtk_box_pack_start (GTK_BOX (hbox138), refine_params_use_beta_strand_peptide_torsions_radiobutton, FALSE, FALSE, 0);

  hbox139 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox139);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "hbox139", hbox139,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox139);
  gtk_box_pack_start (GTK_BOX (peptide_torsions_restraints_vbox), hbox139, TRUE, TRUE, 0);

  label278 = gtk_label_new (_("         "));
  gtk_widget_ref (label278);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "label278", label278,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label278);
  gtk_box_pack_start (GTK_BOX (hbox139), label278, FALSE, FALSE, 0);

  refine_params_use_ramachandran_goodness_torsions_radiobutton = gtk_radio_button_new_with_label (link_torsion_restraints_group, _("Restrain to Ramachandran Goodness"));
  link_torsion_restraints_group = gtk_radio_button_group (GTK_RADIO_BUTTON (refine_params_use_ramachandran_goodness_torsions_radiobutton));
  gtk_widget_ref (refine_params_use_ramachandran_goodness_torsions_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "refine_params_use_ramachandran_goodness_torsions_radiobutton", refine_params_use_ramachandran_goodness_torsions_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (refine_params_use_ramachandran_goodness_torsions_radiobutton);
  gtk_box_pack_start (GTK_BOX (hbox139), refine_params_use_ramachandran_goodness_torsions_radiobutton, FALSE, FALSE, 0);

  hbox141 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox141);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "hbox141", hbox141,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (vbox60), hbox141, FALSE, FALSE, 0);

  label280 = gtk_label_new (_("    "));
  gtk_widget_ref (label280);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "label280", label280,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label280);
  gtk_box_pack_start (GTK_BOX (hbox141), label280, FALSE, FALSE, 0);

  refine_params_use_peptide_omegas_checkbutton = gtk_check_button_new_with_label (_("Use Omega Restraints"));
  gtk_widget_ref (refine_params_use_peptide_omegas_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "refine_params_use_peptide_omegas_checkbutton", refine_params_use_peptide_omegas_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (refine_params_use_peptide_omegas_checkbutton);
  gtk_box_pack_start (GTK_BOX (hbox141), refine_params_use_peptide_omegas_checkbutton, FALSE, FALSE, 0);
  gtk_widget_set_sensitive (refine_params_use_peptide_omegas_checkbutton, FALSE);

  refine_params_use_initial_pos_checkbutton = gtk_check_button_new_with_label (_("Use Initial Position Restraints"));
  gtk_widget_ref (refine_params_use_initial_pos_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "refine_params_use_initial_pos_checkbutton", refine_params_use_initial_pos_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (vbox60), refine_params_use_initial_pos_checkbutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (refine_params_use_initial_pos_checkbutton), 2);
  gtk_widget_set_sensitive (refine_params_use_initial_pos_checkbutton, FALSE);
  gtk_tooltips_set_tip (tooltips, refine_params_use_initial_pos_checkbutton, _("Stops regularization wandering off [non-active]"), NULL);

  frame174 = gtk_frame_new (NULL);
  gtk_widget_ref (frame174);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "frame174", frame174,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame174);
  gtk_box_pack_start (GTK_BOX (vbox60), frame174, TRUE, TRUE, 0);

  sec_struct_restraints_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (sec_struct_restraints_vbox);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "sec_struct_restraints_vbox", sec_struct_restraints_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (sec_struct_restraints_vbox);
  gtk_container_add (GTK_CONTAINER (frame174), sec_struct_restraints_vbox);

  sec_str_rest_no_rest_radiobutton = gtk_radio_button_new_with_label (ss_rest_gr_group, _("No Secondary Structure Restraints"));
  ss_rest_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (sec_str_rest_no_rest_radiobutton));
  gtk_widget_ref (sec_str_rest_no_rest_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "sec_str_rest_no_rest_radiobutton", sec_str_rest_no_rest_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (sec_str_rest_no_rest_radiobutton);
  gtk_box_pack_start (GTK_BOX (sec_struct_restraints_vbox), sec_str_rest_no_rest_radiobutton, FALSE, FALSE, 0);

  sec_str_rest_helix_rest_radiobutton = gtk_radio_button_new_with_label (ss_rest_gr_group, _("Alpha Helix Restraints"));
  ss_rest_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (sec_str_rest_helix_rest_radiobutton));
  gtk_widget_ref (sec_str_rest_helix_rest_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "sec_str_rest_helix_rest_radiobutton", sec_str_rest_helix_rest_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (sec_str_rest_helix_rest_radiobutton);
  gtk_box_pack_start (GTK_BOX (sec_struct_restraints_vbox), sec_str_rest_helix_rest_radiobutton, FALSE, FALSE, 0);

  sec_str_rest_strand_rest_radiobutton = gtk_radio_button_new_with_label (ss_rest_gr_group, _("Beta Strand Restraints"));
  ss_rest_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (sec_str_rest_strand_rest_radiobutton));
  gtk_widget_ref (sec_str_rest_strand_rest_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "sec_str_rest_strand_rest_radiobutton", sec_str_rest_strand_rest_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (sec_str_rest_strand_rest_radiobutton);
  gtk_box_pack_start (GTK_BOX (sec_struct_restraints_vbox), sec_str_rest_strand_rest_radiobutton, FALSE, FALSE, 0);

  dialog_action_area8 = GTK_DIALOG (refine_params_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (refine_params_dialog), "dialog_action_area8", dialog_action_area8);
  gtk_widget_show (dialog_action_area8);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area8), 10);

  refine_params_dialog_ok_button = gtk_button_new_with_label (_("OK"));
  gtk_widget_ref (refine_params_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (refine_params_dialog), "refine_params_dialog_ok_button", refine_params_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (refine_params_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area8), refine_params_dialog_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (refine_params_dialog_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (refine_params_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_refine_params_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (refine_params_use_torsions_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_refine_params_use_torsions_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (refine_params_use_peptide_torsions_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_refine_params_use_peptide_torsions_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (refine_params_use_helix_peptide_torsions_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_refine_params_use_helix_peptide_torsions_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (refine_params_use_beta_strand_peptide_torsions_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_refine_params_use_beta_strand_peptide_torsions_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (refine_params_use_ramachandran_goodness_torsions_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_refine_params_use_ramachandran_goodness_torsions_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (refine_params_use_peptide_omegas_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_refine_params_use_peptide_omegas_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (refine_params_use_initial_pos_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_refine_params_use_initial_pos_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (sec_str_rest_no_rest_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_sec_str_rest_no_rest_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (sec_str_rest_helix_rest_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_sec_str_rest_helix_rest_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (sec_str_rest_strand_rest_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_sec_str_rest_strand_rest_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (refine_params_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_refine_params_dialog_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (refine_params_dialog_ok_button);
  gtk_widget_grab_default (refine_params_dialog_ok_button);
  gtk_object_set_data (GTK_OBJECT (refine_params_dialog), "tooltips", tooltips);

  return refine_params_dialog;
}

GtkWidget*
create_accept_reject_refinement_dialog (void)
{
  GtkWidget *accept_reject_refinement_dialog;
  GtkWidget *dialog_vbox9;
  GtkWidget *frame129;
  GtkWidget *accept_dialog_accept_label_string;
  GtkWidget *dialog_action_area9;
  GtkWidget *hbox41;
  GtkWidget *accept_reject_refinement_accept_button;
  GtkWidget *accept_reject_refinement_reject_button;

  accept_reject_refinement_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (accept_reject_refinement_dialog), "accept_reject_refinement_dialog", accept_reject_refinement_dialog);
  gtk_window_set_title (GTK_WINDOW (accept_reject_refinement_dialog), _("Accept Refinement?"));
  gtk_window_set_policy (GTK_WINDOW (accept_reject_refinement_dialog), TRUE, TRUE, FALSE);

  dialog_vbox9 = GTK_DIALOG (accept_reject_refinement_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (accept_reject_refinement_dialog), "dialog_vbox9", dialog_vbox9);
  gtk_widget_show (dialog_vbox9);

  frame129 = gtk_frame_new (NULL);
  gtk_widget_ref (frame129);
  gtk_object_set_data_full (GTK_OBJECT (accept_reject_refinement_dialog), "frame129", frame129,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame129);
  gtk_box_pack_start (GTK_BOX (dialog_vbox9), frame129, FALSE, FALSE, 6);
  gtk_container_set_border_width (GTK_CONTAINER (frame129), 6);

  accept_dialog_accept_label_string = gtk_label_new (_("Accept Refinement?"));
  gtk_widget_ref (accept_dialog_accept_label_string);
  gtk_object_set_data_full (GTK_OBJECT (accept_reject_refinement_dialog), "accept_dialog_accept_label_string", accept_dialog_accept_label_string,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (accept_dialog_accept_label_string);
  gtk_container_add (GTK_CONTAINER (frame129), accept_dialog_accept_label_string);
  gtk_misc_set_padding (GTK_MISC (accept_dialog_accept_label_string), 80, 50);

  dialog_action_area9 = GTK_DIALOG (accept_reject_refinement_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (accept_reject_refinement_dialog), "dialog_action_area9", dialog_action_area9);
  gtk_widget_show (dialog_action_area9);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area9), 10);

  hbox41 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox41);
  gtk_object_set_data_full (GTK_OBJECT (accept_reject_refinement_dialog), "hbox41", hbox41,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox41);
  gtk_box_pack_start (GTK_BOX (dialog_action_area9), hbox41, TRUE, TRUE, 0);

  accept_reject_refinement_accept_button = gtk_button_new_with_label (_("Accept"));
  gtk_widget_ref (accept_reject_refinement_accept_button);
  gtk_object_set_data_full (GTK_OBJECT (accept_reject_refinement_dialog), "accept_reject_refinement_accept_button", accept_reject_refinement_accept_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (accept_reject_refinement_accept_button);
  gtk_box_pack_start (GTK_BOX (hbox41), accept_reject_refinement_accept_button, TRUE, TRUE, 6);
  GTK_WIDGET_SET_FLAGS (accept_reject_refinement_accept_button, GTK_CAN_DEFAULT);

  accept_reject_refinement_reject_button = gtk_button_new_with_label (_("Reject"));
  gtk_widget_ref (accept_reject_refinement_reject_button);
  gtk_object_set_data_full (GTK_OBJECT (accept_reject_refinement_dialog), "accept_reject_refinement_reject_button", accept_reject_refinement_reject_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (accept_reject_refinement_reject_button);
  gtk_box_pack_start (GTK_BOX (hbox41), accept_reject_refinement_reject_button, TRUE, TRUE, 6);
  GTK_WIDGET_SET_FLAGS (accept_reject_refinement_reject_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (accept_reject_refinement_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_accept_reject_refinement_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (accept_reject_refinement_dialog), "configure_event",
                      GTK_SIGNAL_FUNC (on_accept_reject_refinement_dialog_configure_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (accept_reject_refinement_accept_button), "clicked",
                      GTK_SIGNAL_FUNC (on_accept_reject_refinement_accept_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (accept_reject_refinement_reject_button), "clicked",
                      GTK_SIGNAL_FUNC (on_accept_reject_refinement_reject_button_clicked),
                      NULL);

  gtk_widget_grab_default (accept_reject_refinement_accept_button);
  return accept_reject_refinement_dialog;
}

GtkWidget*
create_find_waters_dialog (void)
{
  GtkWidget *find_waters_dialog;
  GtkWidget *dialog_vbox10;
  GtkWidget *vbox54;
  GtkWidget *frame44;
  GtkWidget *find_waters_map_vbox;
  GtkWidget *label85;
  GtkWidget *frame45;
  GtkWidget *find_waters_protein_vbox;
  GtkWidget *label86;
  GtkWidget *frame46;
  GtkWidget *vbox57;
  GtkWidget *label87;
  GtkWidget *hbox44;
  GtkWidget *find_waters_peak_level_entry;
  GtkWidget *label88;
  GtkWidget *frame63;
  GtkWidget *vbox80;
  GtkWidget *label108;
  GSList *water_mol_group = NULL;
  GtkWidget *water_mol_protein_mask_radiobutton;
  GtkWidget *water_mol_new_mol_radiobutton;
  GtkWidget *dialog_action_area10;
  GtkWidget *hbox43;
  GtkWidget *find_waters_ok_button;
  GtkWidget *find_waters_cancel_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  find_waters_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (find_waters_dialog), "find_waters_dialog", find_waters_dialog);
  gtk_window_set_title (GTK_WINDOW (find_waters_dialog), _("find waters dialog"));
  gtk_window_set_policy (GTK_WINDOW (find_waters_dialog), TRUE, TRUE, FALSE);

  dialog_vbox10 = GTK_DIALOG (find_waters_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (find_waters_dialog), "dialog_vbox10", dialog_vbox10);
  gtk_widget_show (dialog_vbox10);

  vbox54 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox54);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "vbox54", vbox54,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox54);
  gtk_box_pack_start (GTK_BOX (dialog_vbox10), vbox54, TRUE, TRUE, 0);

  frame44 = gtk_frame_new (NULL);
  gtk_widget_ref (frame44);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "frame44", frame44,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame44);
  gtk_box_pack_start (GTK_BOX (vbox54), frame44, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame44), 6);

  find_waters_map_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (find_waters_map_vbox);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "find_waters_map_vbox", find_waters_map_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_waters_map_vbox);
  gtk_container_add (GTK_CONTAINER (frame44), find_waters_map_vbox);
  gtk_container_set_border_width (GTK_CONTAINER (find_waters_map_vbox), 3);

  label85 = gtk_label_new (_("Select Map:"));
  gtk_widget_ref (label85);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "label85", label85,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label85);
  gtk_box_pack_start (GTK_BOX (find_waters_map_vbox), label85, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label85), GTK_JUSTIFY_LEFT);

  frame45 = gtk_frame_new (NULL);
  gtk_widget_ref (frame45);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "frame45", frame45,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame45);
  gtk_box_pack_start (GTK_BOX (vbox54), frame45, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame45), 6);

  find_waters_protein_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (find_waters_protein_vbox);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "find_waters_protein_vbox", find_waters_protein_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_waters_protein_vbox);
  gtk_container_add (GTK_CONTAINER (frame45), find_waters_protein_vbox);
  gtk_container_set_border_width (GTK_CONTAINER (find_waters_protein_vbox), 3);

  label86 = gtk_label_new (_("Select Protein (which Masks Map):"));
  gtk_widget_ref (label86);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "label86", label86,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label86);
  gtk_box_pack_start (GTK_BOX (find_waters_protein_vbox), label86, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label86), GTK_JUSTIFY_LEFT);

  frame46 = gtk_frame_new (NULL);
  gtk_widget_ref (frame46);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "frame46", frame46,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame46);
  gtk_box_pack_start (GTK_BOX (vbox54), frame46, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame46), 6);

  vbox57 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox57);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "vbox57", vbox57,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox57);
  gtk_container_add (GTK_CONTAINER (frame46), vbox57);
  gtk_container_set_border_width (GTK_CONTAINER (vbox57), 3);

  label87 = gtk_label_new (_("Find Peaks above:"));
  gtk_widget_ref (label87);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "label87", label87,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label87);
  gtk_box_pack_start (GTK_BOX (vbox57), label87, FALSE, FALSE, 0);

  hbox44 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox44);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "hbox44", hbox44,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox44);
  gtk_box_pack_start (GTK_BOX (vbox57), hbox44, TRUE, TRUE, 0);

  find_waters_peak_level_entry = gtk_entry_new ();
  gtk_widget_ref (find_waters_peak_level_entry);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "find_waters_peak_level_entry", find_waters_peak_level_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_waters_peak_level_entry);
  gtk_box_pack_start (GTK_BOX (hbox44), find_waters_peak_level_entry, FALSE, TRUE, 6);
  gtk_widget_set_usize (find_waters_peak_level_entry, 36, -2);
  gtk_tooltips_set_tip (tooltips, find_waters_peak_level_entry, _("Note that this is sigma of the map after it has been masked by the protein.  1.8 sigma seems good for a 2Fo-Fc style map and about 3.0 for a difference map."), NULL);

  label88 = gtk_label_new (_(" sigma "));
  gtk_widget_ref (label88);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "label88", label88,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label88);
  gtk_box_pack_start (GTK_BOX (hbox44), label88, FALSE, FALSE, 0);

  frame63 = gtk_frame_new (NULL);
  gtk_widget_ref (frame63);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "frame63", frame63,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame63);
  gtk_box_pack_start (GTK_BOX (vbox54), frame63, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame63), 6);

  vbox80 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox80);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "vbox80", vbox80,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox80);
  gtk_container_add (GTK_CONTAINER (frame63), vbox80);

  label108 = gtk_label_new (_("Waters should be:"));
  gtk_widget_ref (label108);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "label108", label108,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label108);
  gtk_box_pack_start (GTK_BOX (vbox80), label108, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label108), 0.03, 0.5);
  gtk_misc_set_padding (GTK_MISC (label108), 0, 2);

  water_mol_protein_mask_radiobutton = gtk_radio_button_new_with_label (water_mol_group, _("Added to Molecule that masks the map"));
  water_mol_group = gtk_radio_button_group (GTK_RADIO_BUTTON (water_mol_protein_mask_radiobutton));
  gtk_widget_ref (water_mol_protein_mask_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "water_mol_protein_mask_radiobutton", water_mol_protein_mask_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (water_mol_protein_mask_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox80), water_mol_protein_mask_radiobutton, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (water_mol_protein_mask_radiobutton), TRUE);

  water_mol_new_mol_radiobutton = gtk_radio_button_new_with_label (water_mol_group, _("A new \"Waters\" molecule"));
  water_mol_group = gtk_radio_button_group (GTK_RADIO_BUTTON (water_mol_new_mol_radiobutton));
  gtk_widget_ref (water_mol_new_mol_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "water_mol_new_mol_radiobutton", water_mol_new_mol_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (water_mol_new_mol_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox80), water_mol_new_mol_radiobutton, FALSE, FALSE, 0);

  dialog_action_area10 = GTK_DIALOG (find_waters_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (find_waters_dialog), "dialog_action_area10", dialog_action_area10);
  gtk_widget_show (dialog_action_area10);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area10), 10);

  hbox43 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox43);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "hbox43", hbox43,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox43);
  gtk_box_pack_start (GTK_BOX (dialog_action_area10), hbox43, TRUE, TRUE, 0);

  find_waters_ok_button = gtk_button_new_with_label (_("  Find Waters  "));
  gtk_widget_ref (find_waters_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "find_waters_ok_button", find_waters_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_waters_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox43), find_waters_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (find_waters_ok_button, GTK_CAN_DEFAULT);

  find_waters_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (find_waters_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (find_waters_dialog), "find_waters_cancel_button", find_waters_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_waters_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox43), find_waters_cancel_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (find_waters_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (find_waters_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_find_waters_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (find_waters_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_find_waters_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (find_waters_ok_button);
  gtk_widget_grab_default (find_waters_ok_button);
  gtk_object_set_data (GTK_OBJECT (find_waters_dialog), "tooltips", tooltips);

  return find_waters_dialog;
}

GtkWidget*
create_environment_distance_dialog (void)
{
  GtkWidget *environment_distance_dialog;
  GtkWidget *dialog_vbox11;
  GtkWidget *vbox58;
  GtkWidget *frame48;
  GtkWidget *environment_distance_checkbutton;
  GtkWidget *environment_distance_distances_frame;
  GtkWidget *vbox59;
  GtkWidget *label89;
  GtkWidget *hbox46;
  GtkWidget *label90;
  GtkWidget *environment_distance_min_entry;
  GtkWidget *label92;
  GtkWidget *hbox45;
  GtkWidget *label91;
  GtkWidget *environment_distance_max_entry;
  GtkWidget *label93;
  GtkWidget *environment_distance_label_atom_checkbutton;
  GtkWidget *dialog_action_area11;
  GtkWidget *environment_distance_dialog_ok_button;

  environment_distance_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (environment_distance_dialog), "environment_distance_dialog", environment_distance_dialog);
  gtk_container_set_border_width (GTK_CONTAINER (environment_distance_dialog), 6);
  gtk_window_set_title (GTK_WINDOW (environment_distance_dialog), _("Environment Distances"));
  gtk_window_set_policy (GTK_WINDOW (environment_distance_dialog), TRUE, TRUE, FALSE);

  dialog_vbox11 = GTK_DIALOG (environment_distance_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (environment_distance_dialog), "dialog_vbox11", dialog_vbox11);
  gtk_widget_show (dialog_vbox11);

  vbox58 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox58);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "vbox58", vbox58,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox58);
  gtk_box_pack_start (GTK_BOX (dialog_vbox11), vbox58, TRUE, TRUE, 0);

  frame48 = gtk_frame_new (NULL);
  gtk_widget_ref (frame48);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "frame48", frame48,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame48);
  gtk_box_pack_start (GTK_BOX (vbox58), frame48, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame48), 6);

  environment_distance_checkbutton = gtk_check_button_new_with_label (_("Show Residue Environment?"));
  gtk_widget_ref (environment_distance_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "environment_distance_checkbutton", environment_distance_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (environment_distance_checkbutton);
  gtk_container_add (GTK_CONTAINER (frame48), environment_distance_checkbutton);

  environment_distance_distances_frame = gtk_frame_new (NULL);
  gtk_widget_ref (environment_distance_distances_frame);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "environment_distance_distances_frame", environment_distance_distances_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (environment_distance_distances_frame);
  gtk_box_pack_start (GTK_BOX (vbox58), environment_distance_distances_frame, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (environment_distance_distances_frame), 6);
  gtk_widget_set_sensitive (environment_distance_distances_frame, FALSE);

  vbox59 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox59);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "vbox59", vbox59,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox59);
  gtk_container_add (GTK_CONTAINER (environment_distance_distances_frame), vbox59);

  label89 = gtk_label_new ("");
  gtk_widget_ref (label89);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "label89", label89,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label89);
  gtk_box_pack_start (GTK_BOX (vbox59), label89, FALSE, FALSE, 0);

  hbox46 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox46);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "hbox46", hbox46,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox46);
  gtk_box_pack_start (GTK_BOX (vbox59), hbox46, TRUE, TRUE, 0);

  label90 = gtk_label_new (_("  Min Distance  "));
  gtk_widget_ref (label90);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "label90", label90,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label90);
  gtk_box_pack_start (GTK_BOX (hbox46), label90, FALSE, FALSE, 0);

  environment_distance_min_entry = gtk_entry_new ();
  gtk_widget_ref (environment_distance_min_entry);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "environment_distance_min_entry", environment_distance_min_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (environment_distance_min_entry);
  gtk_box_pack_start (GTK_BOX (hbox46), environment_distance_min_entry, TRUE, TRUE, 0);
  gtk_widget_set_usize (environment_distance_min_entry, 32, -2);

  label92 = gtk_label_new (_("  Angstroms  "));
  gtk_widget_ref (label92);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "label92", label92,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label92);
  gtk_box_pack_start (GTK_BOX (hbox46), label92, FALSE, FALSE, 0);

  hbox45 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox45);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "hbox45", hbox45,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox45);
  gtk_box_pack_start (GTK_BOX (vbox59), hbox45, TRUE, TRUE, 0);

  label91 = gtk_label_new (_("  Max Distance  "));
  gtk_widget_ref (label91);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "label91", label91,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label91);
  gtk_box_pack_start (GTK_BOX (hbox45), label91, FALSE, FALSE, 0);

  environment_distance_max_entry = gtk_entry_new ();
  gtk_widget_ref (environment_distance_max_entry);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "environment_distance_max_entry", environment_distance_max_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (environment_distance_max_entry);
  gtk_box_pack_start (GTK_BOX (hbox45), environment_distance_max_entry, TRUE, TRUE, 0);
  gtk_widget_set_usize (environment_distance_max_entry, 32, -2);

  label93 = gtk_label_new (_("  Angstroms  "));
  gtk_widget_ref (label93);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "label93", label93,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label93);
  gtk_box_pack_start (GTK_BOX (hbox45), label93, FALSE, FALSE, 0);

  environment_distance_label_atom_checkbutton = gtk_check_button_new_with_label (_("Label Atom?"));
  gtk_widget_ref (environment_distance_label_atom_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "environment_distance_label_atom_checkbutton", environment_distance_label_atom_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (environment_distance_label_atom_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox58), environment_distance_label_atom_checkbutton, FALSE, FALSE, 0);
  gtk_widget_set_sensitive (environment_distance_label_atom_checkbutton, FALSE);

  dialog_action_area11 = GTK_DIALOG (environment_distance_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (environment_distance_dialog), "dialog_action_area11", dialog_action_area11);
  gtk_widget_show (dialog_action_area11);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area11), 10);

  environment_distance_dialog_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (environment_distance_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (environment_distance_dialog), "environment_distance_dialog_ok_button", environment_distance_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (environment_distance_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area11), environment_distance_dialog_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (environment_distance_dialog_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (environment_distance_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_environment_distance_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (environment_distance_label_atom_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_environment_distance_label_atom_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (environment_distance_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_environment_distance_dialog_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (environment_distance_dialog_ok_button);
  gtk_widget_grab_default (environment_distance_dialog_ok_button);
  return environment_distance_dialog;
}

GtkWidget*
create_cif_dictionary_fileselection (void)
{
  GtkWidget *cif_dictionary_fileselection;
  GtkWidget *cif_dictionary_fileselection_ok_button;
  GtkWidget *cif_dictionary_fileselection_cancel_button;

  cif_dictionary_fileselection = gtk_file_selection_new (_("Select File"));
  gtk_object_set_data (GTK_OBJECT (cif_dictionary_fileselection), "cif_dictionary_fileselection", cif_dictionary_fileselection);
  gtk_container_set_border_width (GTK_CONTAINER (cif_dictionary_fileselection), 10);

  cif_dictionary_fileselection_ok_button = GTK_FILE_SELECTION (cif_dictionary_fileselection)->ok_button;
  gtk_object_set_data (GTK_OBJECT (cif_dictionary_fileselection), "cif_dictionary_fileselection_ok_button", cif_dictionary_fileselection_ok_button);
  gtk_widget_show (cif_dictionary_fileselection_ok_button);
  GTK_WIDGET_SET_FLAGS (cif_dictionary_fileselection_ok_button, GTK_CAN_DEFAULT);

  cif_dictionary_fileselection_cancel_button = GTK_FILE_SELECTION (cif_dictionary_fileselection)->cancel_button;
  gtk_object_set_data (GTK_OBJECT (cif_dictionary_fileselection), "cif_dictionary_fileselection_cancel_button", cif_dictionary_fileselection_cancel_button);
  gtk_widget_show (cif_dictionary_fileselection_cancel_button);
  GTK_WIDGET_SET_FLAGS (cif_dictionary_fileselection_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (cif_dictionary_fileselection_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_cif_dictionary_fileselection_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (cif_dictionary_fileselection_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_cif_dictionary_fileselection_cancel_button_clicked),
                      NULL);

  return cif_dictionary_fileselection;
}

GtkWidget*
create_residue_type_chooser_window (void)
{
  GtkWidget *residue_type_chooser_window;
  GtkWidget *frame50;
  GtkWidget *vbox62;
  GtkWidget *residue_type_chooser_stub_checkbutton;
  GtkWidget *residue_type_chooser_ALA;
  GtkWidget *residue_type_chooser_ARG;
  GtkWidget *residue_type_chooser_ASN;
  GtkWidget *residue_type_chooser_ASP;
  GtkWidget *residue_type_chooser_CYS;
  GtkWidget *residue_type_chooser_GLN;
  GtkWidget *residue_type_chooser_GLU;
  GtkWidget *residue_type_chooser_GLY;
  GtkWidget *residue_type_chooser_HIS;
  GtkWidget *residue_type_chooser_ILE;
  GtkWidget *residue_type_chooser_LEU;
  GtkWidget *residue_type_chooser_LYS;
  GtkWidget *residue_type_chooser_MET;
  GtkWidget *residue_type_chooser_MSE;
  GtkWidget *residue_type_chooser_PHE;
  GtkWidget *residue_type_chooser_PRO;
  GtkWidget *residue_type_chooser_SER;
  GtkWidget *residue_type_chooser_THR;
  GtkWidget *residue_type_chooser_TRP;
  GtkWidget *residue_type_chooser_TYR;
  GtkWidget *residue_type_chooser_VAL;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  residue_type_chooser_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_window", residue_type_chooser_window);
  gtk_window_set_title (GTK_WINDOW (residue_type_chooser_window), _("Residu Type"));

  frame50 = gtk_frame_new (NULL);
  gtk_widget_ref (frame50);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "frame50", frame50,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame50);
  gtk_container_add (GTK_CONTAINER (residue_type_chooser_window), frame50);
  gtk_container_set_border_width (GTK_CONTAINER (frame50), 6);

  vbox62 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox62);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "vbox62", vbox62,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox62);
  gtk_container_add (GTK_CONTAINER (frame50), vbox62);
  gtk_container_set_border_width (GTK_CONTAINER (vbox62), 5);

  residue_type_chooser_stub_checkbutton = gtk_check_button_new_with_label (_("Stub"));
  gtk_widget_ref (residue_type_chooser_stub_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_stub_checkbutton", residue_type_chooser_stub_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_stub_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_stub_checkbutton, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, residue_type_chooser_stub_checkbutton, _("Change the residue type, but only put in the main-chain atoms and the CB"), NULL);

  residue_type_chooser_ALA = gtk_button_new_with_label (_("  ALA (A)  "));
  gtk_widget_ref (residue_type_chooser_ALA);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_ALA", residue_type_chooser_ALA,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_ALA);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_ALA, FALSE, FALSE, 2);

  residue_type_chooser_ARG = gtk_button_new_with_label (_("  ARG (R)  "));
  gtk_widget_ref (residue_type_chooser_ARG);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_ARG", residue_type_chooser_ARG,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_ARG);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_ARG, FALSE, FALSE, 2);

  residue_type_chooser_ASN = gtk_button_new_with_label (_("  ASN (N)  "));
  gtk_widget_ref (residue_type_chooser_ASN);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_ASN", residue_type_chooser_ASN,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_ASN);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_ASN, FALSE, FALSE, 2);

  residue_type_chooser_ASP = gtk_button_new_with_label (_("  ASP (D)  "));
  gtk_widget_ref (residue_type_chooser_ASP);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_ASP", residue_type_chooser_ASP,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_ASP);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_ASP, FALSE, FALSE, 2);

  residue_type_chooser_CYS = gtk_button_new_with_label (_("  CYS (C)  "));
  gtk_widget_ref (residue_type_chooser_CYS);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_CYS", residue_type_chooser_CYS,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_CYS);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_CYS, FALSE, FALSE, 2);

  residue_type_chooser_GLN = gtk_button_new_with_label (_("  GLN (Q)  "));
  gtk_widget_ref (residue_type_chooser_GLN);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_GLN", residue_type_chooser_GLN,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_GLN);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_GLN, FALSE, FALSE, 2);

  residue_type_chooser_GLU = gtk_button_new_with_label (_("  GLU (E)  "));
  gtk_widget_ref (residue_type_chooser_GLU);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_GLU", residue_type_chooser_GLU,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_GLU);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_GLU, FALSE, FALSE, 2);

  residue_type_chooser_GLY = gtk_button_new_with_label (_("  GLY (G)  "));
  gtk_widget_ref (residue_type_chooser_GLY);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_GLY", residue_type_chooser_GLY,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_GLY);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_GLY, FALSE, FALSE, 2);

  residue_type_chooser_HIS = gtk_button_new_with_label (_("  HIS (H)"));
  gtk_widget_ref (residue_type_chooser_HIS);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_HIS", residue_type_chooser_HIS,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_HIS);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_HIS, FALSE, FALSE, 2);

  residue_type_chooser_ILE = gtk_button_new_with_label (_("  ILE (I)"));
  gtk_widget_ref (residue_type_chooser_ILE);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_ILE", residue_type_chooser_ILE,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_ILE);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_ILE, FALSE, FALSE, 2);
  gtk_tooltips_set_tip (tooltips, residue_type_chooser_ILE, _("Selino-MET"), NULL);

  residue_type_chooser_LEU = gtk_button_new_with_label (_("  LEU (L)  "));
  gtk_widget_ref (residue_type_chooser_LEU);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_LEU", residue_type_chooser_LEU,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_LEU);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_LEU, FALSE, FALSE, 2);

  residue_type_chooser_LYS = gtk_button_new_with_label (_("  LYS (K)  "));
  gtk_widget_ref (residue_type_chooser_LYS);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_LYS", residue_type_chooser_LYS,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_LYS);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_LYS, FALSE, FALSE, 2);

  residue_type_chooser_MET = gtk_button_new_with_label (_("  MET (M)  "));
  gtk_widget_ref (residue_type_chooser_MET);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_MET", residue_type_chooser_MET,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_MET);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_MET, FALSE, FALSE, 2);

  residue_type_chooser_MSE = gtk_button_new_with_label (_("  MSE  "));
  gtk_widget_ref (residue_type_chooser_MSE);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_MSE", residue_type_chooser_MSE,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_MSE);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_MSE, FALSE, FALSE, 2);

  residue_type_chooser_PHE = gtk_button_new_with_label (_("  PHE (F)  "));
  gtk_widget_ref (residue_type_chooser_PHE);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_PHE", residue_type_chooser_PHE,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_PHE);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_PHE, FALSE, FALSE, 2);

  residue_type_chooser_PRO = gtk_button_new_with_label (_("  PRO (P)  "));
  gtk_widget_ref (residue_type_chooser_PRO);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_PRO", residue_type_chooser_PRO,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_PRO);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_PRO, FALSE, FALSE, 2);

  residue_type_chooser_SER = gtk_button_new_with_label (_("  SER (S)  "));
  gtk_widget_ref (residue_type_chooser_SER);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_SER", residue_type_chooser_SER,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_SER);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_SER, FALSE, FALSE, 2);

  residue_type_chooser_THR = gtk_button_new_with_label (_("  THR (T)  "));
  gtk_widget_ref (residue_type_chooser_THR);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_THR", residue_type_chooser_THR,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_THR);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_THR, FALSE, FALSE, 2);

  residue_type_chooser_TRP = gtk_button_new_with_label (_("  TRP (W)  "));
  gtk_widget_ref (residue_type_chooser_TRP);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_TRP", residue_type_chooser_TRP,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_TRP);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_TRP, FALSE, FALSE, 2);

  residue_type_chooser_TYR = gtk_button_new_with_label (_("  TYR (Y)  "));
  gtk_widget_ref (residue_type_chooser_TYR);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_TYR", residue_type_chooser_TYR,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_TYR);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_TYR, FALSE, FALSE, 2);

  residue_type_chooser_VAL = gtk_button_new_with_label (_("  VAL (V)  "));
  gtk_widget_ref (residue_type_chooser_VAL);
  gtk_object_set_data_full (GTK_OBJECT (residue_type_chooser_window), "residue_type_chooser_VAL", residue_type_chooser_VAL,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_type_chooser_VAL);
  gtk_box_pack_start (GTK_BOX (vbox62), residue_type_chooser_VAL, FALSE, FALSE, 2);

  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_stub_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_stub_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_ALA), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_ALA_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_ARG), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_ARG_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_ASN), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_ASN_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_ASP), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_ASP_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_CYS), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_CYS_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_GLN), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_GLN_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_GLU), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_GLU_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_GLY), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_GLY_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_HIS), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_HIS_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_ILE), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_ILE_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_LEU), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_LEU_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_LYS), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_LYS_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_MET), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_MET_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_MSE), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_MSE_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_PHE), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_PHE_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_PRO), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_PRO_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_SER), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_SER_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_THR), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_THR_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_TRP), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_TRP_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_TYR), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_TYR_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_type_chooser_VAL), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_type_chooser_VAL_clicked),
                      NULL);

  gtk_object_set_data (GTK_OBJECT (residue_type_chooser_window), "tooltips", tooltips);

  return residue_type_chooser_window;
}

GtkWidget*
create_run_script_fileselection (void)
{
  GtkWidget *run_script_fileselection;
  GtkWidget *run_script_fileselection_ok_button;
  GtkWidget *run_script_fileselection_cancel_button;

  run_script_fileselection = gtk_file_selection_new (_("Select File"));
  gtk_object_set_data (GTK_OBJECT (run_script_fileselection), "run_script_fileselection", run_script_fileselection);
  gtk_container_set_border_width (GTK_CONTAINER (run_script_fileselection), 10);

  run_script_fileselection_ok_button = GTK_FILE_SELECTION (run_script_fileselection)->ok_button;
  gtk_object_set_data (GTK_OBJECT (run_script_fileselection), "run_script_fileselection_ok_button", run_script_fileselection_ok_button);
  gtk_widget_show (run_script_fileselection_ok_button);
  GTK_WIDGET_SET_FLAGS (run_script_fileselection_ok_button, GTK_CAN_DEFAULT);

  run_script_fileselection_cancel_button = GTK_FILE_SELECTION (run_script_fileselection)->cancel_button;
  gtk_object_set_data (GTK_OBJECT (run_script_fileselection), "run_script_fileselection_cancel_button", run_script_fileselection_cancel_button);
  gtk_widget_show (run_script_fileselection_cancel_button);
  GTK_WIDGET_SET_FLAGS (run_script_fileselection_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (run_script_fileselection_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_run_script_fileselection_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (run_script_fileselection_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_run_script_fileselection_cancel_button_clicked),
                      NULL);

  return run_script_fileselection;
}

GtkWidget*
create_delete_item_dialog (void)
{
  GtkWidget *delete_item_dialog;
  GtkWidget *dialog_vbox12;
  GtkWidget *frame51;
  GtkWidget *vbox63;
  GtkWidget *label95;
  GSList *delete_item_group = NULL;
  GtkWidget *delete_item_residue_radiobutton;
  GtkWidget *delete_item_water_radiobutton;
  GtkWidget *delete_item_atom_radiobutton;
  GtkWidget *delete_item_sidechain_radiobutton;
  GtkWidget *delete_item_residue_hydrogens_radiobutton;
  GtkWidget *delete_item_residue_range_radiobutton;
  GtkWidget *delete_item_keep_active_checkbutton;
  GtkWidget *label126;
  GtkWidget *dialog_action_area12;
  GtkWidget *delete_item_cancel_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  delete_item_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (delete_item_dialog), "delete_item_dialog", delete_item_dialog);
  gtk_window_set_title (GTK_WINDOW (delete_item_dialog), _("Delete item"));
  gtk_window_set_policy (GTK_WINDOW (delete_item_dialog), TRUE, TRUE, FALSE);

  dialog_vbox12 = GTK_DIALOG (delete_item_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (delete_item_dialog), "dialog_vbox12", dialog_vbox12);
  gtk_widget_show (dialog_vbox12);

  frame51 = gtk_frame_new (NULL);
  gtk_widget_ref (frame51);
  gtk_object_set_data_full (GTK_OBJECT (delete_item_dialog), "frame51", frame51,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame51);
  gtk_box_pack_start (GTK_BOX (dialog_vbox12), frame51, TRUE, TRUE, 2);
  gtk_container_set_border_width (GTK_CONTAINER (frame51), 6);

  vbox63 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox63);
  gtk_object_set_data_full (GTK_OBJECT (delete_item_dialog), "vbox63", vbox63,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox63);
  gtk_container_add (GTK_CONTAINER (frame51), vbox63);

  label95 = gtk_label_new (_("Delete What Item Type?"));
  gtk_widget_ref (label95);
  gtk_object_set_data_full (GTK_OBJECT (delete_item_dialog), "label95", label95,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label95);
  gtk_box_pack_start (GTK_BOX (vbox63), label95, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label95), 0, 6);

  delete_item_residue_radiobutton = gtk_radio_button_new_with_label (delete_item_group, _("Residue/Monomer"));
  delete_item_group = gtk_radio_button_group (GTK_RADIO_BUTTON (delete_item_residue_radiobutton));
  gtk_widget_ref (delete_item_residue_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (delete_item_dialog), "delete_item_residue_radiobutton", delete_item_residue_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (delete_item_residue_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox63), delete_item_residue_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (delete_item_residue_radiobutton), 3);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (delete_item_residue_radiobutton), TRUE);

  delete_item_water_radiobutton = gtk_radio_button_new_with_label (delete_item_group, _("Water"));
  delete_item_group = gtk_radio_button_group (GTK_RADIO_BUTTON (delete_item_water_radiobutton));
  gtk_widget_ref (delete_item_water_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (delete_item_dialog), "delete_item_water_radiobutton", delete_item_water_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (delete_item_water_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox63), delete_item_water_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (delete_item_water_radiobutton), 3);

  delete_item_atom_radiobutton = gtk_radio_button_new_with_label (delete_item_group, _("Atom"));
  delete_item_group = gtk_radio_button_group (GTK_RADIO_BUTTON (delete_item_atom_radiobutton));
  gtk_widget_ref (delete_item_atom_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (delete_item_dialog), "delete_item_atom_radiobutton", delete_item_atom_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (delete_item_atom_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox63), delete_item_atom_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (delete_item_atom_radiobutton), 3);

  delete_item_sidechain_radiobutton = gtk_radio_button_new_with_label (delete_item_group, _("Sidechain"));
  delete_item_group = gtk_radio_button_group (GTK_RADIO_BUTTON (delete_item_sidechain_radiobutton));
  gtk_widget_ref (delete_item_sidechain_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (delete_item_dialog), "delete_item_sidechain_radiobutton", delete_item_sidechain_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (delete_item_sidechain_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox63), delete_item_sidechain_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (delete_item_sidechain_radiobutton), 3);

  delete_item_residue_hydrogens_radiobutton = gtk_radio_button_new_with_label (delete_item_group, _("Hydrogens in Residue"));
  delete_item_group = gtk_radio_button_group (GTK_RADIO_BUTTON (delete_item_residue_hydrogens_radiobutton));
  gtk_widget_ref (delete_item_residue_hydrogens_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (delete_item_dialog), "delete_item_residue_hydrogens_radiobutton", delete_item_residue_hydrogens_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (delete_item_residue_hydrogens_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox63), delete_item_residue_hydrogens_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (delete_item_residue_hydrogens_radiobutton), 3);

  delete_item_residue_range_radiobutton = gtk_radio_button_new_with_label (delete_item_group, _("Delete Zone"));
  delete_item_group = gtk_radio_button_group (GTK_RADIO_BUTTON (delete_item_residue_range_radiobutton));
  gtk_widget_ref (delete_item_residue_range_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (delete_item_dialog), "delete_item_residue_range_radiobutton", delete_item_residue_range_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (delete_item_residue_range_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox63), delete_item_residue_range_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (delete_item_residue_range_radiobutton), 3);

  delete_item_keep_active_checkbutton = gtk_check_button_new_with_label (_("Keep Delete Active"));
  gtk_widget_ref (delete_item_keep_active_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (delete_item_dialog), "delete_item_keep_active_checkbutton", delete_item_keep_active_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (delete_item_keep_active_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox63), delete_item_keep_active_checkbutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (delete_item_keep_active_checkbutton), 8);
  gtk_tooltips_set_tip (tooltips, delete_item_keep_active_checkbutton, _("For use with Multiple Deletes. When activated, deleting an item does not dismiss this dialog.  (Has the same action as using Ctrl-Left Click)"), NULL);

  label126 = gtk_label_new (_("\n Now click on an atom (of the residue) \nthat you wish to delete.               "));
  gtk_widget_ref (label126);
  gtk_object_set_data_full (GTK_OBJECT (delete_item_dialog), "label126", label126,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label126);
  gtk_box_pack_start (GTK_BOX (vbox63), label126, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label126), 0, 0);

  dialog_action_area12 = GTK_DIALOG (delete_item_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (delete_item_dialog), "dialog_action_area12", dialog_action_area12);
  gtk_widget_show (dialog_action_area12);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area12), 10);

  delete_item_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (delete_item_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (delete_item_dialog), "delete_item_cancel_button", delete_item_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (delete_item_cancel_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area12), delete_item_cancel_button, FALSE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (delete_item_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_delete_item_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (delete_item_dialog), "configure_event",
                      GTK_SIGNAL_FUNC (on_delete_item_dialog_configure_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (delete_item_residue_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_delete_item_residue_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (delete_item_water_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_delete_item_water_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (delete_item_atom_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_delete_item_atom_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (delete_item_sidechain_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_delete_item_sidechain_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (delete_item_residue_hydrogens_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_delete_item_residue_hydrogens_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (delete_item_residue_range_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_delete_item_residue_range_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (delete_item_keep_active_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_delete_item_keep_active_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (delete_item_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_delete_item_cancel_button_clicked),
                      NULL);

  gtk_object_set_data (GTK_OBJECT (delete_item_dialog), "tooltips", tooltips);

  return delete_item_dialog;
}

GtkWidget*
create_close_molecule_dialog (void)
{
  GtkWidget *close_molecule_dialog;
  GtkWidget *dialog_vbox13;
  GtkWidget *vbox64;
  GtkWidget *label96;
  GtkWidget *frame52;
  GtkWidget *close_molecule_optionmenu;
  GtkWidget *close_molecule_optionmenu_menu;
  GtkWidget *dialog_action_area13;
  GtkWidget *hbox48;
  GtkWidget *close_molecule_close_button;
  GtkWidget *close_molecule_cancel_button;

  close_molecule_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (close_molecule_dialog), "close_molecule_dialog", close_molecule_dialog);
  gtk_window_set_title (GTK_WINDOW (close_molecule_dialog), _("Choose Molecule to Close:"));
  gtk_window_set_policy (GTK_WINDOW (close_molecule_dialog), TRUE, TRUE, FALSE);

  dialog_vbox13 = GTK_DIALOG (close_molecule_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (close_molecule_dialog), "dialog_vbox13", dialog_vbox13);
  gtk_widget_show (dialog_vbox13);

  vbox64 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox64);
  gtk_object_set_data_full (GTK_OBJECT (close_molecule_dialog), "vbox64", vbox64,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox64);
  gtk_box_pack_start (GTK_BOX (dialog_vbox13), vbox64, TRUE, TRUE, 0);

  label96 = gtk_label_new (_("Choose Molecule/Map to Close:"));
  gtk_widget_ref (label96);
  gtk_object_set_data_full (GTK_OBJECT (close_molecule_dialog), "label96", label96,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label96);
  gtk_box_pack_start (GTK_BOX (vbox64), label96, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label96), 0, 6);

  frame52 = gtk_frame_new (NULL);
  gtk_widget_ref (frame52);
  gtk_object_set_data_full (GTK_OBJECT (close_molecule_dialog), "frame52", frame52,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame52);
  gtk_box_pack_start (GTK_BOX (vbox64), frame52, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame52), 6);

  close_molecule_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (close_molecule_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (close_molecule_dialog), "close_molecule_optionmenu", close_molecule_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (close_molecule_optionmenu);
  gtk_container_add (GTK_CONTAINER (frame52), close_molecule_optionmenu);
  close_molecule_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (close_molecule_optionmenu), close_molecule_optionmenu_menu);

  dialog_action_area13 = GTK_DIALOG (close_molecule_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (close_molecule_dialog), "dialog_action_area13", dialog_action_area13);
  gtk_widget_show (dialog_action_area13);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area13), 10);

  hbox48 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox48);
  gtk_object_set_data_full (GTK_OBJECT (close_molecule_dialog), "hbox48", hbox48,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox48);
  gtk_box_pack_start (GTK_BOX (dialog_action_area13), hbox48, TRUE, TRUE, 0);

  close_molecule_close_button = gtk_button_new_with_label (_("  Close Molecule   "));
  gtk_widget_ref (close_molecule_close_button);
  gtk_object_set_data_full (GTK_OBJECT (close_molecule_dialog), "close_molecule_close_button", close_molecule_close_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (close_molecule_close_button);
  gtk_box_pack_start (GTK_BOX (hbox48), close_molecule_close_button, TRUE, TRUE, 2);
  GTK_WIDGET_SET_FLAGS (close_molecule_close_button, GTK_CAN_DEFAULT);

  close_molecule_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (close_molecule_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (close_molecule_dialog), "close_molecule_cancel_button", close_molecule_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (close_molecule_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox48), close_molecule_cancel_button, TRUE, TRUE, 2);
  GTK_WIDGET_SET_FLAGS (close_molecule_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (close_molecule_close_button), "clicked",
                      GTK_SIGNAL_FUNC (on_close_molecule_close_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (close_molecule_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_close_molecule_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (close_molecule_close_button);
  gtk_widget_grab_default (close_molecule_close_button);
  return close_molecule_dialog;
}

GtkWidget*
create_residue_info_dialog (void)
{
  GtkWidget *residue_info_dialog;
  GtkWidget *dialog_vbox14;
  GtkWidget *vbox65;
  GtkWidget *residue_info_residue_label;
  GtkWidget *label97;
  GtkWidget *frame159;
  GtkWidget *vbox164;
  GtkWidget *hbox130;
  GtkWidget *label260;
  GtkWidget *residue_info_master_atom_occ_entry;
  GtkWidget *residue_info_master_atom_b_factor_entry;
  GtkWidget *residue_info_occ_apply_all_checkbutton;
  GtkWidget *residue_info_b_factor_apply_all_checkbutton;
  GtkWidget *scrolledwindow23;
  GtkWidget *viewport18;
  GtkWidget *frame53;
  GtkWidget *residue_info_hbox;
  GtkWidget *residue_info_atom_table;
  GtkWidget *dialog_action_area14;
  GtkWidget *hbox49;
  GtkWidget *residue_info_ok_button;
  GtkWidget *residue_info_cancel_button;

  residue_info_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (residue_info_dialog), "residue_info_dialog", residue_info_dialog);
  gtk_window_set_title (GTK_WINDOW (residue_info_dialog), _("Residue Info"));
  gtk_window_set_policy (GTK_WINDOW (residue_info_dialog), TRUE, TRUE, FALSE);

  dialog_vbox14 = GTK_DIALOG (residue_info_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (residue_info_dialog), "dialog_vbox14", dialog_vbox14);
  gtk_widget_show (dialog_vbox14);

  vbox65 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox65);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "vbox65", vbox65,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox65);
  gtk_box_pack_start (GTK_BOX (dialog_vbox14), vbox65, TRUE, TRUE, 0);

  residue_info_residue_label = gtk_label_new (_("Residue: "));
  gtk_widget_ref (residue_info_residue_label);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "residue_info_residue_label", residue_info_residue_label,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_info_residue_label);
  gtk_box_pack_start (GTK_BOX (vbox65), residue_info_residue_label, FALSE, FALSE, 6);
  gtk_misc_set_padding (GTK_MISC (residue_info_residue_label), 2, 6);

  label97 = gtk_label_new (_("   Atom Info:                       Occupancy                  Temperature Factor"));
  gtk_widget_ref (label97);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "label97", label97,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label97);
  gtk_box_pack_start (GTK_BOX (vbox65), label97, FALSE, FALSE, 6);
  gtk_misc_set_padding (GTK_MISC (label97), 10, 0);

  frame159 = gtk_frame_new (_("Master Atom"));
  gtk_widget_ref (frame159);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "frame159", frame159,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame159);
  gtk_box_pack_start (GTK_BOX (vbox65), frame159, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame159), 6);

  vbox164 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox164);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "vbox164", vbox164,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox164);
  gtk_container_add (GTK_CONTAINER (frame159), vbox164);

  hbox130 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox130);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "hbox130", hbox130,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox130);
  gtk_box_pack_start (GTK_BOX (vbox164), hbox130, TRUE, TRUE, 0);

  label260 = gtk_label_new (_("                                      "));
  gtk_widget_ref (label260);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "label260", label260,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label260);
  gtk_box_pack_start (GTK_BOX (hbox130), label260, FALSE, FALSE, 0);

  residue_info_master_atom_occ_entry = gtk_entry_new ();
  gtk_widget_ref (residue_info_master_atom_occ_entry);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "residue_info_master_atom_occ_entry", residue_info_master_atom_occ_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_info_master_atom_occ_entry);
  gtk_box_pack_start (GTK_BOX (hbox130), residue_info_master_atom_occ_entry, TRUE, TRUE, 3);
  gtk_widget_set_sensitive (residue_info_master_atom_occ_entry, FALSE);

  residue_info_master_atom_b_factor_entry = gtk_entry_new ();
  gtk_widget_ref (residue_info_master_atom_b_factor_entry);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "residue_info_master_atom_b_factor_entry", residue_info_master_atom_b_factor_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_info_master_atom_b_factor_entry);
  gtk_box_pack_start (GTK_BOX (hbox130), residue_info_master_atom_b_factor_entry, TRUE, TRUE, 3);
  gtk_widget_set_sensitive (residue_info_master_atom_b_factor_entry, FALSE);

  residue_info_occ_apply_all_checkbutton = gtk_check_button_new_with_label (_("Apply Occupancy to all atoms in residue?"));
  gtk_widget_ref (residue_info_occ_apply_all_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "residue_info_occ_apply_all_checkbutton", residue_info_occ_apply_all_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_info_occ_apply_all_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox164), residue_info_occ_apply_all_checkbutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (residue_info_occ_apply_all_checkbutton), 4);

  residue_info_b_factor_apply_all_checkbutton = gtk_check_button_new_with_label (_("Apply Temperature Factor to all atoms in residue?"));
  gtk_widget_ref (residue_info_b_factor_apply_all_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "residue_info_b_factor_apply_all_checkbutton", residue_info_b_factor_apply_all_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_info_b_factor_apply_all_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox164), residue_info_b_factor_apply_all_checkbutton, FALSE, FALSE, 0);

  scrolledwindow23 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow23);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "scrolledwindow23", scrolledwindow23,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow23);
  gtk_box_pack_start (GTK_BOX (vbox65), scrolledwindow23, TRUE, TRUE, 0);
  gtk_widget_set_usize (scrolledwindow23, -2, 220);

  viewport18 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport18);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "viewport18", viewport18,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport18);
  gtk_container_add (GTK_CONTAINER (scrolledwindow23), viewport18);

  frame53 = gtk_frame_new (NULL);
  gtk_widget_ref (frame53);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "frame53", frame53,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame53);
  gtk_container_add (GTK_CONTAINER (viewport18), frame53);
  gtk_container_set_border_width (GTK_CONTAINER (frame53), 6);

  residue_info_hbox = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (residue_info_hbox);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "residue_info_hbox", residue_info_hbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_info_hbox);
  gtk_container_add (GTK_CONTAINER (frame53), residue_info_hbox);

  residue_info_atom_table = gtk_table_new (3, 3, FALSE);
  gtk_widget_ref (residue_info_atom_table);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "residue_info_atom_table", residue_info_atom_table,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_info_atom_table);
  gtk_box_pack_start (GTK_BOX (residue_info_hbox), residue_info_atom_table, TRUE, TRUE, 0);

  dialog_action_area14 = GTK_DIALOG (residue_info_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (residue_info_dialog), "dialog_action_area14", dialog_action_area14);
  gtk_widget_show (dialog_action_area14);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area14), 10);

  hbox49 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox49);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "hbox49", hbox49,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox49);
  gtk_box_pack_start (GTK_BOX (dialog_action_area14), hbox49, TRUE, TRUE, 0);

  residue_info_ok_button = gtk_button_new_with_label (_("  Apply  "));
  gtk_widget_ref (residue_info_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "residue_info_ok_button", residue_info_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_info_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox49), residue_info_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (residue_info_ok_button, GTK_CAN_DEFAULT);

  residue_info_cancel_button = gtk_button_new_with_label (_("  Close  "));
  gtk_widget_ref (residue_info_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (residue_info_dialog), "residue_info_cancel_button", residue_info_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (residue_info_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox49), residue_info_cancel_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (residue_info_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (residue_info_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_residue_info_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_info_occ_apply_all_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_residue_info_occ_apply_all_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_info_b_factor_apply_all_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_residue_info_b_factor_apply_all_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_info_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_info_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (residue_info_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_residue_info_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_default (residue_info_ok_button);
  return residue_info_dialog;
}

GtkWidget*
create_hints_dialog (void)
{
  GtkWidget *hints_dialog;
  GtkWidget *dialog_vbox15;
  GtkWidget *scrolledwindow5;
  GtkWidget *hints_text;
  GtkWidget *dialog_action_area15;
  GtkWidget *hints_dialog_ok_button;

  hints_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (hints_dialog), "hints_dialog", hints_dialog);
  gtk_window_set_title (GTK_WINDOW (hints_dialog), _("Hints"));
  gtk_window_set_policy (GTK_WINDOW (hints_dialog), TRUE, TRUE, FALSE);

  dialog_vbox15 = GTK_DIALOG (hints_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (hints_dialog), "dialog_vbox15", dialog_vbox15);
  gtk_widget_show (dialog_vbox15);

  scrolledwindow5 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow5);
  gtk_object_set_data_full (GTK_OBJECT (hints_dialog), "scrolledwindow5", scrolledwindow5,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow5);
  gtk_box_pack_start (GTK_BOX (dialog_vbox15), scrolledwindow5, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (scrolledwindow5), 6);
  gtk_scrolled_window_set_policy (GTK_SCROLLED_WINDOW (scrolledwindow5), GTK_POLICY_NEVER, GTK_POLICY_ALWAYS);

  hints_text = gtk_text_new (NULL, NULL);
  gtk_widget_ref (hints_text);
  gtk_object_set_data_full (GTK_OBJECT (hints_dialog), "hints_text", hints_text,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hints_text);
  gtk_container_add (GTK_CONTAINER (scrolledwindow5), hints_text);
  gtk_widget_set_usize (hints_text, 376, 217);
  gtk_text_insert (GTK_TEXT (hints_text), NULL, NULL, NULL,
                   _("\nLeft-Mouse: Rotate View\nCtrl Left-Mouse Drag:  Moves around view\nShift Left-Mouse:  Label Atom\nRight-Mouse Drag: Zoom in and out\nMiddle-mouse: Centre on Atom\n\nKeyboard +/- changes contour level\n\nCtrl Left-mouse drag is how you \"Move the Pointer\" in Coot.\n\nNote that left-mouse does atom picking and rotating view, so try\nnot to click over an atom when trying to rotate the view when in\natom selection mode.\n\nIf you get stuck in \"translate\" mode, simply press and release\nthe Ctrl key to return to \"rotate\" mode.\n\nTo change the map to which the scrollwheel is attached, use\nHID->Scrollwhell->Attach Scrollwheel to which map?\n\nTo Use the \"Rotation/Translation\" column of buttons, simply \nclick on the button and drag (with the button still \"down\").\n\nUse the function \"(quanta-buttons)\" (or \"quanta_buttons()\") to \nmake the mouse functions more like other molecular graphics\nprograms to which you may be more accustomed.\n"), -1);

  dialog_action_area15 = GTK_DIALOG (hints_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (hints_dialog), "dialog_action_area15", dialog_action_area15);
  gtk_widget_show (dialog_action_area15);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area15), 10);

  hints_dialog_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (hints_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (hints_dialog), "hints_dialog_ok_button", hints_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hints_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area15), hints_dialog_ok_button, TRUE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (hints_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_hints_dialog_ok_button_clicked),
                      NULL);

  return hints_dialog;
}

GtkWidget*
create_rotamer_selection_dialog (void)
{
  GtkWidget *rotamer_selection_dialog;
  GtkWidget *dialog_vbox16;
  GtkWidget *vbox158;
  GtkWidget *scrolledwindow6;
  GtkWidget *viewport3;
  GtkWidget *rotamer_selection_button_vbox;
  GtkWidget *new_alt_conf_occ_frame;
  GtkWidget *new_alt_conf_occ_hscale;
  GtkWidget *dialog_action_area16;
  GtkWidget *hbox50;
  GtkWidget *rotamer_selection_ok_button;
  GtkWidget *rotamer_selection_cancel_button;

  rotamer_selection_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (rotamer_selection_dialog), "rotamer_selection_dialog", rotamer_selection_dialog);
  gtk_window_set_title (GTK_WINDOW (rotamer_selection_dialog), _("Select Rotamer"));
  gtk_window_set_policy (GTK_WINDOW (rotamer_selection_dialog), TRUE, TRUE, FALSE);

  dialog_vbox16 = GTK_DIALOG (rotamer_selection_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (rotamer_selection_dialog), "dialog_vbox16", dialog_vbox16);
  gtk_widget_show (dialog_vbox16);

  vbox158 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox158);
  gtk_object_set_data_full (GTK_OBJECT (rotamer_selection_dialog), "vbox158", vbox158,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox158);
  gtk_box_pack_start (GTK_BOX (dialog_vbox16), vbox158, TRUE, TRUE, 0);

  scrolledwindow6 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow6);
  gtk_object_set_data_full (GTK_OBJECT (rotamer_selection_dialog), "scrolledwindow6", scrolledwindow6,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow6);
  gtk_box_pack_start (GTK_BOX (vbox158), scrolledwindow6, TRUE, TRUE, 0);
  gtk_widget_set_usize (scrolledwindow6, 245, 170);

  viewport3 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport3);
  gtk_object_set_data_full (GTK_OBJECT (rotamer_selection_dialog), "viewport3", viewport3,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport3);
  gtk_container_add (GTK_CONTAINER (scrolledwindow6), viewport3);

  rotamer_selection_button_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (rotamer_selection_button_vbox);
  gtk_object_set_data_full (GTK_OBJECT (rotamer_selection_dialog), "rotamer_selection_button_vbox", rotamer_selection_button_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotamer_selection_button_vbox);
  gtk_container_add (GTK_CONTAINER (viewport3), rotamer_selection_button_vbox);
  gtk_container_set_border_width (GTK_CONTAINER (rotamer_selection_button_vbox), 2);

  new_alt_conf_occ_frame = gtk_frame_new (_("New Alt Conf Occupancy"));
  gtk_widget_ref (new_alt_conf_occ_frame);
  gtk_object_set_data_full (GTK_OBJECT (rotamer_selection_dialog), "new_alt_conf_occ_frame", new_alt_conf_occ_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (new_alt_conf_occ_frame);
  gtk_box_pack_start (GTK_BOX (vbox158), new_alt_conf_occ_frame, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (new_alt_conf_occ_frame), 6);

  new_alt_conf_occ_hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (new_alt_conf_occ_hscale);
  gtk_object_set_data_full (GTK_OBJECT (rotamer_selection_dialog), "new_alt_conf_occ_hscale", new_alt_conf_occ_hscale,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (new_alt_conf_occ_hscale);
  gtk_container_add (GTK_CONTAINER (new_alt_conf_occ_frame), new_alt_conf_occ_hscale);

  dialog_action_area16 = GTK_DIALOG (rotamer_selection_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (rotamer_selection_dialog), "dialog_action_area16", dialog_action_area16);
  gtk_widget_show (dialog_action_area16);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area16), 10);

  hbox50 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox50);
  gtk_object_set_data_full (GTK_OBJECT (rotamer_selection_dialog), "hbox50", hbox50,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox50);
  gtk_box_pack_start (GTK_BOX (dialog_action_area16), hbox50, TRUE, TRUE, 0);

  rotamer_selection_ok_button = gtk_button_new_with_label (_("  Accept  "));
  gtk_widget_ref (rotamer_selection_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (rotamer_selection_dialog), "rotamer_selection_ok_button", rotamer_selection_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotamer_selection_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox50), rotamer_selection_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (rotamer_selection_ok_button, GTK_CAN_DEFAULT);

  rotamer_selection_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (rotamer_selection_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (rotamer_selection_dialog), "rotamer_selection_cancel_button", rotamer_selection_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rotamer_selection_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox50), rotamer_selection_cancel_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (rotamer_selection_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (rotamer_selection_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_rotamer_selection_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (rotamer_selection_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_rotamer_selection_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (rotamer_selection_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_rotamer_selection_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (rotamer_selection_ok_button);
  gtk_widget_grab_default (rotamer_selection_ok_button);
  return rotamer_selection_dialog;
}

GtkWidget*
create_unsaved_changes_dialog (void)
{
  GtkWidget *unsaved_changes_dialog;
  GtkWidget *dialog_vbox17;
  GtkWidget *frame54;
  GtkWidget *vbox66;
  GtkWidget *label98;
  GtkWidget *unsaved_changes_molecule_vbox;
  GtkWidget *label99;
  GtkWidget *dialog_action_area17;
  GtkWidget *hbox51;
  GtkWidget *unsaved_changes_continue_button;
  GtkWidget *unsaved_changes_cancel_button;

  unsaved_changes_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (unsaved_changes_dialog), "unsaved_changes_dialog", unsaved_changes_dialog);
  gtk_window_set_title (GTK_WINDOW (unsaved_changes_dialog), _("dialog1"));
  gtk_window_set_policy (GTK_WINDOW (unsaved_changes_dialog), TRUE, TRUE, FALSE);

  dialog_vbox17 = GTK_DIALOG (unsaved_changes_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (unsaved_changes_dialog), "dialog_vbox17", dialog_vbox17);
  gtk_widget_show (dialog_vbox17);

  frame54 = gtk_frame_new (NULL);
  gtk_widget_ref (frame54);
  gtk_object_set_data_full (GTK_OBJECT (unsaved_changes_dialog), "frame54", frame54,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame54);
  gtk_box_pack_start (GTK_BOX (dialog_vbox17), frame54, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame54), 6);

  vbox66 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox66);
  gtk_object_set_data_full (GTK_OBJECT (unsaved_changes_dialog), "vbox66", vbox66,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox66);
  gtk_container_add (GTK_CONTAINER (frame54), vbox66);

  label98 = gtk_label_new (_("The following molecule(s) have unsaved changes:"));
  gtk_widget_ref (label98);
  gtk_object_set_data_full (GTK_OBJECT (unsaved_changes_dialog), "label98", label98,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label98);
  gtk_box_pack_start (GTK_BOX (vbox66), label98, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label98), 6, 6);

  unsaved_changes_molecule_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (unsaved_changes_molecule_vbox);
  gtk_object_set_data_full (GTK_OBJECT (unsaved_changes_dialog), "unsaved_changes_molecule_vbox", unsaved_changes_molecule_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (unsaved_changes_molecule_vbox);
  gtk_box_pack_start (GTK_BOX (vbox66), unsaved_changes_molecule_vbox, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (unsaved_changes_molecule_vbox), 6);

  label99 = gtk_label_new (_("Do you wish to Continue to Exit?"));
  gtk_widget_ref (label99);
  gtk_object_set_data_full (GTK_OBJECT (unsaved_changes_dialog), "label99", label99,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label99);
  gtk_box_pack_start (GTK_BOX (vbox66), label99, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label99), 6, 6);

  dialog_action_area17 = GTK_DIALOG (unsaved_changes_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (unsaved_changes_dialog), "dialog_action_area17", dialog_action_area17);
  gtk_widget_show (dialog_action_area17);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area17), 10);

  hbox51 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox51);
  gtk_object_set_data_full (GTK_OBJECT (unsaved_changes_dialog), "hbox51", hbox51,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox51);
  gtk_box_pack_start (GTK_BOX (dialog_action_area17), hbox51, TRUE, TRUE, 0);

  unsaved_changes_continue_button = gtk_button_new_with_label (_("Continue Exit"));
  gtk_widget_ref (unsaved_changes_continue_button);
  gtk_object_set_data_full (GTK_OBJECT (unsaved_changes_dialog), "unsaved_changes_continue_button", unsaved_changes_continue_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (unsaved_changes_continue_button);
  gtk_box_pack_start (GTK_BOX (hbox51), unsaved_changes_continue_button, TRUE, TRUE, 2);
  GTK_WIDGET_SET_FLAGS (unsaved_changes_continue_button, GTK_CAN_DEFAULT);

  unsaved_changes_cancel_button = gtk_button_new_with_label (_("Cancel"));
  gtk_widget_ref (unsaved_changes_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (unsaved_changes_dialog), "unsaved_changes_cancel_button", unsaved_changes_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (unsaved_changes_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox51), unsaved_changes_cancel_button, TRUE, TRUE, 2);
  GTK_WIDGET_SET_FLAGS (unsaved_changes_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (unsaved_changes_continue_button), "clicked",
                      GTK_SIGNAL_FUNC (on_unsaved_changes_continue_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (unsaved_changes_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_unsaved_changes_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (unsaved_changes_continue_button);
  gtk_widget_grab_default (unsaved_changes_continue_button);
  return unsaved_changes_dialog;
}

GtkWidget*
create_baton_dialog (void)
{
  GtkWidget *baton_dialog;
  GtkWidget *dialog_vbox18;
  GtkWidget *vbox69;
  GtkWidget *frame55;
  GtkWidget *vbox70;
  GtkWidget *label101;
  GtkWidget *frame57;
  GtkWidget *vbox72;
  GtkWidget *baton_accept_button;
  GtkWidget *baton_try_again_button;
  GtkWidget *baton_undo_button;
  GtkWidget *frame56;
  GtkWidget *vbox71;
  GtkWidget *label102;
  GtkWidget *frame58;
  GtkWidget *vbox73;
  GtkWidget *baton_lengthen_button;
  GtkWidget *baton_shorten_button;
  GtkWidget *dialog_action_area18;
  GtkWidget *baton_dialog_ok_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  baton_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (baton_dialog), "baton_dialog", baton_dialog);
  gtk_window_set_title (GTK_WINDOW (baton_dialog), _("Baton"));
  gtk_window_set_policy (GTK_WINDOW (baton_dialog), TRUE, TRUE, FALSE);

  dialog_vbox18 = GTK_DIALOG (baton_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (baton_dialog), "dialog_vbox18", dialog_vbox18);
  gtk_widget_show (dialog_vbox18);

  vbox69 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox69);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "vbox69", vbox69,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox69);
  gtk_box_pack_start (GTK_BOX (dialog_vbox18), vbox69, TRUE, TRUE, 0);
  gtk_widget_set_usize (vbox69, 155, -2);
  gtk_container_set_border_width (GTK_CONTAINER (vbox69), 6);

  frame55 = gtk_frame_new (NULL);
  gtk_widget_ref (frame55);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "frame55", frame55,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame55);
  gtk_box_pack_start (GTK_BOX (vbox69), frame55, TRUE, TRUE, 0);

  vbox70 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox70);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "vbox70", vbox70,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox70);
  gtk_container_add (GTK_CONTAINER (frame55), vbox70);
  gtk_container_set_border_width (GTK_CONTAINER (vbox70), 2);

  label101 = gtk_label_new (_("  Baton Position"));
  gtk_widget_ref (label101);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "label101", label101,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label101);
  gtk_box_pack_start (GTK_BOX (vbox70), label101, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label101), 0, 0.5);

  frame57 = gtk_frame_new (NULL);
  gtk_widget_ref (frame57);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "frame57", frame57,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame57);
  gtk_box_pack_start (GTK_BOX (vbox70), frame57, TRUE, TRUE, 0);

  vbox72 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox72);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "vbox72", vbox72,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox72);
  gtk_container_add (GTK_CONTAINER (frame57), vbox72);

  baton_accept_button = gtk_button_new_with_label (_("Accept"));
  gtk_widget_ref (baton_accept_button);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "baton_accept_button", baton_accept_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (baton_accept_button);
  gtk_box_pack_start (GTK_BOX (vbox72), baton_accept_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (baton_accept_button), 4);
  gtk_tooltips_set_tip (tooltips, baton_accept_button, _("Accept this baton tip position, place atom and try new one..."), NULL);

  baton_try_again_button = gtk_button_new_with_label (_("Try Another"));
  gtk_widget_ref (baton_try_again_button);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "baton_try_again_button", baton_try_again_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (baton_try_again_button);
  gtk_box_pack_start (GTK_BOX (vbox72), baton_try_again_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (baton_try_again_button), 4);
  gtk_tooltips_set_tip (tooltips, baton_try_again_button, _("Try Another Autoplacement Baton Position.  Cycles back to beginning"), NULL);

  baton_undo_button = gtk_button_new_with_label (_("Undo"));
  gtk_widget_ref (baton_undo_button);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "baton_undo_button", baton_undo_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (baton_undo_button);
  gtk_box_pack_start (GTK_BOX (vbox72), baton_undo_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (baton_undo_button), 4);

  frame56 = gtk_frame_new (NULL);
  gtk_widget_ref (frame56);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "frame56", frame56,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame56);
  gtk_box_pack_start (GTK_BOX (vbox69), frame56, TRUE, TRUE, 0);

  vbox71 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox71);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "vbox71", vbox71,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox71);
  gtk_container_add (GTK_CONTAINER (frame56), vbox71);

  label102 = gtk_label_new (_("  Baton Length"));
  gtk_widget_ref (label102);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "label102", label102,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label102);
  gtk_box_pack_start (GTK_BOX (vbox71), label102, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label102), 0, 0.5);

  frame58 = gtk_frame_new (NULL);
  gtk_widget_ref (frame58);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "frame58", frame58,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame58);
  gtk_box_pack_start (GTK_BOX (vbox71), frame58, TRUE, TRUE, 0);

  vbox73 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox73);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "vbox73", vbox73,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox73);
  gtk_container_add (GTK_CONTAINER (frame58), vbox73);

  baton_lengthen_button = gtk_button_new_with_label (_("  Lengthen  "));
  gtk_widget_ref (baton_lengthen_button);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "baton_lengthen_button", baton_lengthen_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (baton_lengthen_button);
  gtk_box_pack_start (GTK_BOX (vbox73), baton_lengthen_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (baton_lengthen_button), 4);

  baton_shorten_button = gtk_button_new_with_label (_("Shorten"));
  gtk_widget_ref (baton_shorten_button);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "baton_shorten_button", baton_shorten_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (baton_shorten_button);
  gtk_box_pack_start (GTK_BOX (vbox73), baton_shorten_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (baton_shorten_button), 5);

  dialog_action_area18 = GTK_DIALOG (baton_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (baton_dialog), "dialog_action_area18", dialog_action_area18);
  gtk_widget_show (dialog_action_area18);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area18), 10);

  baton_dialog_ok_button = gtk_button_new_with_label (_("  Dismiss  "));
  gtk_widget_ref (baton_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (baton_dialog), "baton_dialog_ok_button", baton_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (baton_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area18), baton_dialog_ok_button, TRUE, TRUE, 0);
  gtk_tooltips_set_tip (tooltips, baton_dialog_ok_button, _("Exits Baton Mode"), NULL);

  gtk_signal_connect (GTK_OBJECT (baton_accept_button), "clicked",
                      GTK_SIGNAL_FUNC (on_baton_accept_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (baton_try_again_button), "clicked",
                      GTK_SIGNAL_FUNC (on_baton_try_again_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (baton_undo_button), "clicked",
                      GTK_SIGNAL_FUNC (on_baton_undo_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (baton_lengthen_button), "clicked",
                      GTK_SIGNAL_FUNC (on_baton_lengthen_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (baton_shorten_button), "clicked",
                      GTK_SIGNAL_FUNC (on_baton_shorten_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (baton_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_baton_dialog_ok_button_clicked),
                      NULL);

  gtk_object_set_data (GTK_OBJECT (baton_dialog), "tooltips", tooltips);

  return baton_dialog;
}

GtkWidget*
create_read_pdb_recentre_dialog (void)
{
  GtkWidget *read_pdb_recentre_dialog;
  GtkWidget *dialog_vbox20;
  GtkWidget *vbox75;
  GtkWidget *label103;
  GtkWidget *frame60;
  GtkWidget *vbox76;
  GSList *recentre_group = NULL;
  GtkWidget *read_pdb_recentre_yes_radiobutton;
  GtkWidget *read_pdb_recentre_no_radiobutton;
  GtkWidget *dialog_action_area20;
  GtkWidget *read_pdb_recentre_dialog_ok_button;

  read_pdb_recentre_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (read_pdb_recentre_dialog), "read_pdb_recentre_dialog", read_pdb_recentre_dialog);
  gtk_window_set_title (GTK_WINDOW (read_pdb_recentre_dialog), _("Recentre Dialog"));
  gtk_window_set_policy (GTK_WINDOW (read_pdb_recentre_dialog), TRUE, TRUE, FALSE);

  dialog_vbox20 = GTK_DIALOG (read_pdb_recentre_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (read_pdb_recentre_dialog), "dialog_vbox20", dialog_vbox20);
  gtk_widget_show (dialog_vbox20);

  vbox75 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox75);
  gtk_object_set_data_full (GTK_OBJECT (read_pdb_recentre_dialog), "vbox75", vbox75,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox75);
  gtk_box_pack_start (GTK_BOX (dialog_vbox20), vbox75, TRUE, TRUE, 0);

  label103 = gtk_label_new (_("Recentre on read new PDB?"));
  gtk_widget_ref (label103);
  gtk_object_set_data_full (GTK_OBJECT (read_pdb_recentre_dialog), "label103", label103,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label103);
  gtk_box_pack_start (GTK_BOX (vbox75), label103, FALSE, FALSE, 5);
  gtk_misc_set_padding (GTK_MISC (label103), 10, 0);

  frame60 = gtk_frame_new (NULL);
  gtk_widget_ref (frame60);
  gtk_object_set_data_full (GTK_OBJECT (read_pdb_recentre_dialog), "frame60", frame60,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame60);
  gtk_box_pack_start (GTK_BOX (vbox75), frame60, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame60), 6);

  vbox76 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox76);
  gtk_object_set_data_full (GTK_OBJECT (read_pdb_recentre_dialog), "vbox76", vbox76,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox76);
  gtk_container_add (GTK_CONTAINER (frame60), vbox76);

  read_pdb_recentre_yes_radiobutton = gtk_radio_button_new_with_label (recentre_group, _("  Yes  "));
  recentre_group = gtk_radio_button_group (GTK_RADIO_BUTTON (read_pdb_recentre_yes_radiobutton));
  gtk_widget_ref (read_pdb_recentre_yes_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (read_pdb_recentre_dialog), "read_pdb_recentre_yes_radiobutton", read_pdb_recentre_yes_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (read_pdb_recentre_yes_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox76), read_pdb_recentre_yes_radiobutton, FALSE, FALSE, 0);

  read_pdb_recentre_no_radiobutton = gtk_radio_button_new_with_label (recentre_group, _("  No  "));
  recentre_group = gtk_radio_button_group (GTK_RADIO_BUTTON (read_pdb_recentre_no_radiobutton));
  gtk_widget_ref (read_pdb_recentre_no_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (read_pdb_recentre_dialog), "read_pdb_recentre_no_radiobutton", read_pdb_recentre_no_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (read_pdb_recentre_no_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox76), read_pdb_recentre_no_radiobutton, FALSE, FALSE, 0);

  dialog_action_area20 = GTK_DIALOG (read_pdb_recentre_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (read_pdb_recentre_dialog), "dialog_action_area20", dialog_action_area20);
  gtk_widget_show (dialog_action_area20);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area20), 10);

  read_pdb_recentre_dialog_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (read_pdb_recentre_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (read_pdb_recentre_dialog), "read_pdb_recentre_dialog_ok_button", read_pdb_recentre_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (read_pdb_recentre_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area20), read_pdb_recentre_dialog_ok_button, TRUE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (read_pdb_recentre_yes_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_read_pdb_recentre_yes_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (read_pdb_recentre_no_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_read_pdb_recentre_no_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (read_pdb_recentre_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_read_pdb_recentre_dialog_ok_button_clicked),
                      NULL);

  return read_pdb_recentre_dialog;
}

GtkWidget*
create_pointer_atom_type_dialog (void)
{
  GtkWidget *pointer_atom_type_dialog;
  GtkWidget *dialog_vbox21;
  GtkWidget *vbox77;
  GtkWidget *label104;
  GtkWidget *frame61;
  GtkWidget *vbox78;
  GSList *pointer_atom_group = NULL;
  GtkWidget *pointer_atom_type_radiobutton_water;
  GtkWidget *pointer_atom_type_radiobutton_ca;
  GtkWidget *pointer_atom_type_radiobutton_mg;
  GtkWidget *pointer_atom_type_radiobutton_na;
  GtkWidget *pointer_atom_type_radiobutton_cl;
  GtkWidget *pointer_atom_type_radiobutton_br;
  GtkWidget *pointer_atom_type_radiobutton_so4;
  GtkWidget *pointer_atom_type_radiobutton_po4;
  GtkWidget *frame81;
  GtkWidget *hbox70;
  GtkWidget *pointer_atom_type_other_button;
  GtkWidget *pointer_atom_type_other_entry;
  GtkWidget *frame80;
  GtkWidget *pointer_atom_molecule_optionmenu;
  GtkWidget *pointer_atom_molecule_optionmenu_menu;
  GtkWidget *dialog_action_area21;
  GtkWidget *hbox52;
  GtkWidget *pointer_atom_type_ok_button;
  GtkWidget *pointer_atom_type_cancel_button;

  pointer_atom_type_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_type_dialog", pointer_atom_type_dialog);
  gtk_window_set_title (GTK_WINDOW (pointer_atom_type_dialog), _("Pointer atom type"));
  gtk_window_set_policy (GTK_WINDOW (pointer_atom_type_dialog), TRUE, TRUE, FALSE);

  dialog_vbox21 = GTK_DIALOG (pointer_atom_type_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (pointer_atom_type_dialog), "dialog_vbox21", dialog_vbox21);
  gtk_widget_show (dialog_vbox21);

  vbox77 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox77);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "vbox77", vbox77,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox77);
  gtk_box_pack_start (GTK_BOX (dialog_vbox21), vbox77, TRUE, TRUE, 0);

  label104 = gtk_label_new (_("Pointer Atom Type:"));
  gtk_widget_ref (label104);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "label104", label104,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label104);
  gtk_box_pack_start (GTK_BOX (vbox77), label104, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label104), 0, 10);

  frame61 = gtk_frame_new (NULL);
  gtk_widget_ref (frame61);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "frame61", frame61,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame61);
  gtk_box_pack_start (GTK_BOX (vbox77), frame61, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame61), 6);

  vbox78 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox78);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "vbox78", vbox78,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox78);
  gtk_container_add (GTK_CONTAINER (frame61), vbox78);

  pointer_atom_type_radiobutton_water = gtk_radio_button_new_with_label (pointer_atom_group, _("Water"));
  pointer_atom_group = gtk_radio_button_group (GTK_RADIO_BUTTON (pointer_atom_type_radiobutton_water));
  gtk_widget_ref (pointer_atom_type_radiobutton_water);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_type_radiobutton_water", pointer_atom_type_radiobutton_water,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_atom_type_radiobutton_water);
  gtk_box_pack_start (GTK_BOX (vbox78), pointer_atom_type_radiobutton_water, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (pointer_atom_type_radiobutton_water), TRUE);

  pointer_atom_type_radiobutton_ca = gtk_radio_button_new_with_label (pointer_atom_group, _("Ca (calcium)"));
  pointer_atom_group = gtk_radio_button_group (GTK_RADIO_BUTTON (pointer_atom_type_radiobutton_ca));
  gtk_widget_ref (pointer_atom_type_radiobutton_ca);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_type_radiobutton_ca", pointer_atom_type_radiobutton_ca,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_atom_type_radiobutton_ca);
  gtk_box_pack_start (GTK_BOX (vbox78), pointer_atom_type_radiobutton_ca, FALSE, FALSE, 0);

  pointer_atom_type_radiobutton_mg = gtk_radio_button_new_with_label (pointer_atom_group, _("Mg"));
  pointer_atom_group = gtk_radio_button_group (GTK_RADIO_BUTTON (pointer_atom_type_radiobutton_mg));
  gtk_widget_ref (pointer_atom_type_radiobutton_mg);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_type_radiobutton_mg", pointer_atom_type_radiobutton_mg,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_atom_type_radiobutton_mg);
  gtk_box_pack_start (GTK_BOX (vbox78), pointer_atom_type_radiobutton_mg, FALSE, FALSE, 0);

  pointer_atom_type_radiobutton_na = gtk_radio_button_new_with_label (pointer_atom_group, _("Na"));
  pointer_atom_group = gtk_radio_button_group (GTK_RADIO_BUTTON (pointer_atom_type_radiobutton_na));
  gtk_widget_ref (pointer_atom_type_radiobutton_na);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_type_radiobutton_na", pointer_atom_type_radiobutton_na,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_atom_type_radiobutton_na);
  gtk_box_pack_start (GTK_BOX (vbox78), pointer_atom_type_radiobutton_na, FALSE, FALSE, 0);

  pointer_atom_type_radiobutton_cl = gtk_radio_button_new_with_label (pointer_atom_group, _("Cl"));
  pointer_atom_group = gtk_radio_button_group (GTK_RADIO_BUTTON (pointer_atom_type_radiobutton_cl));
  gtk_widget_ref (pointer_atom_type_radiobutton_cl);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_type_radiobutton_cl", pointer_atom_type_radiobutton_cl,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_atom_type_radiobutton_cl);
  gtk_box_pack_start (GTK_BOX (vbox78), pointer_atom_type_radiobutton_cl, FALSE, FALSE, 0);

  pointer_atom_type_radiobutton_br = gtk_radio_button_new_with_label (pointer_atom_group, _("Br"));
  pointer_atom_group = gtk_radio_button_group (GTK_RADIO_BUTTON (pointer_atom_type_radiobutton_br));
  gtk_widget_ref (pointer_atom_type_radiobutton_br);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_type_radiobutton_br", pointer_atom_type_radiobutton_br,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_atom_type_radiobutton_br);
  gtk_box_pack_start (GTK_BOX (vbox78), pointer_atom_type_radiobutton_br, FALSE, FALSE, 0);

  pointer_atom_type_radiobutton_so4 = gtk_radio_button_new_with_label (pointer_atom_group, _("SO4"));
  pointer_atom_group = gtk_radio_button_group (GTK_RADIO_BUTTON (pointer_atom_type_radiobutton_so4));
  gtk_widget_ref (pointer_atom_type_radiobutton_so4);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_type_radiobutton_so4", pointer_atom_type_radiobutton_so4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_atom_type_radiobutton_so4);
  gtk_box_pack_start (GTK_BOX (vbox78), pointer_atom_type_radiobutton_so4, FALSE, FALSE, 0);

  pointer_atom_type_radiobutton_po4 = gtk_radio_button_new_with_label (pointer_atom_group, _("PO4"));
  pointer_atom_group = gtk_radio_button_group (GTK_RADIO_BUTTON (pointer_atom_type_radiobutton_po4));
  gtk_widget_ref (pointer_atom_type_radiobutton_po4);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_type_radiobutton_po4", pointer_atom_type_radiobutton_po4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_atom_type_radiobutton_po4);
  gtk_box_pack_start (GTK_BOX (vbox78), pointer_atom_type_radiobutton_po4, FALSE, FALSE, 0);

  frame81 = gtk_frame_new ("");
  gtk_widget_ref (frame81);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "frame81", frame81,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame81);
  gtk_box_pack_start (GTK_BOX (vbox78), frame81, TRUE, TRUE, 0);

  hbox70 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox70);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "hbox70", hbox70,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox70);
  gtk_container_add (GTK_CONTAINER (frame81), hbox70);

  pointer_atom_type_other_button = gtk_button_new_with_label (_("Other..."));
  gtk_widget_ref (pointer_atom_type_other_button);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_type_other_button", pointer_atom_type_other_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_atom_type_other_button);
  gtk_box_pack_start (GTK_BOX (hbox70), pointer_atom_type_other_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (pointer_atom_type_other_button), 2);

  pointer_atom_type_other_entry = gtk_entry_new ();
  gtk_widget_ref (pointer_atom_type_other_entry);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_type_other_entry", pointer_atom_type_other_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_atom_type_other_entry);
  gtk_box_pack_start (GTK_BOX (hbox70), pointer_atom_type_other_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (pointer_atom_type_other_entry, 32, -2);
  gtk_widget_set_sensitive (pointer_atom_type_other_entry, FALSE);

  frame80 = gtk_frame_new (_("Pointer Atom Added to Molecule:"));
  gtk_widget_ref (frame80);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "frame80", frame80,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame80);
  gtk_box_pack_start (GTK_BOX (vbox77), frame80, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame80), 6);

  pointer_atom_molecule_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (pointer_atom_molecule_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_molecule_optionmenu", pointer_atom_molecule_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_atom_molecule_optionmenu);
  gtk_container_add (GTK_CONTAINER (frame80), pointer_atom_molecule_optionmenu);
  pointer_atom_molecule_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (pointer_atom_molecule_optionmenu), pointer_atom_molecule_optionmenu_menu);

  dialog_action_area21 = GTK_DIALOG (pointer_atom_type_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (pointer_atom_type_dialog), "dialog_action_area21", dialog_action_area21);
  gtk_widget_show (dialog_action_area21);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area21), 10);

  hbox52 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox52);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "hbox52", hbox52,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox52);
  gtk_box_pack_start (GTK_BOX (dialog_action_area21), hbox52, TRUE, TRUE, 0);

  pointer_atom_type_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (pointer_atom_type_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_type_ok_button", pointer_atom_type_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_atom_type_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox52), pointer_atom_type_ok_button, TRUE, TRUE, 2);

  pointer_atom_type_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (pointer_atom_type_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (pointer_atom_type_dialog), "pointer_atom_type_cancel_button", pointer_atom_type_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_atom_type_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox52), pointer_atom_type_cancel_button, TRUE, TRUE, 2);

  gtk_signal_connect (GTK_OBJECT (pointer_atom_type_other_button), "clicked",
                      GTK_SIGNAL_FUNC (on_pointer_atom_type_other_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (pointer_atom_type_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_pointer_atom_type_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (pointer_atom_type_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_pointer_atom_type_cancel_button_clicked),
                      NULL);

  return pointer_atom_type_dialog;
}

GtkWidget*
create_run_refmac_dialog (void)
{
  GtkWidget *run_refmac_dialog;
  GtkWidget *dialog_vbox22;
  GtkWidget *vbox81;
  GtkWidget *label109;
  GtkWidget *frame64;
  GtkWidget *run_refmac_coords_optionmenu;
  GtkWidget *run_refmac_coords_optionmenu_menu;
  GtkWidget *hseparator4;
  GtkWidget *label110;
  GtkWidget *frame65;
  GtkWidget *hbox69;
  GtkWidget *run_refmac_map_optionmenu;
  GtkWidget *run_refmac_map_optionmenu_menu;
  GtkWidget *label130;
  GtkWidget *run_refmac_help_button;
  GtkWidget *frame68;
  GtkWidget *run_refmac_diff_map_checkbutton;
  GtkWidget *frame69;
  GtkWidget *run_refmac_phase_combine_checkbutton;
  GtkWidget *frame87;
  GtkWidget *run_refmac_ccp4i_optionmenu;
  GtkWidget *run_refmac_ccp4i_optionmenu_menu;
  GtkWidget *dialog_action_area22;
  GtkWidget *hbox56;
  GtkWidget *run_refmac_run_button;
  GtkWidget *run_refmac_cancel_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  run_refmac_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (run_refmac_dialog), "run_refmac_dialog", run_refmac_dialog);
  gtk_window_set_title (GTK_WINDOW (run_refmac_dialog), _("Run Refmac"));
  gtk_window_set_policy (GTK_WINDOW (run_refmac_dialog), TRUE, TRUE, FALSE);

  dialog_vbox22 = GTK_DIALOG (run_refmac_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (run_refmac_dialog), "dialog_vbox22", dialog_vbox22);
  gtk_widget_show (dialog_vbox22);

  vbox81 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox81);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "vbox81", vbox81,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox81);
  gtk_box_pack_start (GTK_BOX (dialog_vbox22), vbox81, TRUE, TRUE, 0);

  label109 = gtk_label_new (_("Choose Coordinates Molecule on which to run refmac:"));
  gtk_widget_ref (label109);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "label109", label109,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label109);
  gtk_box_pack_start (GTK_BOX (vbox81), label109, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label109), 6, 8);

  frame64 = gtk_frame_new (NULL);
  gtk_widget_ref (frame64);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "frame64", frame64,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame64);
  gtk_box_pack_start (GTK_BOX (vbox81), frame64, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame64), 2);

  run_refmac_coords_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (run_refmac_coords_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "run_refmac_coords_optionmenu", run_refmac_coords_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (run_refmac_coords_optionmenu);
  gtk_container_add (GTK_CONTAINER (frame64), run_refmac_coords_optionmenu);
  run_refmac_coords_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (run_refmac_coords_optionmenu), run_refmac_coords_optionmenu_menu);

  hseparator4 = gtk_hseparator_new ();
  gtk_widget_ref (hseparator4);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "hseparator4", hseparator4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hseparator4);
  gtk_box_pack_start (GTK_BOX (vbox81), hseparator4, TRUE, TRUE, 0);

  label110 = gtk_label_new (_("Choose Map Molecule that has mtz column labels for refmac:"));
  gtk_widget_ref (label110);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "label110", label110,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label110);
  gtk_box_pack_start (GTK_BOX (vbox81), label110, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label110), 6, 0);

  frame65 = gtk_frame_new (NULL);
  gtk_widget_ref (frame65);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "frame65", frame65,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame65);
  gtk_box_pack_start (GTK_BOX (vbox81), frame65, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame65), 2);

  hbox69 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox69);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "hbox69", hbox69,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox69);
  gtk_container_add (GTK_CONTAINER (frame65), hbox69);

  run_refmac_map_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (run_refmac_map_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "run_refmac_map_optionmenu", run_refmac_map_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (run_refmac_map_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox69), run_refmac_map_optionmenu, FALSE, FALSE, 0);
  run_refmac_map_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (run_refmac_map_optionmenu), run_refmac_map_optionmenu_menu);

  label130 = gtk_label_new (_("    "));
  gtk_widget_ref (label130);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "label130", label130,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label130);
  gtk_box_pack_start (GTK_BOX (hbox69), label130, FALSE, FALSE, 0);

  run_refmac_help_button = gtk_button_new_with_label (_("  Help  "));
  gtk_widget_ref (run_refmac_help_button);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "run_refmac_help_button", run_refmac_help_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (run_refmac_help_button);
  gtk_box_pack_start (GTK_BOX (hbox69), run_refmac_help_button, FALSE, FALSE, 2);

  frame68 = gtk_frame_new (NULL);
  gtk_widget_ref (frame68);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "frame68", frame68,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame68);
  gtk_box_pack_start (GTK_BOX (vbox81), frame68, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame68), 2);

  run_refmac_diff_map_checkbutton = gtk_check_button_new_with_label (_("Display the resulting difference map also"));
  gtk_widget_ref (run_refmac_diff_map_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "run_refmac_diff_map_checkbutton", run_refmac_diff_map_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (run_refmac_diff_map_checkbutton);
  gtk_container_add (GTK_CONTAINER (frame68), run_refmac_diff_map_checkbutton);
  gtk_container_set_border_width (GTK_CONTAINER (run_refmac_diff_map_checkbutton), 3);

  frame69 = gtk_frame_new (NULL);
  gtk_widget_ref (frame69);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "frame69", frame69,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame69);
  gtk_box_pack_start (GTK_BOX (vbox81), frame69, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame69), 2);

  run_refmac_phase_combine_checkbutton = gtk_check_button_new_with_label (_("Refmac Phase Combine with Phases used for Map"));
  gtk_widget_ref (run_refmac_phase_combine_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "run_refmac_phase_combine_checkbutton", run_refmac_phase_combine_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (run_refmac_phase_combine_checkbutton);
  gtk_container_add (GTK_CONTAINER (frame69), run_refmac_phase_combine_checkbutton);
  gtk_container_set_border_width (GTK_CONTAINER (run_refmac_phase_combine_checkbutton), 3);
  gtk_tooltips_set_tip (tooltips, run_refmac_phase_combine_checkbutton, _("When using MAD/MIR etc phasing, you can combine the experimental phases (i.e. the \"Phases used for Map\") and the phases derived from the model, thereby (hopefully) improving the map..."), NULL);

  frame87 = gtk_frame_new (_("CCP4i Project"));
  gtk_widget_ref (frame87);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "frame87", frame87,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame87);
  gtk_box_pack_start (GTK_BOX (vbox81), frame87, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame87), 4);

  run_refmac_ccp4i_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (run_refmac_ccp4i_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "run_refmac_ccp4i_optionmenu", run_refmac_ccp4i_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (run_refmac_ccp4i_optionmenu);
  gtk_container_add (GTK_CONTAINER (frame87), run_refmac_ccp4i_optionmenu);
  run_refmac_ccp4i_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (run_refmac_ccp4i_optionmenu), run_refmac_ccp4i_optionmenu_menu);

  dialog_action_area22 = GTK_DIALOG (run_refmac_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (run_refmac_dialog), "dialog_action_area22", dialog_action_area22);
  gtk_widget_show (dialog_action_area22);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area22), 10);

  hbox56 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox56);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "hbox56", hbox56,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox56);
  gtk_box_pack_start (GTK_BOX (dialog_action_area22), hbox56, TRUE, TRUE, 0);

  run_refmac_run_button = gtk_button_new_with_label (_("  Run Refmac  "));
  gtk_widget_ref (run_refmac_run_button);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "run_refmac_run_button", run_refmac_run_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (run_refmac_run_button);
  gtk_box_pack_start (GTK_BOX (hbox56), run_refmac_run_button, TRUE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, run_refmac_run_button, _("Please be patient (sit back and wait...)"), NULL);

  run_refmac_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (run_refmac_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_dialog), "run_refmac_cancel_button", run_refmac_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (run_refmac_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox56), run_refmac_cancel_button, TRUE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (run_refmac_help_button), "clicked",
                      GTK_SIGNAL_FUNC (on_run_refmac_help_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (run_refmac_diff_map_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_run_refmac_diff_map_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (run_refmac_phase_combine_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_run_refmac_phase_combine_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (run_refmac_run_button), "clicked",
                      GTK_SIGNAL_FUNC (on_run_refmac_run_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (run_refmac_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_run_refmac_cancel_button_clicked),
                      NULL);

  gtk_object_set_data (GTK_OBJECT (run_refmac_dialog), "tooltips", tooltips);

  return run_refmac_dialog;
}

GtkWidget*
create_single_map_properties_dialog (void)
{
  GtkWidget *single_map_properties_dialog;
  GtkWidget *dialog_vbox23;
  GtkWidget *vbox82;
  GtkWidget *label115;
  GtkWidget *frame102;
  GtkWidget *vbox110;
  GtkWidget *label163;
  GtkWidget *single_map_properties_cell_text;
  GtkWidget *label165;
  GtkWidget *single_map_properties_sg_text;
  GtkWidget *frame103;
  GtkWidget *table1;
  GtkWidget *label167;
  GtkWidget *label168;
  GtkWidget *single_map_sigma_checkbutton;
  GtkWidget *single_map_sigma_step_entry;
  GtkWidget *frame104;
  GtkWidget *hbox84;
  GtkWidget *label169;
  GtkWidget *single_map_properties_colour_button;
  GtkWidget *single_map_colour_button_frame;
  GtkWidget *label114;
  GtkWidget *single_map_skeleton_frame;
  GtkWidget *vbox86;
  GSList *single_map_skeleton_group = NULL;
  GtkWidget *single_map_skeleton_on_radiobutton;
  GtkWidget *single_map_skeleton_off_radiobutton;
  GtkWidget *dialog_action_area23;
  GtkWidget *hbox58;
  GtkWidget *single_map_properties_ok_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  single_map_properties_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (single_map_properties_dialog), "single_map_properties_dialog", single_map_properties_dialog);
  gtk_window_set_title (GTK_WINDOW (single_map_properties_dialog), _("Individual Map Properties"));
  gtk_window_set_policy (GTK_WINDOW (single_map_properties_dialog), TRUE, TRUE, FALSE);

  dialog_vbox23 = GTK_DIALOG (single_map_properties_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (single_map_properties_dialog), "dialog_vbox23", dialog_vbox23);
  gtk_widget_show (dialog_vbox23);

  vbox82 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox82);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "vbox82", vbox82,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox82);
  gtk_box_pack_start (GTK_BOX (dialog_vbox23), vbox82, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (vbox82), 2);

  label115 = gtk_label_new (_("Map Settings"));
  gtk_widget_ref (label115);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "label115", label115,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label115);
  gtk_box_pack_start (GTK_BOX (vbox82), label115, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label115), 2, 6);

  frame102 = gtk_frame_new (_("Cell and Symmetry:"));
  gtk_widget_ref (frame102);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "frame102", frame102,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame102);
  gtk_box_pack_start (GTK_BOX (vbox82), frame102, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame102), 6);

  vbox110 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox110);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "vbox110", vbox110,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox110);
  gtk_container_add (GTK_CONTAINER (frame102), vbox110);

  label163 = gtk_label_new (_("Cell:"));
  gtk_widget_ref (label163);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "label163", label163,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label163);
  gtk_box_pack_start (GTK_BOX (vbox110), label163, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label163), 0, 0.5);
  gtk_misc_set_padding (GTK_MISC (label163), 0, 2);

  single_map_properties_cell_text = gtk_label_new (_("[map]"));
  gtk_widget_ref (single_map_properties_cell_text);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "single_map_properties_cell_text", single_map_properties_cell_text,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (single_map_properties_cell_text);
  gtk_box_pack_start (GTK_BOX (vbox110), single_map_properties_cell_text, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (single_map_properties_cell_text), 0, 0.5);

  label165 = gtk_label_new (_("Spacegroup:"));
  gtk_widget_ref (label165);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "label165", label165,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label165);
  gtk_box_pack_start (GTK_BOX (vbox110), label165, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label165), 7.45058e-09, 0.5);
  gtk_misc_set_padding (GTK_MISC (label165), 0, 2);

  single_map_properties_sg_text = gtk_label_new (_("[spacegroup]"));
  gtk_widget_ref (single_map_properties_sg_text);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "single_map_properties_sg_text", single_map_properties_sg_text,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (single_map_properties_sg_text);
  gtk_box_pack_start (GTK_BOX (vbox110), single_map_properties_sg_text, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (single_map_properties_sg_text), 7.45058e-09, 0.5);

  frame103 = gtk_frame_new (_("Contouring:"));
  gtk_widget_ref (frame103);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "frame103", frame103,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame103);
  gtk_box_pack_start (GTK_BOX (vbox82), frame103, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame103), 6);

  table1 = gtk_table_new (2, 2, FALSE);
  gtk_widget_ref (table1);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "table1", table1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (table1);
  gtk_container_add (GTK_CONTAINER (frame103), table1);
  gtk_container_set_border_width (GTK_CONTAINER (table1), 4);

  label167 = gtk_label_new ("");
  gtk_widget_ref (label167);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "label167", label167,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label167);
  gtk_table_attach (GTK_TABLE (table1), label167, 0, 1, 0, 1,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_misc_set_alignment (GTK_MISC (label167), 0, 0.5);

  label168 = gtk_label_new (_("  Sigma Step  "));
  gtk_widget_ref (label168);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "label168", label168,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label168);
  gtk_table_attach (GTK_TABLE (table1), label168, 1, 2, 0, 1,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_misc_set_alignment (GTK_MISC (label168), 0, 0.5);

  single_map_sigma_checkbutton = gtk_check_button_new_with_label (_("Change by sigma? "));
  gtk_widget_ref (single_map_sigma_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "single_map_sigma_checkbutton", single_map_sigma_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (single_map_sigma_checkbutton);
  gtk_table_attach (GTK_TABLE (table1), single_map_sigma_checkbutton, 0, 1, 1, 2,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_tooltips_set_tip (tooltips, single_map_sigma_checkbutton, _("By default, maps are contoured by fixed e/A3 units.  Setting this allows you to contour using sigma step instead.  This is useful for unusual maps - such as E-maps and maps synthesised from structure factors far off the absolute scale."), NULL);

  single_map_sigma_step_entry = gtk_entry_new ();
  gtk_widget_ref (single_map_sigma_step_entry);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "single_map_sigma_step_entry", single_map_sigma_step_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (single_map_sigma_step_entry);
  gtk_table_attach (GTK_TABLE (table1), single_map_sigma_step_entry, 1, 2, 1, 2,
                    (GtkAttachOptions) (0),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_widget_set_usize (single_map_sigma_step_entry, 99, -2);

  frame104 = gtk_frame_new (NULL);
  gtk_widget_ref (frame104);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "frame104", frame104,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame104);
  gtk_box_pack_start (GTK_BOX (vbox82), frame104, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame104), 6);

  hbox84 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox84);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "hbox84", hbox84,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox84);
  gtk_container_add (GTK_CONTAINER (frame104), hbox84);
  gtk_container_set_border_width (GTK_CONTAINER (hbox84), 6);

  label169 = gtk_label_new (_("Map Colour "));
  gtk_widget_ref (label169);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "label169", label169,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label169);
  gtk_box_pack_start (GTK_BOX (hbox84), label169, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label169), 7, 0);

  single_map_properties_colour_button = gtk_button_new ();
  gtk_widget_ref (single_map_properties_colour_button);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "single_map_properties_colour_button", single_map_properties_colour_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (single_map_properties_colour_button);
  gtk_box_pack_start (GTK_BOX (hbox84), single_map_properties_colour_button, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, single_map_properties_colour_button, _("See Section 6.5 of the User Manual for default Difference Map colouring."), NULL);

  single_map_colour_button_frame = gtk_frame_new (NULL);
  gtk_widget_ref (single_map_colour_button_frame);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "single_map_colour_button_frame", single_map_colour_button_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (single_map_colour_button_frame);
  gtk_container_add (GTK_CONTAINER (single_map_properties_colour_button), single_map_colour_button_frame);

  label114 = gtk_label_new (_("  Colour  "));
  gtk_widget_ref (label114);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "label114", label114,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label114);
  gtk_container_add (GTK_CONTAINER (single_map_colour_button_frame), label114);

  single_map_skeleton_frame = gtk_frame_new (_("Skeleton:"));
  gtk_widget_ref (single_map_skeleton_frame);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "single_map_skeleton_frame", single_map_skeleton_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (single_map_skeleton_frame);
  gtk_box_pack_start (GTK_BOX (vbox82), single_map_skeleton_frame, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (single_map_skeleton_frame), 6);

  vbox86 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox86);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "vbox86", vbox86,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox86);
  gtk_container_add (GTK_CONTAINER (single_map_skeleton_frame), vbox86);

  single_map_skeleton_on_radiobutton = gtk_radio_button_new_with_label (single_map_skeleton_group, _("On"));
  single_map_skeleton_group = gtk_radio_button_group (GTK_RADIO_BUTTON (single_map_skeleton_on_radiobutton));
  gtk_widget_ref (single_map_skeleton_on_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "single_map_skeleton_on_radiobutton", single_map_skeleton_on_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (single_map_skeleton_on_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox86), single_map_skeleton_on_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (single_map_skeleton_on_radiobutton), 4);

  single_map_skeleton_off_radiobutton = gtk_radio_button_new_with_label (single_map_skeleton_group, _("Off"));
  single_map_skeleton_group = gtk_radio_button_group (GTK_RADIO_BUTTON (single_map_skeleton_off_radiobutton));
  gtk_widget_ref (single_map_skeleton_off_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "single_map_skeleton_off_radiobutton", single_map_skeleton_off_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (single_map_skeleton_off_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox86), single_map_skeleton_off_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (single_map_skeleton_off_radiobutton), 4);

  dialog_action_area23 = GTK_DIALOG (single_map_properties_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (single_map_properties_dialog), "dialog_action_area23", dialog_action_area23);
  gtk_widget_show (dialog_action_area23);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area23), 10);

  hbox58 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox58);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "hbox58", hbox58,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox58);
  gtk_box_pack_start (GTK_BOX (dialog_action_area23), hbox58, TRUE, TRUE, 0);

  single_map_properties_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (single_map_properties_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (single_map_properties_dialog), "single_map_properties_ok_button", single_map_properties_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (single_map_properties_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox58), single_map_properties_ok_button, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (single_map_properties_ok_button), 6);
  GTK_WIDGET_SET_FLAGS (single_map_properties_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (single_map_sigma_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_single_map_sigma_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (single_map_properties_colour_button), "clicked",
                      GTK_SIGNAL_FUNC (on_single_map_properties_colour_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (single_map_properties_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_single_map_properties_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (single_map_properties_ok_button);
  gtk_widget_grab_default (single_map_properties_ok_button);
  gtk_object_set_data (GTK_OBJECT (single_map_properties_dialog), "tooltips", tooltips);

  return single_map_properties_dialog;
}

GtkWidget*
create_undo_molecule_chooser_dialog (void)
{
  GtkWidget *undo_molecule_chooser_dialog;
  GtkWidget *dialog_vbox24;
  GtkWidget *vbox83;
  GtkWidget *label116;
  GtkWidget *frame70;
  GtkWidget *undo_molecule_chooser_option_menu;
  GtkWidget *undo_molecule_chooser_option_menu_menu;
  GtkWidget *dialog_action_area24;
  GtkWidget *undo_molecule_chooser_ok_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  undo_molecule_chooser_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (undo_molecule_chooser_dialog), "undo_molecule_chooser_dialog", undo_molecule_chooser_dialog);
  gtk_window_set_title (GTK_WINDOW (undo_molecule_chooser_dialog), _("Choose molecule to Undo:"));
  gtk_window_set_policy (GTK_WINDOW (undo_molecule_chooser_dialog), TRUE, TRUE, FALSE);

  dialog_vbox24 = GTK_DIALOG (undo_molecule_chooser_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (undo_molecule_chooser_dialog), "dialog_vbox24", dialog_vbox24);
  gtk_widget_show (dialog_vbox24);

  vbox83 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox83);
  gtk_object_set_data_full (GTK_OBJECT (undo_molecule_chooser_dialog), "vbox83", vbox83,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox83);
  gtk_box_pack_start (GTK_BOX (dialog_vbox24), vbox83, TRUE, TRUE, 0);

  label116 = gtk_label_new (_("Choose Molecule to Undo:"));
  gtk_widget_ref (label116);
  gtk_object_set_data_full (GTK_OBJECT (undo_molecule_chooser_dialog), "label116", label116,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label116);
  gtk_box_pack_start (GTK_BOX (vbox83), label116, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label116), 3, 4);

  frame70 = gtk_frame_new (NULL);
  gtk_widget_ref (frame70);
  gtk_object_set_data_full (GTK_OBJECT (undo_molecule_chooser_dialog), "frame70", frame70,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame70);
  gtk_box_pack_start (GTK_BOX (vbox83), frame70, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame70), 2);

  undo_molecule_chooser_option_menu = gtk_option_menu_new ();
  gtk_widget_ref (undo_molecule_chooser_option_menu);
  gtk_object_set_data_full (GTK_OBJECT (undo_molecule_chooser_dialog), "undo_molecule_chooser_option_menu", undo_molecule_chooser_option_menu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (undo_molecule_chooser_option_menu);
  gtk_container_add (GTK_CONTAINER (frame70), undo_molecule_chooser_option_menu);
  gtk_tooltips_set_tip (tooltips, undo_molecule_chooser_option_menu, _("You want to undo a modification.  There are 2 or more molecules that have been modified.  To which molecule should the undo apply?"), NULL);
  undo_molecule_chooser_option_menu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (undo_molecule_chooser_option_menu), undo_molecule_chooser_option_menu_menu);

  dialog_action_area24 = GTK_DIALOG (undo_molecule_chooser_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (undo_molecule_chooser_dialog), "dialog_action_area24", dialog_action_area24);
  gtk_widget_show (dialog_action_area24);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area24), 10);

  undo_molecule_chooser_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (undo_molecule_chooser_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (undo_molecule_chooser_dialog), "undo_molecule_chooser_ok_button", undo_molecule_chooser_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (undo_molecule_chooser_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area24), undo_molecule_chooser_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (undo_molecule_chooser_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (undo_molecule_chooser_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_undo_molecule_chooser_ok_button_clicked),
                      NULL);

  gtk_widget_grab_default (undo_molecule_chooser_ok_button);
  gtk_object_set_data (GTK_OBJECT (undo_molecule_chooser_dialog), "tooltips", tooltips);

  return undo_molecule_chooser_dialog;
}

GtkWidget*
create_skeleton_dialog (void)
{
  GtkWidget *skeleton_dialog;
  GtkWidget *dialog_vbox25;
  GtkWidget *vbox84;
  GtkWidget *label117;
  GtkWidget *frame71;
  GtkWidget *skeleton_map_optionmenu;
  GtkWidget *skeleton_map_optionmenu_menu;
  GtkWidget *skeleton_dialog_on_off_frame;
  GtkWidget *vbox85;
  GSList *skeleton_group = NULL;
  GtkWidget *skeleton_on_radiobutton;
  GtkWidget *skeleton_off_radiobutton;
  GtkWidget *skeleton_prune_and_colour_checkbutton;
  GtkWidget *dialog_action_area25;
  GtkWidget *hbox59;
  GtkWidget *skeleton_ok_button;
  GtkWidget *skeleton_cancel_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  skeleton_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (skeleton_dialog), "skeleton_dialog", skeleton_dialog);
  gtk_window_set_title (GTK_WINDOW (skeleton_dialog), _("Skeleton Dialog"));
  gtk_window_set_policy (GTK_WINDOW (skeleton_dialog), TRUE, TRUE, FALSE);

  dialog_vbox25 = GTK_DIALOG (skeleton_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (skeleton_dialog), "dialog_vbox25", dialog_vbox25);
  gtk_widget_show (dialog_vbox25);

  vbox84 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox84);
  gtk_object_set_data_full (GTK_OBJECT (skeleton_dialog), "vbox84", vbox84,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox84);
  gtk_box_pack_start (GTK_BOX (dialog_vbox25), vbox84, TRUE, TRUE, 0);

  label117 = gtk_label_new (_("Skeletonize Map:"));
  gtk_widget_ref (label117);
  gtk_object_set_data_full (GTK_OBJECT (skeleton_dialog), "label117", label117,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label117);
  gtk_box_pack_start (GTK_BOX (vbox84), label117, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label117), 0, 5);

  frame71 = gtk_frame_new (NULL);
  gtk_widget_ref (frame71);
  gtk_object_set_data_full (GTK_OBJECT (skeleton_dialog), "frame71", frame71,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame71);
  gtk_box_pack_start (GTK_BOX (vbox84), frame71, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame71), 2);

  skeleton_map_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (skeleton_map_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (skeleton_dialog), "skeleton_map_optionmenu", skeleton_map_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeleton_map_optionmenu);
  gtk_container_add (GTK_CONTAINER (frame71), skeleton_map_optionmenu);
  skeleton_map_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (skeleton_map_optionmenu), skeleton_map_optionmenu_menu);

  skeleton_dialog_on_off_frame = gtk_frame_new (NULL);
  gtk_widget_ref (skeleton_dialog_on_off_frame);
  gtk_object_set_data_full (GTK_OBJECT (skeleton_dialog), "skeleton_dialog_on_off_frame", skeleton_dialog_on_off_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeleton_dialog_on_off_frame);
  gtk_box_pack_start (GTK_BOX (vbox84), skeleton_dialog_on_off_frame, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (skeleton_dialog_on_off_frame), 2);

  vbox85 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox85);
  gtk_object_set_data_full (GTK_OBJECT (skeleton_dialog), "vbox85", vbox85,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox85);
  gtk_container_add (GTK_CONTAINER (skeleton_dialog_on_off_frame), vbox85);

  skeleton_on_radiobutton = gtk_radio_button_new_with_label (skeleton_group, _("On"));
  skeleton_group = gtk_radio_button_group (GTK_RADIO_BUTTON (skeleton_on_radiobutton));
  gtk_widget_ref (skeleton_on_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (skeleton_dialog), "skeleton_on_radiobutton", skeleton_on_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeleton_on_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox85), skeleton_on_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (skeleton_on_radiobutton), 4);

  skeleton_off_radiobutton = gtk_radio_button_new_with_label (skeleton_group, _("Off"));
  skeleton_group = gtk_radio_button_group (GTK_RADIO_BUTTON (skeleton_off_radiobutton));
  gtk_widget_ref (skeleton_off_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (skeleton_dialog), "skeleton_off_radiobutton", skeleton_off_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeleton_off_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox85), skeleton_off_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (skeleton_off_radiobutton), 4);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (skeleton_off_radiobutton), TRUE);

  skeleton_prune_and_colour_checkbutton = gtk_check_button_new_with_label (_("Prune & Colour"));
  gtk_widget_ref (skeleton_prune_and_colour_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (skeleton_dialog), "skeleton_prune_and_colour_checkbutton", skeleton_prune_and_colour_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeleton_prune_and_colour_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox84), skeleton_prune_and_colour_checkbutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (skeleton_prune_and_colour_checkbutton), 4);
  gtk_tooltips_set_tip (tooltips, skeleton_prune_and_colour_checkbutton, _("Remove sidechains from the skeleton and colour by domain"), NULL);

  dialog_action_area25 = GTK_DIALOG (skeleton_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (skeleton_dialog), "dialog_action_area25", dialog_action_area25);
  gtk_widget_show (dialog_action_area25);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area25), 10);

  hbox59 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox59);
  gtk_object_set_data_full (GTK_OBJECT (skeleton_dialog), "hbox59", hbox59,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox59);
  gtk_box_pack_start (GTK_BOX (dialog_action_area25), hbox59, TRUE, TRUE, 0);

  skeleton_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (skeleton_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (skeleton_dialog), "skeleton_ok_button", skeleton_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeleton_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox59), skeleton_ok_button, TRUE, TRUE, 3);

  skeleton_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (skeleton_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (skeleton_dialog), "skeleton_cancel_button", skeleton_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeleton_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox59), skeleton_cancel_button, TRUE, TRUE, 3);

  gtk_signal_connect (GTK_OBJECT (skeleton_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_skeleton_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (skeleton_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_skeleton_cancel_button_clicked),
                      NULL);

  gtk_object_set_data (GTK_OBJECT (skeleton_dialog), "tooltips", tooltips);

  return skeleton_dialog;
}

GtkWidget*
create_splash_screen_window (void)
{
  GtkWidget *splash_screen_window;
  GtkWidget *pixmap1;

  splash_screen_window = gtk_window_new (GTK_WINDOW_POPUP);
  gtk_object_set_data (GTK_OBJECT (splash_screen_window), "splash_screen_window", splash_screen_window);
  gtk_window_set_title (GTK_WINDOW (splash_screen_window), _("Coot"));
  gtk_window_set_position (GTK_WINDOW (splash_screen_window), GTK_WIN_POS_CENTER);

  pixmap1 = create_pixmap (splash_screen_window, "coot-0.3.xpm");
  gtk_widget_ref (pixmap1);
  gtk_object_set_data_full (GTK_OBJECT (splash_screen_window), "pixmap1", pixmap1,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pixmap1);
  gtk_container_add (GTK_CONTAINER (splash_screen_window), pixmap1);

  return splash_screen_window;
}

GtkWidget*
create_crosshairs_dialog (void)
{
  GtkWidget *crosshairs_dialog;
  GtkWidget *dialog_vbox26;
  GtkWidget *vbox87;
  GtkWidget *label119;
  GtkWidget *frame72;
  GtkWidget *vbox88;
  GSList *crosshairs_group = NULL;
  GtkWidget *crosshairs_on_radiobutton;
  GtkWidget *crosshairs_off_radiobutton;
  GtkWidget *dialog_action_area26;
  GtkWidget *display_crosshairs_ok_button;

  crosshairs_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (crosshairs_dialog), "crosshairs_dialog", crosshairs_dialog);
  gtk_window_set_title (GTK_WINDOW (crosshairs_dialog), _("Crosshairs"));
  gtk_window_set_policy (GTK_WINDOW (crosshairs_dialog), TRUE, TRUE, FALSE);

  dialog_vbox26 = GTK_DIALOG (crosshairs_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (crosshairs_dialog), "dialog_vbox26", dialog_vbox26);
  gtk_widget_show (dialog_vbox26);

  vbox87 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox87);
  gtk_object_set_data_full (GTK_OBJECT (crosshairs_dialog), "vbox87", vbox87,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox87);
  gtk_box_pack_start (GTK_BOX (dialog_vbox26), vbox87, TRUE, TRUE, 0);

  label119 = gtk_label_new (_("Display Crosshairs"));
  gtk_widget_ref (label119);
  gtk_object_set_data_full (GTK_OBJECT (crosshairs_dialog), "label119", label119,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label119);
  gtk_box_pack_start (GTK_BOX (vbox87), label119, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label119), 3, 7);

  frame72 = gtk_frame_new (NULL);
  gtk_widget_ref (frame72);
  gtk_object_set_data_full (GTK_OBJECT (crosshairs_dialog), "frame72", frame72,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame72);
  gtk_box_pack_start (GTK_BOX (vbox87), frame72, TRUE, TRUE, 0);

  vbox88 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox88);
  gtk_object_set_data_full (GTK_OBJECT (crosshairs_dialog), "vbox88", vbox88,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox88);
  gtk_container_add (GTK_CONTAINER (frame72), vbox88);

  crosshairs_on_radiobutton = gtk_radio_button_new_with_label (crosshairs_group, _("On"));
  crosshairs_group = gtk_radio_button_group (GTK_RADIO_BUTTON (crosshairs_on_radiobutton));
  gtk_widget_ref (crosshairs_on_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (crosshairs_dialog), "crosshairs_on_radiobutton", crosshairs_on_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (crosshairs_on_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox88), crosshairs_on_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (crosshairs_on_radiobutton), 6);

  crosshairs_off_radiobutton = gtk_radio_button_new_with_label (crosshairs_group, _("Off"));
  crosshairs_group = gtk_radio_button_group (GTK_RADIO_BUTTON (crosshairs_off_radiobutton));
  gtk_widget_ref (crosshairs_off_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (crosshairs_dialog), "crosshairs_off_radiobutton", crosshairs_off_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (crosshairs_off_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox88), crosshairs_off_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (crosshairs_off_radiobutton), 6);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (crosshairs_off_radiobutton), TRUE);

  dialog_action_area26 = GTK_DIALOG (crosshairs_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (crosshairs_dialog), "dialog_action_area26", dialog_action_area26);
  gtk_widget_show (dialog_action_area26);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area26), 10);

  display_crosshairs_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (display_crosshairs_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (crosshairs_dialog), "display_crosshairs_ok_button", display_crosshairs_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (display_crosshairs_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area26), display_crosshairs_ok_button, TRUE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (crosshairs_on_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_crosshairs_on_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (crosshairs_off_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_crosshairs_off_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (display_crosshairs_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_display_crosshairs_ok_button_clicked),
                      NULL);

  return crosshairs_dialog;
}

GtkWidget*
create_add_alt_conf_dialog (void)
{
  GtkWidget *add_alt_conf_dialog;
  GtkWidget *dialog_vbox27;
  GtkWidget *vbox89;
  GtkWidget *label120;
  GtkWidget *frame73;
  GtkWidget *vbox90;
  GSList *add_alt_conf_group = NULL;
  GtkWidget *add_alt_conf_ca_radiobutton;
  GtkWidget *add_alt_conf_whole_single_residue_radiobutton;
  GtkWidget *add_alt_conf_residue_range_radiobutton;
  GtkWidget *dialog_action_area27;
  GtkWidget *hbox60;
  GtkWidget *add_alt_conf_cancel_button;

  add_alt_conf_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (add_alt_conf_dialog), "add_alt_conf_dialog", add_alt_conf_dialog);
  gtk_window_set_title (GTK_WINDOW (add_alt_conf_dialog), _("Add Alternate Conformation"));
  gtk_window_set_policy (GTK_WINDOW (add_alt_conf_dialog), TRUE, TRUE, FALSE);

  dialog_vbox27 = GTK_DIALOG (add_alt_conf_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (add_alt_conf_dialog), "dialog_vbox27", dialog_vbox27);
  gtk_widget_show (dialog_vbox27);

  vbox89 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox89);
  gtk_object_set_data_full (GTK_OBJECT (add_alt_conf_dialog), "vbox89", vbox89,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox89);
  gtk_box_pack_start (GTK_BOX (dialog_vbox27), vbox89, TRUE, TRUE, 0);

  label120 = gtk_label_new (_("Add Alternate Conformation"));
  gtk_widget_ref (label120);
  gtk_object_set_data_full (GTK_OBJECT (add_alt_conf_dialog), "label120", label120,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label120);
  gtk_box_pack_start (GTK_BOX (vbox89), label120, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label120), 3, 6);

  frame73 = gtk_frame_new (NULL);
  gtk_widget_ref (frame73);
  gtk_object_set_data_full (GTK_OBJECT (add_alt_conf_dialog), "frame73", frame73,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame73);
  gtk_box_pack_start (GTK_BOX (vbox89), frame73, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame73), 6);

  vbox90 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox90);
  gtk_object_set_data_full (GTK_OBJECT (add_alt_conf_dialog), "vbox90", vbox90,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox90);
  gtk_container_add (GTK_CONTAINER (frame73), vbox90);

  add_alt_conf_ca_radiobutton = gtk_radio_button_new_with_label (add_alt_conf_group, _("Split Single Residue at C-alpha"));
  add_alt_conf_group = gtk_radio_button_group (GTK_RADIO_BUTTON (add_alt_conf_ca_radiobutton));
  gtk_widget_ref (add_alt_conf_ca_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (add_alt_conf_dialog), "add_alt_conf_ca_radiobutton", add_alt_conf_ca_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (add_alt_conf_ca_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox90), add_alt_conf_ca_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (add_alt_conf_ca_radiobutton), 4);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (add_alt_conf_ca_radiobutton), TRUE);

  add_alt_conf_whole_single_residue_radiobutton = gtk_radio_button_new_with_label (add_alt_conf_group, _("Split All of a Single Residue"));
  add_alt_conf_group = gtk_radio_button_group (GTK_RADIO_BUTTON (add_alt_conf_whole_single_residue_radiobutton));
  gtk_widget_ref (add_alt_conf_whole_single_residue_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (add_alt_conf_dialog), "add_alt_conf_whole_single_residue_radiobutton", add_alt_conf_whole_single_residue_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (add_alt_conf_whole_single_residue_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox90), add_alt_conf_whole_single_residue_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (add_alt_conf_whole_single_residue_radiobutton), 4);

  add_alt_conf_residue_range_radiobutton = gtk_radio_button_new_with_label (add_alt_conf_group, _("Split a Residue Range"));
  add_alt_conf_group = gtk_radio_button_group (GTK_RADIO_BUTTON (add_alt_conf_residue_range_radiobutton));
  gtk_widget_ref (add_alt_conf_residue_range_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (add_alt_conf_dialog), "add_alt_conf_residue_range_radiobutton", add_alt_conf_residue_range_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (vbox90), add_alt_conf_residue_range_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (add_alt_conf_residue_range_radiobutton), 4);

  dialog_action_area27 = GTK_DIALOG (add_alt_conf_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (add_alt_conf_dialog), "dialog_action_area27", dialog_action_area27);
  gtk_widget_show (dialog_action_area27);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area27), 10);

  hbox60 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox60);
  gtk_object_set_data_full (GTK_OBJECT (add_alt_conf_dialog), "hbox60", hbox60,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox60);
  gtk_box_pack_start (GTK_BOX (dialog_action_area27), hbox60, TRUE, TRUE, 0);

  add_alt_conf_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (add_alt_conf_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (add_alt_conf_dialog), "add_alt_conf_cancel_button", add_alt_conf_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (add_alt_conf_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox60), add_alt_conf_cancel_button, TRUE, TRUE, 2);

  gtk_signal_connect (GTK_OBJECT (add_alt_conf_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_add_alt_conf_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (add_alt_conf_ca_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_add_alt_conf_ca_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (add_alt_conf_whole_single_residue_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_add_alt_conf_whole_single_residue_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (add_alt_conf_residue_range_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_add_alt_conf_residue_range_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (add_alt_conf_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_add_alt_conf_cancel_button_clicked),
                      NULL);

  return add_alt_conf_dialog;
}

GtkWidget*
create_validation_dialog (void)
{
  GtkWidget *validation_dialog;
  GtkWidget *dialog_vbox28;
  GtkWidget *frame74;
  GtkWidget *vbox91;
  GtkWidget *label121;
  GtkWidget *scrolledwindow7;
  GtkWidget *validation_dialog_text;
  GtkWidget *hbox63;
  GtkWidget *validation_dialog_residue_or_atom_label;
  GtkWidget *validation_dialog_residue_entry;
  GtkWidget *label123;
  GtkWidget *hbox64;
  GtkWidget *label124;
  GtkWidget *validation_dialog_baddie_number_entry;
  GtkWidget *label125;
  GtkWidget *dialog_action_area28;
  GtkWidget *hbox61;
  GtkWidget *validation_dialog_next_button;
  GtkWidget *validation_dialog_prev_button;
  GtkWidget *validation_dialog_cancel_button;

  validation_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (validation_dialog), "validation_dialog", validation_dialog);
  gtk_window_set_title (GTK_WINDOW (validation_dialog), _("validation dialog"));
  gtk_window_set_policy (GTK_WINDOW (validation_dialog), TRUE, TRUE, FALSE);

  dialog_vbox28 = GTK_DIALOG (validation_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (validation_dialog), "dialog_vbox28", dialog_vbox28);
  gtk_widget_show (dialog_vbox28);

  frame74 = gtk_frame_new (NULL);
  gtk_widget_ref (frame74);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "frame74", frame74,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame74);
  gtk_box_pack_start (GTK_BOX (dialog_vbox28), frame74, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame74), 4);

  vbox91 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox91);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "vbox91", vbox91,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox91);
  gtk_container_add (GTK_CONTAINER (frame74), vbox91);

  label121 = gtk_label_new (_("Description"));
  gtk_widget_ref (label121);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "label121", label121,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label121);
  gtk_box_pack_start (GTK_BOX (vbox91), label121, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label121), 0, 3);

  scrolledwindow7 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow7);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "scrolledwindow7", scrolledwindow7,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow7);
  gtk_box_pack_start (GTK_BOX (vbox91), scrolledwindow7, TRUE, TRUE, 0);
  gtk_scrolled_window_set_policy (GTK_SCROLLED_WINDOW (scrolledwindow7), GTK_POLICY_NEVER, GTK_POLICY_ALWAYS);

  validation_dialog_text = gtk_text_new (NULL, NULL);
  gtk_widget_ref (validation_dialog_text);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "validation_dialog_text", validation_dialog_text,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (validation_dialog_text);
  gtk_container_add (GTK_CONTAINER (scrolledwindow7), validation_dialog_text);
  gtk_widget_set_usize (validation_dialog_text, 230, -2);

  hbox63 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox63);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "hbox63", hbox63,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox63);
  gtk_box_pack_start (GTK_BOX (vbox91), hbox63, FALSE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox63), 4);

  validation_dialog_residue_or_atom_label = gtk_label_new (_("  Residue:  "));
  gtk_widget_ref (validation_dialog_residue_or_atom_label);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "validation_dialog_residue_or_atom_label", validation_dialog_residue_or_atom_label,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (validation_dialog_residue_or_atom_label);
  gtk_box_pack_start (GTK_BOX (hbox63), validation_dialog_residue_or_atom_label, FALSE, FALSE, 0);

  validation_dialog_residue_entry = gtk_entry_new ();
  gtk_widget_ref (validation_dialog_residue_entry);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "validation_dialog_residue_entry", validation_dialog_residue_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (validation_dialog_residue_entry);
  gtk_box_pack_start (GTK_BOX (hbox63), validation_dialog_residue_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (validation_dialog_residue_entry, 99, -2);
  gtk_entry_set_editable (GTK_ENTRY (validation_dialog_residue_entry), FALSE);

  label123 = gtk_label_new (_("  "));
  gtk_widget_ref (label123);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "label123", label123,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label123);
  gtk_box_pack_start (GTK_BOX (hbox63), label123, FALSE, FALSE, 0);

  hbox64 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox64);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "hbox64", hbox64,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox64);
  gtk_box_pack_start (GTK_BOX (vbox91), hbox64, FALSE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox64), 4);

  label124 = gtk_label_new (_(" Number "));
  gtk_widget_ref (label124);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "label124", label124,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label124);
  gtk_box_pack_start (GTK_BOX (hbox64), label124, FALSE, FALSE, 0);

  validation_dialog_baddie_number_entry = gtk_entry_new ();
  gtk_widget_ref (validation_dialog_baddie_number_entry);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "validation_dialog_baddie_number_entry", validation_dialog_baddie_number_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (validation_dialog_baddie_number_entry);
  gtk_box_pack_start (GTK_BOX (hbox64), validation_dialog_baddie_number_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (validation_dialog_baddie_number_entry, 35, -2);
  gtk_entry_set_editable (GTK_ENTRY (validation_dialog_baddie_number_entry), FALSE);

  label125 = gtk_label_new (_("  of 104  "));
  gtk_widget_ref (label125);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "label125", label125,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label125);
  gtk_box_pack_start (GTK_BOX (hbox64), label125, FALSE, FALSE, 0);

  dialog_action_area28 = GTK_DIALOG (validation_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (validation_dialog), "dialog_action_area28", dialog_action_area28);
  gtk_widget_show (dialog_action_area28);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area28), 10);

  hbox61 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox61);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "hbox61", hbox61,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox61);
  gtk_box_pack_start (GTK_BOX (dialog_action_area28), hbox61, TRUE, TRUE, 0);

  validation_dialog_next_button = gtk_button_new_with_label (_("  Next  "));
  gtk_widget_ref (validation_dialog_next_button);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "validation_dialog_next_button", validation_dialog_next_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (validation_dialog_next_button);
  gtk_box_pack_start (GTK_BOX (hbox61), validation_dialog_next_button, TRUE, TRUE, 2);
  gtk_container_set_border_width (GTK_CONTAINER (validation_dialog_next_button), 2);

  validation_dialog_prev_button = gtk_button_new_with_label (_("  Previous  "));
  gtk_widget_ref (validation_dialog_prev_button);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "validation_dialog_prev_button", validation_dialog_prev_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (validation_dialog_prev_button);
  gtk_box_pack_start (GTK_BOX (hbox61), validation_dialog_prev_button, TRUE, TRUE, 2);
  gtk_container_set_border_width (GTK_CONTAINER (validation_dialog_prev_button), 2);

  validation_dialog_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (validation_dialog_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (validation_dialog), "validation_dialog_cancel_button", validation_dialog_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (validation_dialog_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox61), validation_dialog_cancel_button, TRUE, TRUE, 2);
  gtk_container_set_border_width (GTK_CONTAINER (validation_dialog_cancel_button), 2);

  gtk_signal_connect (GTK_OBJECT (validation_dialog_next_button), "clicked",
                      GTK_SIGNAL_FUNC (on_validation_dialog_next_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (validation_dialog_prev_button), "clicked",
                      GTK_SIGNAL_FUNC (on_validation_dialog_prev_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (validation_dialog_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_validation_dialog_cancel_button_clicked),
                      NULL);

  return validation_dialog;
}

GtkWidget*
create_run_state_file_dialog (void)
{
  GtkWidget *run_state_file_dialog;
  GtkWidget *dialog_vbox29;
  GtkWidget *vbox191;
  GtkWidget *label127;
  GtkWidget *mols_vbox;
  GtkWidget *label300;
  GtkWidget *dialog_action_area29;
  GtkWidget *hbox66;
  GtkWidget *run_state_file_ok_button;
  GtkWidget *run_state_file_cancel_button;

  run_state_file_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (run_state_file_dialog), "run_state_file_dialog", run_state_file_dialog);
  gtk_window_set_title (GTK_WINDOW (run_state_file_dialog), _("saved state dialog"));
  gtk_window_set_policy (GTK_WINDOW (run_state_file_dialog), TRUE, TRUE, FALSE);

  dialog_vbox29 = GTK_DIALOG (run_state_file_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (run_state_file_dialog), "dialog_vbox29", dialog_vbox29);
  gtk_widget_show (dialog_vbox29);

  vbox191 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox191);
  gtk_object_set_data_full (GTK_OBJECT (run_state_file_dialog), "vbox191", vbox191,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox191);
  gtk_box_pack_start (GTK_BOX (dialog_vbox29), vbox191, FALSE, FALSE, 0);

  label127 = gtk_label_new (_("There is a coot auto-save state file here. "));
  gtk_widget_ref (label127);
  gtk_object_set_data_full (GTK_OBJECT (run_state_file_dialog), "label127", label127,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label127);
  gtk_box_pack_start (GTK_BOX (vbox191), label127, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label127), 30, 15);

  mols_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (mols_vbox);
  gtk_object_set_data_full (GTK_OBJECT (run_state_file_dialog), "mols_vbox", mols_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (mols_vbox);
  gtk_box_pack_start (GTK_BOX (vbox191), mols_vbox, TRUE, TRUE, 0);

  label300 = gtk_label_new (_("Do you want to run it?"));
  gtk_widget_ref (label300);
  gtk_object_set_data_full (GTK_OBJECT (run_state_file_dialog), "label300", label300,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label300);
  gtk_box_pack_start (GTK_BOX (vbox191), label300, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label300), 30, 15);

  dialog_action_area29 = GTK_DIALOG (run_state_file_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (run_state_file_dialog), "dialog_action_area29", dialog_action_area29);
  gtk_widget_show (dialog_action_area29);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area29), 10);

  hbox66 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox66);
  gtk_object_set_data_full (GTK_OBJECT (run_state_file_dialog), "hbox66", hbox66,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox66);
  gtk_box_pack_start (GTK_BOX (dialog_action_area29), hbox66, TRUE, TRUE, 0);

  run_state_file_ok_button = gtk_button_new_with_label (_("  Yes  "));
  gtk_widget_ref (run_state_file_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (run_state_file_dialog), "run_state_file_ok_button", run_state_file_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (run_state_file_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox66), run_state_file_ok_button, TRUE, TRUE, 2);
  GTK_WIDGET_SET_FLAGS (run_state_file_ok_button, GTK_CAN_DEFAULT);

  run_state_file_cancel_button = gtk_button_new_with_label (_("  No  "));
  gtk_widget_ref (run_state_file_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (run_state_file_dialog), "run_state_file_cancel_button", run_state_file_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (run_state_file_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox66), run_state_file_cancel_button, TRUE, TRUE, 2);
  GTK_WIDGET_SET_FLAGS (run_state_file_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (run_state_file_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_run_state_file_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (run_state_file_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_run_state_file_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (run_state_file_ok_button);
  gtk_widget_grab_default (run_state_file_ok_button);
  return run_state_file_dialog;
}

GtkWidget*
create_edit_backbone_torsions_dialog (void)
{
  GtkWidget *edit_backbone_torsions_dialog;
  GtkWidget *dialog_vbox30;
  GtkWidget *frame75;
  GtkWidget *vbox93;
  GtkWidget *frame82;
  GtkWidget *edit_backbone_torsions_rotate_peptide_hscale;
  GtkWidget *frame83;
  GtkWidget *edit_backbone_torsions_rotate_carbonyl_hscale;
  GtkWidget *dialog_action_area30;
  GtkWidget *hbox67;
  GtkWidget *edit_backbone_torsion_ok_button;
  GtkWidget *edit_backbone_torsion_cancel_button;

  edit_backbone_torsions_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (edit_backbone_torsions_dialog), "edit_backbone_torsions_dialog", edit_backbone_torsions_dialog);
  gtk_window_set_title (GTK_WINDOW (edit_backbone_torsions_dialog), _("Edit Backbone Torsions"));
  gtk_window_set_policy (GTK_WINDOW (edit_backbone_torsions_dialog), TRUE, TRUE, FALSE);

  dialog_vbox30 = GTK_DIALOG (edit_backbone_torsions_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (edit_backbone_torsions_dialog), "dialog_vbox30", dialog_vbox30);
  gtk_widget_show (dialog_vbox30);

  frame75 = gtk_frame_new (NULL);
  gtk_widget_ref (frame75);
  gtk_object_set_data_full (GTK_OBJECT (edit_backbone_torsions_dialog), "frame75", frame75,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame75);
  gtk_box_pack_start (GTK_BOX (dialog_vbox30), frame75, TRUE, TRUE, 7);
  gtk_widget_set_usize (frame75, 200, -2);
  gtk_container_set_border_width (GTK_CONTAINER (frame75), 2);

  vbox93 = gtk_vbox_new (FALSE, 3);
  gtk_widget_ref (vbox93);
  gtk_object_set_data_full (GTK_OBJECT (edit_backbone_torsions_dialog), "vbox93", vbox93,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox93);
  gtk_container_add (GTK_CONTAINER (frame75), vbox93);
  gtk_widget_set_usize (vbox93, 160, -2);

  frame82 = gtk_frame_new (_("Rotate Peptide"));
  gtk_widget_ref (frame82);
  gtk_object_set_data_full (GTK_OBJECT (edit_backbone_torsions_dialog), "frame82", frame82,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame82);
  gtk_box_pack_start (GTK_BOX (vbox93), frame82, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame82), 6);

  edit_backbone_torsions_rotate_peptide_hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (edit_backbone_torsions_rotate_peptide_hscale);
  gtk_object_set_data_full (GTK_OBJECT (edit_backbone_torsions_dialog), "edit_backbone_torsions_rotate_peptide_hscale", edit_backbone_torsions_rotate_peptide_hscale,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (edit_backbone_torsions_rotate_peptide_hscale);
  gtk_container_add (GTK_CONTAINER (frame82), edit_backbone_torsions_rotate_peptide_hscale);

  frame83 = gtk_frame_new (_("Rotate Carbonyl"));
  gtk_widget_ref (frame83);
  gtk_object_set_data_full (GTK_OBJECT (edit_backbone_torsions_dialog), "frame83", frame83,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame83);
  gtk_box_pack_start (GTK_BOX (vbox93), frame83, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame83), 6);

  edit_backbone_torsions_rotate_carbonyl_hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (edit_backbone_torsions_rotate_carbonyl_hscale);
  gtk_object_set_data_full (GTK_OBJECT (edit_backbone_torsions_dialog), "edit_backbone_torsions_rotate_carbonyl_hscale", edit_backbone_torsions_rotate_carbonyl_hscale,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (edit_backbone_torsions_rotate_carbonyl_hscale);
  gtk_container_add (GTK_CONTAINER (frame83), edit_backbone_torsions_rotate_carbonyl_hscale);

  dialog_action_area30 = GTK_DIALOG (edit_backbone_torsions_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (edit_backbone_torsions_dialog), "dialog_action_area30", dialog_action_area30);
  gtk_widget_show (dialog_action_area30);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area30), 10);

  hbox67 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox67);
  gtk_object_set_data_full (GTK_OBJECT (edit_backbone_torsions_dialog), "hbox67", hbox67,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox67);
  gtk_box_pack_start (GTK_BOX (dialog_action_area30), hbox67, TRUE, TRUE, 0);

  edit_backbone_torsion_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (edit_backbone_torsion_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (edit_backbone_torsions_dialog), "edit_backbone_torsion_ok_button", edit_backbone_torsion_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (edit_backbone_torsion_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox67), edit_backbone_torsion_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (edit_backbone_torsion_ok_button, GTK_CAN_DEFAULT);

  edit_backbone_torsion_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (edit_backbone_torsion_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (edit_backbone_torsions_dialog), "edit_backbone_torsion_cancel_button", edit_backbone_torsion_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (edit_backbone_torsion_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox67), edit_backbone_torsion_cancel_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (edit_backbone_torsion_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (edit_backbone_torsions_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_edit_backbone_torsions_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (edit_backbone_torsion_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_edit_backbone_torsion_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (edit_backbone_torsion_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_edit_backbone_torsion_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (edit_backbone_torsion_ok_button);
  gtk_widget_grab_default (edit_backbone_torsion_ok_button);
  return edit_backbone_torsions_dialog;
}

GtkWidget*
create_start_workflow_dialog (void)
{
  GtkWidget *start_workflow_dialog;
  GtkWidget *dialog_vbox31;
  GtkWidget *frame76;
  GtkWidget *vbox94;
  GSList *workflow_start_group = NULL;
  GtkWidget *workflow_radiobutton_coords_only;
  GtkWidget *workflow_radiobutton_coords_and_dataset;
  GtkWidget *workflow_radiobutton_coords_and_map;
  GtkWidget *workflow_radiobutton_map_from_dataset;
  GtkWidget *workstate_radiobutton_clean_slate;
  GtkWidget *dialog_action_area31;
  GtkWidget *hbox68;
  GtkWidget *workflow_ok_button;
  GtkWidget *workflow_cancel_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  start_workflow_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (start_workflow_dialog), "start_workflow_dialog", start_workflow_dialog);
  gtk_window_set_title (GTK_WINDOW (start_workflow_dialog), _("What do you want to do?"));
  gtk_window_set_policy (GTK_WINDOW (start_workflow_dialog), TRUE, TRUE, FALSE);

  dialog_vbox31 = GTK_DIALOG (start_workflow_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (start_workflow_dialog), "dialog_vbox31", dialog_vbox31);
  gtk_widget_show (dialog_vbox31);

  frame76 = gtk_frame_new (NULL);
  gtk_widget_ref (frame76);
  gtk_object_set_data_full (GTK_OBJECT (start_workflow_dialog), "frame76", frame76,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame76);
  gtk_box_pack_start (GTK_BOX (dialog_vbox31), frame76, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame76), 6);

  vbox94 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox94);
  gtk_object_set_data_full (GTK_OBJECT (start_workflow_dialog), "vbox94", vbox94,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox94);
  gtk_container_add (GTK_CONTAINER (frame76), vbox94);

  workflow_radiobutton_coords_only = gtk_radio_button_new_with_label (workflow_start_group, _(" Display just Coordinates"));
  workflow_start_group = gtk_radio_button_group (GTK_RADIO_BUTTON (workflow_radiobutton_coords_only));
  gtk_widget_ref (workflow_radiobutton_coords_only);
  gtk_object_set_data_full (GTK_OBJECT (start_workflow_dialog), "workflow_radiobutton_coords_only", workflow_radiobutton_coords_only,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (workflow_radiobutton_coords_only);
  gtk_box_pack_start (GTK_BOX (vbox94), workflow_radiobutton_coords_only, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, workflow_radiobutton_coords_only, _("Only Coordinates - no map"), NULL);

  workflow_radiobutton_coords_and_dataset = gtk_radio_button_new_with_label (workflow_start_group, _(" Display Coordinates and calculate a Map from a Dataset"));
  workflow_start_group = gtk_radio_button_group (GTK_RADIO_BUTTON (workflow_radiobutton_coords_and_dataset));
  gtk_widget_ref (workflow_radiobutton_coords_and_dataset);
  gtk_object_set_data_full (GTK_OBJECT (start_workflow_dialog), "workflow_radiobutton_coords_and_dataset", workflow_radiobutton_coords_and_dataset,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (workflow_radiobutton_coords_and_dataset);
  gtk_box_pack_start (GTK_BOX (vbox94), workflow_radiobutton_coords_and_dataset, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, workflow_radiobutton_coords_and_dataset, _("Here, \"Dataset\" means an mtz, phs or mmcif file"), NULL);

  workflow_radiobutton_coords_and_map = gtk_radio_button_new_with_label (workflow_start_group, _(" Display Coordinates and a pre-calculated CCP4 Map"));
  workflow_start_group = gtk_radio_button_group (GTK_RADIO_BUTTON (workflow_radiobutton_coords_and_map));
  gtk_widget_ref (workflow_radiobutton_coords_and_map);
  gtk_object_set_data_full (GTK_OBJECT (start_workflow_dialog), "workflow_radiobutton_coords_and_map", workflow_radiobutton_coords_and_map,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (workflow_radiobutton_coords_and_map);
  gtk_box_pack_start (GTK_BOX (vbox94), workflow_radiobutton_coords_and_map, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, workflow_radiobutton_coords_and_map, _("Coordinates and a CCP4 Map"), NULL);

  workflow_radiobutton_map_from_dataset = gtk_radio_button_new_with_label (workflow_start_group, _(" Calculate a Map from a Dataset"));
  workflow_start_group = gtk_radio_button_group (GTK_RADIO_BUTTON (workflow_radiobutton_map_from_dataset));
  gtk_widget_ref (workflow_radiobutton_map_from_dataset);
  gtk_object_set_data_full (GTK_OBJECT (start_workflow_dialog), "workflow_radiobutton_map_from_dataset", workflow_radiobutton_map_from_dataset,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (workflow_radiobutton_map_from_dataset);
  gtk_box_pack_start (GTK_BOX (vbox94), workflow_radiobutton_map_from_dataset, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, workflow_radiobutton_map_from_dataset, _("Here, \"Dataset\" means an mtz, phs or mmcif file"), NULL);

  workstate_radiobutton_clean_slate = gtk_radio_button_new_with_label (workflow_start_group, _(" Start from a \"Clean Slate\""));
  workflow_start_group = gtk_radio_button_group (GTK_RADIO_BUTTON (workstate_radiobutton_clean_slate));
  gtk_widget_ref (workstate_radiobutton_clean_slate);
  gtk_object_set_data_full (GTK_OBJECT (start_workflow_dialog), "workstate_radiobutton_clean_slate", workstate_radiobutton_clean_slate,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (workstate_radiobutton_clean_slate);
  gtk_box_pack_start (GTK_BOX (vbox94), workstate_radiobutton_clean_slate, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, workstate_radiobutton_clean_slate, _("Nothing special"), NULL);

  dialog_action_area31 = GTK_DIALOG (start_workflow_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (start_workflow_dialog), "dialog_action_area31", dialog_action_area31);
  gtk_widget_show (dialog_action_area31);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area31), 10);

  hbox68 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox68);
  gtk_object_set_data_full (GTK_OBJECT (start_workflow_dialog), "hbox68", hbox68,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox68);
  gtk_box_pack_start (GTK_BOX (dialog_action_area31), hbox68, TRUE, TRUE, 0);

  workflow_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (workflow_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (start_workflow_dialog), "workflow_ok_button", workflow_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (workflow_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox68), workflow_ok_button, TRUE, TRUE, 4);
  GTK_WIDGET_SET_FLAGS (workflow_ok_button, GTK_CAN_DEFAULT);

  workflow_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (workflow_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (start_workflow_dialog), "workflow_cancel_button", workflow_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (workflow_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox68), workflow_cancel_button, TRUE, TRUE, 4);
  GTK_WIDGET_SET_FLAGS (workflow_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (workflow_radiobutton_coords_only), "toggled",
                      GTK_SIGNAL_FUNC (on_workflow_radiobutton_coords_only_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (workflow_radiobutton_coords_and_dataset), "toggled",
                      GTK_SIGNAL_FUNC (on_workflow_radiobutton_coords_and_dataset_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (workflow_radiobutton_coords_and_map), "toggled",
                      GTK_SIGNAL_FUNC (on_workflow_radiobutton_coords_and_map_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (workflow_radiobutton_map_from_dataset), "toggled",
                      GTK_SIGNAL_FUNC (on_workflow_radiobutton_map_from_dataset_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (workstate_radiobutton_clean_slate), "toggled",
                      GTK_SIGNAL_FUNC (on_workstate_radiobutton_clean_slate_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (workflow_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_workflow_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (workflow_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_workflow_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (workflow_ok_button);
  gtk_widget_grab_default (workflow_ok_button);
  gtk_object_set_data (GTK_OBJECT (start_workflow_dialog), "tooltips", tooltips);

  return start_workflow_dialog;
}

GtkWidget*
create_select_fitting_map_dialog (void)
{
  GtkWidget *select_fitting_map_dialog;
  GtkWidget *dialog_vbox32;
  GtkWidget *frame77;
  GtkWidget *vbox95;
  GtkWidget *label128;
  GtkWidget *select_map_for_fitting_optionmenu;
  GtkWidget *select_map_for_fitting_optionmenu_menu;
  GtkWidget *dialog_action_area32;
  GtkWidget *select_map_for_fitting_button;

  select_fitting_map_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (select_fitting_map_dialog), "select_fitting_map_dialog", select_fitting_map_dialog);
  gtk_window_set_title (GTK_WINDOW (select_fitting_map_dialog), _("Select Map for Fitting"));
  gtk_window_set_policy (GTK_WINDOW (select_fitting_map_dialog), TRUE, TRUE, FALSE);

  dialog_vbox32 = GTK_DIALOG (select_fitting_map_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (select_fitting_map_dialog), "dialog_vbox32", dialog_vbox32);
  gtk_widget_show (dialog_vbox32);

  frame77 = gtk_frame_new (NULL);
  gtk_widget_ref (frame77);
  gtk_object_set_data_full (GTK_OBJECT (select_fitting_map_dialog), "frame77", frame77,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame77);
  gtk_box_pack_start (GTK_BOX (dialog_vbox32), frame77, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame77), 4);

  vbox95 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox95);
  gtk_object_set_data_full (GTK_OBJECT (select_fitting_map_dialog), "vbox95", vbox95,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox95);
  gtk_container_add (GTK_CONTAINER (frame77), vbox95);

  label128 = gtk_label_new (_("Choose a Map:"));
  gtk_widget_ref (label128);
  gtk_object_set_data_full (GTK_OBJECT (select_fitting_map_dialog), "label128", label128,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label128);
  gtk_box_pack_start (GTK_BOX (vbox95), label128, FALSE, FALSE, 0);

  select_map_for_fitting_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (select_map_for_fitting_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (select_fitting_map_dialog), "select_map_for_fitting_optionmenu", select_map_for_fitting_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (select_map_for_fitting_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox95), select_map_for_fitting_optionmenu, FALSE, FALSE, 0);
  select_map_for_fitting_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (select_map_for_fitting_optionmenu), select_map_for_fitting_optionmenu_menu);

  dialog_action_area32 = GTK_DIALOG (select_fitting_map_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (select_fitting_map_dialog), "dialog_action_area32", dialog_action_area32);
  gtk_widget_show (dialog_action_area32);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area32), 10);

  select_map_for_fitting_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (select_map_for_fitting_button);
  gtk_object_set_data_full (GTK_OBJECT (select_fitting_map_dialog), "select_map_for_fitting_button", select_map_for_fitting_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (select_map_for_fitting_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area32), select_map_for_fitting_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (select_map_for_fitting_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (select_map_for_fitting_button), "clicked",
                      GTK_SIGNAL_FUNC (on_select_map_for_fitting_button_clicked),
                      NULL);

  gtk_widget_grab_focus (select_map_for_fitting_button);
  gtk_widget_grab_default (select_map_for_fitting_button);
  return select_fitting_map_dialog;
}

GtkWidget*
create_run_refmac_help_dialog (void)
{
  GtkWidget *run_refmac_help_dialog;
  GtkWidget *dialog_vbox33;
  GtkWidget *label129;
  GtkWidget *dialog_action_area33;
  GtkWidget *run_refmac_help_dialog_ok_button;

  run_refmac_help_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (run_refmac_help_dialog), "run_refmac_help_dialog", run_refmac_help_dialog);
  gtk_window_set_title (GTK_WINDOW (run_refmac_help_dialog), _("Help on Running Refmac:"));
  gtk_window_set_policy (GTK_WINDOW (run_refmac_help_dialog), TRUE, TRUE, FALSE);

  dialog_vbox33 = GTK_DIALOG (run_refmac_help_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (run_refmac_help_dialog), "dialog_vbox33", dialog_vbox33);
  gtk_widget_show (dialog_vbox33);

  label129 = gtk_label_new (_("\n\nWhen you read in an MTZ file, you can assign the column labels \nneeded to run Refmac. \n\nIf this option menu is empty it means that you  have not assigned \nRefmac labels from any MTZ file.  To fix, Cancel the \"Run Refmac\" \ndialog, Use File -> Open MTZ and assign Refmac column labels. \nThen use \"Run Refmac...\" from the \"Model/Fit/Refine\" dialog.\n"));
  gtk_widget_ref (label129);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_help_dialog), "label129", label129,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label129);
  gtk_box_pack_start (GTK_BOX (dialog_vbox33), label129, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label129), 0, 0);
  gtk_misc_set_padding (GTK_MISC (label129), 6, 5);

  dialog_action_area33 = GTK_DIALOG (run_refmac_help_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (run_refmac_help_dialog), "dialog_action_area33", dialog_action_area33);
  gtk_widget_show (dialog_action_area33);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area33), 10);

  run_refmac_help_dialog_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (run_refmac_help_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (run_refmac_help_dialog), "run_refmac_help_dialog_ok_button", run_refmac_help_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (run_refmac_help_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area33), run_refmac_help_dialog_ok_button, FALSE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (run_refmac_help_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_run_refmac_help_dialog_ok_button_clicked),
                      NULL);

  return run_refmac_help_dialog;
}

GtkWidget*
create_no_restraints_info_dialog (void)
{
  GtkWidget *no_restraints_info_dialog;
  GtkWidget *dialog_vbox34;
  GtkWidget *frame78;
  GtkWidget *label131;
  GtkWidget *dialog_action_area34;
  GtkWidget *no_restraints_info_dialog_button;

  no_restraints_info_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (no_restraints_info_dialog), "no_restraints_info_dialog", no_restraints_info_dialog);
  gtk_window_set_title (GTK_WINDOW (no_restraints_info_dialog), _("No Restraints!"));
  gtk_window_set_policy (GTK_WINDOW (no_restraints_info_dialog), TRUE, TRUE, FALSE);

  dialog_vbox34 = GTK_DIALOG (no_restraints_info_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (no_restraints_info_dialog), "dialog_vbox34", dialog_vbox34);
  gtk_widget_show (dialog_vbox34);

  frame78 = gtk_frame_new (NULL);
  gtk_widget_ref (frame78);
  gtk_object_set_data_full (GTK_OBJECT (no_restraints_info_dialog), "frame78", frame78,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame78);
  gtk_box_pack_start (GTK_BOX (dialog_vbox34), frame78, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame78), 6);

  label131 = gtk_label_new (_("\nNo Restraints Found!\n\nNon-existent or minimal description of restrained residues.\n\nAre you sure that you read a non-minimal mmCIF dictionary\nfor this monomer? Are you sure the PDB residue name\nmatches the dictionary residue name?\n\nIf not, try File -> Import CIF Dictionary\n\nAlternatively, did you check that the atom names of the \nPDB file match those of the restraints?\n"));
  gtk_widget_ref (label131);
  gtk_object_set_data_full (GTK_OBJECT (no_restraints_info_dialog), "label131", label131,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label131);
  gtk_container_add (GTK_CONTAINER (frame78), label131);
  gtk_misc_set_alignment (GTK_MISC (label131), 0, 0);
  gtk_misc_set_padding (GTK_MISC (label131), 8, 0);

  dialog_action_area34 = GTK_DIALOG (no_restraints_info_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (no_restraints_info_dialog), "dialog_action_area34", dialog_action_area34);
  gtk_widget_show (dialog_action_area34);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area34), 10);

  no_restraints_info_dialog_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (no_restraints_info_dialog_button);
  gtk_object_set_data_full (GTK_OBJECT (no_restraints_info_dialog), "no_restraints_info_dialog_button", no_restraints_info_dialog_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (no_restraints_info_dialog_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area34), no_restraints_info_dialog_button, TRUE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (no_restraints_info_dialog_button), "clicked",
                      GTK_SIGNAL_FUNC (on_no_restraints_info_dialog_button_clicked),
                      NULL);

  return no_restraints_info_dialog;
}

GtkWidget*
create_no_cif_dictionary_bonds_dialog (void)
{
  GtkWidget *no_cif_dictionary_bonds_dialog;
  GtkWidget *dialog_vbox35;
  GtkWidget *frame79;
  GtkWidget *label132;
  GtkWidget *dialog_action_area35;
  GtkWidget *no_cif_dictionary_bonds_ok_button;

  no_cif_dictionary_bonds_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (no_cif_dictionary_bonds_dialog), "no_cif_dictionary_bonds_dialog", no_cif_dictionary_bonds_dialog);
  gtk_window_set_title (GTK_WINDOW (no_cif_dictionary_bonds_dialog), _("No Restraints in Dictionary!"));
  gtk_window_set_policy (GTK_WINDOW (no_cif_dictionary_bonds_dialog), TRUE, TRUE, FALSE);

  dialog_vbox35 = GTK_DIALOG (no_cif_dictionary_bonds_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (no_cif_dictionary_bonds_dialog), "dialog_vbox35", dialog_vbox35);
  gtk_widget_show (dialog_vbox35);

  frame79 = gtk_frame_new (NULL);
  gtk_widget_ref (frame79);
  gtk_object_set_data_full (GTK_OBJECT (no_cif_dictionary_bonds_dialog), "frame79", frame79,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame79);
  gtk_box_pack_start (GTK_BOX (dialog_vbox35), frame79, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame79), 6);

  label132 = gtk_label_new (_("Ooops! CIF Dictionary contains no restraints!"));
  gtk_widget_ref (label132);
  gtk_object_set_data_full (GTK_OBJECT (no_cif_dictionary_bonds_dialog), "label132", label132,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label132);
  gtk_container_add (GTK_CONTAINER (frame79), label132);
  gtk_misc_set_padding (GTK_MISC (label132), 8, 16);

  dialog_action_area35 = GTK_DIALOG (no_cif_dictionary_bonds_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (no_cif_dictionary_bonds_dialog), "dialog_action_area35", dialog_action_area35);
  gtk_widget_show (dialog_action_area35);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area35), 10);

  no_cif_dictionary_bonds_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (no_cif_dictionary_bonds_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (no_cif_dictionary_bonds_dialog), "no_cif_dictionary_bonds_ok_button", no_cif_dictionary_bonds_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (no_cif_dictionary_bonds_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area35), no_cif_dictionary_bonds_ok_button, TRUE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (no_cif_dictionary_bonds_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_no_cif_dictionary_bonds_ok_button_clicked),
                      NULL);

  return no_cif_dictionary_bonds_dialog;
}

GtkWidget*
create_ligand_big_blob_dialog (void)
{
  GtkWidget *ligand_big_blob_dialog;
  GtkWidget *dialog_vbox36;
  GtkWidget *vbox97;
  GtkWidget *label133;
  GtkWidget *scrolledwindow8;
  GtkWidget *viewport4;
  GtkWidget *ligand_big_blob_vbox;
  GtkWidget *dialog_action_area36;
  GtkWidget *ligand_big_blob_dismiss_button;

  ligand_big_blob_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (ligand_big_blob_dialog), "ligand_big_blob_dialog", ligand_big_blob_dialog);
  gtk_window_set_title (GTK_WINDOW (ligand_big_blob_dialog), _("Unmodelled blobs of density:"));
  gtk_window_set_policy (GTK_WINDOW (ligand_big_blob_dialog), TRUE, TRUE, FALSE);

  dialog_vbox36 = GTK_DIALOG (ligand_big_blob_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (ligand_big_blob_dialog), "dialog_vbox36", dialog_vbox36);
  gtk_widget_show (dialog_vbox36);

  vbox97 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox97);
  gtk_object_set_data_full (GTK_OBJECT (ligand_big_blob_dialog), "vbox97", vbox97,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox97);
  gtk_box_pack_start (GTK_BOX (dialog_vbox36), vbox97, TRUE, TRUE, 0);

  label133 = gtk_label_new (_("\nThere are unexplained blobs of \ndensity (too big to be waters):\n"));
  gtk_widget_ref (label133);
  gtk_object_set_data_full (GTK_OBJECT (ligand_big_blob_dialog), "label133", label133,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label133);
  gtk_box_pack_start (GTK_BOX (vbox97), label133, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label133), 10, 0);

  scrolledwindow8 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow8);
  gtk_object_set_data_full (GTK_OBJECT (ligand_big_blob_dialog), "scrolledwindow8", scrolledwindow8,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow8);
  gtk_box_pack_start (GTK_BOX (vbox97), scrolledwindow8, TRUE, TRUE, 0);
  gtk_widget_set_usize (scrolledwindow8, -2, 106);

  viewport4 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport4);
  gtk_object_set_data_full (GTK_OBJECT (ligand_big_blob_dialog), "viewport4", viewport4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport4);
  gtk_container_add (GTK_CONTAINER (scrolledwindow8), viewport4);

  ligand_big_blob_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (ligand_big_blob_vbox);
  gtk_object_set_data_full (GTK_OBJECT (ligand_big_blob_dialog), "ligand_big_blob_vbox", ligand_big_blob_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ligand_big_blob_vbox);
  gtk_container_add (GTK_CONTAINER (viewport4), ligand_big_blob_vbox);

  dialog_action_area36 = GTK_DIALOG (ligand_big_blob_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (ligand_big_blob_dialog), "dialog_action_area36", dialog_action_area36);
  gtk_widget_show (dialog_action_area36);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area36), 10);

  ligand_big_blob_dismiss_button = gtk_button_new_with_label (_("  Dismiss  "));
  gtk_widget_ref (ligand_big_blob_dismiss_button);
  gtk_object_set_data_full (GTK_OBJECT (ligand_big_blob_dialog), "ligand_big_blob_dismiss_button", ligand_big_blob_dismiss_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ligand_big_blob_dismiss_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area36), ligand_big_blob_dismiss_button, TRUE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (ligand_big_blob_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_ligand_big_blob_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ligand_big_blob_dismiss_button), "clicked",
                      GTK_SIGNAL_FUNC (on_ligand_big_blob_dismiss_button_clicked),
                      NULL);

  return ligand_big_blob_dialog;
}

GtkWidget*
create_edit_chi_angles_dialog (void)
{
  GtkWidget *edit_chi_angles_dialog;
  GtkWidget *dialog_vbox37;
  GtkWidget *vbox98;
  GtkWidget *label134;
  GtkWidget *scrolledwindow9;
  GtkWidget *viewport5;
  GtkWidget *edit_chi_angles_vbox;
  GtkWidget *edit_chi_angles_normal_rotation_button;
  GtkWidget *edit_chi_angles_help_button;
  GtkWidget *dialog_action_area37;
  GtkWidget *hbox71;
  GtkWidget *edit_chi_angles_dialog_ok_button;
  GtkWidget *edit_chi_angles_cancel_button;

  edit_chi_angles_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (edit_chi_angles_dialog), "edit_chi_angles_dialog", edit_chi_angles_dialog);
  gtk_window_set_title (GTK_WINDOW (edit_chi_angles_dialog), _("Edit Chi Angles"));
  gtk_window_set_policy (GTK_WINDOW (edit_chi_angles_dialog), TRUE, TRUE, FALSE);

  dialog_vbox37 = GTK_DIALOG (edit_chi_angles_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (edit_chi_angles_dialog), "dialog_vbox37", dialog_vbox37);
  gtk_widget_show (dialog_vbox37);

  vbox98 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox98);
  gtk_object_set_data_full (GTK_OBJECT (edit_chi_angles_dialog), "vbox98", vbox98,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox98);
  gtk_box_pack_start (GTK_BOX (dialog_vbox37), vbox98, TRUE, TRUE, 0);

  label134 = gtk_label_new (_("Chi Angles Rotation Mode:"));
  gtk_widget_ref (label134);
  gtk_object_set_data_full (GTK_OBJECT (edit_chi_angles_dialog), "label134", label134,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label134);
  gtk_box_pack_start (GTK_BOX (vbox98), label134, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label134), 2, 7);

  scrolledwindow9 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow9);
  gtk_object_set_data_full (GTK_OBJECT (edit_chi_angles_dialog), "scrolledwindow9", scrolledwindow9,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow9);
  gtk_box_pack_start (GTK_BOX (vbox98), scrolledwindow9, TRUE, TRUE, 0);
  gtk_widget_set_usize (scrolledwindow9, -2, 125);

  viewport5 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport5);
  gtk_object_set_data_full (GTK_OBJECT (edit_chi_angles_dialog), "viewport5", viewport5,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport5);
  gtk_container_add (GTK_CONTAINER (scrolledwindow9), viewport5);

  edit_chi_angles_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (edit_chi_angles_vbox);
  gtk_object_set_data_full (GTK_OBJECT (edit_chi_angles_dialog), "edit_chi_angles_vbox", edit_chi_angles_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (edit_chi_angles_vbox);
  gtk_container_add (GTK_CONTAINER (viewport5), edit_chi_angles_vbox);

  edit_chi_angles_normal_rotation_button = gtk_button_new_with_label (_(" View Rotation Mode "));
  gtk_widget_ref (edit_chi_angles_normal_rotation_button);
  gtk_object_set_data_full (GTK_OBJECT (edit_chi_angles_dialog), "edit_chi_angles_normal_rotation_button", edit_chi_angles_normal_rotation_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (edit_chi_angles_normal_rotation_button);
  gtk_box_pack_start (GTK_BOX (vbox98), edit_chi_angles_normal_rotation_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (edit_chi_angles_normal_rotation_button), 6);

  edit_chi_angles_help_button = gtk_button_new_with_label (_("Help me out here..."));
  gtk_widget_ref (edit_chi_angles_help_button);
  gtk_object_set_data_full (GTK_OBJECT (edit_chi_angles_dialog), "edit_chi_angles_help_button", edit_chi_angles_help_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (edit_chi_angles_help_button);
  gtk_box_pack_start (GTK_BOX (vbox98), edit_chi_angles_help_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (edit_chi_angles_help_button), 6);

  dialog_action_area37 = GTK_DIALOG (edit_chi_angles_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (edit_chi_angles_dialog), "dialog_action_area37", dialog_action_area37);
  gtk_widget_show (dialog_action_area37);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area37), 10);

  hbox71 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox71);
  gtk_object_set_data_full (GTK_OBJECT (edit_chi_angles_dialog), "hbox71", hbox71,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox71);
  gtk_box_pack_start (GTK_BOX (dialog_action_area37), hbox71, TRUE, TRUE, 0);

  edit_chi_angles_dialog_ok_button = gtk_button_new_with_label (_("  Accept  "));
  gtk_widget_ref (edit_chi_angles_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (edit_chi_angles_dialog), "edit_chi_angles_dialog_ok_button", edit_chi_angles_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (edit_chi_angles_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox71), edit_chi_angles_dialog_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (edit_chi_angles_dialog_ok_button, GTK_CAN_DEFAULT);

  edit_chi_angles_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (edit_chi_angles_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (edit_chi_angles_dialog), "edit_chi_angles_cancel_button", edit_chi_angles_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (edit_chi_angles_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox71), edit_chi_angles_cancel_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (edit_chi_angles_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (edit_chi_angles_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_edit_chi_angles_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (edit_chi_angles_normal_rotation_button), "clicked",
                      GTK_SIGNAL_FUNC (on_edit_chi_angles_normal_rotation_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (edit_chi_angles_help_button), "clicked",
                      GTK_SIGNAL_FUNC (on_edit_chi_angles_help_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (edit_chi_angles_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_edit_chi_angles_dialog_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (edit_chi_angles_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_edit_chi_angles_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (edit_chi_angles_dialog_ok_button);
  gtk_widget_grab_default (edit_chi_angles_dialog_ok_button);
  return edit_chi_angles_dialog;
}

GtkWidget*
create_check_waters_dialog (void)
{
  GtkWidget *check_waters_dialog;
  GtkWidget *dialog_vbox38;
  GtkWidget *vbox100;
  GtkWidget *hbox73;
  GtkWidget *label136;
  GtkWidget *check_waters_molecule_optionmenu;
  GtkWidget *check_waters_molecule_optionmenu_menu;
  GtkWidget *hbox72;
  GtkWidget *label135;
  GtkWidget *check_waters_action_optionmenu;
  GtkWidget *check_waters_action_optionmenu_menu;
  GtkWidget *glade_menuitem;
  GtkWidget *frame84;
  GtkWidget *vbox101;
  GtkWidget *hbox74;
  GtkWidget *check_waters_b_factor_hbox;
  GtkWidget *label259;
  GtkWidget *check_waters_b_factor_entry;
  GtkWidget *label141;
  GtkWidget *check_waters_b_factor_entry_active_checkbutton;
  GtkWidget *hbox75;
  GtkWidget *check_waters_sigma_level_hbox;
  GtkWidget *label138;
  GtkWidget *check_waters_map_sigma_entry;
  GtkWidget *label142;
  GtkWidget *check_waters_map_sigma_entry_active_checkbutton;
  GtkWidget *hbox76;
  GtkWidget *check_waters_min_dist_hbox;
  GtkWidget *label139;
  GtkWidget *check_waters_min_dist_entry;
  GtkWidget *label143;
  GtkWidget *check_waters_min_dist_entry_active_checkbutton;
  GtkWidget *hbox77;
  GtkWidget *check_waters_max_dist_hbox;
  GtkWidget *label140;
  GtkWidget *check_waters_max_dist_entry;
  GtkWidget *label144;
  GtkWidget *check_waters_max_dist_entry_active_checkbutton;
  GtkWidget *check_waters_low_occ_dist_checkbutton;
  GtkWidget *check_waters_zero_occ_checkbutton;
  GtkWidget *frame154;
  GtkWidget *vbox157;
  GtkWidget *label244;
  GSList *check_waters_logic_gr_group = NULL;
  GtkWidget *check_waters_OR_radiobutton;
  GtkWidget *check_waters_AND_radiobutton;
  GtkWidget *dialog_action_area38;
  GtkWidget *hbox78;
  GtkWidget *check_waters_ok_button;
  GtkWidget *check_waters_cancel_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  check_waters_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (check_waters_dialog), "check_waters_dialog", check_waters_dialog);
  gtk_window_set_title (GTK_WINDOW (check_waters_dialog), _("Checking Waters:"));
  gtk_window_set_policy (GTK_WINDOW (check_waters_dialog), TRUE, TRUE, FALSE);

  dialog_vbox38 = GTK_DIALOG (check_waters_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (check_waters_dialog), "dialog_vbox38", dialog_vbox38);
  gtk_widget_show (dialog_vbox38);

  vbox100 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox100);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "vbox100", vbox100,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox100);
  gtk_box_pack_start (GTK_BOX (dialog_vbox38), vbox100, TRUE, TRUE, 0);

  hbox73 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox73);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "hbox73", hbox73,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox73);
  gtk_box_pack_start (GTK_BOX (vbox100), hbox73, TRUE, TRUE, 5);
  gtk_container_set_border_width (GTK_CONTAINER (hbox73), 6);

  label136 = gtk_label_new (_("  Molecule Number:  "));
  gtk_widget_ref (label136);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "label136", label136,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label136);
  gtk_box_pack_start (GTK_BOX (hbox73), label136, FALSE, FALSE, 0);

  check_waters_molecule_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (check_waters_molecule_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_molecule_optionmenu", check_waters_molecule_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_molecule_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox73), check_waters_molecule_optionmenu, FALSE, FALSE, 0);
  check_waters_molecule_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (check_waters_molecule_optionmenu), check_waters_molecule_optionmenu_menu);

  hbox72 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox72);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "hbox72", hbox72,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox72);
  gtk_box_pack_start (GTK_BOX (vbox100), hbox72, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox72), 6);

  label135 = gtk_label_new (_("  Action:  "));
  gtk_widget_ref (label135);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "label135", label135,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label135);
  gtk_box_pack_start (GTK_BOX (hbox72), label135, FALSE, FALSE, 0);

  check_waters_action_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (check_waters_action_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_action_optionmenu", check_waters_action_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_action_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox72), check_waters_action_optionmenu, FALSE, FALSE, 0);
  check_waters_action_optionmenu_menu = gtk_menu_new ();
  glade_menuitem = gtk_menu_item_new_with_label (_("Generate a List"));
  gtk_widget_show (glade_menuitem);
  gtk_menu_append (GTK_MENU (check_waters_action_optionmenu_menu), glade_menuitem);
  glade_menuitem = gtk_menu_item_new_with_label (_("Delete Waters"));
  gtk_widget_show (glade_menuitem);
  gtk_menu_append (GTK_MENU (check_waters_action_optionmenu_menu), glade_menuitem);
  gtk_option_menu_set_menu (GTK_OPTION_MENU (check_waters_action_optionmenu), check_waters_action_optionmenu_menu);

  frame84 = gtk_frame_new (NULL);
  gtk_widget_ref (frame84);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "frame84", frame84,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame84);
  gtk_box_pack_start (GTK_BOX (vbox100), frame84, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame84), 6);

  vbox101 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox101);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "vbox101", vbox101,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox101);
  gtk_container_add (GTK_CONTAINER (frame84), vbox101);

  hbox74 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox74);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "hbox74", hbox74,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox74);
  gtk_box_pack_start (GTK_BOX (vbox101), hbox74, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox74), 2);

  check_waters_b_factor_hbox = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (check_waters_b_factor_hbox);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_b_factor_hbox", check_waters_b_factor_hbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_b_factor_hbox);
  gtk_box_pack_start (GTK_BOX (hbox74), check_waters_b_factor_hbox, TRUE, TRUE, 0);

  label259 = gtk_label_new (_("  with B factor greater than:  "));
  gtk_widget_ref (label259);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "label259", label259,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label259);
  gtk_box_pack_start (GTK_BOX (check_waters_b_factor_hbox), label259, FALSE, FALSE, 0);

  check_waters_b_factor_entry = gtk_entry_new ();
  gtk_widget_ref (check_waters_b_factor_entry);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_b_factor_entry", check_waters_b_factor_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_b_factor_entry);
  gtk_box_pack_start (GTK_BOX (check_waters_b_factor_hbox), check_waters_b_factor_entry, TRUE, TRUE, 0);
  gtk_widget_set_usize (check_waters_b_factor_entry, 70, -2);

  label141 = gtk_label_new (_(" A^2                     "));
  gtk_widget_ref (label141);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "label141", label141,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label141);
  gtk_box_pack_start (GTK_BOX (check_waters_b_factor_hbox), label141, FALSE, FALSE, 0);

  check_waters_b_factor_entry_active_checkbutton = gtk_check_button_new_with_label (_("Active"));
  gtk_widget_ref (check_waters_b_factor_entry_active_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_b_factor_entry_active_checkbutton", check_waters_b_factor_entry_active_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_b_factor_entry_active_checkbutton);
  gtk_box_pack_start (GTK_BOX (hbox74), check_waters_b_factor_entry_active_checkbutton, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (check_waters_b_factor_entry_active_checkbutton), TRUE);

  hbox75 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox75);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "hbox75", hbox75,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox75);
  gtk_box_pack_start (GTK_BOX (vbox101), hbox75, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox75), 2);

  check_waters_sigma_level_hbox = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (check_waters_sigma_level_hbox);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_sigma_level_hbox", check_waters_sigma_level_hbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_sigma_level_hbox);
  gtk_box_pack_start (GTK_BOX (hbox75), check_waters_sigma_level_hbox, TRUE, TRUE, 0);

  label138 = gtk_label_new (_("  with map sigma level less than:  "));
  gtk_widget_ref (label138);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "label138", label138,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label138);
  gtk_box_pack_start (GTK_BOX (check_waters_sigma_level_hbox), label138, FALSE, FALSE, 0);

  check_waters_map_sigma_entry = gtk_entry_new ();
  gtk_widget_ref (check_waters_map_sigma_entry);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_map_sigma_entry", check_waters_map_sigma_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_map_sigma_entry);
  gtk_box_pack_start (GTK_BOX (check_waters_sigma_level_hbox), check_waters_map_sigma_entry, TRUE, TRUE, 0);
  gtk_widget_set_usize (check_waters_map_sigma_entry, 72, -2);

  label142 = gtk_label_new (_(" electrons/A3 "));
  gtk_widget_ref (label142);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "label142", label142,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label142);
  gtk_box_pack_start (GTK_BOX (check_waters_sigma_level_hbox), label142, FALSE, FALSE, 0);

  check_waters_map_sigma_entry_active_checkbutton = gtk_check_button_new_with_label (_("Active"));
  gtk_widget_ref (check_waters_map_sigma_entry_active_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_map_sigma_entry_active_checkbutton", check_waters_map_sigma_entry_active_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_map_sigma_entry_active_checkbutton);
  gtk_box_pack_start (GTK_BOX (hbox75), check_waters_map_sigma_entry_active_checkbutton, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (check_waters_map_sigma_entry_active_checkbutton), TRUE);

  hbox76 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox76);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "hbox76", hbox76,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox76);
  gtk_box_pack_start (GTK_BOX (vbox101), hbox76, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox76), 2);

  check_waters_min_dist_hbox = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (check_waters_min_dist_hbox);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_min_dist_hbox", check_waters_min_dist_hbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_min_dist_hbox);
  gtk_box_pack_start (GTK_BOX (hbox76), check_waters_min_dist_hbox, TRUE, TRUE, 0);

  label139 = gtk_label_new (_("  with closest contact less than:  "));
  gtk_widget_ref (label139);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "label139", label139,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label139);
  gtk_box_pack_start (GTK_BOX (check_waters_min_dist_hbox), label139, FALSE, FALSE, 0);

  check_waters_min_dist_entry = gtk_entry_new ();
  gtk_widget_ref (check_waters_min_dist_entry);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_min_dist_entry", check_waters_min_dist_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_min_dist_entry);
  gtk_box_pack_start (GTK_BOX (check_waters_min_dist_hbox), check_waters_min_dist_entry, TRUE, TRUE, 0);
  gtk_widget_set_usize (check_waters_min_dist_entry, 78, -2);

  label143 = gtk_label_new (_(" A                 "));
  gtk_widget_ref (label143);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "label143", label143,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label143);
  gtk_box_pack_start (GTK_BOX (check_waters_min_dist_hbox), label143, FALSE, FALSE, 0);

  check_waters_min_dist_entry_active_checkbutton = gtk_check_button_new_with_label (_("Active"));
  gtk_widget_ref (check_waters_min_dist_entry_active_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_min_dist_entry_active_checkbutton", check_waters_min_dist_entry_active_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_min_dist_entry_active_checkbutton);
  gtk_box_pack_start (GTK_BOX (hbox76), check_waters_min_dist_entry_active_checkbutton, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (check_waters_min_dist_entry_active_checkbutton), TRUE);

  hbox77 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox77);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "hbox77", hbox77,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox77);
  gtk_box_pack_start (GTK_BOX (vbox101), hbox77, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox77), 2);

  check_waters_max_dist_hbox = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (check_waters_max_dist_hbox);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_max_dist_hbox", check_waters_max_dist_hbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_max_dist_hbox);
  gtk_box_pack_start (GTK_BOX (hbox77), check_waters_max_dist_hbox, TRUE, TRUE, 0);

  label140 = gtk_label_new (_("  with closest contact more than:  "));
  gtk_widget_ref (label140);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "label140", label140,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label140);
  gtk_box_pack_start (GTK_BOX (check_waters_max_dist_hbox), label140, FALSE, FALSE, 0);

  check_waters_max_dist_entry = gtk_entry_new ();
  gtk_widget_ref (check_waters_max_dist_entry);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_max_dist_entry", check_waters_max_dist_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_max_dist_entry);
  gtk_box_pack_start (GTK_BOX (check_waters_max_dist_hbox), check_waters_max_dist_entry, TRUE, TRUE, 0);
  gtk_widget_set_usize (check_waters_max_dist_entry, 74, -2);

  label144 = gtk_label_new (_(" A                "));
  gtk_widget_ref (label144);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "label144", label144,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label144);
  gtk_box_pack_start (GTK_BOX (check_waters_max_dist_hbox), label144, FALSE, FALSE, 0);

  check_waters_max_dist_entry_active_checkbutton = gtk_check_button_new_with_label (_("Active"));
  gtk_widget_ref (check_waters_max_dist_entry_active_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_max_dist_entry_active_checkbutton", check_waters_max_dist_entry_active_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_max_dist_entry_active_checkbutton);
  gtk_box_pack_start (GTK_BOX (hbox77), check_waters_max_dist_entry_active_checkbutton, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (check_waters_max_dist_entry_active_checkbutton), TRUE);

  check_waters_low_occ_dist_checkbutton = gtk_check_button_new_with_label (_(" Ignore Partial Occupancy close contacts"));
  gtk_widget_ref (check_waters_low_occ_dist_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_low_occ_dist_checkbutton", check_waters_low_occ_dist_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_low_occ_dist_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox101), check_waters_low_occ_dist_checkbutton, FALSE, FALSE, 0);

  check_waters_zero_occ_checkbutton = gtk_check_button_new_with_label (_(" Ignore Waters with Zero Occupancy"));
  gtk_widget_ref (check_waters_zero_occ_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_zero_occ_checkbutton", check_waters_zero_occ_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_zero_occ_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox101), check_waters_zero_occ_checkbutton, FALSE, FALSE, 0);

  frame154 = gtk_frame_new (NULL);
  gtk_widget_ref (frame154);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "frame154", frame154,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame154);
  gtk_box_pack_start (GTK_BOX (vbox100), frame154, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame154), 6);

  vbox157 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox157);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "vbox157", vbox157,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox157);
  gtk_container_add (GTK_CONTAINER (frame154), vbox157);

  label244 = gtk_label_new (_("For Waters that match:"));
  gtk_widget_ref (label244);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "label244", label244,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label244);
  gtk_box_pack_start (GTK_BOX (vbox157), label244, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label244), 0, 0.5);

  check_waters_OR_radiobutton = gtk_radio_button_new_with_label (check_waters_logic_gr_group, _("Any Criterion"));
  check_waters_logic_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (check_waters_OR_radiobutton));
  gtk_widget_ref (check_waters_OR_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_OR_radiobutton", check_waters_OR_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_OR_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox157), check_waters_OR_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (check_waters_OR_radiobutton), 3);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (check_waters_OR_radiobutton), TRUE);

  check_waters_AND_radiobutton = gtk_radio_button_new_with_label (check_waters_logic_gr_group, _("All Criteria"));
  check_waters_logic_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (check_waters_AND_radiobutton));
  gtk_widget_ref (check_waters_AND_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_AND_radiobutton", check_waters_AND_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_AND_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox157), check_waters_AND_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (check_waters_AND_radiobutton), 3);
  gtk_tooltips_set_tip (tooltips, check_waters_AND_radiobutton, _("All criteria except the distance criteria (can be either)"), NULL);

  dialog_action_area38 = GTK_DIALOG (check_waters_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (check_waters_dialog), "dialog_action_area38", dialog_action_area38);
  gtk_widget_show (dialog_action_area38);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area38), 10);

  hbox78 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox78);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "hbox78", hbox78,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox78);
  gtk_box_pack_start (GTK_BOX (dialog_action_area38), hbox78, TRUE, TRUE, 0);

  check_waters_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (check_waters_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_ok_button", check_waters_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox78), check_waters_ok_button, TRUE, TRUE, 2);

  check_waters_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (check_waters_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_dialog), "check_waters_cancel_button", check_waters_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox78), check_waters_cancel_button, TRUE, TRUE, 2);

  gtk_signal_connect (GTK_OBJECT (check_waters_b_factor_entry_active_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_check_waters_b_factor_entry_active_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (check_waters_map_sigma_entry_active_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_check_waters_map_sigma_entry_active_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (check_waters_min_dist_entry_active_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_check_waters_min_dist_entry_active_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (check_waters_max_dist_entry_active_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_check_waters_max_dist_entry_active_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (check_waters_low_occ_dist_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_check_waters_low_occ_dist_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (check_waters_zero_occ_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_check_waters_zero_occ_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (check_waters_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_check_waters_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (check_waters_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_check_waters_cancel_button_clicked),
                      NULL);

  gtk_object_set_data (GTK_OBJECT (check_waters_dialog), "tooltips", tooltips);

  return check_waters_dialog;
}

GtkWidget*
create_geometry_dialog (void)
{
  GtkWidget *geometry_dialog;
  GtkWidget *dialog_vbox39;
  GtkWidget *vbox102;
  GtkWidget *geometry_distance_togglebutton;
  GtkWidget *geometry_angle_togglebutton;
  GtkWidget *geometry_torsion_togglebutton;
  GtkWidget *hseparator10;
  GtkWidget *geometry_clear_last_distance_button;
  GtkWidget *geometry_clear_all_distances_button;
  GtkWidget *geometry_clear_atom_labels_button;
  GtkWidget *dialog_action_area39;
  GtkWidget *geometry_dialog_close_button;

  geometry_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (geometry_dialog), "geometry_dialog", geometry_dialog);
  gtk_container_set_border_width (GTK_CONTAINER (geometry_dialog), 6);
  gtk_window_set_title (GTK_WINDOW (geometry_dialog), _("Geometry"));
  gtk_window_set_policy (GTK_WINDOW (geometry_dialog), TRUE, TRUE, FALSE);

  dialog_vbox39 = GTK_DIALOG (geometry_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (geometry_dialog), "dialog_vbox39", dialog_vbox39);
  gtk_widget_show (dialog_vbox39);

  vbox102 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox102);
  gtk_object_set_data_full (GTK_OBJECT (geometry_dialog), "vbox102", vbox102,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox102);
  gtk_box_pack_start (GTK_BOX (dialog_vbox39), vbox102, TRUE, TRUE, 0);

  geometry_distance_togglebutton = gtk_toggle_button_new_with_label (_("  Distance  "));
  gtk_widget_ref (geometry_distance_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (geometry_dialog), "geometry_distance_togglebutton", geometry_distance_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (geometry_distance_togglebutton);
  gtk_box_pack_start (GTK_BOX (vbox102), geometry_distance_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (geometry_distance_togglebutton), 2);

  geometry_angle_togglebutton = gtk_toggle_button_new_with_label (_("  Angle  "));
  gtk_widget_ref (geometry_angle_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (geometry_dialog), "geometry_angle_togglebutton", geometry_angle_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (geometry_angle_togglebutton);
  gtk_box_pack_start (GTK_BOX (vbox102), geometry_angle_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (geometry_angle_togglebutton), 2);

  geometry_torsion_togglebutton = gtk_toggle_button_new_with_label (_("  Torsion  "));
  gtk_widget_ref (geometry_torsion_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (geometry_dialog), "geometry_torsion_togglebutton", geometry_torsion_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (geometry_torsion_togglebutton);
  gtk_box_pack_start (GTK_BOX (vbox102), geometry_torsion_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (geometry_torsion_togglebutton), 2);

  hseparator10 = gtk_hseparator_new ();
  gtk_widget_ref (hseparator10);
  gtk_object_set_data_full (GTK_OBJECT (geometry_dialog), "hseparator10", hseparator10,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hseparator10);
  gtk_box_pack_start (GTK_BOX (vbox102), hseparator10, TRUE, TRUE, 0);
  gtk_widget_set_usize (hseparator10, -2, 10);

  geometry_clear_last_distance_button = gtk_button_new_with_label (_("  Clear Last Distance  "));
  gtk_widget_ref (geometry_clear_last_distance_button);
  gtk_object_set_data_full (GTK_OBJECT (geometry_dialog), "geometry_clear_last_distance_button", geometry_clear_last_distance_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (geometry_clear_last_distance_button);
  gtk_box_pack_start (GTK_BOX (vbox102), geometry_clear_last_distance_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (geometry_clear_last_distance_button), 2);

  geometry_clear_all_distances_button = gtk_button_new_with_label (_("  Clear All Distances  "));
  gtk_widget_ref (geometry_clear_all_distances_button);
  gtk_object_set_data_full (GTK_OBJECT (geometry_dialog), "geometry_clear_all_distances_button", geometry_clear_all_distances_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (geometry_clear_all_distances_button);
  gtk_box_pack_start (GTK_BOX (vbox102), geometry_clear_all_distances_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (geometry_clear_all_distances_button), 2);

  geometry_clear_atom_labels_button = gtk_button_new_with_label (_("  Clear All Atom Labels  "));
  gtk_widget_ref (geometry_clear_atom_labels_button);
  gtk_object_set_data_full (GTK_OBJECT (geometry_dialog), "geometry_clear_atom_labels_button", geometry_clear_atom_labels_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (geometry_clear_atom_labels_button);
  gtk_box_pack_start (GTK_BOX (vbox102), geometry_clear_atom_labels_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (geometry_clear_atom_labels_button), 2);

  dialog_action_area39 = GTK_DIALOG (geometry_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (geometry_dialog), "dialog_action_area39", dialog_action_area39);
  gtk_widget_show (dialog_action_area39);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area39), 10);

  geometry_dialog_close_button = gtk_button_new_with_label (_("  Close  "));
  gtk_widget_ref (geometry_dialog_close_button);
  gtk_object_set_data_full (GTK_OBJECT (geometry_dialog), "geometry_dialog_close_button", geometry_dialog_close_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (geometry_dialog_close_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area39), geometry_dialog_close_button, TRUE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (geometry_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_geometry_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (geometry_distance_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_geometry_distance_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (geometry_angle_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_geometry_angle_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (geometry_torsion_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_geometry_torsion_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (geometry_clear_last_distance_button), "clicked",
                      GTK_SIGNAL_FUNC (on_geometry_clear_last_distance_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (geometry_clear_all_distances_button), "clicked",
                      GTK_SIGNAL_FUNC (on_geometry_clear_all_distances_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (geometry_clear_atom_labels_button), "clicked",
                      GTK_SIGNAL_FUNC (on_geometry_clear_atom_labels_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (geometry_dialog_close_button), "clicked",
                      GTK_SIGNAL_FUNC (on_geometry_dialog_close_button_clicked),
                      NULL);

  return geometry_dialog;
}

GtkWidget*
create_new_ligands_info_dialog (void)
{
  GtkWidget *new_ligands_info_dialog;
  GtkWidget *dialog_vbox40;
  GtkWidget *vbox103;
  GtkWidget *new_ligands_info_dialog_label;
  GtkWidget *label148;
  GtkWidget *dialog_action_area40;
  GtkWidget *new_ligands_info_dialog_ok_button;

  new_ligands_info_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (new_ligands_info_dialog), "new_ligands_info_dialog", new_ligands_info_dialog);
  gtk_window_set_title (GTK_WINDOW (new_ligands_info_dialog), _("New Ligands"));
  gtk_window_set_policy (GTK_WINDOW (new_ligands_info_dialog), TRUE, TRUE, FALSE);

  dialog_vbox40 = GTK_DIALOG (new_ligands_info_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (new_ligands_info_dialog), "dialog_vbox40", dialog_vbox40);
  gtk_widget_show (dialog_vbox40);

  vbox103 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox103);
  gtk_object_set_data_full (GTK_OBJECT (new_ligands_info_dialog), "vbox103", vbox103,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox103);
  gtk_box_pack_start (GTK_BOX (dialog_vbox40), vbox103, FALSE, FALSE, 0);

  new_ligands_info_dialog_label = gtk_label_new (_("Found 4 acceptable ligands"));
  gtk_widget_ref (new_ligands_info_dialog_label);
  gtk_object_set_data_full (GTK_OBJECT (new_ligands_info_dialog), "new_ligands_info_dialog_label", new_ligands_info_dialog_label,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (new_ligands_info_dialog_label);
  gtk_box_pack_start (GTK_BOX (vbox103), new_ligands_info_dialog_label, FALSE, FALSE, 4);
  gtk_misc_set_padding (GTK_MISC (new_ligands_info_dialog_label), 3, 15);

  label148 = gtk_label_new (_("Use Display Manager and Goto Atom \nMolecule optionmenu to navigate these \nnew molecules"));
  gtk_widget_ref (label148);
  gtk_object_set_data_full (GTK_OBJECT (new_ligands_info_dialog), "label148", label148,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (vbox103), label148, FALSE, FALSE, 7);
  gtk_misc_set_padding (GTK_MISC (label148), 7, 0);

  dialog_action_area40 = GTK_DIALOG (new_ligands_info_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (new_ligands_info_dialog), "dialog_action_area40", dialog_action_area40);
  gtk_widget_show (dialog_action_area40);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area40), 10);

  new_ligands_info_dialog_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (new_ligands_info_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (new_ligands_info_dialog), "new_ligands_info_dialog_ok_button", new_ligands_info_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (new_ligands_info_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area40), new_ligands_info_dialog_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (new_ligands_info_dialog_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (new_ligands_info_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_new_ligands_info_dialog_ok_button_clicked),
                      NULL);

  gtk_widget_grab_default (new_ligands_info_dialog_ok_button);
  return new_ligands_info_dialog;
}

GtkWidget*
create_no_new_ligands_info_dialog (void)
{
  GtkWidget *no_new_ligands_info_dialog;
  GtkWidget *dialog_vbox41;
  GtkWidget *label149;
  GtkWidget *dialog_action_area41;
  GtkWidget *no_new_ligands_info_dialog_ok_button;

  no_new_ligands_info_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (no_new_ligands_info_dialog), "no_new_ligands_info_dialog", no_new_ligands_info_dialog);
  gtk_window_set_title (GTK_WINDOW (no_new_ligands_info_dialog), _("No New Ligands"));
  gtk_window_set_policy (GTK_WINDOW (no_new_ligands_info_dialog), TRUE, TRUE, FALSE);

  dialog_vbox41 = GTK_DIALOG (no_new_ligands_info_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (no_new_ligands_info_dialog), "dialog_vbox41", dialog_vbox41);
  gtk_widget_show (dialog_vbox41);

  label149 = gtk_label_new (_("Sadly no ligands were found.\n\nPerhaps there were no ligands to be found?\n\nAlternatively you could try to reduce the search \nsigma level or the acceptable fit fraction."));
  gtk_widget_ref (label149);
  gtk_object_set_data_full (GTK_OBJECT (no_new_ligands_info_dialog), "label149", label149,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label149);
  gtk_box_pack_start (GTK_BOX (dialog_vbox41), label149, FALSE, FALSE, 10);
  gtk_misc_set_padding (GTK_MISC (label149), 1, 6);

  dialog_action_area41 = GTK_DIALOG (no_new_ligands_info_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (no_new_ligands_info_dialog), "dialog_action_area41", dialog_action_area41);
  gtk_widget_show (dialog_action_area41);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area41), 10);

  no_new_ligands_info_dialog_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (no_new_ligands_info_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (no_new_ligands_info_dialog), "no_new_ligands_info_dialog_ok_button", no_new_ligands_info_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (no_new_ligands_info_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area41), no_new_ligands_info_dialog_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (no_new_ligands_info_dialog_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (no_new_ligands_info_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_no_new_ligands_info_dialog_ok_button_clicked),
                      NULL);

  gtk_widget_grab_default (no_new_ligands_info_dialog_ok_button);
  return no_new_ligands_info_dialog;
}

GtkWidget*
create_zoom_dialog (void)
{
  GtkWidget *zoom_dialog;
  GtkWidget *dialog_vbox42;
  GtkWidget *vbox104;
  GtkWidget *label150;
  GtkWidget *frame86;
  GtkWidget *zoom_hscale;
  GtkWidget *dialog_action_area42;
  GtkWidget *zoom_dialog_ok_button;

  zoom_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (zoom_dialog), "zoom_dialog", zoom_dialog);
  gtk_window_set_title (GTK_WINDOW (zoom_dialog), _("Zoom Control"));
  gtk_window_set_policy (GTK_WINDOW (zoom_dialog), TRUE, TRUE, FALSE);

  dialog_vbox42 = GTK_DIALOG (zoom_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (zoom_dialog), "dialog_vbox42", dialog_vbox42);
  gtk_widget_show (dialog_vbox42);

  vbox104 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox104);
  gtk_object_set_data_full (GTK_OBJECT (zoom_dialog), "vbox104", vbox104,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox104);
  gtk_box_pack_start (GTK_BOX (dialog_vbox42), vbox104, TRUE, TRUE, 0);

  label150 = gtk_label_new ("");
  gtk_widget_ref (label150);
  gtk_object_set_data_full (GTK_OBJECT (zoom_dialog), "label150", label150,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label150);
  gtk_box_pack_start (GTK_BOX (vbox104), label150, FALSE, FALSE, 5);

  frame86 = gtk_frame_new (_("Zoom Control"));
  gtk_widget_ref (frame86);
  gtk_object_set_data_full (GTK_OBJECT (zoom_dialog), "frame86", frame86,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame86);
  gtk_box_pack_start (GTK_BOX (vbox104), frame86, FALSE, FALSE, 9);
  gtk_widget_set_usize (frame86, 270, -2);
  gtk_container_set_border_width (GTK_CONTAINER (frame86), 7);

  zoom_hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (zoom_hscale);
  gtk_object_set_data_full (GTK_OBJECT (zoom_dialog), "zoom_hscale", zoom_hscale,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (zoom_hscale);
  gtk_container_add (GTK_CONTAINER (frame86), zoom_hscale);

  dialog_action_area42 = GTK_DIALOG (zoom_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (zoom_dialog), "dialog_action_area42", dialog_action_area42);
  gtk_widget_show (dialog_action_area42);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area42), 10);

  zoom_dialog_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (zoom_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (zoom_dialog), "zoom_dialog_ok_button", zoom_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (zoom_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area42), zoom_dialog_ok_button, TRUE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (zoom_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_zoom_dialog_ok_button_clicked),
                      NULL);

  return zoom_dialog;
}

GtkWidget*
create_libcheck_monomer_dialog (void)
{
  GtkWidget *libcheck_monomer_dialog;
  GtkWidget *dialog_vbox43;
  GtkWidget *vbox105;
  GtkWidget *hbox80;
  GtkWidget *label151;
  GtkWidget *libcheck_monomer_entry;
  GtkWidget *label152;
  GtkWidget *dialog_action_area43;
  GtkWidget *hbox81;
  GtkWidget *libcheck_monomer_ok_button;
  GtkWidget *libcheck_monomer_cancel_button;

  libcheck_monomer_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (libcheck_monomer_dialog), "libcheck_monomer_dialog", libcheck_monomer_dialog);
  gtk_window_set_title (GTK_WINDOW (libcheck_monomer_dialog), _("Get monomer molecule from libcheck"));
  gtk_window_set_policy (GTK_WINDOW (libcheck_monomer_dialog), TRUE, TRUE, FALSE);

  dialog_vbox43 = GTK_DIALOG (libcheck_monomer_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (libcheck_monomer_dialog), "dialog_vbox43", dialog_vbox43);
  gtk_widget_show (dialog_vbox43);

  vbox105 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox105);
  gtk_object_set_data_full (GTK_OBJECT (libcheck_monomer_dialog), "vbox105", vbox105,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox105);
  gtk_box_pack_start (GTK_BOX (dialog_vbox43), vbox105, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (vbox105), 4);

  hbox80 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox80);
  gtk_object_set_data_full (GTK_OBJECT (libcheck_monomer_dialog), "hbox80", hbox80,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox80);
  gtk_box_pack_start (GTK_BOX (vbox105), hbox80, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox80), 17);

  label151 = gtk_label_new (_("  3 Letter Code: "));
  gtk_widget_ref (label151);
  gtk_object_set_data_full (GTK_OBJECT (libcheck_monomer_dialog), "label151", label151,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label151);
  gtk_box_pack_start (GTK_BOX (hbox80), label151, FALSE, FALSE, 0);

  libcheck_monomer_entry = gtk_entry_new ();
  gtk_widget_ref (libcheck_monomer_entry);
  gtk_object_set_data_full (GTK_OBJECT (libcheck_monomer_dialog), "libcheck_monomer_entry", libcheck_monomer_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (libcheck_monomer_entry);
  gtk_box_pack_start (GTK_BOX (hbox80), libcheck_monomer_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (libcheck_monomer_entry, 53, -2);

  label152 = gtk_label_new (_("  Note: Code is Case Sensitive  "));
  gtk_widget_ref (label152);
  gtk_object_set_data_full (GTK_OBJECT (libcheck_monomer_dialog), "label152", label152,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label152);
  gtk_box_pack_start (GTK_BOX (vbox105), label152, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label152), 10, 2);

  dialog_action_area43 = GTK_DIALOG (libcheck_monomer_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (libcheck_monomer_dialog), "dialog_action_area43", dialog_action_area43);
  gtk_widget_show (dialog_action_area43);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area43), 10);

  hbox81 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox81);
  gtk_object_set_data_full (GTK_OBJECT (libcheck_monomer_dialog), "hbox81", hbox81,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox81);
  gtk_box_pack_start (GTK_BOX (dialog_action_area43), hbox81, TRUE, TRUE, 0);

  libcheck_monomer_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (libcheck_monomer_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (libcheck_monomer_dialog), "libcheck_monomer_ok_button", libcheck_monomer_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (libcheck_monomer_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox81), libcheck_monomer_ok_button, TRUE, TRUE, 4);
  GTK_WIDGET_SET_FLAGS (libcheck_monomer_ok_button, GTK_CAN_DEFAULT);

  libcheck_monomer_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (libcheck_monomer_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (libcheck_monomer_dialog), "libcheck_monomer_cancel_button", libcheck_monomer_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (libcheck_monomer_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox81), libcheck_monomer_cancel_button, TRUE, TRUE, 4);
  GTK_WIDGET_SET_FLAGS (libcheck_monomer_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (libcheck_monomer_entry), "key_press_event",
                      GTK_SIGNAL_FUNC (on_libcheck_monomer_entry_key_press_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (libcheck_monomer_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_libcheck_monomer_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (libcheck_monomer_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_libcheck_monomer_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (libcheck_monomer_ok_button);
  gtk_widget_grab_default (libcheck_monomer_ok_button);
  return libcheck_monomer_dialog;
}

GtkWidget*
create_recover_coordinates_dialog (void)
{
  GtkWidget *recover_coordinates_dialog;
  GtkWidget *dialog_vbox44;
  GtkWidget *frame88;
  GtkWidget *vbox107;
  GtkWidget *label153;
  GtkWidget *recover_coordinates_read_coords_label;
  GtkWidget *label154;
  GtkWidget *recover_coordinates_backup_coordinates_label;
  GtkWidget *dialog_action_area44;
  GtkWidget *hbox82;
  GtkWidget *recover_coordinates_ok_button;
  GtkWidget *recover_coordinates_cancel_button;

  recover_coordinates_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (recover_coordinates_dialog), "recover_coordinates_dialog", recover_coordinates_dialog);
  gtk_window_set_title (GTK_WINDOW (recover_coordinates_dialog), _("Recover Coordinates"));
  gtk_window_set_policy (GTK_WINDOW (recover_coordinates_dialog), TRUE, TRUE, FALSE);

  dialog_vbox44 = GTK_DIALOG (recover_coordinates_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (recover_coordinates_dialog), "dialog_vbox44", dialog_vbox44);
  gtk_widget_show (dialog_vbox44);

  frame88 = gtk_frame_new (NULL);
  gtk_widget_ref (frame88);
  gtk_object_set_data_full (GTK_OBJECT (recover_coordinates_dialog), "frame88", frame88,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame88);
  gtk_box_pack_start (GTK_BOX (dialog_vbox44), frame88, TRUE, TRUE, 13);
  gtk_container_set_border_width (GTK_CONTAINER (frame88), 7);

  vbox107 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox107);
  gtk_object_set_data_full (GTK_OBJECT (recover_coordinates_dialog), "vbox107", vbox107,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox107);
  gtk_container_add (GTK_CONTAINER (frame88), vbox107);

  label153 = gtk_label_new (_("Read Coordinates:"));
  gtk_widget_ref (label153);
  gtk_object_set_data_full (GTK_OBJECT (recover_coordinates_dialog), "label153", label153,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label153);
  gtk_box_pack_start (GTK_BOX (vbox107), label153, FALSE, FALSE, 4);
  gtk_misc_set_alignment (GTK_MISC (label153), 0, 0.5);
  gtk_misc_set_padding (GTK_MISC (label153), 0, 6);

  recover_coordinates_read_coords_label = gtk_label_new (_("molecule name"));
  gtk_widget_ref (recover_coordinates_read_coords_label);
  gtk_object_set_data_full (GTK_OBJECT (recover_coordinates_dialog), "recover_coordinates_read_coords_label", recover_coordinates_read_coords_label,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (recover_coordinates_read_coords_label);
  gtk_box_pack_start (GTK_BOX (vbox107), recover_coordinates_read_coords_label, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (recover_coordinates_read_coords_label), 7.45058e-09, 0.5);
  gtk_misc_set_padding (GTK_MISC (recover_coordinates_read_coords_label), 0, 4);

  label154 = gtk_label_new (_("Backup Coordinates:"));
  gtk_widget_ref (label154);
  gtk_object_set_data_full (GTK_OBJECT (recover_coordinates_dialog), "label154", label154,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label154);
  gtk_box_pack_start (GTK_BOX (vbox107), label154, FALSE, FALSE, 4);
  gtk_misc_set_alignment (GTK_MISC (label154), 0, 0.5);
  gtk_misc_set_padding (GTK_MISC (label154), 0, 6);

  recover_coordinates_backup_coordinates_label = gtk_label_new (_("filename"));
  gtk_widget_ref (recover_coordinates_backup_coordinates_label);
  gtk_object_set_data_full (GTK_OBJECT (recover_coordinates_dialog), "recover_coordinates_backup_coordinates_label", recover_coordinates_backup_coordinates_label,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (recover_coordinates_backup_coordinates_label);
  gtk_box_pack_start (GTK_BOX (vbox107), recover_coordinates_backup_coordinates_label, FALSE, FALSE, 2);
  gtk_misc_set_alignment (GTK_MISC (recover_coordinates_backup_coordinates_label), 7.45058e-09, 0.5);
  gtk_misc_set_padding (GTK_MISC (recover_coordinates_backup_coordinates_label), 0, 4);

  dialog_action_area44 = GTK_DIALOG (recover_coordinates_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (recover_coordinates_dialog), "dialog_action_area44", dialog_action_area44);
  gtk_widget_show (dialog_action_area44);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area44), 10);

  hbox82 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox82);
  gtk_object_set_data_full (GTK_OBJECT (recover_coordinates_dialog), "hbox82", hbox82,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox82);
  gtk_box_pack_start (GTK_BOX (dialog_action_area44), hbox82, TRUE, TRUE, 0);

  recover_coordinates_ok_button = gtk_button_new_with_label (_("  Recover  "));
  gtk_widget_ref (recover_coordinates_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (recover_coordinates_dialog), "recover_coordinates_ok_button", recover_coordinates_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (recover_coordinates_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox82), recover_coordinates_ok_button, TRUE, FALSE, 4);
  GTK_WIDGET_SET_FLAGS (recover_coordinates_ok_button, GTK_CAN_DEFAULT);

  recover_coordinates_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (recover_coordinates_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (recover_coordinates_dialog), "recover_coordinates_cancel_button", recover_coordinates_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (recover_coordinates_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox82), recover_coordinates_cancel_button, TRUE, FALSE, 4);
  GTK_WIDGET_SET_FLAGS (recover_coordinates_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (recover_coordinates_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_recover_coordinates_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (recover_coordinates_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_recover_coordinates_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_default (recover_coordinates_ok_button);
  return recover_coordinates_dialog;
}

GtkWidget*
create_centre_atom_label_dialog (void)
{
  GtkWidget *centre_atom_label_dialog;
  GtkWidget *dialog_vbox45;
  GtkWidget *frame89;
  GtkWidget *vbox108;
  GtkWidget *label155;
  GSList *centre_atom_label_gr_group = NULL;
  GtkWidget *centre_atom_label_radiobutton_on;
  GtkWidget *centre_atom_label_radiobutton_off;
  GtkWidget *label166;
  GtkWidget *dialog_action_area45;
  GtkWidget *centre_atom_label_ok_button;

  centre_atom_label_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (centre_atom_label_dialog), "centre_atom_label_dialog", centre_atom_label_dialog);
  gtk_window_set_title (GTK_WINDOW (centre_atom_label_dialog), _("Centre Atom Label"));
  gtk_window_set_policy (GTK_WINDOW (centre_atom_label_dialog), TRUE, TRUE, FALSE);

  dialog_vbox45 = GTK_DIALOG (centre_atom_label_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (centre_atom_label_dialog), "dialog_vbox45", dialog_vbox45);
  gtk_widget_show (dialog_vbox45);

  frame89 = gtk_frame_new (NULL);
  gtk_widget_ref (frame89);
  gtk_object_set_data_full (GTK_OBJECT (centre_atom_label_dialog), "frame89", frame89,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame89);
  gtk_box_pack_start (GTK_BOX (dialog_vbox45), frame89, TRUE, TRUE, 6);
  gtk_container_set_border_width (GTK_CONTAINER (frame89), 6);

  vbox108 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox108);
  gtk_object_set_data_full (GTK_OBJECT (centre_atom_label_dialog), "vbox108", vbox108,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox108);
  gtk_container_add (GTK_CONTAINER (frame89), vbox108);

  label155 = gtk_label_new (_("Label Centre Atom on Recentre?"));
  gtk_widget_ref (label155);
  gtk_object_set_data_full (GTK_OBJECT (centre_atom_label_dialog), "label155", label155,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label155);
  gtk_box_pack_start (GTK_BOX (vbox108), label155, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label155), 26, 18);

  centre_atom_label_radiobutton_on = gtk_radio_button_new_with_label (centre_atom_label_gr_group, _("On"));
  centre_atom_label_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (centre_atom_label_radiobutton_on));
  gtk_widget_ref (centre_atom_label_radiobutton_on);
  gtk_object_set_data_full (GTK_OBJECT (centre_atom_label_dialog), "centre_atom_label_radiobutton_on", centre_atom_label_radiobutton_on,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (centre_atom_label_radiobutton_on);
  gtk_box_pack_start (GTK_BOX (vbox108), centre_atom_label_radiobutton_on, FALSE, FALSE, 4);

  centre_atom_label_radiobutton_off = gtk_radio_button_new_with_label (centre_atom_label_gr_group, _("Off"));
  centre_atom_label_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (centre_atom_label_radiobutton_off));
  gtk_widget_ref (centre_atom_label_radiobutton_off);
  gtk_object_set_data_full (GTK_OBJECT (centre_atom_label_dialog), "centre_atom_label_radiobutton_off", centre_atom_label_radiobutton_off,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (centre_atom_label_radiobutton_off);
  gtk_box_pack_start (GTK_BOX (vbox108), centre_atom_label_radiobutton_off, FALSE, FALSE, 4);

  label166 = gtk_label_new (_("[   Note: this setting is trumped by   ]\n[ Evironment Disance Label Atom? ]"));
  gtk_widget_ref (label166);
  gtk_object_set_data_full (GTK_OBJECT (centre_atom_label_dialog), "label166", label166,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label166);
  gtk_box_pack_start (GTK_BOX (dialog_vbox45), label166, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label166), 0, 5);

  dialog_action_area45 = GTK_DIALOG (centre_atom_label_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (centre_atom_label_dialog), "dialog_action_area45", dialog_action_area45);
  gtk_widget_show (dialog_action_area45);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area45), 10);

  centre_atom_label_ok_button = gtk_button_new_with_label (_("  Dismiss  "));
  gtk_widget_ref (centre_atom_label_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (centre_atom_label_dialog), "centre_atom_label_ok_button", centre_atom_label_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (centre_atom_label_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area45), centre_atom_label_ok_button, TRUE, FALSE, 0);
  GTK_WIDGET_SET_FLAGS (centre_atom_label_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (centre_atom_label_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_centre_atom_label_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (centre_atom_label_ok_button);
  gtk_widget_grab_default (centre_atom_label_ok_button);
  return centre_atom_label_dialog;
}

GtkWidget*
create_chi_angle_help_dialog (void)
{
  GtkWidget *chi_angle_help_dialog;
  GtkWidget *dialog_vbox46;
  GtkWidget *frame96;
  GtkWidget *label156;
  GtkWidget *dialog_action_area46;
  GtkWidget *help_chi_angles_dismiss_button;

  chi_angle_help_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (chi_angle_help_dialog), "chi_angle_help_dialog", chi_angle_help_dialog);
  gtk_window_set_title (GTK_WINDOW (chi_angle_help_dialog), _("Chi Angle Help"));
  gtk_window_set_policy (GTK_WINDOW (chi_angle_help_dialog), TRUE, TRUE, FALSE);

  dialog_vbox46 = GTK_DIALOG (chi_angle_help_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (chi_angle_help_dialog), "dialog_vbox46", dialog_vbox46);
  gtk_widget_show (dialog_vbox46);

  frame96 = gtk_frame_new (NULL);
  gtk_widget_ref (frame96);
  gtk_object_set_data_full (GTK_OBJECT (chi_angle_help_dialog), "frame96", frame96,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame96);
  gtk_box_pack_start (GTK_BOX (dialog_vbox46), frame96, TRUE, TRUE, 2);
  gtk_container_set_border_width (GTK_CONTAINER (frame96), 4);

  label156 = gtk_label_new ("");
  gtk_label_parse_uline (GTK_LABEL (label156),
                         _("  Select the chi angle (rotatable bond) by clicking \non the button in the list.\n\nIn the graphics window, click and drag as you\nwould if you wanted to change the view - this \ncauses the atoms to move.\n\nThere are keyboard equivalents to the butons, \"1\" \n  will rotate chi__1, \"2\" will rotate chi__2 etc...\n\nTo make the view move (rather than the intermediate \natoms), click the \"View Rotation Mode\" button or use \nthe Ctrl key when moving the mouse."));
  gtk_widget_ref (label156);
  gtk_object_set_data_full (GTK_OBJECT (chi_angle_help_dialog), "label156", label156,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label156);
  gtk_container_add (GTK_CONTAINER (frame96), label156);
  gtk_misc_set_alignment (GTK_MISC (label156), 0, 0.5);
  gtk_misc_set_padding (GTK_MISC (label156), 2, 8);

  dialog_action_area46 = GTK_DIALOG (chi_angle_help_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (chi_angle_help_dialog), "dialog_action_area46", dialog_action_area46);
  gtk_widget_show (dialog_action_area46);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area46), 10);

  help_chi_angles_dismiss_button = gtk_button_new_with_label (_("  Dismiss  "));
  gtk_widget_ref (help_chi_angles_dismiss_button);
  gtk_object_set_data_full (GTK_OBJECT (chi_angle_help_dialog), "help_chi_angles_dismiss_button", help_chi_angles_dismiss_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (help_chi_angles_dismiss_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area46), help_chi_angles_dismiss_button, FALSE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (help_chi_angles_dismiss_button), "clicked",
                      GTK_SIGNAL_FUNC (on_help_chi_angles_dismiss_button_clicked),
                      NULL);

  return chi_angle_help_dialog;
}

GtkWidget*
create_no_symmetry_warning_dialog (void)
{
  GtkWidget *no_symmetry_warning_dialog;
  GtkWidget *dialog_vbox47;
  GtkWidget *label157;
  GtkWidget *dialog_action_area47;
  GtkWidget *no_symmetry_warning_ok_button;

  no_symmetry_warning_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (no_symmetry_warning_dialog), "no_symmetry_warning_dialog", no_symmetry_warning_dialog);
  gtk_window_set_title (GTK_WINDOW (no_symmetry_warning_dialog), _("No Symmetry!"));
  gtk_window_set_policy (GTK_WINDOW (no_symmetry_warning_dialog), TRUE, TRUE, FALSE);

  dialog_vbox47 = GTK_DIALOG (no_symmetry_warning_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (no_symmetry_warning_dialog), "dialog_vbox47", dialog_vbox47);
  gtk_widget_show (dialog_vbox47);

  label157 = gtk_label_new (_("\n\nWARNING!\n\nSymmetry Library not found\n\nIf you need symmetry, setup ccp4 before starting coot\n\n\n"));
  gtk_widget_ref (label157);
  gtk_object_set_data_full (GTK_OBJECT (no_symmetry_warning_dialog), "label157", label157,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label157);
  gtk_box_pack_start (GTK_BOX (dialog_vbox47), label157, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label157), 15, 0);

  dialog_action_area47 = GTK_DIALOG (no_symmetry_warning_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (no_symmetry_warning_dialog), "dialog_action_area47", dialog_action_area47);
  gtk_widget_show (dialog_action_area47);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area47), 10);

  no_symmetry_warning_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (no_symmetry_warning_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (no_symmetry_warning_dialog), "no_symmetry_warning_ok_button", no_symmetry_warning_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (no_symmetry_warning_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area47), no_symmetry_warning_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (no_symmetry_warning_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (no_symmetry_warning_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_no_symmetry_warning_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (no_symmetry_warning_ok_button);
  gtk_widget_grab_default (no_symmetry_warning_ok_button);
  return no_symmetry_warning_dialog;
}

GtkWidget*
create_nothing_to_recover_dialog (void)
{
  GtkWidget *nothing_to_recover_dialog;
  GtkWidget *dialog_vbox48;
  GtkWidget *frame97;
  GtkWidget *label158;
  GtkWidget *dialog_action_area48;
  GtkWidget *nothing_to_recover_ok_button;

  nothing_to_recover_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (nothing_to_recover_dialog), "nothing_to_recover_dialog", nothing_to_recover_dialog);
  gtk_window_set_title (GTK_WINDOW (nothing_to_recover_dialog), _("Nothing to Recover"));
  gtk_window_set_policy (GTK_WINDOW (nothing_to_recover_dialog), TRUE, TRUE, FALSE);

  dialog_vbox48 = GTK_DIALOG (nothing_to_recover_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (nothing_to_recover_dialog), "dialog_vbox48", dialog_vbox48);
  gtk_widget_show (dialog_vbox48);

  frame97 = gtk_frame_new (NULL);
  gtk_widget_ref (frame97);
  gtk_object_set_data_full (GTK_OBJECT (nothing_to_recover_dialog), "frame97", frame97,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame97);
  gtk_box_pack_start (GTK_BOX (dialog_vbox48), frame97, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame97), 6);

  label158 = gtk_label_new (_("Nothing to recover"));
  gtk_widget_ref (label158);
  gtk_object_set_data_full (GTK_OBJECT (nothing_to_recover_dialog), "label158", label158,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label158);
  gtk_container_add (GTK_CONTAINER (frame97), label158);
  gtk_misc_set_padding (GTK_MISC (label158), 50, 20);

  dialog_action_area48 = GTK_DIALOG (nothing_to_recover_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (nothing_to_recover_dialog), "dialog_action_area48", dialog_action_area48);
  gtk_widget_show (dialog_action_area48);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area48), 10);

  nothing_to_recover_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (nothing_to_recover_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (nothing_to_recover_dialog), "nothing_to_recover_ok_button", nothing_to_recover_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (nothing_to_recover_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area48), nothing_to_recover_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (nothing_to_recover_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (nothing_to_recover_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_nothing_to_recover_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (nothing_to_recover_ok_button);
  gtk_widget_grab_default (nothing_to_recover_ok_button);
  return nothing_to_recover_dialog;
}

GtkWidget*
create_superpose_dialog (void)
{
  GtkWidget *superpose_dialog;
  GtkWidget *dialog_vbox49;
  GtkWidget *vbox109;
  GtkWidget *label159;
  GtkWidget *frame98;
  GtkWidget *vbox142;
  GtkWidget *superpose_dialog_reference_mol_optionmenu;
  GtkWidget *superpose_dialog_reference_mol_optionmenu_menu;
  GtkWidget *superpose_reference_structure_frame;
  GtkWidget *vbox144;
  GtkWidget *superpose_reference_chain_checkbutton;
  GtkWidget *superpose_reference_chain_optionmenu;
  GtkWidget *superpose_reference_chain_optionmenu_menu;
  GtkWidget *label160;
  GtkWidget *frame99;
  GtkWidget *vbox143;
  GtkWidget *superpose_dialog_moving_mol_optionmenu;
  GtkWidget *superpose_dialog_moving_mol_optionmenu_menu;
  GtkWidget *superpose_moving_structure_frame;
  GtkWidget *vbox145;
  GtkWidget *superpose_moving_chain_checkbutton;
  GtkWidget *superpose_moving_chain_optionmenu;
  GtkWidget *superpose_moving_chain_optionmenu_menu;
  GtkWidget *superpose_dialog_move_copy_checkbutton;
  GtkWidget *dialog_action_area49;
  GtkWidget *hbox83;
  GtkWidget *superpose_dialog_superpose_button;
  GtkWidget *superpose_dialog_cancel_button;

  superpose_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (superpose_dialog), "superpose_dialog", superpose_dialog);
  gtk_window_set_title (GTK_WINDOW (superpose_dialog), _("SSM Superpose"));
  gtk_window_set_policy (GTK_WINDOW (superpose_dialog), TRUE, TRUE, FALSE);

  dialog_vbox49 = GTK_DIALOG (superpose_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (superpose_dialog), "dialog_vbox49", dialog_vbox49);
  gtk_widget_show (dialog_vbox49);

  vbox109 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox109);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "vbox109", vbox109,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox109);
  gtk_box_pack_start (GTK_BOX (dialog_vbox49), vbox109, TRUE, TRUE, 0);

  label159 = gtk_label_new (_("Superpose Molecules"));
  gtk_widget_ref (label159);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "label159", label159,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label159);
  gtk_box_pack_start (GTK_BOX (vbox109), label159, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label159), 0, 11);

  frame98 = gtk_frame_new (_("Reference Structure"));
  gtk_widget_ref (frame98);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "frame98", frame98,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame98);
  gtk_box_pack_start (GTK_BOX (vbox109), frame98, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame98), 4);

  vbox142 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox142);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "vbox142", vbox142,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox142);
  gtk_container_add (GTK_CONTAINER (frame98), vbox142);

  superpose_dialog_reference_mol_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (superpose_dialog_reference_mol_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "superpose_dialog_reference_mol_optionmenu", superpose_dialog_reference_mol_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (superpose_dialog_reference_mol_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox142), superpose_dialog_reference_mol_optionmenu, FALSE, FALSE, 0);
  superpose_dialog_reference_mol_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (superpose_dialog_reference_mol_optionmenu), superpose_dialog_reference_mol_optionmenu_menu);

  superpose_reference_structure_frame = gtk_frame_new (NULL);
  gtk_widget_ref (superpose_reference_structure_frame);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "superpose_reference_structure_frame", superpose_reference_structure_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (superpose_reference_structure_frame);
  gtk_box_pack_start (GTK_BOX (vbox142), superpose_reference_structure_frame, TRUE, TRUE, 0);

  vbox144 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox144);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "vbox144", vbox144,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox144);
  gtk_container_add (GTK_CONTAINER (superpose_reference_structure_frame), vbox144);

  superpose_reference_chain_checkbutton = gtk_check_button_new_with_label (_("Use Specific Chain"));
  gtk_widget_ref (superpose_reference_chain_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "superpose_reference_chain_checkbutton", superpose_reference_chain_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (superpose_reference_chain_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox144), superpose_reference_chain_checkbutton, FALSE, FALSE, 0);

  superpose_reference_chain_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (superpose_reference_chain_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "superpose_reference_chain_optionmenu", superpose_reference_chain_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (superpose_reference_chain_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox144), superpose_reference_chain_optionmenu, FALSE, FALSE, 0);
  superpose_reference_chain_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (superpose_reference_chain_optionmenu), superpose_reference_chain_optionmenu_menu);

  label160 = gtk_label_new ("");
  gtk_widget_ref (label160);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "label160", label160,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label160);
  gtk_box_pack_start (GTK_BOX (vbox109), label160, FALSE, FALSE, 0);

  frame99 = gtk_frame_new (_("Moving Structure"));
  gtk_widget_ref (frame99);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "frame99", frame99,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame99);
  gtk_box_pack_start (GTK_BOX (vbox109), frame99, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame99), 4);

  vbox143 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox143);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "vbox143", vbox143,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox143);
  gtk_container_add (GTK_CONTAINER (frame99), vbox143);

  superpose_dialog_moving_mol_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (superpose_dialog_moving_mol_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "superpose_dialog_moving_mol_optionmenu", superpose_dialog_moving_mol_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (superpose_dialog_moving_mol_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox143), superpose_dialog_moving_mol_optionmenu, FALSE, FALSE, 0);
  superpose_dialog_moving_mol_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (superpose_dialog_moving_mol_optionmenu), superpose_dialog_moving_mol_optionmenu_menu);

  superpose_moving_structure_frame = gtk_frame_new (NULL);
  gtk_widget_ref (superpose_moving_structure_frame);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "superpose_moving_structure_frame", superpose_moving_structure_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (superpose_moving_structure_frame);
  gtk_box_pack_start (GTK_BOX (vbox143), superpose_moving_structure_frame, TRUE, TRUE, 0);

  vbox145 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox145);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "vbox145", vbox145,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox145);
  gtk_container_add (GTK_CONTAINER (superpose_moving_structure_frame), vbox145);

  superpose_moving_chain_checkbutton = gtk_check_button_new_with_label (_("Use Specific Chain"));
  gtk_widget_ref (superpose_moving_chain_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "superpose_moving_chain_checkbutton", superpose_moving_chain_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (superpose_moving_chain_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox145), superpose_moving_chain_checkbutton, FALSE, FALSE, 0);

  superpose_moving_chain_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (superpose_moving_chain_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "superpose_moving_chain_optionmenu", superpose_moving_chain_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (superpose_moving_chain_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox145), superpose_moving_chain_optionmenu, FALSE, FALSE, 0);
  superpose_moving_chain_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (superpose_moving_chain_optionmenu), superpose_moving_chain_optionmenu_menu);

  superpose_dialog_move_copy_checkbutton = gtk_check_button_new_with_label (_("Move copy of Moving Structure"));
  gtk_widget_ref (superpose_dialog_move_copy_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "superpose_dialog_move_copy_checkbutton", superpose_dialog_move_copy_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (superpose_dialog_move_copy_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox109), superpose_dialog_move_copy_checkbutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (superpose_dialog_move_copy_checkbutton), 4);

  dialog_action_area49 = GTK_DIALOG (superpose_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (superpose_dialog), "dialog_action_area49", dialog_action_area49);
  gtk_widget_show (dialog_action_area49);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area49), 10);

  hbox83 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox83);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "hbox83", hbox83,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox83);
  gtk_box_pack_start (GTK_BOX (dialog_action_area49), hbox83, TRUE, TRUE, 0);

  superpose_dialog_superpose_button = gtk_button_new_with_label (_("  Superpose  "));
  gtk_widget_ref (superpose_dialog_superpose_button);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "superpose_dialog_superpose_button", superpose_dialog_superpose_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (superpose_dialog_superpose_button);
  gtk_box_pack_start (GTK_BOX (hbox83), superpose_dialog_superpose_button, TRUE, TRUE, 2);
  gtk_container_set_border_width (GTK_CONTAINER (superpose_dialog_superpose_button), 2);
  GTK_WIDGET_SET_FLAGS (superpose_dialog_superpose_button, GTK_CAN_DEFAULT);

  superpose_dialog_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (superpose_dialog_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (superpose_dialog), "superpose_dialog_cancel_button", superpose_dialog_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (superpose_dialog_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox83), superpose_dialog_cancel_button, TRUE, TRUE, 2);
  gtk_container_set_border_width (GTK_CONTAINER (superpose_dialog_cancel_button), 2);
  GTK_WIDGET_SET_FLAGS (superpose_dialog_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (superpose_reference_chain_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_superpose_reference_chain_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (superpose_moving_chain_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_superpose_moving_chain_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (superpose_dialog_superpose_button), "clicked",
                      GTK_SIGNAL_FUNC (on_superpose_dialog_superpose_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (superpose_dialog_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_superpose_dialog_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (superpose_dialog_superpose_button);
  gtk_widget_grab_default (superpose_dialog_superpose_button);
  return superpose_dialog;
}

GtkWidget*
create_superpose_nonsense_dialog (void)
{
  GtkWidget *superpose_nonsense_dialog;
  GtkWidget *dialog_vbox50;
  GtkWidget *frame100;
  GtkWidget *label161;
  GtkWidget *dialog_action_area50;
  GtkWidget *hbox149;
  GtkWidget *superpose_nonsense_ok_button;
  GtkWidget *superpose_nonsense_cancel_button;

  superpose_nonsense_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (superpose_nonsense_dialog), "superpose_nonsense_dialog", superpose_nonsense_dialog);
  gtk_window_set_title (GTK_WINDOW (superpose_nonsense_dialog), _("Nonsense!"));
  gtk_window_set_policy (GTK_WINDOW (superpose_nonsense_dialog), TRUE, TRUE, FALSE);

  dialog_vbox50 = GTK_DIALOG (superpose_nonsense_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (superpose_nonsense_dialog), "dialog_vbox50", dialog_vbox50);
  gtk_widget_show (dialog_vbox50);

  frame100 = gtk_frame_new (NULL);
  gtk_widget_ref (frame100);
  gtk_object_set_data_full (GTK_OBJECT (superpose_nonsense_dialog), "frame100", frame100,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame100);
  gtk_box_pack_start (GTK_BOX (dialog_vbox50), frame100, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame100), 6);

  label161 = gtk_label_new (_("Can't superpose a molecule onto itself.\n\nMove a copy?"));
  gtk_widget_ref (label161);
  gtk_object_set_data_full (GTK_OBJECT (superpose_nonsense_dialog), "label161", label161,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label161);
  gtk_container_add (GTK_CONTAINER (frame100), label161);
  gtk_label_set_justify (GTK_LABEL (label161), GTK_JUSTIFY_LEFT);
  gtk_misc_set_padding (GTK_MISC (label161), 10, 20);

  dialog_action_area50 = GTK_DIALOG (superpose_nonsense_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (superpose_nonsense_dialog), "dialog_action_area50", dialog_action_area50);
  gtk_widget_show (dialog_action_area50);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area50), 10);

  hbox149 = gtk_hbox_new (TRUE, 0);
  gtk_widget_ref (hbox149);
  gtk_object_set_data_full (GTK_OBJECT (superpose_nonsense_dialog), "hbox149", hbox149,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox149);
  gtk_box_pack_start (GTK_BOX (dialog_action_area50), hbox149, TRUE, TRUE, 0);

  superpose_nonsense_ok_button = gtk_button_new_with_label (_("   OK   "));
  gtk_widget_ref (superpose_nonsense_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (superpose_nonsense_dialog), "superpose_nonsense_ok_button", superpose_nonsense_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (superpose_nonsense_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox149), superpose_nonsense_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (superpose_nonsense_ok_button, GTK_CAN_DEFAULT);

  superpose_nonsense_cancel_button = gtk_button_new_with_label (_("   Cancel   "));
  gtk_widget_ref (superpose_nonsense_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (superpose_nonsense_dialog), "superpose_nonsense_cancel_button", superpose_nonsense_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (superpose_nonsense_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox149), superpose_nonsense_cancel_button, TRUE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (superpose_nonsense_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_superpose_nonsense_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (superpose_nonsense_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_superpose_nonsense_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (superpose_nonsense_ok_button);
  gtk_widget_grab_default (superpose_nonsense_ok_button);
  return superpose_nonsense_dialog;
}

GtkWidget*
create_add_terminal_residue_finds_none_dialog (void)
{
  GtkWidget *add_terminal_residue_finds_none_dialog;
  GtkWidget *dialog_vbox51;
  GtkWidget *frame101;
  GtkWidget *label162;
  GtkWidget *dialog_action_area51;
  GtkWidget *add_terminal_residue_finds_none_ok_button;

  add_terminal_residue_finds_none_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (add_terminal_residue_finds_none_dialog), "add_terminal_residue_finds_none_dialog", add_terminal_residue_finds_none_dialog);
  gtk_window_set_title (GTK_WINDOW (add_terminal_residue_finds_none_dialog), _("No Acceptable Terminal Residue "));
  gtk_window_set_policy (GTK_WINDOW (add_terminal_residue_finds_none_dialog), TRUE, TRUE, FALSE);

  dialog_vbox51 = GTK_DIALOG (add_terminal_residue_finds_none_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (add_terminal_residue_finds_none_dialog), "dialog_vbox51", dialog_vbox51);
  gtk_widget_show (dialog_vbox51);

  frame101 = gtk_frame_new (NULL);
  gtk_widget_ref (frame101);
  gtk_object_set_data_full (GTK_OBJECT (add_terminal_residue_finds_none_dialog), "frame101", frame101,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame101);
  gtk_box_pack_start (GTK_BOX (dialog_vbox51), frame101, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame101), 6);

  label162 = gtk_label_new (_("  Add Terminal Residue failed to find \nany acceptable configuration here."));
  gtk_widget_ref (label162);
  gtk_object_set_data_full (GTK_OBJECT (add_terminal_residue_finds_none_dialog), "label162", label162,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label162);
  gtk_container_add (GTK_CONTAINER (frame101), label162);
  gtk_misc_set_padding (GTK_MISC (label162), 33, 42);

  dialog_action_area51 = GTK_DIALOG (add_terminal_residue_finds_none_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (add_terminal_residue_finds_none_dialog), "dialog_action_area51", dialog_action_area51);
  gtk_widget_show (dialog_action_area51);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area51), 10);

  add_terminal_residue_finds_none_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (add_terminal_residue_finds_none_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (add_terminal_residue_finds_none_dialog), "add_terminal_residue_finds_none_ok_button", add_terminal_residue_finds_none_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (add_terminal_residue_finds_none_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area51), add_terminal_residue_finds_none_ok_button, TRUE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (add_terminal_residue_finds_none_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_add_terminal_residue_finds_none_ok_button_clicked),
                      NULL);

  return add_terminal_residue_finds_none_dialog;
}

GtkWidget*
create_no_bad_chiral_volumes_dialog (void)
{
  GtkWidget *no_bad_chiral_volumes_dialog;
  GtkWidget *dialog_vbox52;
  GtkWidget *frame105;
  GtkWidget *label170;
  GtkWidget *dialog_action_area52;
  GtkWidget *no_bad_chiral_volumes_dialog_ok_button;

  no_bad_chiral_volumes_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (no_bad_chiral_volumes_dialog), "no_bad_chiral_volumes_dialog", no_bad_chiral_volumes_dialog);
  gtk_container_set_border_width (GTK_CONTAINER (no_bad_chiral_volumes_dialog), 2);
  gtk_window_set_title (GTK_WINDOW (no_bad_chiral_volumes_dialog), _("Clean!"));
  gtk_window_set_policy (GTK_WINDOW (no_bad_chiral_volumes_dialog), TRUE, TRUE, FALSE);

  dialog_vbox52 = GTK_DIALOG (no_bad_chiral_volumes_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (no_bad_chiral_volumes_dialog), "dialog_vbox52", dialog_vbox52);
  gtk_widget_show (dialog_vbox52);

  frame105 = gtk_frame_new (NULL);
  gtk_widget_ref (frame105);
  gtk_object_set_data_full (GTK_OBJECT (no_bad_chiral_volumes_dialog), "frame105", frame105,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame105);
  gtk_box_pack_start (GTK_BOX (dialog_vbox52), frame105, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame105), 4);

  label170 = gtk_label_new (_("Coot detected no bad chiral volumes\nin this molecule."));
  gtk_widget_ref (label170);
  gtk_object_set_data_full (GTK_OBJECT (no_bad_chiral_volumes_dialog), "label170", label170,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label170);
  gtk_container_add (GTK_CONTAINER (frame105), label170);
  gtk_misc_set_padding (GTK_MISC (label170), 24, 31);

  dialog_action_area52 = GTK_DIALOG (no_bad_chiral_volumes_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (no_bad_chiral_volumes_dialog), "dialog_action_area52", dialog_action_area52);
  gtk_widget_show (dialog_action_area52);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area52), 10);

  no_bad_chiral_volumes_dialog_ok_button = gtk_button_new_with_label (_("   Good   "));
  gtk_widget_ref (no_bad_chiral_volumes_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (no_bad_chiral_volumes_dialog), "no_bad_chiral_volumes_dialog_ok_button", no_bad_chiral_volumes_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (no_bad_chiral_volumes_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area52), no_bad_chiral_volumes_dialog_ok_button, FALSE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (no_bad_chiral_volumes_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_no_bad_chiral_volumes_dialog_ok_button_clicked),
                      NULL);

  return no_bad_chiral_volumes_dialog;
}

GtkWidget*
create_check_chiral_volumes_dialog (void)
{
  GtkWidget *check_chiral_volumes_dialog;
  GtkWidget *dialog_vbox53;
  GtkWidget *frame106;
  GtkWidget *vbox111;
  GtkWidget *label171;
  GtkWidget *check_chiral_volumes_molecule_optionmenu;
  GtkWidget *check_chiral_volumes_molecule_optionmenu_menu;
  GtkWidget *dialog_action_area53;
  GtkWidget *hbox85;
  GtkWidget *check_chiral_volumes_ok_button;
  GtkWidget *check_chiral_volumes_cancel_button;

  check_chiral_volumes_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (check_chiral_volumes_dialog), "check_chiral_volumes_dialog", check_chiral_volumes_dialog);
  gtk_window_set_title (GTK_WINDOW (check_chiral_volumes_dialog), _("Check Chiral Volumes molecule chooser:"));
  gtk_window_set_policy (GTK_WINDOW (check_chiral_volumes_dialog), TRUE, TRUE, FALSE);

  dialog_vbox53 = GTK_DIALOG (check_chiral_volumes_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (check_chiral_volumes_dialog), "dialog_vbox53", dialog_vbox53);
  gtk_widget_show (dialog_vbox53);

  frame106 = gtk_frame_new (NULL);
  gtk_widget_ref (frame106);
  gtk_object_set_data_full (GTK_OBJECT (check_chiral_volumes_dialog), "frame106", frame106,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame106);
  gtk_box_pack_start (GTK_BOX (dialog_vbox53), frame106, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame106), 7);

  vbox111 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox111);
  gtk_object_set_data_full (GTK_OBJECT (check_chiral_volumes_dialog), "vbox111", vbox111,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox111);
  gtk_container_add (GTK_CONTAINER (frame106), vbox111);

  label171 = gtk_label_new (_("Check Chiral Volumes on molecule:"));
  gtk_widget_ref (label171);
  gtk_object_set_data_full (GTK_OBJECT (check_chiral_volumes_dialog), "label171", label171,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label171);
  gtk_box_pack_start (GTK_BOX (vbox111), label171, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label171), 2, 9);

  check_chiral_volumes_molecule_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (check_chiral_volumes_molecule_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (check_chiral_volumes_dialog), "check_chiral_volumes_molecule_optionmenu", check_chiral_volumes_molecule_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_chiral_volumes_molecule_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox111), check_chiral_volumes_molecule_optionmenu, FALSE, FALSE, 0);
  check_chiral_volumes_molecule_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (check_chiral_volumes_molecule_optionmenu), check_chiral_volumes_molecule_optionmenu_menu);

  dialog_action_area53 = GTK_DIALOG (check_chiral_volumes_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (check_chiral_volumes_dialog), "dialog_action_area53", dialog_action_area53);
  gtk_widget_show (dialog_action_area53);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area53), 10);

  hbox85 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox85);
  gtk_object_set_data_full (GTK_OBJECT (check_chiral_volumes_dialog), "hbox85", hbox85,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox85);
  gtk_box_pack_start (GTK_BOX (dialog_action_area53), hbox85, TRUE, TRUE, 0);

  check_chiral_volumes_ok_button = gtk_button_new_with_label (_("   Check Volumes   "));
  gtk_widget_ref (check_chiral_volumes_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (check_chiral_volumes_dialog), "check_chiral_volumes_ok_button", check_chiral_volumes_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_chiral_volumes_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox85), check_chiral_volumes_ok_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (check_chiral_volumes_ok_button), 4);
  GTK_WIDGET_SET_FLAGS (check_chiral_volumes_ok_button, GTK_CAN_DEFAULT);

  check_chiral_volumes_cancel_button = gtk_button_new_with_label (_("   Cancel   "));
  gtk_widget_ref (check_chiral_volumes_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (check_chiral_volumes_dialog), "check_chiral_volumes_cancel_button", check_chiral_volumes_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_chiral_volumes_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox85), check_chiral_volumes_cancel_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (check_chiral_volumes_cancel_button), 4);
  GTK_WIDGET_SET_FLAGS (check_chiral_volumes_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (check_chiral_volumes_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_check_chiral_volumes_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (check_chiral_volumes_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_check_chiral_volumes_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (check_chiral_volumes_ok_button);
  gtk_widget_grab_default (check_chiral_volumes_ok_button);
  return check_chiral_volumes_dialog;
}

GtkWidget*
create_bad_chiral_volumes_dialog (void)
{
  GtkWidget *bad_chiral_volumes_dialog;
  GtkWidget *dialog_vbox54;
  GtkWidget *scrolledwindow10;
  GtkWidget *viewport6;
  GtkWidget *chiral_volume_baddies_vbox;
  GtkWidget *dialog_action_area54;
  GtkWidget *chiral_volume_baddies_dialog_cancel_button;

  bad_chiral_volumes_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (bad_chiral_volumes_dialog), "bad_chiral_volumes_dialog", bad_chiral_volumes_dialog);
  gtk_window_set_title (GTK_WINDOW (bad_chiral_volumes_dialog), _("Chiral Volume Baddies:"));
  gtk_window_set_policy (GTK_WINDOW (bad_chiral_volumes_dialog), TRUE, TRUE, FALSE);

  dialog_vbox54 = GTK_DIALOG (bad_chiral_volumes_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (bad_chiral_volumes_dialog), "dialog_vbox54", dialog_vbox54);
  gtk_widget_show (dialog_vbox54);

  scrolledwindow10 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow10);
  gtk_object_set_data_full (GTK_OBJECT (bad_chiral_volumes_dialog), "scrolledwindow10", scrolledwindow10,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow10);
  gtk_box_pack_start (GTK_BOX (dialog_vbox54), scrolledwindow10, TRUE, TRUE, 0);
  gtk_widget_set_usize (scrolledwindow10, 130, 98);

  viewport6 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport6);
  gtk_object_set_data_full (GTK_OBJECT (bad_chiral_volumes_dialog), "viewport6", viewport6,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport6);
  gtk_container_add (GTK_CONTAINER (scrolledwindow10), viewport6);

  chiral_volume_baddies_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (chiral_volume_baddies_vbox);
  gtk_object_set_data_full (GTK_OBJECT (bad_chiral_volumes_dialog), "chiral_volume_baddies_vbox", chiral_volume_baddies_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (chiral_volume_baddies_vbox);
  gtk_container_add (GTK_CONTAINER (viewport6), chiral_volume_baddies_vbox);

  dialog_action_area54 = GTK_DIALOG (bad_chiral_volumes_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (bad_chiral_volumes_dialog), "dialog_action_area54", dialog_action_area54);
  gtk_widget_show (dialog_action_area54);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area54), 10);

  chiral_volume_baddies_dialog_cancel_button = gtk_button_new_with_label (_("   Cancel   "));
  gtk_widget_ref (chiral_volume_baddies_dialog_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (bad_chiral_volumes_dialog), "chiral_volume_baddies_dialog_cancel_button", chiral_volume_baddies_dialog_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (chiral_volume_baddies_dialog_cancel_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area54), chiral_volume_baddies_dialog_cancel_button, FALSE, FALSE, 0);
  GTK_WIDGET_SET_FLAGS (chiral_volume_baddies_dialog_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (chiral_volume_baddies_dialog_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_chiral_volume_baddies_dialog_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (chiral_volume_baddies_dialog_cancel_button);
  gtk_widget_grab_default (chiral_volume_baddies_dialog_cancel_button);
  return bad_chiral_volumes_dialog;
}

GtkWidget*
create_rigid_body_refinement_failed_dialog (void)
{
  GtkWidget *rigid_body_refinement_failed_dialog;
  GtkWidget *dialog_vbox55;
  GtkWidget *frame107;
  GtkWidget *label172;
  GtkWidget *dialog_action_area55;
  GtkWidget *rigid_body_refinement_failed_dialog_ok_button;

  rigid_body_refinement_failed_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (rigid_body_refinement_failed_dialog), "rigid_body_refinement_failed_dialog", rigid_body_refinement_failed_dialog);
  gtk_container_set_border_width (GTK_CONTAINER (rigid_body_refinement_failed_dialog), 4);
  gtk_window_set_title (GTK_WINDOW (rigid_body_refinement_failed_dialog), _("Rigid Body Refine Failed!"));
  gtk_window_set_policy (GTK_WINDOW (rigid_body_refinement_failed_dialog), TRUE, TRUE, FALSE);

  dialog_vbox55 = GTK_DIALOG (rigid_body_refinement_failed_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (rigid_body_refinement_failed_dialog), "dialog_vbox55", dialog_vbox55);
  gtk_widget_show (dialog_vbox55);

  frame107 = gtk_frame_new (NULL);
  gtk_widget_ref (frame107);
  gtk_object_set_data_full (GTK_OBJECT (rigid_body_refinement_failed_dialog), "frame107", frame107,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame107);
  gtk_box_pack_start (GTK_BOX (dialog_vbox55), frame107, TRUE, TRUE, 0);

  label172 = gtk_label_new (_("\nRigid Body Refinement failed.\nNo sensible place to put the atoms.\n\nSorry.\n"));
  gtk_widget_ref (label172);
  gtk_object_set_data_full (GTK_OBJECT (rigid_body_refinement_failed_dialog), "label172", label172,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label172);
  gtk_container_add (GTK_CONTAINER (frame107), label172);
  gtk_misc_set_padding (GTK_MISC (label172), 13, 18);

  dialog_action_area55 = GTK_DIALOG (rigid_body_refinement_failed_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (rigid_body_refinement_failed_dialog), "dialog_action_area55", dialog_action_area55);
  gtk_widget_show (dialog_action_area55);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area55), 10);

  rigid_body_refinement_failed_dialog_ok_button = gtk_button_new_with_label (_("   OK   "));
  gtk_widget_ref (rigid_body_refinement_failed_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (rigid_body_refinement_failed_dialog), "rigid_body_refinement_failed_dialog_ok_button", rigid_body_refinement_failed_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (rigid_body_refinement_failed_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area55), rigid_body_refinement_failed_dialog_ok_button, FALSE, FALSE, 6);

  gtk_signal_connect (GTK_OBJECT (rigid_body_refinement_failed_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_rigid_body_refinement_failed_dialog_ok_button_clicked),
                      NULL);

  return rigid_body_refinement_failed_dialog;
}

GtkWidget*
create_baton_mode_make_skeleton_dialog (void)
{
  GtkWidget *baton_mode_make_skeleton_dialog;
  GtkWidget *dialog_vbox56;
  GtkWidget *label173;
  GtkWidget *dialog_action_area56;
  GtkWidget *hbox86;
  GtkWidget *baton_mode_calculate_skeleton_ok_button;
  GtkWidget *baton_mode_calculate_skeleton_cancel_button;

  baton_mode_make_skeleton_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (baton_mode_make_skeleton_dialog), "baton_mode_make_skeleton_dialog", baton_mode_make_skeleton_dialog);
  gtk_window_set_title (GTK_WINDOW (baton_mode_make_skeleton_dialog), _("Make Skeleton?"));
  gtk_window_set_policy (GTK_WINDOW (baton_mode_make_skeleton_dialog), TRUE, TRUE, FALSE);

  dialog_vbox56 = GTK_DIALOG (baton_mode_make_skeleton_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (baton_mode_make_skeleton_dialog), "dialog_vbox56", dialog_vbox56);
  gtk_widget_show (dialog_vbox56);

  label173 = gtk_label_new (_("\n\nThere is no skeleton for this map.\n\nCalculate a skeleton now?\n\n"));
  gtk_widget_ref (label173);
  gtk_object_set_data_full (GTK_OBJECT (baton_mode_make_skeleton_dialog), "label173", label173,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label173);
  gtk_box_pack_start (GTK_BOX (dialog_vbox56), label173, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label173), 16, 3);

  dialog_action_area56 = GTK_DIALOG (baton_mode_make_skeleton_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (baton_mode_make_skeleton_dialog), "dialog_action_area56", dialog_action_area56);
  gtk_widget_show (dialog_action_area56);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area56), 10);

  hbox86 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox86);
  gtk_object_set_data_full (GTK_OBJECT (baton_mode_make_skeleton_dialog), "hbox86", hbox86,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox86);
  gtk_box_pack_start (GTK_BOX (dialog_action_area56), hbox86, TRUE, TRUE, 0);

  baton_mode_calculate_skeleton_ok_button = gtk_button_new_with_label (_("   Calculate   "));
  gtk_widget_ref (baton_mode_calculate_skeleton_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (baton_mode_make_skeleton_dialog), "baton_mode_calculate_skeleton_ok_button", baton_mode_calculate_skeleton_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (baton_mode_calculate_skeleton_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox86), baton_mode_calculate_skeleton_ok_button, TRUE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (baton_mode_calculate_skeleton_ok_button), 2);
  GTK_WIDGET_SET_FLAGS (baton_mode_calculate_skeleton_ok_button, GTK_CAN_DEFAULT);

  baton_mode_calculate_skeleton_cancel_button = gtk_button_new_with_label (_("   Cancel   "));
  gtk_widget_ref (baton_mode_calculate_skeleton_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (baton_mode_make_skeleton_dialog), "baton_mode_calculate_skeleton_cancel_button", baton_mode_calculate_skeleton_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (baton_mode_calculate_skeleton_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox86), baton_mode_calculate_skeleton_cancel_button, TRUE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (baton_mode_calculate_skeleton_cancel_button), 2);
  GTK_WIDGET_SET_FLAGS (baton_mode_calculate_skeleton_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (baton_mode_calculate_skeleton_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_baton_mode_calculate_skeleton_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (baton_mode_calculate_skeleton_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_baton_mode_calculate_skeleton_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (baton_mode_calculate_skeleton_ok_button);
  gtk_widget_grab_default (baton_mode_calculate_skeleton_ok_button);
  return baton_mode_make_skeleton_dialog;
}

GtkWidget*
create_merge_molecules_dialog (void)
{
  GtkWidget *merge_molecules_dialog;
  GtkWidget *dialog_vbox57;
  GtkWidget *frame109;
  GtkWidget *vbox114;
  GtkWidget *label178;
  GtkWidget *merge_molecuoes_scrolledwindow;
  GtkWidget *viewport7;
  GtkWidget *merge_molecules_vbox;
  GtkWidget *label179;
  GtkWidget *merge_molecules_optionmenu;
  GtkWidget *merge_molecules_optionmenu_menu;
  GtkWidget *label180;
  GtkWidget *dialog_action_area57;
  GtkWidget *hbox89;
  GtkWidget *merge_molecules_ok_button;
  GtkWidget *merge_molecules_cancel_button;

  merge_molecules_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (merge_molecules_dialog), "merge_molecules_dialog", merge_molecules_dialog);
  gtk_window_set_title (GTK_WINDOW (merge_molecules_dialog), _("Merge Molecules"));
  gtk_window_set_policy (GTK_WINDOW (merge_molecules_dialog), TRUE, TRUE, FALSE);

  dialog_vbox57 = GTK_DIALOG (merge_molecules_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (merge_molecules_dialog), "dialog_vbox57", dialog_vbox57);
  gtk_widget_show (dialog_vbox57);

  frame109 = gtk_frame_new (NULL);
  gtk_widget_ref (frame109);
  gtk_object_set_data_full (GTK_OBJECT (merge_molecules_dialog), "frame109", frame109,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame109);
  gtk_box_pack_start (GTK_BOX (dialog_vbox57), frame109, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame109), 4);

  vbox114 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox114);
  gtk_object_set_data_full (GTK_OBJECT (merge_molecules_dialog), "vbox114", vbox114,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox114);
  gtk_container_add (GTK_CONTAINER (frame109), vbox114);

  label178 = gtk_label_new (_("\nAppend/Insert Molecule(s):\n"));
  gtk_widget_ref (label178);
  gtk_object_set_data_full (GTK_OBJECT (merge_molecules_dialog), "label178", label178,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label178);
  gtk_box_pack_start (GTK_BOX (vbox114), label178, FALSE, FALSE, 0);

  merge_molecuoes_scrolledwindow = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (merge_molecuoes_scrolledwindow);
  gtk_object_set_data_full (GTK_OBJECT (merge_molecules_dialog), "merge_molecuoes_scrolledwindow", merge_molecuoes_scrolledwindow,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (merge_molecuoes_scrolledwindow);
  gtk_box_pack_start (GTK_BOX (vbox114), merge_molecuoes_scrolledwindow, TRUE, TRUE, 0);
  gtk_widget_set_usize (merge_molecuoes_scrolledwindow, 287, 103);

  viewport7 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport7);
  gtk_object_set_data_full (GTK_OBJECT (merge_molecules_dialog), "viewport7", viewport7,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport7);
  gtk_container_add (GTK_CONTAINER (merge_molecuoes_scrolledwindow), viewport7);

  merge_molecules_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (merge_molecules_vbox);
  gtk_object_set_data_full (GTK_OBJECT (merge_molecules_dialog), "merge_molecules_vbox", merge_molecules_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (merge_molecules_vbox);
  gtk_container_add (GTK_CONTAINER (viewport7), merge_molecules_vbox);

  label179 = gtk_label_new (_("\ninto Molecule:\n"));
  gtk_widget_ref (label179);
  gtk_object_set_data_full (GTK_OBJECT (merge_molecules_dialog), "label179", label179,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label179);
  gtk_box_pack_start (GTK_BOX (vbox114), label179, FALSE, FALSE, 0);

  merge_molecules_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (merge_molecules_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (merge_molecules_dialog), "merge_molecules_optionmenu", merge_molecules_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (merge_molecules_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox114), merge_molecules_optionmenu, FALSE, FALSE, 0);
  merge_molecules_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (merge_molecules_optionmenu), merge_molecules_optionmenu_menu);

  label180 = gtk_label_new (_(" "));
  gtk_widget_ref (label180);
  gtk_object_set_data_full (GTK_OBJECT (merge_molecules_dialog), "label180", label180,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label180);
  gtk_box_pack_start (GTK_BOX (vbox114), label180, FALSE, FALSE, 0);

  dialog_action_area57 = GTK_DIALOG (merge_molecules_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (merge_molecules_dialog), "dialog_action_area57", dialog_action_area57);
  gtk_widget_show (dialog_action_area57);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area57), 10);

  hbox89 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox89);
  gtk_object_set_data_full (GTK_OBJECT (merge_molecules_dialog), "hbox89", hbox89,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox89);
  gtk_box_pack_start (GTK_BOX (dialog_action_area57), hbox89, TRUE, TRUE, 0);

  merge_molecules_ok_button = gtk_button_new_with_label (_("   Merge   "));
  gtk_widget_ref (merge_molecules_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (merge_molecules_dialog), "merge_molecules_ok_button", merge_molecules_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (merge_molecules_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox89), merge_molecules_ok_button, TRUE, FALSE, 0);

  merge_molecules_cancel_button = gtk_button_new_with_label (_("   Cancel   "));
  gtk_widget_ref (merge_molecules_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (merge_molecules_dialog), "merge_molecules_cancel_button", merge_molecules_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (merge_molecules_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox89), merge_molecules_cancel_button, TRUE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (merge_molecules_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_merge_molecules_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (merge_molecules_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_merge_molecules_cancel_button_clicked),
                      NULL);

  return merge_molecules_dialog;
}

GtkWidget*
create_mutate_sequence_dialog (void)
{
  GtkWidget *mutate_sequence_dialog;
  GtkWidget *dialog_vbox58;
  GtkWidget *frame110;
  GtkWidget *vbox116;
  GtkWidget *function_for_molecule_label;
  GtkWidget *mutate_molecule_optionmenu;
  GtkWidget *mutate_molecule_optionmenu_menu;
  GtkWidget *hbox90;
  GtkWidget *label182;
  GtkWidget *mutate_molecule_chain_optionmenu;
  GtkWidget *mutate_molecule_chain_optionmenu_menu;
  GtkWidget *hbox91;
  GtkWidget *label183;
  GtkWidget *mutate_molecule_resno_1_entry;
  GtkWidget *label184;
  GtkWidget *mutate_molecule_resno_2_entry;
  GtkWidget *label185;
  GtkWidget *loop_fit_method_frame;
  GtkWidget *vbox159;
  GtkWidget *label245;
  GtkWidget *label186;
  GtkWidget *scrolledwindow12;
  GtkWidget *mutate_molecule_sequence_text;
  GtkWidget *label187;
  GtkWidget *mutate_sequence_do_autofit_checkbutton;
  GtkWidget *dialog_action_area58;
  GtkWidget *hbox92;
  GtkWidget *mutate_sequence_ok_button;
  GtkWidget *fit_loop_ok_button;
  GtkWidget *mutate_sequence_cancel_button;

  mutate_sequence_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (mutate_sequence_dialog), "mutate_sequence_dialog", mutate_sequence_dialog);
  gtk_window_set_title (GTK_WINDOW (mutate_sequence_dialog), _("Mutate sequence"));
  gtk_window_set_policy (GTK_WINDOW (mutate_sequence_dialog), TRUE, TRUE, FALSE);

  dialog_vbox58 = GTK_DIALOG (mutate_sequence_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (mutate_sequence_dialog), "dialog_vbox58", dialog_vbox58);
  gtk_widget_show (dialog_vbox58);

  frame110 = gtk_frame_new (NULL);
  gtk_widget_ref (frame110);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "frame110", frame110,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame110);
  gtk_box_pack_start (GTK_BOX (dialog_vbox58), frame110, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame110), 8);

  vbox116 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox116);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "vbox116", vbox116,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox116);
  gtk_container_add (GTK_CONTAINER (frame110), vbox116);

  function_for_molecule_label = gtk_label_new (_("\n   Mutate Molecule:\n"));
  gtk_widget_ref (function_for_molecule_label);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "function_for_molecule_label", function_for_molecule_label,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (function_for_molecule_label);
  gtk_box_pack_start (GTK_BOX (vbox116), function_for_molecule_label, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (function_for_molecule_label), 7.45058e-09, 0.5);

  mutate_molecule_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (mutate_molecule_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "mutate_molecule_optionmenu", mutate_molecule_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (mutate_molecule_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox116), mutate_molecule_optionmenu, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (mutate_molecule_optionmenu), 2);
  mutate_molecule_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (mutate_molecule_optionmenu), mutate_molecule_optionmenu_menu);

  hbox90 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox90);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "hbox90", hbox90,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox90);
  gtk_box_pack_start (GTK_BOX (vbox116), hbox90, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox90), 2);

  label182 = gtk_label_new (_("  Chain ID: "));
  gtk_widget_ref (label182);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "label182", label182,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label182);
  gtk_box_pack_start (GTK_BOX (hbox90), label182, FALSE, FALSE, 0);

  mutate_molecule_chain_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (mutate_molecule_chain_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "mutate_molecule_chain_optionmenu", mutate_molecule_chain_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (mutate_molecule_chain_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox90), mutate_molecule_chain_optionmenu, FALSE, FALSE, 0);
  mutate_molecule_chain_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (mutate_molecule_chain_optionmenu), mutate_molecule_chain_optionmenu_menu);

  hbox91 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox91);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "hbox91", hbox91,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox91);
  gtk_box_pack_start (GTK_BOX (vbox116), hbox91, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox91), 2);

  label183 = gtk_label_new (_("  Residue numbers "));
  gtk_widget_ref (label183);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "label183", label183,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label183);
  gtk_box_pack_start (GTK_BOX (hbox91), label183, FALSE, FALSE, 0);

  mutate_molecule_resno_1_entry = gtk_entry_new ();
  gtk_widget_ref (mutate_molecule_resno_1_entry);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "mutate_molecule_resno_1_entry", mutate_molecule_resno_1_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (mutate_molecule_resno_1_entry);
  gtk_box_pack_start (GTK_BOX (hbox91), mutate_molecule_resno_1_entry, FALSE, FALSE, 0);
  gtk_widget_set_usize (mutate_molecule_resno_1_entry, 50, -2);

  label184 = gtk_label_new (_("   to   "));
  gtk_widget_ref (label184);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "label184", label184,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label184);
  gtk_box_pack_start (GTK_BOX (hbox91), label184, FALSE, FALSE, 0);

  mutate_molecule_resno_2_entry = gtk_entry_new ();
  gtk_widget_ref (mutate_molecule_resno_2_entry);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "mutate_molecule_resno_2_entry", mutate_molecule_resno_2_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (mutate_molecule_resno_2_entry);
  gtk_box_pack_start (GTK_BOX (hbox91), mutate_molecule_resno_2_entry, FALSE, FALSE, 0);
  gtk_widget_set_usize (mutate_molecule_resno_2_entry, 50, -2);

  label185 = gtk_label_new (_("  (inclusive)   "));
  gtk_widget_ref (label185);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "label185", label185,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label185);
  gtk_box_pack_start (GTK_BOX (hbox91), label185, FALSE, FALSE, 0);

  loop_fit_method_frame = gtk_frame_new (_("Using Method:"));
  gtk_widget_ref (loop_fit_method_frame);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "loop_fit_method_frame", loop_fit_method_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (vbox116), loop_fit_method_frame, TRUE, TRUE, 7);
  gtk_container_set_border_width (GTK_CONTAINER (loop_fit_method_frame), 4);

  vbox159 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox159);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "vbox159", vbox159,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox159);
  gtk_container_add (GTK_CONTAINER (loop_fit_method_frame), vbox159);

  label245 = gtk_label_new (_("Successive Peptides by Ramachandran \nsearch (this may not work well)"));
  gtk_widget_ref (label245);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "label245", label245,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label245);
  gtk_box_pack_start (GTK_BOX (vbox159), label245, FALSE, FALSE, 0);

  label186 = gtk_label_new (_("\n   to (single letter) sequence:\n"));
  gtk_widget_ref (label186);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "label186", label186,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label186);
  gtk_box_pack_start (GTK_BOX (vbox116), label186, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label186), 0, 0.5);

  scrolledwindow12 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow12);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "scrolledwindow12", scrolledwindow12,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow12);
  gtk_box_pack_start (GTK_BOX (vbox116), scrolledwindow12, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (scrolledwindow12), 4);
  gtk_scrolled_window_set_policy (GTK_SCROLLED_WINDOW (scrolledwindow12), GTK_POLICY_NEVER, GTK_POLICY_ALWAYS);

  mutate_molecule_sequence_text = gtk_text_new (NULL, NULL);
  gtk_widget_ref (mutate_molecule_sequence_text);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "mutate_molecule_sequence_text", mutate_molecule_sequence_text,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (mutate_molecule_sequence_text);
  gtk_container_add (GTK_CONTAINER (scrolledwindow12), mutate_molecule_sequence_text);
  gtk_text_set_editable (GTK_TEXT (mutate_molecule_sequence_text), TRUE);

  label187 = gtk_label_new ("");
  gtk_widget_ref (label187);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "label187", label187,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label187);
  gtk_box_pack_start (GTK_BOX (vbox116), label187, FALSE, FALSE, 0);

  mutate_sequence_do_autofit_checkbutton = gtk_check_button_new_with_label (_(" Autofit the mutated residues?"));
  gtk_widget_ref (mutate_sequence_do_autofit_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "mutate_sequence_do_autofit_checkbutton", mutate_sequence_do_autofit_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (mutate_sequence_do_autofit_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox116), mutate_sequence_do_autofit_checkbutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (mutate_sequence_do_autofit_checkbutton), 4);

  dialog_action_area58 = GTK_DIALOG (mutate_sequence_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (mutate_sequence_dialog), "dialog_action_area58", dialog_action_area58);
  gtk_widget_show (dialog_action_area58);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area58), 10);

  hbox92 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox92);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "hbox92", hbox92,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox92);
  gtk_box_pack_start (GTK_BOX (dialog_action_area58), hbox92, TRUE, TRUE, 0);

  mutate_sequence_ok_button = gtk_button_new_with_label (_("   Mutate   "));
  gtk_widget_ref (mutate_sequence_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "mutate_sequence_ok_button", mutate_sequence_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (mutate_sequence_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox92), mutate_sequence_ok_button, TRUE, FALSE, 0);

  fit_loop_ok_button = gtk_button_new_with_label (_("  Fit Loop  "));
  gtk_widget_ref (fit_loop_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "fit_loop_ok_button", fit_loop_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (hbox92), fit_loop_ok_button, TRUE, FALSE, 0);

  mutate_sequence_cancel_button = gtk_button_new_with_label (_("   Cancel   "));
  gtk_widget_ref (mutate_sequence_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (mutate_sequence_dialog), "mutate_sequence_cancel_button", mutate_sequence_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (mutate_sequence_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox92), mutate_sequence_cancel_button, TRUE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (mutate_sequence_do_autofit_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_mutate_sequence_do_autofit_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (mutate_sequence_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_mutate_sequence_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (fit_loop_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_fit_loop_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (mutate_sequence_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_mutate_sequence_cancel_button_clicked),
                      NULL);

  return mutate_sequence_dialog;
}

GtkWidget*
create_bond_parameters_dialog (void)
{
  GtkWidget *bond_parameters_dialog;
  GtkWidget *dialog_vbox59;
  GtkWidget *vbox117;
  GtkWidget *hbox93;
  GtkWidget *label189;
  GtkWidget *bond_parameters_molecule_optionmenu;
  GtkWidget *bond_parameters_molecule_optionmenu_menu;
  GtkWidget *label190;
  GtkWidget *frame111;
  GtkWidget *vbox118;
  GtkWidget *hbox94;
  GtkWidget *bond_parameters_bond_width_optionmenu;
  GtkWidget *bond_parameters_bond_width_optionmenu_menu;
  GtkWidget *label191;
  GtkWidget *frame112;
  GtkWidget *vbox119;
  GSList *draw_hydrogens_group = NULL;
  GtkWidget *draw_hydrogens_yes_radiobutton;
  GtkWidget *draw_hydrogens_no_radiobutton;
  GtkWidget *ncs_frame;
  GtkWidget *vbox146;
  GSList *ncs_ghosts_gr_group = NULL;
  GtkWidget *draw_ncs_ghosts_yes_radiobutton;
  GtkWidget *draw_ncs_ghosts_no_radiobutton;
  GtkWidget *dialog_action_area59;
  GtkWidget *hbox105;
  GtkWidget *bond_parameters_apply_button;
  GtkWidget *bond_parameters_ok_button;
  GtkWidget *bond_parameters_cancel_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  bond_parameters_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (bond_parameters_dialog), "bond_parameters_dialog", bond_parameters_dialog);
  gtk_window_set_title (GTK_WINDOW (bond_parameters_dialog), _("Bond Parameters"));
  gtk_window_set_policy (GTK_WINDOW (bond_parameters_dialog), TRUE, TRUE, FALSE);

  dialog_vbox59 = GTK_DIALOG (bond_parameters_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (bond_parameters_dialog), "dialog_vbox59", dialog_vbox59);
  gtk_widget_show (dialog_vbox59);

  vbox117 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox117);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "vbox117", vbox117,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox117);
  gtk_box_pack_start (GTK_BOX (dialog_vbox59), vbox117, TRUE, TRUE, 0);

  hbox93 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox93);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "hbox93", hbox93,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox93);
  gtk_box_pack_start (GTK_BOX (vbox117), hbox93, TRUE, TRUE, 5);
  gtk_container_set_border_width (GTK_CONTAINER (hbox93), 6);

  label189 = gtk_label_new (_("  Molecule:  "));
  gtk_widget_ref (label189);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "label189", label189,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label189);
  gtk_box_pack_start (GTK_BOX (hbox93), label189, FALSE, FALSE, 0);

  bond_parameters_molecule_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (bond_parameters_molecule_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "bond_parameters_molecule_optionmenu", bond_parameters_molecule_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (bond_parameters_molecule_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox93), bond_parameters_molecule_optionmenu, FALSE, FALSE, 0);
  bond_parameters_molecule_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (bond_parameters_molecule_optionmenu), bond_parameters_molecule_optionmenu_menu);

  label190 = gtk_label_new (_("   "));
  gtk_widget_ref (label190);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "label190", label190,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label190);
  gtk_box_pack_start (GTK_BOX (hbox93), label190, FALSE, FALSE, 0);

  frame111 = gtk_frame_new (_("Molecule Bond Width:"));
  gtk_widget_ref (frame111);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "frame111", frame111,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame111);
  gtk_box_pack_start (GTK_BOX (vbox117), frame111, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame111), 8);

  vbox118 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox118);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "vbox118", vbox118,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox118);
  gtk_container_add (GTK_CONTAINER (frame111), vbox118);

  hbox94 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox94);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "hbox94", hbox94,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox94);
  gtk_box_pack_start (GTK_BOX (vbox118), hbox94, TRUE, TRUE, 0);

  bond_parameters_bond_width_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (bond_parameters_bond_width_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "bond_parameters_bond_width_optionmenu", bond_parameters_bond_width_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (bond_parameters_bond_width_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox94), bond_parameters_bond_width_optionmenu, FALSE, FALSE, 0);
  bond_parameters_bond_width_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (bond_parameters_bond_width_optionmenu), bond_parameters_bond_width_optionmenu_menu);

  label191 = gtk_label_new (_("  pixels  "));
  gtk_widget_ref (label191);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "label191", label191,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label191);
  gtk_box_pack_start (GTK_BOX (hbox94), label191, FALSE, FALSE, 0);

  frame112 = gtk_frame_new (_("Draw Hydrogens?"));
  gtk_widget_ref (frame112);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "frame112", frame112,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame112);
  gtk_box_pack_start (GTK_BOX (vbox117), frame112, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame112), 8);

  vbox119 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox119);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "vbox119", vbox119,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox119);
  gtk_container_add (GTK_CONTAINER (frame112), vbox119);

  draw_hydrogens_yes_radiobutton = gtk_radio_button_new_with_label (draw_hydrogens_group, _("Yes"));
  draw_hydrogens_group = gtk_radio_button_group (GTK_RADIO_BUTTON (draw_hydrogens_yes_radiobutton));
  gtk_widget_ref (draw_hydrogens_yes_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "draw_hydrogens_yes_radiobutton", draw_hydrogens_yes_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (draw_hydrogens_yes_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox119), draw_hydrogens_yes_radiobutton, FALSE, FALSE, 0);

  draw_hydrogens_no_radiobutton = gtk_radio_button_new_with_label (draw_hydrogens_group, _("No"));
  draw_hydrogens_group = gtk_radio_button_group (GTK_RADIO_BUTTON (draw_hydrogens_no_radiobutton));
  gtk_widget_ref (draw_hydrogens_no_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "draw_hydrogens_no_radiobutton", draw_hydrogens_no_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (draw_hydrogens_no_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox119), draw_hydrogens_no_radiobutton, FALSE, FALSE, 0);

  ncs_frame = gtk_frame_new (_("Draw Non-Crystallographic Ghosts?"));
  gtk_widget_ref (ncs_frame);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "ncs_frame", ncs_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (vbox117), ncs_frame, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (ncs_frame), 8);
  gtk_widget_set_sensitive (ncs_frame, FALSE);

  vbox146 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox146);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "vbox146", vbox146,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox146);
  gtk_container_add (GTK_CONTAINER (ncs_frame), vbox146);

  draw_ncs_ghosts_yes_radiobutton = gtk_radio_button_new_with_label (ncs_ghosts_gr_group, _("Yes"));
  ncs_ghosts_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (draw_ncs_ghosts_yes_radiobutton));
  gtk_widget_ref (draw_ncs_ghosts_yes_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "draw_ncs_ghosts_yes_radiobutton", draw_ncs_ghosts_yes_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (draw_ncs_ghosts_yes_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox146), draw_ncs_ghosts_yes_radiobutton, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, draw_ncs_ghosts_yes_radiobutton, _("Note that the sequences must match exactly for NCS ghosts to be generated"), NULL);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (draw_ncs_ghosts_yes_radiobutton), TRUE);

  draw_ncs_ghosts_no_radiobutton = gtk_radio_button_new_with_label (ncs_ghosts_gr_group, _("No"));
  ncs_ghosts_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (draw_ncs_ghosts_no_radiobutton));
  gtk_widget_ref (draw_ncs_ghosts_no_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "draw_ncs_ghosts_no_radiobutton", draw_ncs_ghosts_no_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (draw_ncs_ghosts_no_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox146), draw_ncs_ghosts_no_radiobutton, FALSE, FALSE, 0);

  dialog_action_area59 = GTK_DIALOG (bond_parameters_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (bond_parameters_dialog), "dialog_action_area59", dialog_action_area59);
  gtk_widget_show (dialog_action_area59);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area59), 2);

  hbox105 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox105);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "hbox105", hbox105,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox105);
  gtk_box_pack_start (GTK_BOX (dialog_action_area59), hbox105, FALSE, FALSE, 0);

  bond_parameters_apply_button = gtk_button_new_with_label (_("  Apply  "));
  gtk_widget_ref (bond_parameters_apply_button);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "bond_parameters_apply_button", bond_parameters_apply_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (bond_parameters_apply_button);
  gtk_box_pack_start (GTK_BOX (hbox105), bond_parameters_apply_button, TRUE, TRUE, 2);
  gtk_container_set_border_width (GTK_CONTAINER (bond_parameters_apply_button), 4);

  bond_parameters_ok_button = gtk_button_new_with_label (_("       OK       "));
  gtk_widget_ref (bond_parameters_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "bond_parameters_ok_button", bond_parameters_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (bond_parameters_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox105), bond_parameters_ok_button, TRUE, TRUE, 2);
  gtk_container_set_border_width (GTK_CONTAINER (bond_parameters_ok_button), 4);

  bond_parameters_cancel_button = gtk_button_new_with_label (_("  Close  "));
  gtk_widget_ref (bond_parameters_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (bond_parameters_dialog), "bond_parameters_cancel_button", bond_parameters_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (bond_parameters_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox105), bond_parameters_cancel_button, TRUE, TRUE, 2);
  gtk_container_set_border_width (GTK_CONTAINER (bond_parameters_cancel_button), 4);

  gtk_signal_connect (GTK_OBJECT (draw_hydrogens_yes_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_draw_hydrogens_yes_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (draw_hydrogens_no_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_draw_hydrogens_no_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (draw_ncs_ghosts_yes_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_draw_ncs_ghosts_yes_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (draw_ncs_ghosts_no_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_draw_ncs_ghosts_no_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (bond_parameters_apply_button), "clicked",
                      GTK_SIGNAL_FUNC (on_bond_parameters_apply_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (bond_parameters_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_bond_parameters_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (bond_parameters_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_bond_parameters_cancel_button_clicked),
                      NULL);

  gtk_object_set_data (GTK_OBJECT (bond_parameters_dialog), "tooltips", tooltips);

  return bond_parameters_dialog;
}

GtkWidget*
create_renumber_residue_range_dialog (void)
{
  GtkWidget *renumber_residue_range_dialog;
  GtkWidget *dialog_vbox60;
  GtkWidget *frame113;
  GtkWidget *vbox120;
  GtkWidget *label192;
  GtkWidget *renumber_residue_range_molecule_optionmenu;
  GtkWidget *renumber_residue_range_molecule_optionmenu_menu;
  GtkWidget *hbox95;
  GtkWidget *label193;
  GtkWidget *renumber_residue_range_chain_optionmenu;
  GtkWidget *renumber_residue_range_chain_optionmenu_menu;
  GtkWidget *hbox96;
  GtkWidget *label194;
  GtkWidget *renumber_residue_range_resno_1_entry;
  GtkWidget *label195;
  GtkWidget *renumber_residue_range_resno_2_entry;
  GtkWidget *label196;
  GtkWidget *hbox97;
  GtkWidget *label197;
  GtkWidget *renumber_residue_range_offset_entry;
  GtkWidget *dialog_action_area60;
  GtkWidget *hbox98;
  GtkWidget *renumber_residue_range_ok_button;
  GtkWidget *renumber_residue_range_cancel_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  renumber_residue_range_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (renumber_residue_range_dialog), "renumber_residue_range_dialog", renumber_residue_range_dialog);
  gtk_window_set_title (GTK_WINDOW (renumber_residue_range_dialog), _("Renumber Residue Range"));
  gtk_window_set_policy (GTK_WINDOW (renumber_residue_range_dialog), TRUE, TRUE, FALSE);

  dialog_vbox60 = GTK_DIALOG (renumber_residue_range_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (renumber_residue_range_dialog), "dialog_vbox60", dialog_vbox60);
  gtk_widget_show (dialog_vbox60);

  frame113 = gtk_frame_new (NULL);
  gtk_widget_ref (frame113);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "frame113", frame113,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame113);
  gtk_box_pack_start (GTK_BOX (dialog_vbox60), frame113, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame113), 8);

  vbox120 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox120);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "vbox120", vbox120,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox120);
  gtk_container_add (GTK_CONTAINER (frame113), vbox120);

  label192 = gtk_label_new (_("Renumber Residue Range of Molecule:"));
  gtk_widget_ref (label192);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "label192", label192,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label192);
  gtk_box_pack_start (GTK_BOX (vbox120), label192, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label192), 0.04, 0.5);
  gtk_misc_set_padding (GTK_MISC (label192), 3, 5);

  renumber_residue_range_molecule_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (renumber_residue_range_molecule_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "renumber_residue_range_molecule_optionmenu", renumber_residue_range_molecule_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (renumber_residue_range_molecule_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox120), renumber_residue_range_molecule_optionmenu, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (renumber_residue_range_molecule_optionmenu), 2);
  renumber_residue_range_molecule_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (renumber_residue_range_molecule_optionmenu), renumber_residue_range_molecule_optionmenu_menu);

  hbox95 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox95);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "hbox95", hbox95,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox95);
  gtk_box_pack_start (GTK_BOX (vbox120), hbox95, TRUE, TRUE, 0);

  label193 = gtk_label_new (_("  Chain ID:  "));
  gtk_widget_ref (label193);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "label193", label193,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label193);
  gtk_box_pack_start (GTK_BOX (hbox95), label193, FALSE, FALSE, 0);

  renumber_residue_range_chain_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (renumber_residue_range_chain_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "renumber_residue_range_chain_optionmenu", renumber_residue_range_chain_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (renumber_residue_range_chain_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox95), renumber_residue_range_chain_optionmenu, FALSE, FALSE, 0);
  renumber_residue_range_chain_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (renumber_residue_range_chain_optionmenu), renumber_residue_range_chain_optionmenu_menu);

  hbox96 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox96);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "hbox96", hbox96,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox96);
  gtk_box_pack_start (GTK_BOX (vbox120), hbox96, TRUE, TRUE, 0);

  label194 = gtk_label_new (_("  Residue numbers:  "));
  gtk_widget_ref (label194);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "label194", label194,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label194);
  gtk_box_pack_start (GTK_BOX (hbox96), label194, FALSE, FALSE, 0);

  renumber_residue_range_resno_1_entry = gtk_entry_new ();
  gtk_widget_ref (renumber_residue_range_resno_1_entry);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "renumber_residue_range_resno_1_entry", renumber_residue_range_resno_1_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (renumber_residue_range_resno_1_entry);
  gtk_box_pack_start (GTK_BOX (hbox96), renumber_residue_range_resno_1_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (renumber_residue_range_resno_1_entry, 60, -2);

  label195 = gtk_label_new (_("  to  "));
  gtk_widget_ref (label195);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "label195", label195,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label195);
  gtk_box_pack_start (GTK_BOX (hbox96), label195, FALSE, FALSE, 0);

  renumber_residue_range_resno_2_entry = gtk_entry_new ();
  gtk_widget_ref (renumber_residue_range_resno_2_entry);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "renumber_residue_range_resno_2_entry", renumber_residue_range_resno_2_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (renumber_residue_range_resno_2_entry);
  gtk_box_pack_start (GTK_BOX (hbox96), renumber_residue_range_resno_2_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (renumber_residue_range_resno_2_entry, 60, -2);

  label196 = gtk_label_new (_("  (inclusive)  "));
  gtk_widget_ref (label196);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "label196", label196,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label196);
  gtk_box_pack_start (GTK_BOX (hbox96), label196, FALSE, FALSE, 0);

  hbox97 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox97);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "hbox97", hbox97,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox97);
  gtk_box_pack_start (GTK_BOX (vbox120), hbox97, TRUE, TRUE, 0);

  label197 = gtk_label_new (_("  Offset:  "));
  gtk_widget_ref (label197);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "label197", label197,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label197);
  gtk_box_pack_start (GTK_BOX (hbox97), label197, FALSE, FALSE, 0);

  renumber_residue_range_offset_entry = gtk_entry_new ();
  gtk_widget_ref (renumber_residue_range_offset_entry);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "renumber_residue_range_offset_entry", renumber_residue_range_offset_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (renumber_residue_range_offset_entry);
  gtk_box_pack_start (GTK_BOX (hbox97), renumber_residue_range_offset_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (renumber_residue_range_offset_entry, 60, -2);
  gtk_tooltips_set_tip (tooltips, renumber_residue_range_offset_entry, _("e.g. an offset of -10 will renumber residues 33 to 36 as 23 to 36"), NULL);

  dialog_action_area60 = GTK_DIALOG (renumber_residue_range_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (renumber_residue_range_dialog), "dialog_action_area60", dialog_action_area60);
  gtk_widget_show (dialog_action_area60);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area60), 7);

  hbox98 = gtk_hbox_new (TRUE, 0);
  gtk_widget_ref (hbox98);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "hbox98", hbox98,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox98);
  gtk_box_pack_start (GTK_BOX (dialog_action_area60), hbox98, TRUE, TRUE, 0);

  renumber_residue_range_ok_button = gtk_button_new_with_label (_("  Renumber  "));
  gtk_widget_ref (renumber_residue_range_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "renumber_residue_range_ok_button", renumber_residue_range_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (renumber_residue_range_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox98), renumber_residue_range_ok_button, FALSE, TRUE, 20);

  renumber_residue_range_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (renumber_residue_range_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (renumber_residue_range_dialog), "renumber_residue_range_cancel_button", renumber_residue_range_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (renumber_residue_range_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox98), renumber_residue_range_cancel_button, FALSE, TRUE, 20);

  gtk_signal_connect (GTK_OBJECT (renumber_residue_range_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_renumber_residue_range_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (renumber_residue_range_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_renumber_residue_range_cancel_button_clicked),
                      NULL);

  gtk_object_set_data (GTK_OBJECT (renumber_residue_range_dialog), "tooltips", tooltips);

  return renumber_residue_range_dialog;
}

GtkWidget*
create_add_OXT_dialog (void)
{
  GtkWidget *add_OXT_dialog;
  GtkWidget *dialog_vbox61;
  GtkWidget *frame114;
  GtkWidget *vbox121;
  GtkWidget *label198;
  GtkWidget *hbox101;
  GtkWidget *label199;
  GtkWidget *add_OXT_molecule_optionmenu;
  GtkWidget *add_OXT_molecule_optionmenu_menu;
  GtkWidget *hbox102;
  GtkWidget *label200;
  GtkWidget *add_OXT_chain_optionmenu;
  GtkWidget *add_OXT_chain_optionmenu_menu;
  GtkWidget *frame115;
  GtkWidget *vbox122;
  GtkWidget *hbox103;
  GSList *add_OXT_group = NULL;
  GtkWidget *add_OXT_c_terminus_radiobutton;
  GtkWidget *add_OXT_residue_hbox;
  GtkWidget *add_OXT_residue_radiobutton;
  GtkWidget *add_OXT_residue_entry;
  GtkWidget *dialog_action_area61;
  GtkWidget *hbox99;
  GtkWidget *add_OXT_ok_button;
  GtkWidget *add_OXT_cancel_button;

  add_OXT_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (add_OXT_dialog), "add_OXT_dialog", add_OXT_dialog);
  gtk_window_set_title (GTK_WINDOW (add_OXT_dialog), _("add OXT to chain"));
  gtk_window_set_policy (GTK_WINDOW (add_OXT_dialog), TRUE, TRUE, FALSE);

  dialog_vbox61 = GTK_DIALOG (add_OXT_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (add_OXT_dialog), "dialog_vbox61", dialog_vbox61);
  gtk_widget_show (dialog_vbox61);

  frame114 = gtk_frame_new (NULL);
  gtk_widget_ref (frame114);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "frame114", frame114,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame114);
  gtk_box_pack_start (GTK_BOX (dialog_vbox61), frame114, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame114), 6);

  vbox121 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox121);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "vbox121", vbox121,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox121);
  gtk_container_add (GTK_CONTAINER (frame114), vbox121);

  label198 = gtk_label_new (_("Add OXT to Chain:"));
  gtk_widget_ref (label198);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "label198", label198,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label198);
  gtk_box_pack_start (GTK_BOX (vbox121), label198, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label198), 0.06, 0.5);

  hbox101 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox101);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "hbox101", hbox101,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox101);
  gtk_box_pack_start (GTK_BOX (vbox121), hbox101, TRUE, TRUE, 0);

  label199 = gtk_label_new (_("  Molecule:  "));
  gtk_widget_ref (label199);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "label199", label199,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label199);
  gtk_box_pack_start (GTK_BOX (hbox101), label199, FALSE, FALSE, 0);

  add_OXT_molecule_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (add_OXT_molecule_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "add_OXT_molecule_optionmenu", add_OXT_molecule_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (add_OXT_molecule_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox101), add_OXT_molecule_optionmenu, FALSE, FALSE, 0);
  add_OXT_molecule_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (add_OXT_molecule_optionmenu), add_OXT_molecule_optionmenu_menu);

  hbox102 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox102);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "hbox102", hbox102,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox102);
  gtk_box_pack_start (GTK_BOX (vbox121), hbox102, TRUE, TRUE, 0);

  label200 = gtk_label_new (_("  Chain:  "));
  gtk_widget_ref (label200);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "label200", label200,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label200);
  gtk_box_pack_start (GTK_BOX (hbox102), label200, FALSE, FALSE, 0);

  add_OXT_chain_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (add_OXT_chain_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "add_OXT_chain_optionmenu", add_OXT_chain_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (add_OXT_chain_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox102), add_OXT_chain_optionmenu, FALSE, FALSE, 0);
  add_OXT_chain_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (add_OXT_chain_optionmenu), add_OXT_chain_optionmenu_menu);

  frame115 = gtk_frame_new (NULL);
  gtk_widget_ref (frame115);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "frame115", frame115,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame115);
  gtk_box_pack_start (GTK_BOX (vbox121), frame115, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame115), 6);

  vbox122 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox122);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "vbox122", vbox122,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox122);
  gtk_container_add (GTK_CONTAINER (frame115), vbox122);

  hbox103 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox103);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "hbox103", hbox103,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox103);
  gtk_box_pack_start (GTK_BOX (vbox122), hbox103, TRUE, TRUE, 0);

  add_OXT_c_terminus_radiobutton = gtk_radio_button_new_with_label (add_OXT_group, _("  At C terminus"));
  add_OXT_group = gtk_radio_button_group (GTK_RADIO_BUTTON (add_OXT_c_terminus_radiobutton));
  gtk_widget_ref (add_OXT_c_terminus_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "add_OXT_c_terminus_radiobutton", add_OXT_c_terminus_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (add_OXT_c_terminus_radiobutton);
  gtk_box_pack_start (GTK_BOX (hbox103), add_OXT_c_terminus_radiobutton, FALSE, FALSE, 0);

  add_OXT_residue_hbox = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (add_OXT_residue_hbox);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "add_OXT_residue_hbox", add_OXT_residue_hbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (add_OXT_residue_hbox);
  gtk_box_pack_start (GTK_BOX (vbox122), add_OXT_residue_hbox, TRUE, TRUE, 0);

  add_OXT_residue_radiobutton = gtk_radio_button_new_with_label (add_OXT_group, _("At Residue: "));
  add_OXT_group = gtk_radio_button_group (GTK_RADIO_BUTTON (add_OXT_residue_radiobutton));
  gtk_widget_ref (add_OXT_residue_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "add_OXT_residue_radiobutton", add_OXT_residue_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (add_OXT_residue_radiobutton);
  gtk_box_pack_start (GTK_BOX (add_OXT_residue_hbox), add_OXT_residue_radiobutton, FALSE, FALSE, 0);

  add_OXT_residue_entry = gtk_entry_new ();
  gtk_widget_ref (add_OXT_residue_entry);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "add_OXT_residue_entry", add_OXT_residue_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (add_OXT_residue_entry);
  gtk_box_pack_start (GTK_BOX (add_OXT_residue_hbox), add_OXT_residue_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (add_OXT_residue_entry, 60, -2);

  dialog_action_area61 = GTK_DIALOG (add_OXT_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (add_OXT_dialog), "dialog_action_area61", dialog_action_area61);
  gtk_widget_show (dialog_action_area61);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area61), 10);

  hbox99 = gtk_hbox_new (TRUE, 0);
  gtk_widget_ref (hbox99);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "hbox99", hbox99,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox99);
  gtk_box_pack_start (GTK_BOX (dialog_action_area61), hbox99, TRUE, TRUE, 0);

  add_OXT_ok_button = gtk_button_new_with_label (_("  Add it  "));
  gtk_widget_ref (add_OXT_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "add_OXT_ok_button", add_OXT_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (add_OXT_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox99), add_OXT_ok_button, FALSE, TRUE, 8);

  add_OXT_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (add_OXT_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (add_OXT_dialog), "add_OXT_cancel_button", add_OXT_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (add_OXT_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox99), add_OXT_cancel_button, FALSE, TRUE, 8);

  gtk_signal_connect (GTK_OBJECT (add_OXT_c_terminus_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_add_OXT_c_terminus_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (add_OXT_residue_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_add_OXT_residue_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (add_OXT_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_add_OXT_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (add_OXT_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_add_OXT_cancel_button_clicked),
                      NULL);

  return add_OXT_dialog;
}

GtkWidget*
create_ligand_no_blobs_dialog (void)
{
  GtkWidget *ligand_no_blobs_dialog;
  GtkWidget *dialog_vbox62;
  GtkWidget *frame117;
  GtkWidget *label203;
  GtkWidget *dialog_action_area62;
  GtkWidget *hbox106;
  GtkWidget *ligand_no_blobs_OK_button;

  ligand_no_blobs_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (ligand_no_blobs_dialog), "ligand_no_blobs_dialog", ligand_no_blobs_dialog);
  gtk_window_set_title (GTK_WINDOW (ligand_no_blobs_dialog), _("dialog1"));
  gtk_window_set_policy (GTK_WINDOW (ligand_no_blobs_dialog), TRUE, TRUE, FALSE);

  dialog_vbox62 = GTK_DIALOG (ligand_no_blobs_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (ligand_no_blobs_dialog), "dialog_vbox62", dialog_vbox62);
  gtk_widget_show (dialog_vbox62);

  frame117 = gtk_frame_new (NULL);
  gtk_widget_ref (frame117);
  gtk_object_set_data_full (GTK_OBJECT (ligand_no_blobs_dialog), "frame117", frame117,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame117);
  gtk_box_pack_start (GTK_BOX (dialog_vbox62), frame117, TRUE, TRUE, 0);

  label203 = gtk_label_new (_("\n\n\n     Coot found no unexplained blobs      \n\n\n"));
  gtk_widget_ref (label203);
  gtk_object_set_data_full (GTK_OBJECT (ligand_no_blobs_dialog), "label203", label203,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label203);
  gtk_container_add (GTK_CONTAINER (frame117), label203);

  dialog_action_area62 = GTK_DIALOG (ligand_no_blobs_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (ligand_no_blobs_dialog), "dialog_action_area62", dialog_action_area62);
  gtk_widget_show (dialog_action_area62);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area62), 10);

  hbox106 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox106);
  gtk_object_set_data_full (GTK_OBJECT (ligand_no_blobs_dialog), "hbox106", hbox106,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox106);
  gtk_box_pack_start (GTK_BOX (dialog_action_area62), hbox106, TRUE, TRUE, 0);

  ligand_no_blobs_OK_button = gtk_button_new_with_label (_("   OK!   "));
  gtk_widget_ref (ligand_no_blobs_OK_button);
  gtk_object_set_data_full (GTK_OBJECT (ligand_no_blobs_dialog), "ligand_no_blobs_OK_button", ligand_no_blobs_OK_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ligand_no_blobs_OK_button);
  gtk_box_pack_start (GTK_BOX (hbox106), ligand_no_blobs_OK_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (ligand_no_blobs_OK_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (ligand_no_blobs_OK_button), "clicked",
                      GTK_SIGNAL_FUNC (on_ligand_no_blobs_OK_button_clicked),
                      NULL);

  gtk_widget_grab_focus (ligand_no_blobs_OK_button);
  gtk_widget_grab_default (ligand_no_blobs_OK_button);
  return ligand_no_blobs_dialog;
}

GtkWidget*
create_new_close_molecules_dialog (void)
{
  GtkWidget *new_close_molecules_dialog;
  GtkWidget *dialog_vbox67;
  GtkWidget *frame121;
  GtkWidget *vbox126;
  GtkWidget *hbox107;
  GtkWidget *label209;
  GtkWidget *label210;
  GtkWidget *scrolledwindow16;
  GtkWidget *viewport9;
  GtkWidget *new_delete_molecules_vbox;
  GtkWidget *dialog_action_area67;
  GtkWidget *hbox108;
  GtkWidget *new_delete_molecules_ok_button;
  GtkWidget *new_delete_molecules_cancel_button;

  new_close_molecules_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (new_close_molecules_dialog), "new_close_molecules_dialog", new_close_molecules_dialog);
  gtk_container_set_border_width (GTK_CONTAINER (new_close_molecules_dialog), 2);
  gtk_window_set_title (GTK_WINDOW (new_close_molecules_dialog), _("Delete Molecules:"));
  gtk_window_set_policy (GTK_WINDOW (new_close_molecules_dialog), TRUE, TRUE, FALSE);

  dialog_vbox67 = GTK_DIALOG (new_close_molecules_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (new_close_molecules_dialog), "dialog_vbox67", dialog_vbox67);
  gtk_widget_show (dialog_vbox67);

  frame121 = gtk_frame_new (NULL);
  gtk_widget_ref (frame121);
  gtk_object_set_data_full (GTK_OBJECT (new_close_molecules_dialog), "frame121", frame121,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame121);
  gtk_box_pack_start (GTK_BOX (dialog_vbox67), frame121, TRUE, TRUE, 0);

  vbox126 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox126);
  gtk_object_set_data_full (GTK_OBJECT (new_close_molecules_dialog), "vbox126", vbox126,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox126);
  gtk_container_add (GTK_CONTAINER (frame121), vbox126);

  hbox107 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox107);
  gtk_object_set_data_full (GTK_OBJECT (new_close_molecules_dialog), "hbox107", hbox107,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox107);
  gtk_box_pack_start (GTK_BOX (vbox126), hbox107, FALSE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox107), 3);

  label209 = gtk_label_new (_("      Delete?    "));
  gtk_widget_ref (label209);
  gtk_object_set_data_full (GTK_OBJECT (new_close_molecules_dialog), "label209", label209,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label209);
  gtk_box_pack_start (GTK_BOX (hbox107), label209, FALSE, FALSE, 0);

  label210 = gtk_label_new (_("     Name"));
  gtk_widget_ref (label210);
  gtk_object_set_data_full (GTK_OBJECT (new_close_molecules_dialog), "label210", label210,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label210);
  gtk_box_pack_start (GTK_BOX (hbox107), label210, FALSE, FALSE, 0);

  scrolledwindow16 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow16);
  gtk_object_set_data_full (GTK_OBJECT (new_close_molecules_dialog), "scrolledwindow16", scrolledwindow16,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow16);
  gtk_box_pack_start (GTK_BOX (vbox126), scrolledwindow16, TRUE, TRUE, 0);
  gtk_widget_set_usize (scrolledwindow16, 335, 140);

  viewport9 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport9);
  gtk_object_set_data_full (GTK_OBJECT (new_close_molecules_dialog), "viewport9", viewport9,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport9);
  gtk_container_add (GTK_CONTAINER (scrolledwindow16), viewport9);

  new_delete_molecules_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (new_delete_molecules_vbox);
  gtk_object_set_data_full (GTK_OBJECT (new_close_molecules_dialog), "new_delete_molecules_vbox", new_delete_molecules_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (new_delete_molecules_vbox);
  gtk_container_add (GTK_CONTAINER (viewport9), new_delete_molecules_vbox);

  dialog_action_area67 = GTK_DIALOG (new_close_molecules_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (new_close_molecules_dialog), "dialog_action_area67", dialog_action_area67);
  gtk_widget_show (dialog_action_area67);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area67), 10);

  hbox108 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox108);
  gtk_object_set_data_full (GTK_OBJECT (new_close_molecules_dialog), "hbox108", hbox108,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox108);
  gtk_box_pack_start (GTK_BOX (dialog_action_area67), hbox108, TRUE, TRUE, 0);

  new_delete_molecules_ok_button = gtk_button_new_with_label (_("  Delete Marked Molecules & Maps  "));
  gtk_widget_ref (new_delete_molecules_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (new_close_molecules_dialog), "new_delete_molecules_ok_button", new_delete_molecules_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (new_delete_molecules_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox108), new_delete_molecules_ok_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (new_delete_molecules_ok_button), 4);

  new_delete_molecules_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (new_delete_molecules_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (new_close_molecules_dialog), "new_delete_molecules_cancel_button", new_delete_molecules_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (new_delete_molecules_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox108), new_delete_molecules_cancel_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (new_delete_molecules_cancel_button), 4);

  gtk_signal_connect (GTK_OBJECT (new_delete_molecules_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_new_delete_molecules_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (new_delete_molecules_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_new_delete_molecules_cancel_button_clicked),
                      NULL);

  return new_close_molecules_dialog;
}

GtkWidget*
create_unmodelled_blobs_dialog (void)
{
  GtkWidget *unmodelled_blobs_dialog;
  GtkWidget *dialog_vbox68;
  GtkWidget *vbox127;
  GtkWidget *vbox128;
  GtkWidget *frame122;
  GtkWidget *find_blobs_map_vbox;
  GtkWidget *label211;
  GtkWidget *frame123;
  GtkWidget *find_blobs_protein_vbox;
  GtkWidget *label212;
  GtkWidget *frame124;
  GtkWidget *vbox131;
  GtkWidget *label213;
  GtkWidget *hbox111;
  GtkWidget *find_blobs_peak_level_entry;
  GtkWidget *label214;
  GtkWidget *hbox109;
  GtkWidget *hbox110;
  GtkWidget *find_blobs_ok_button;
  GtkWidget *find_blobs_cancel_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  unmodelled_blobs_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (unmodelled_blobs_dialog), "unmodelled_blobs_dialog", unmodelled_blobs_dialog);
  gtk_window_set_title (GTK_WINDOW (unmodelled_blobs_dialog), _("Find Unmodelled Blobs of density"));
  gtk_window_set_policy (GTK_WINDOW (unmodelled_blobs_dialog), TRUE, TRUE, FALSE);

  dialog_vbox68 = GTK_DIALOG (unmodelled_blobs_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (unmodelled_blobs_dialog), "dialog_vbox68", dialog_vbox68);
  gtk_widget_show (dialog_vbox68);

  vbox127 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox127);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "vbox127", vbox127,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox127);
  gtk_box_pack_start (GTK_BOX (dialog_vbox68), vbox127, TRUE, TRUE, 0);

  vbox128 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox128);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "vbox128", vbox128,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox128);
  gtk_box_pack_start (GTK_BOX (vbox127), vbox128, TRUE, TRUE, 0);

  frame122 = gtk_frame_new (NULL);
  gtk_widget_ref (frame122);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "frame122", frame122,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame122);
  gtk_box_pack_start (GTK_BOX (vbox128), frame122, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame122), 6);

  find_blobs_map_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (find_blobs_map_vbox);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "find_blobs_map_vbox", find_blobs_map_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_blobs_map_vbox);
  gtk_container_add (GTK_CONTAINER (frame122), find_blobs_map_vbox);
  gtk_container_set_border_width (GTK_CONTAINER (find_blobs_map_vbox), 3);

  label211 = gtk_label_new (_("Select Map:"));
  gtk_widget_ref (label211);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "label211", label211,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label211);
  gtk_box_pack_start (GTK_BOX (find_blobs_map_vbox), label211, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label211), GTK_JUSTIFY_LEFT);

  frame123 = gtk_frame_new (NULL);
  gtk_widget_ref (frame123);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "frame123", frame123,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame123);
  gtk_box_pack_start (GTK_BOX (vbox128), frame123, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame123), 6);

  find_blobs_protein_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (find_blobs_protein_vbox);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "find_blobs_protein_vbox", find_blobs_protein_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_blobs_protein_vbox);
  gtk_container_add (GTK_CONTAINER (frame123), find_blobs_protein_vbox);
  gtk_container_set_border_width (GTK_CONTAINER (find_blobs_protein_vbox), 3);

  label212 = gtk_label_new (_("Select Protein Model:"));
  gtk_widget_ref (label212);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "label212", label212,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label212);
  gtk_box_pack_start (GTK_BOX (find_blobs_protein_vbox), label212, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label212), GTK_JUSTIFY_LEFT);

  frame124 = gtk_frame_new (NULL);
  gtk_widget_ref (frame124);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "frame124", frame124,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame124);
  gtk_box_pack_start (GTK_BOX (vbox128), frame124, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame124), 6);

  vbox131 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox131);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "vbox131", vbox131,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox131);
  gtk_container_add (GTK_CONTAINER (frame124), vbox131);
  gtk_container_set_border_width (GTK_CONTAINER (vbox131), 3);

  label213 = gtk_label_new (_("Find Blobs above:"));
  gtk_widget_ref (label213);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "label213", label213,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label213);
  gtk_box_pack_start (GTK_BOX (vbox131), label213, FALSE, FALSE, 0);

  hbox111 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox111);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "hbox111", hbox111,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox111);
  gtk_box_pack_start (GTK_BOX (vbox131), hbox111, TRUE, TRUE, 0);

  find_blobs_peak_level_entry = gtk_entry_new ();
  gtk_widget_ref (find_blobs_peak_level_entry);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "find_blobs_peak_level_entry", find_blobs_peak_level_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_blobs_peak_level_entry);
  gtk_box_pack_start (GTK_BOX (hbox111), find_blobs_peak_level_entry, FALSE, TRUE, 6);
  gtk_widget_set_usize (find_blobs_peak_level_entry, 36, -2);
  gtk_tooltips_set_tip (tooltips, find_blobs_peak_level_entry, _("Note that this is sigma of the map after it has been masked by the protein.  1.8 sigma seems good for a 2Fo-Fc style map and about 3.0 for a difference map."), NULL);

  label214 = gtk_label_new (_(" sigma "));
  gtk_widget_ref (label214);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "label214", label214,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label214);
  gtk_box_pack_start (GTK_BOX (hbox111), label214, FALSE, FALSE, 0);

  hbox109 = GTK_DIALOG (unmodelled_blobs_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (unmodelled_blobs_dialog), "hbox109", hbox109);
  gtk_widget_show (hbox109);
  gtk_container_set_border_width (GTK_CONTAINER (hbox109), 10);

  hbox110 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox110);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "hbox110", hbox110,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox110);
  gtk_box_pack_start (GTK_BOX (hbox109), hbox110, TRUE, TRUE, 0);

  find_blobs_ok_button = gtk_button_new_with_label (_("  Find Blobs  "));
  gtk_widget_ref (find_blobs_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "find_blobs_ok_button", find_blobs_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_blobs_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox110), find_blobs_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (find_blobs_ok_button, GTK_CAN_DEFAULT);

  find_blobs_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (find_blobs_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (unmodelled_blobs_dialog), "find_blobs_cancel_button", find_blobs_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (find_blobs_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox110), find_blobs_cancel_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (find_blobs_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (find_blobs_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_find_blobs_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (find_blobs_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_find_blobs_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (find_blobs_ok_button);
  gtk_widget_grab_default (find_blobs_ok_button);
  gtk_object_set_data (GTK_OBJECT (unmodelled_blobs_dialog), "tooltips", tooltips);

  return unmodelled_blobs_dialog;
}

GtkWidget*
create_chiral_restraints_problem_dialog (void)
{
  GtkWidget *chiral_restraints_problem_dialog;
  GtkWidget *dialog_vbox69;
  GtkWidget *frame125;
  GtkWidget *chiral_volume_restraints_problem_label;
  GtkWidget *dialog_action_area68;
  GtkWidget *chiral_restraints_problem_ok_button;

  chiral_restraints_problem_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (chiral_restraints_problem_dialog), "chiral_restraints_problem_dialog", chiral_restraints_problem_dialog);
  gtk_window_set_title (GTK_WINDOW (chiral_restraints_problem_dialog), _("Problem with restraints..."));
  gtk_window_set_policy (GTK_WINDOW (chiral_restraints_problem_dialog), TRUE, TRUE, FALSE);

  dialog_vbox69 = GTK_DIALOG (chiral_restraints_problem_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (chiral_restraints_problem_dialog), "dialog_vbox69", dialog_vbox69);
  gtk_widget_show (dialog_vbox69);

  frame125 = gtk_frame_new (NULL);
  gtk_widget_ref (frame125);
  gtk_object_set_data_full (GTK_OBJECT (chiral_restraints_problem_dialog), "frame125", frame125,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame125);
  gtk_box_pack_start (GTK_BOX (dialog_vbox69), frame125, TRUE, TRUE, 0);

  chiral_volume_restraints_problem_label = gtk_label_new (_("\n\n         Problem finding restraints!          \n(see console)\n\n"));
  gtk_widget_ref (chiral_volume_restraints_problem_label);
  gtk_object_set_data_full (GTK_OBJECT (chiral_restraints_problem_dialog), "chiral_volume_restraints_problem_label", chiral_volume_restraints_problem_label,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (chiral_volume_restraints_problem_label);
  gtk_container_add (GTK_CONTAINER (frame125), chiral_volume_restraints_problem_label);

  dialog_action_area68 = GTK_DIALOG (chiral_restraints_problem_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (chiral_restraints_problem_dialog), "dialog_action_area68", dialog_action_area68);
  gtk_widget_show (dialog_action_area68);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area68), 10);

  chiral_restraints_problem_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (chiral_restraints_problem_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (chiral_restraints_problem_dialog), "chiral_restraints_problem_ok_button", chiral_restraints_problem_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (chiral_restraints_problem_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area68), chiral_restraints_problem_ok_button, FALSE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (chiral_restraints_problem_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_chiral_restraints_problem_ok_button_clicked),
                      NULL);

  return chiral_restraints_problem_dialog;
}

GtkWidget*
create_check_waters_diff_map_dialog (void)
{
  GtkWidget *check_waters_diff_map_dialog;
  GtkWidget *dialog_vbox70;
  GtkWidget *vbox132;
  GtkWidget *vbox133;
  GtkWidget *frame126;
  GtkWidget *check_waters_diff_map_map_vbox;
  GtkWidget *label216;
  GtkWidget *no_difference_maps_frame;
  GtkWidget *label220;
  GtkWidget *frame127;
  GtkWidget *check_waters_diff_map_model_vbox;
  GtkWidget *label217;
  GtkWidget *no_models_with_waters_frame;
  GtkWidget *label221;
  GtkWidget *dialog_action_area69;
  GtkWidget *hbox112;
  GtkWidget *check_waters_diff_map_ok_button;
  GtkWidget *check_waters_diff_map_cancel_button;

  check_waters_diff_map_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (check_waters_diff_map_dialog), "check_waters_diff_map_dialog", check_waters_diff_map_dialog);
  gtk_window_set_title (GTK_WINDOW (check_waters_diff_map_dialog), _("Check waters by difference map"));
  gtk_window_set_policy (GTK_WINDOW (check_waters_diff_map_dialog), TRUE, TRUE, FALSE);

  dialog_vbox70 = GTK_DIALOG (check_waters_diff_map_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (check_waters_diff_map_dialog), "dialog_vbox70", dialog_vbox70);
  gtk_widget_show (dialog_vbox70);

  vbox132 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox132);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "vbox132", vbox132,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox132);
  gtk_box_pack_start (GTK_BOX (dialog_vbox70), vbox132, TRUE, TRUE, 0);

  vbox133 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox133);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "vbox133", vbox133,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox133);
  gtk_box_pack_start (GTK_BOX (vbox132), vbox133, TRUE, TRUE, 0);

  frame126 = gtk_frame_new (NULL);
  gtk_widget_ref (frame126);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "frame126", frame126,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame126);
  gtk_box_pack_start (GTK_BOX (vbox133), frame126, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame126), 6);

  check_waters_diff_map_map_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (check_waters_diff_map_map_vbox);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "check_waters_diff_map_map_vbox", check_waters_diff_map_map_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_diff_map_map_vbox);
  gtk_container_add (GTK_CONTAINER (frame126), check_waters_diff_map_map_vbox);
  gtk_container_set_border_width (GTK_CONTAINER (check_waters_diff_map_map_vbox), 3);

  label216 = gtk_label_new (_("Select Difference Map:"));
  gtk_widget_ref (label216);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "label216", label216,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label216);
  gtk_box_pack_start (GTK_BOX (check_waters_diff_map_map_vbox), label216, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label216), GTK_JUSTIFY_LEFT);

  no_difference_maps_frame = gtk_frame_new (NULL);
  gtk_widget_ref (no_difference_maps_frame);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "no_difference_maps_frame", no_difference_maps_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (check_waters_diff_map_map_vbox), no_difference_maps_frame, TRUE, TRUE, 0);

  label220 = gtk_label_new (_("\nWARNING:: No Difference Maps Available!\n"));
  gtk_widget_ref (label220);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "label220", label220,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label220);
  gtk_container_add (GTK_CONTAINER (no_difference_maps_frame), label220);
  gtk_misc_set_padding (GTK_MISC (label220), 4, 0);

  frame127 = gtk_frame_new (NULL);
  gtk_widget_ref (frame127);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "frame127", frame127,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame127);
  gtk_box_pack_start (GTK_BOX (vbox133), frame127, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame127), 6);

  check_waters_diff_map_model_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (check_waters_diff_map_model_vbox);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "check_waters_diff_map_model_vbox", check_waters_diff_map_model_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_diff_map_model_vbox);
  gtk_container_add (GTK_CONTAINER (frame127), check_waters_diff_map_model_vbox);
  gtk_container_set_border_width (GTK_CONTAINER (check_waters_diff_map_model_vbox), 3);

  label217 = gtk_label_new (_("Select Model with Waters:"));
  gtk_widget_ref (label217);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "label217", label217,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label217);
  gtk_box_pack_start (GTK_BOX (check_waters_diff_map_model_vbox), label217, FALSE, FALSE, 0);
  gtk_label_set_justify (GTK_LABEL (label217), GTK_JUSTIFY_LEFT);

  no_models_with_waters_frame = gtk_frame_new (NULL);
  gtk_widget_ref (no_models_with_waters_frame);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "no_models_with_waters_frame", no_models_with_waters_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (check_waters_diff_map_model_vbox), no_models_with_waters_frame, TRUE, TRUE, 0);

  label221 = gtk_label_new (_("\nWARNING:: No Models with Waters Available!\n"));
  gtk_widget_ref (label221);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "label221", label221,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label221);
  gtk_container_add (GTK_CONTAINER (no_models_with_waters_frame), label221);
  gtk_misc_set_padding (GTK_MISC (label221), 4, 0);

  dialog_action_area69 = GTK_DIALOG (check_waters_diff_map_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (check_waters_diff_map_dialog), "dialog_action_area69", dialog_action_area69);
  gtk_widget_show (dialog_action_area69);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area69), 10);

  hbox112 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox112);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "hbox112", hbox112,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox112);
  gtk_box_pack_start (GTK_BOX (dialog_action_area69), hbox112, TRUE, TRUE, 0);

  check_waters_diff_map_ok_button = gtk_button_new_with_label (_("   Check Waters   "));
  gtk_widget_ref (check_waters_diff_map_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "check_waters_diff_map_ok_button", check_waters_diff_map_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_diff_map_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox112), check_waters_diff_map_ok_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (check_waters_diff_map_ok_button), 4);
  GTK_WIDGET_SET_FLAGS (check_waters_diff_map_ok_button, GTK_CAN_DEFAULT);

  check_waters_diff_map_cancel_button = gtk_button_new_with_label (_("   Cancel   "));
  gtk_widget_ref (check_waters_diff_map_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (check_waters_diff_map_dialog), "check_waters_diff_map_cancel_button", check_waters_diff_map_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (check_waters_diff_map_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox112), check_waters_diff_map_cancel_button, TRUE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (check_waters_diff_map_cancel_button), 4);
  GTK_WIDGET_SET_FLAGS (check_waters_diff_map_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (check_waters_diff_map_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_check_waters_diff_map_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (check_waters_diff_map_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_check_waters_diff_map_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (check_waters_diff_map_ok_button);
  gtk_widget_grab_default (check_waters_diff_map_ok_button);
  return check_waters_diff_map_dialog;
}

GtkWidget*
create_interesting_waters_by_difference_map_check_dialog (void)
{
  GtkWidget *interesting_waters_by_difference_map_check_dialog;
  GtkWidget *dialog_vbox71;
  GtkWidget *scrolledwindow17;
  GtkWidget *viewport10;
  GtkWidget *interesting_waters_by_difference_map_check_vbox;
  GtkWidget *dialog_action_area70;
  GtkWidget *interesting_waters_by_difference_map_check_ok_button;

  interesting_waters_by_difference_map_check_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (interesting_waters_by_difference_map_check_dialog), "interesting_waters_by_difference_map_check_dialog", interesting_waters_by_difference_map_check_dialog);
  gtk_window_set_title (GTK_WINDOW (interesting_waters_by_difference_map_check_dialog), _("Interesting/Strange Waters:"));
  gtk_window_set_policy (GTK_WINDOW (interesting_waters_by_difference_map_check_dialog), TRUE, TRUE, FALSE);

  dialog_vbox71 = GTK_DIALOG (interesting_waters_by_difference_map_check_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (interesting_waters_by_difference_map_check_dialog), "dialog_vbox71", dialog_vbox71);
  gtk_widget_show (dialog_vbox71);

  scrolledwindow17 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow17);
  gtk_object_set_data_full (GTK_OBJECT (interesting_waters_by_difference_map_check_dialog), "scrolledwindow17", scrolledwindow17,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow17);
  gtk_box_pack_start (GTK_BOX (dialog_vbox71), scrolledwindow17, TRUE, TRUE, 0);
  gtk_widget_set_usize (scrolledwindow17, 180, 160);

  viewport10 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport10);
  gtk_object_set_data_full (GTK_OBJECT (interesting_waters_by_difference_map_check_dialog), "viewport10", viewport10,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport10);
  gtk_container_add (GTK_CONTAINER (scrolledwindow17), viewport10);

  interesting_waters_by_difference_map_check_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (interesting_waters_by_difference_map_check_vbox);
  gtk_object_set_data_full (GTK_OBJECT (interesting_waters_by_difference_map_check_dialog), "interesting_waters_by_difference_map_check_vbox", interesting_waters_by_difference_map_check_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (interesting_waters_by_difference_map_check_vbox);
  gtk_container_add (GTK_CONTAINER (viewport10), interesting_waters_by_difference_map_check_vbox);

  dialog_action_area70 = GTK_DIALOG (interesting_waters_by_difference_map_check_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (interesting_waters_by_difference_map_check_dialog), "dialog_action_area70", dialog_action_area70);
  gtk_widget_show (dialog_action_area70);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area70), 10);

  interesting_waters_by_difference_map_check_ok_button = gtk_button_new_with_label (_("   Cancel   "));
  gtk_widget_ref (interesting_waters_by_difference_map_check_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (interesting_waters_by_difference_map_check_dialog), "interesting_waters_by_difference_map_check_ok_button", interesting_waters_by_difference_map_check_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (interesting_waters_by_difference_map_check_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area70), interesting_waters_by_difference_map_check_ok_button, FALSE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (interesting_waters_by_difference_map_check_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_interesting_waters_by_difference_map_check_ok_button_clicked),
                      NULL);

  return interesting_waters_by_difference_map_check_dialog;
}

GtkWidget*
create_nothing_bad_dialog (void)
{
  GtkWidget *nothing_bad_dialog;
  GtkWidget *dialog_vbox72;
  GtkWidget *frame128;
  GtkWidget *nothing_bad_label;
  GtkWidget *dialog_action_area71;
  GtkWidget *nothing_bad_ok_button;

  nothing_bad_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (nothing_bad_dialog), "nothing_bad_dialog", nothing_bad_dialog);
  gtk_window_set_title (GTK_WINDOW (nothing_bad_dialog), _("Info:"));
  gtk_window_set_policy (GTK_WINDOW (nothing_bad_dialog), TRUE, TRUE, FALSE);

  dialog_vbox72 = GTK_DIALOG (nothing_bad_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (nothing_bad_dialog), "dialog_vbox72", dialog_vbox72);
  gtk_widget_show (dialog_vbox72);

  frame128 = gtk_frame_new (NULL);
  gtk_widget_ref (frame128);
  gtk_object_set_data_full (GTK_OBJECT (nothing_bad_dialog), "frame128", frame128,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame128);
  gtk_box_pack_start (GTK_BOX (dialog_vbox72), frame128, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame128), 6);

  nothing_bad_label = gtk_label_new (_("Nothing Bad"));
  gtk_widget_ref (nothing_bad_label);
  gtk_object_set_data_full (GTK_OBJECT (nothing_bad_dialog), "nothing_bad_label", nothing_bad_label,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (nothing_bad_label);
  gtk_container_add (GTK_CONTAINER (frame128), nothing_bad_label);
  gtk_misc_set_padding (GTK_MISC (nothing_bad_label), 80, 40);

  dialog_action_area71 = GTK_DIALOG (nothing_bad_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (nothing_bad_dialog), "dialog_action_area71", dialog_action_area71);
  gtk_widget_show (dialog_action_area71);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area71), 10);

  nothing_bad_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (nothing_bad_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (nothing_bad_dialog), "nothing_bad_ok_button", nothing_bad_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (nothing_bad_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area71), nothing_bad_ok_button, FALSE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (nothing_bad_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (nothing_bad_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_nothing_bad_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (nothing_bad_ok_button);
  gtk_widget_grab_default (nothing_bad_ok_button);
  return nothing_bad_dialog;
}

GtkWidget*
create_skeletonize_map_dialog (void)
{
  GtkWidget *skeletonize_map_dialog;
  GtkWidget *dialog_vbox73;
  GtkWidget *frame130;
  GtkWidget *vbox134;
  GtkWidget *label218;
  GtkWidget *skeletonize_map_optionmenu;
  GtkWidget *skeletonize_map_optionmenu_menu;
  GtkWidget *dialog_action_area72;
  GtkWidget *hbox113;
  GtkWidget *skeletonize_map_dialog_ok_button;
  GtkWidget *skeletonize_map_dialog_cancel_button;

  skeletonize_map_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (skeletonize_map_dialog), "skeletonize_map_dialog", skeletonize_map_dialog);
  gtk_window_set_title (GTK_WINDOW (skeletonize_map_dialog), _("Skeletonize Map"));
  gtk_window_set_policy (GTK_WINDOW (skeletonize_map_dialog), TRUE, TRUE, FALSE);

  dialog_vbox73 = GTK_DIALOG (skeletonize_map_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (skeletonize_map_dialog), "dialog_vbox73", dialog_vbox73);
  gtk_widget_show (dialog_vbox73);

  frame130 = gtk_frame_new (NULL);
  gtk_widget_ref (frame130);
  gtk_object_set_data_full (GTK_OBJECT (skeletonize_map_dialog), "frame130", frame130,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame130);
  gtk_box_pack_start (GTK_BOX (dialog_vbox73), frame130, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame130), 6);

  vbox134 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox134);
  gtk_object_set_data_full (GTK_OBJECT (skeletonize_map_dialog), "vbox134", vbox134,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox134);
  gtk_container_add (GTK_CONTAINER (frame130), vbox134);

  label218 = gtk_label_new (_("\nYou need a skeleton to use baton building.  \n\nWhich map do you want to skeletonize?\n"));
  gtk_widget_ref (label218);
  gtk_object_set_data_full (GTK_OBJECT (skeletonize_map_dialog), "label218", label218,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label218);
  gtk_box_pack_start (GTK_BOX (vbox134), label218, FALSE, FALSE, 0);

  skeletonize_map_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (skeletonize_map_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (skeletonize_map_dialog), "skeletonize_map_optionmenu", skeletonize_map_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeletonize_map_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox134), skeletonize_map_optionmenu, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (skeletonize_map_optionmenu), 2);
  skeletonize_map_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (skeletonize_map_optionmenu), skeletonize_map_optionmenu_menu);

  dialog_action_area72 = GTK_DIALOG (skeletonize_map_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (skeletonize_map_dialog), "dialog_action_area72", dialog_action_area72);
  gtk_widget_show (dialog_action_area72);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area72), 10);

  hbox113 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox113);
  gtk_object_set_data_full (GTK_OBJECT (skeletonize_map_dialog), "hbox113", hbox113,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox113);
  gtk_box_pack_start (GTK_BOX (dialog_action_area72), hbox113, TRUE, TRUE, 0);

  skeletonize_map_dialog_ok_button = gtk_button_new_with_label (_("   Skeletonize   "));
  gtk_widget_ref (skeletonize_map_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (skeletonize_map_dialog), "skeletonize_map_dialog_ok_button", skeletonize_map_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeletonize_map_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox113), skeletonize_map_dialog_ok_button, FALSE, FALSE, 10);

  skeletonize_map_dialog_cancel_button = gtk_button_new_with_label (_("   Cancel   "));
  gtk_widget_ref (skeletonize_map_dialog_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (skeletonize_map_dialog), "skeletonize_map_dialog_cancel_button", skeletonize_map_dialog_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (skeletonize_map_dialog_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox113), skeletonize_map_dialog_cancel_button, FALSE, FALSE, 10);

  gtk_signal_connect (GTK_OBJECT (skeletonize_map_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_skeletonize_map_dialog_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (skeletonize_map_dialog_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_skeletonize_map_dialog_cancel_button_clicked),
                      NULL);

  return skeletonize_map_dialog;
}

GtkWidget*
create_antialiasing_dialog (void)
{
  GtkWidget *antialiasing_dialog;
  GtkWidget *dialog_vbox74;
  GtkWidget *frame131;
  GtkWidget *vbox135;
  GtkWidget *label219;
  GtkWidget *frame132;
  GtkWidget *vbox136;
  GSList *antialias_gr_group = NULL;
  GtkWidget *antialias_dialog_yes_radiobutton;
  GtkWidget *antialias_dialog_no_radiobutton;
  GtkWidget *dialog_action_area73;
  GtkWidget *antialiasing_dialog_ok_button;

  antialiasing_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (antialiasing_dialog), "antialiasing_dialog", antialiasing_dialog);
  gtk_window_set_title (GTK_WINDOW (antialiasing_dialog), _("Antialiasing"));
  gtk_window_set_policy (GTK_WINDOW (antialiasing_dialog), TRUE, TRUE, FALSE);

  dialog_vbox74 = GTK_DIALOG (antialiasing_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (antialiasing_dialog), "dialog_vbox74", dialog_vbox74);
  gtk_widget_show (dialog_vbox74);

  frame131 = gtk_frame_new (NULL);
  gtk_widget_ref (frame131);
  gtk_object_set_data_full (GTK_OBJECT (antialiasing_dialog), "frame131", frame131,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame131);
  gtk_box_pack_start (GTK_BOX (dialog_vbox74), frame131, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame131), 6);

  vbox135 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox135);
  gtk_object_set_data_full (GTK_OBJECT (antialiasing_dialog), "vbox135", vbox135,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox135);
  gtk_container_add (GTK_CONTAINER (frame131), vbox135);
  gtk_widget_set_usize (vbox135, 242, -2);

  label219 = gtk_label_new (_("Antialias Lines?"));
  gtk_widget_ref (label219);
  gtk_object_set_data_full (GTK_OBJECT (antialiasing_dialog), "label219", label219,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label219);
  gtk_box_pack_start (GTK_BOX (vbox135), label219, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label219), 9, 7);

  frame132 = gtk_frame_new (NULL);
  gtk_widget_ref (frame132);
  gtk_object_set_data_full (GTK_OBJECT (antialiasing_dialog), "frame132", frame132,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame132);
  gtk_box_pack_start (GTK_BOX (vbox135), frame132, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame132), 12);

  vbox136 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox136);
  gtk_object_set_data_full (GTK_OBJECT (antialiasing_dialog), "vbox136", vbox136,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox136);
  gtk_container_add (GTK_CONTAINER (frame132), vbox136);

  antialias_dialog_yes_radiobutton = gtk_radio_button_new_with_label (antialias_gr_group, _("Yes"));
  antialias_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (antialias_dialog_yes_radiobutton));
  gtk_widget_ref (antialias_dialog_yes_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (antialiasing_dialog), "antialias_dialog_yes_radiobutton", antialias_dialog_yes_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (antialias_dialog_yes_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox136), antialias_dialog_yes_radiobutton, FALSE, FALSE, 0);

  antialias_dialog_no_radiobutton = gtk_radio_button_new_with_label (antialias_gr_group, _("No"));
  antialias_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (antialias_dialog_no_radiobutton));
  gtk_widget_ref (antialias_dialog_no_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (antialiasing_dialog), "antialias_dialog_no_radiobutton", antialias_dialog_no_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (antialias_dialog_no_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox136), antialias_dialog_no_radiobutton, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (antialias_dialog_no_radiobutton), TRUE);

  dialog_action_area73 = GTK_DIALOG (antialiasing_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (antialiasing_dialog), "dialog_action_area73", dialog_action_area73);
  gtk_widget_show (dialog_action_area73);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area73), 10);

  antialiasing_dialog_ok_button = gtk_button_new_with_label (_("   OK   "));
  gtk_widget_ref (antialiasing_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (antialiasing_dialog), "antialiasing_dialog_ok_button", antialiasing_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (antialiasing_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area73), antialiasing_dialog_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (antialiasing_dialog_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (antialias_dialog_yes_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_antialias_dialog_yes_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (antialias_dialog_no_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_antialias_dialog_no_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (antialiasing_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_antialiasing_dialog_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (antialiasing_dialog_ok_button);
  gtk_widget_grab_default (antialiasing_dialog_ok_button);
  return antialiasing_dialog;
}

GtkWidget*
create_geometry_graphs_dialog (void)
{
  GtkWidget *geometry_graphs_dialog;
  GtkWidget *dialog_vbox75;
  GtkWidget *geometry_graphs_scrolledwindow;
  GtkWidget *geometry_graphs_viewport;
  GtkWidget *dialog_action_area74;
  GtkWidget *geometry_graphs_ok_button;

  geometry_graphs_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (geometry_graphs_dialog), "geometry_graphs_dialog", geometry_graphs_dialog);
  gtk_window_set_title (GTK_WINDOW (geometry_graphs_dialog), _("Geometry Graphs"));
  gtk_window_set_policy (GTK_WINDOW (geometry_graphs_dialog), TRUE, TRUE, FALSE);

  dialog_vbox75 = GTK_DIALOG (geometry_graphs_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (geometry_graphs_dialog), "dialog_vbox75", dialog_vbox75);
  gtk_widget_show (dialog_vbox75);

  geometry_graphs_scrolledwindow = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (geometry_graphs_scrolledwindow);
  gtk_object_set_data_full (GTK_OBJECT (geometry_graphs_dialog), "geometry_graphs_scrolledwindow", geometry_graphs_scrolledwindow,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (geometry_graphs_scrolledwindow);
  gtk_box_pack_start (GTK_BOX (dialog_vbox75), geometry_graphs_scrolledwindow, TRUE, TRUE, 0);

  geometry_graphs_viewport = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (geometry_graphs_viewport);
  gtk_object_set_data_full (GTK_OBJECT (geometry_graphs_dialog), "geometry_graphs_viewport", geometry_graphs_viewport,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (geometry_graphs_viewport);
  gtk_container_add (GTK_CONTAINER (geometry_graphs_scrolledwindow), geometry_graphs_viewport);

  dialog_action_area74 = GTK_DIALOG (geometry_graphs_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (geometry_graphs_dialog), "dialog_action_area74", dialog_action_area74);
  gtk_widget_show (dialog_action_area74);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area74), 10);

  geometry_graphs_ok_button = gtk_button_new_with_label (_("   OK   "));
  gtk_widget_ref (geometry_graphs_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (geometry_graphs_dialog), "geometry_graphs_ok_button", geometry_graphs_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (geometry_graphs_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area74), geometry_graphs_ok_button, FALSE, FALSE, 0);
  GTK_WIDGET_SET_FLAGS (geometry_graphs_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (geometry_graphs_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_geometry_graphs_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (geometry_graphs_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_geometry_graphs_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (geometry_graphs_ok_button);
  gtk_widget_grab_default (geometry_graphs_ok_button);
  return geometry_graphs_dialog;
}

GtkWidget*
create_save_symmetry_coords_fileselection (void)
{
  GtkWidget *save_symmetry_coords_fileselection;
  GtkWidget *save_symmetry_coords_fileselection_ok_button;
  GtkWidget *save_symmetry_coords_fileselection_cancel_button;

  save_symmetry_coords_fileselection = gtk_file_selection_new (_("Select File"));
  gtk_object_set_data (GTK_OBJECT (save_symmetry_coords_fileselection), "save_symmetry_coords_fileselection", save_symmetry_coords_fileselection);
  gtk_container_set_border_width (GTK_CONTAINER (save_symmetry_coords_fileselection), 10);

  save_symmetry_coords_fileselection_ok_button = GTK_FILE_SELECTION (save_symmetry_coords_fileselection)->ok_button;
  gtk_object_set_data (GTK_OBJECT (save_symmetry_coords_fileselection), "save_symmetry_coords_fileselection_ok_button", save_symmetry_coords_fileselection_ok_button);
  gtk_widget_show (save_symmetry_coords_fileselection_ok_button);
  GTK_WIDGET_SET_FLAGS (save_symmetry_coords_fileselection_ok_button, GTK_CAN_DEFAULT);

  save_symmetry_coords_fileselection_cancel_button = GTK_FILE_SELECTION (save_symmetry_coords_fileselection)->cancel_button;
  gtk_object_set_data (GTK_OBJECT (save_symmetry_coords_fileselection), "save_symmetry_coords_fileselection_cancel_button", save_symmetry_coords_fileselection_cancel_button);
  gtk_widget_show (save_symmetry_coords_fileselection_cancel_button);
  GTK_WIDGET_SET_FLAGS (save_symmetry_coords_fileselection_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (save_symmetry_coords_fileselection), "destroy",
                      GTK_SIGNAL_FUNC (on_save_symmetry_coords_fileselection_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (save_symmetry_coords_fileselection_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_save_symmetry_coords_fileselection_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (save_symmetry_coords_fileselection_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_save_symmetry_coords_fileselection_cancel_button_clicked),
                      NULL);

  return save_symmetry_coords_fileselection;
}

GtkWidget*
create_stereo_dialog (void)
{
  GtkWidget *stereo_dialog;
  GtkWidget *dialog_vbox76;
  GtkWidget *frame133;
  GtkWidget *vbox137;
  GtkWidget *label222;
  GtkWidget *frame134;
  GtkWidget *vbox138;
  GSList *stereo_gr_group = NULL;
  GtkWidget *stereo_dialog_mono_radiobutton;
  GtkWidget *stereo_dialog_hardware_stereo_radiobutton;
  GtkWidget *stereo_dialog_side_by_side_stereo_crosseyed_radiobutton;
  GtkWidget *stereo_dialog_side_by_side_stereo_walleyed_radiobutton;
  GtkWidget *dialog_action_area75;
  GtkWidget *stereo_dialog_ok_button;

  stereo_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (stereo_dialog), "stereo_dialog", stereo_dialog);
  gtk_window_set_title (GTK_WINDOW (stereo_dialog), _("Stereo/Mono"));
  gtk_window_set_policy (GTK_WINDOW (stereo_dialog), TRUE, TRUE, FALSE);

  dialog_vbox76 = GTK_DIALOG (stereo_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (stereo_dialog), "dialog_vbox76", dialog_vbox76);
  gtk_widget_show (dialog_vbox76);

  frame133 = gtk_frame_new (NULL);
  gtk_widget_ref (frame133);
  gtk_object_set_data_full (GTK_OBJECT (stereo_dialog), "frame133", frame133,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame133);
  gtk_box_pack_start (GTK_BOX (dialog_vbox76), frame133, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame133), 6);

  vbox137 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox137);
  gtk_object_set_data_full (GTK_OBJECT (stereo_dialog), "vbox137", vbox137,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox137);
  gtk_container_add (GTK_CONTAINER (frame133), vbox137);

  label222 = gtk_label_new (_("\nView Mode"));
  gtk_widget_ref (label222);
  gtk_object_set_data_full (GTK_OBJECT (stereo_dialog), "label222", label222,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label222);
  gtk_box_pack_start (GTK_BOX (vbox137), label222, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label222), 0, 7);

  frame134 = gtk_frame_new (NULL);
  gtk_widget_ref (frame134);
  gtk_object_set_data_full (GTK_OBJECT (stereo_dialog), "frame134", frame134,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame134);
  gtk_box_pack_start (GTK_BOX (vbox137), frame134, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame134), 14);

  vbox138 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox138);
  gtk_object_set_data_full (GTK_OBJECT (stereo_dialog), "vbox138", vbox138,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox138);
  gtk_container_add (GTK_CONTAINER (frame134), vbox138);

  stereo_dialog_mono_radiobutton = gtk_radio_button_new_with_label (stereo_gr_group, _("Mono"));
  stereo_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (stereo_dialog_mono_radiobutton));
  gtk_widget_ref (stereo_dialog_mono_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (stereo_dialog), "stereo_dialog_mono_radiobutton", stereo_dialog_mono_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (stereo_dialog_mono_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox138), stereo_dialog_mono_radiobutton, FALSE, FALSE, 0);

  stereo_dialog_hardware_stereo_radiobutton = gtk_radio_button_new_with_label (stereo_gr_group, _("Hardware Stereo"));
  stereo_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (stereo_dialog_hardware_stereo_radiobutton));
  gtk_widget_ref (stereo_dialog_hardware_stereo_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (stereo_dialog), "stereo_dialog_hardware_stereo_radiobutton", stereo_dialog_hardware_stereo_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (stereo_dialog_hardware_stereo_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox138), stereo_dialog_hardware_stereo_radiobutton, FALSE, FALSE, 0);

  stereo_dialog_side_by_side_stereo_crosseyed_radiobutton = gtk_radio_button_new_with_label (stereo_gr_group, _("Side by Side Stereo"));
  stereo_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (stereo_dialog_side_by_side_stereo_crosseyed_radiobutton));
  gtk_widget_ref (stereo_dialog_side_by_side_stereo_crosseyed_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (stereo_dialog), "stereo_dialog_side_by_side_stereo_crosseyed_radiobutton", stereo_dialog_side_by_side_stereo_crosseyed_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (stereo_dialog_side_by_side_stereo_crosseyed_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox138), stereo_dialog_side_by_side_stereo_crosseyed_radiobutton, FALSE, FALSE, 0);

  stereo_dialog_side_by_side_stereo_walleyed_radiobutton = gtk_radio_button_new_with_label (stereo_gr_group, _("Side by Side (Wall Eyed)"));
  stereo_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (stereo_dialog_side_by_side_stereo_walleyed_radiobutton));
  gtk_widget_ref (stereo_dialog_side_by_side_stereo_walleyed_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (stereo_dialog), "stereo_dialog_side_by_side_stereo_walleyed_radiobutton", stereo_dialog_side_by_side_stereo_walleyed_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (stereo_dialog_side_by_side_stereo_walleyed_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox138), stereo_dialog_side_by_side_stereo_walleyed_radiobutton, FALSE, FALSE, 0);

  dialog_action_area75 = GTK_DIALOG (stereo_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (stereo_dialog), "dialog_action_area75", dialog_action_area75);
  gtk_widget_show (dialog_action_area75);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area75), 10);

  stereo_dialog_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (stereo_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (stereo_dialog), "stereo_dialog_ok_button", stereo_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (stereo_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area75), stereo_dialog_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (stereo_dialog_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (stereo_dialog_mono_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_stereo_dialog_mono_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (stereo_dialog_hardware_stereo_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_stereo_dialog_hardware_stereo_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (stereo_dialog_side_by_side_stereo_crosseyed_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_stereo_dialog_side_by_side_stereo_crosseyed_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (stereo_dialog_side_by_side_stereo_walleyed_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_stereo_dialog_side_by_side_stereo_walleyed_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (stereo_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_stereo_dialog_ok_button_clicked),
                      NULL);

  gtk_widget_grab_focus (stereo_dialog_ok_button);
  gtk_widget_grab_default (stereo_dialog_ok_button);
  return stereo_dialog;
}

GtkWidget*
create_preferences (void)
{
  GtkWidget *preferences;
  GtkWidget *dialog_vbox77;
  GtkWidget *hbox114;
  GtkWidget *frame137;
  GtkWidget *notebook3;
  GtkWidget *empty_notebook_page;
  GtkWidget *label223;
  GtkWidget *frame135;
  GtkWidget *vbox139;
  GtkWidget *label226;
  GtkWidget *frame136;
  GtkWidget *vbox140;
  GSList *preferences_geometry_cis_peptide_gr_group = NULL;
  GtkWidget *preferences_geometry_cis_peptide_bad_yes_radiobutton;
  GtkWidget *preferences_geometry_cis_peptide_bad_no_radiobutton;
  GtkWidget *label224;
  GtkWidget *label225;
  GtkWidget *dialog_action_area76;
  GtkWidget *hbox115;
  GtkWidget *preferences_ok_button;

  preferences = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (preferences), "preferences", preferences);
  gtk_window_set_title (GTK_WINDOW (preferences), _("Preferences"));
  gtk_window_set_policy (GTK_WINDOW (preferences), TRUE, TRUE, FALSE);

  dialog_vbox77 = GTK_DIALOG (preferences)->vbox;
  gtk_object_set_data (GTK_OBJECT (preferences), "dialog_vbox77", dialog_vbox77);
  gtk_widget_show (dialog_vbox77);

  hbox114 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox114);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "hbox114", hbox114,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox114);
  gtk_box_pack_start (GTK_BOX (dialog_vbox77), hbox114, TRUE, TRUE, 0);

  frame137 = gtk_frame_new (NULL);
  gtk_widget_ref (frame137);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "frame137", frame137,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame137);
  gtk_box_pack_start (GTK_BOX (hbox114), frame137, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame137), 3);

  notebook3 = gtk_notebook_new ();
  gtk_widget_ref (notebook3);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "notebook3", notebook3,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (notebook3);
  gtk_box_pack_start (GTK_BOX (hbox114), notebook3, TRUE, TRUE, 0);

  empty_notebook_page = gtk_vbox_new (FALSE, 0);
  gtk_widget_show (empty_notebook_page);
  gtk_container_add (GTK_CONTAINER (notebook3), empty_notebook_page);

  label223 = gtk_label_new (_("Bond Parameters"));
  gtk_widget_ref (label223);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "label223", label223,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label223);
  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook3), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook3), 0), label223);

  frame135 = gtk_frame_new (NULL);
  gtk_widget_ref (frame135);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "frame135", frame135,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame135);
  gtk_container_add (GTK_CONTAINER (notebook3), frame135);

  vbox139 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox139);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "vbox139", vbox139,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox139);
  gtk_container_add (GTK_CONTAINER (frame135), vbox139);

  label226 = gtk_label_new (_("Mark Cis-Peptides as Bad in Geometry Graph?"));
  gtk_widget_ref (label226);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "label226", label226,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label226);
  gtk_box_pack_start (GTK_BOX (vbox139), label226, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label226), 0, 9);

  frame136 = gtk_frame_new (NULL);
  gtk_widget_ref (frame136);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "frame136", frame136,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame136);
  gtk_box_pack_start (GTK_BOX (vbox139), frame136, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame136), 10);

  vbox140 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox140);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "vbox140", vbox140,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox140);
  gtk_container_add (GTK_CONTAINER (frame136), vbox140);

  preferences_geometry_cis_peptide_bad_yes_radiobutton = gtk_radio_button_new_with_label (preferences_geometry_cis_peptide_gr_group, _(" Yes"));
  preferences_geometry_cis_peptide_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (preferences_geometry_cis_peptide_bad_yes_radiobutton));
  gtk_widget_ref (preferences_geometry_cis_peptide_bad_yes_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "preferences_geometry_cis_peptide_bad_yes_radiobutton", preferences_geometry_cis_peptide_bad_yes_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (preferences_geometry_cis_peptide_bad_yes_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox140), preferences_geometry_cis_peptide_bad_yes_radiobutton, FALSE, FALSE, 0);

  preferences_geometry_cis_peptide_bad_no_radiobutton = gtk_radio_button_new_with_label (preferences_geometry_cis_peptide_gr_group, _(" No"));
  preferences_geometry_cis_peptide_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (preferences_geometry_cis_peptide_bad_no_radiobutton));
  gtk_widget_ref (preferences_geometry_cis_peptide_bad_no_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "preferences_geometry_cis_peptide_bad_no_radiobutton", preferences_geometry_cis_peptide_bad_no_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (preferences_geometry_cis_peptide_bad_no_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox140), preferences_geometry_cis_peptide_bad_no_radiobutton, FALSE, FALSE, 0);

  label224 = gtk_label_new (_("Geometry"));
  gtk_widget_ref (label224);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "label224", label224,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label224);
  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook3), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook3), 1), label224);

  empty_notebook_page = gtk_vbox_new (FALSE, 0);
  gtk_widget_show (empty_notebook_page);
  gtk_container_add (GTK_CONTAINER (notebook3), empty_notebook_page);

  label225 = gtk_label_new (_("Other"));
  gtk_widget_ref (label225);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "label225", label225,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label225);
  gtk_notebook_set_tab_label (GTK_NOTEBOOK (notebook3), gtk_notebook_get_nth_page (GTK_NOTEBOOK (notebook3), 2), label225);

  dialog_action_area76 = GTK_DIALOG (preferences)->action_area;
  gtk_object_set_data (GTK_OBJECT (preferences), "dialog_action_area76", dialog_action_area76);
  gtk_widget_show (dialog_action_area76);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area76), 10);

  hbox115 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox115);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "hbox115", hbox115,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox115);
  gtk_box_pack_start (GTK_BOX (dialog_action_area76), hbox115, TRUE, TRUE, 0);

  preferences_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (preferences_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (preferences), "preferences_ok_button", preferences_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (preferences_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox115), preferences_ok_button, TRUE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (preferences), "destroy",
                      GTK_SIGNAL_FUNC (on_preferences_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (preferences_geometry_cis_peptide_bad_yes_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_preferences_geometry_cis_peptide_bad_yes_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (preferences_geometry_cis_peptide_bad_no_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_preferences_geometry_cis_peptide_bad_no_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (preferences_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_preferences_ok_button_clicked),
                      NULL);

  return preferences;
}

GtkWidget*
create_diff_map_peaks_dialog (void)
{
  GtkWidget *diff_map_peaks_dialog;
  GtkWidget *dialog_vbox78;
  GtkWidget *scrolledwindow18;
  GtkWidget *viewport11;
  GtkWidget *diff_map_peaks_vbox;
  GtkWidget *dialog_action_area77;
  GtkWidget *diff_map_peaks_dialog_ok_button;

  diff_map_peaks_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (diff_map_peaks_dialog), "diff_map_peaks_dialog", diff_map_peaks_dialog);
  gtk_window_set_title (GTK_WINDOW (diff_map_peaks_dialog), _("Difference Map Peaks"));
  gtk_window_set_policy (GTK_WINDOW (diff_map_peaks_dialog), TRUE, TRUE, FALSE);

  dialog_vbox78 = GTK_DIALOG (diff_map_peaks_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (diff_map_peaks_dialog), "dialog_vbox78", dialog_vbox78);
  gtk_widget_show (dialog_vbox78);

  scrolledwindow18 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow18);
  gtk_object_set_data_full (GTK_OBJECT (diff_map_peaks_dialog), "scrolledwindow18", scrolledwindow18,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow18);
  gtk_box_pack_start (GTK_BOX (dialog_vbox78), scrolledwindow18, TRUE, TRUE, 0);
  gtk_widget_set_usize (scrolledwindow18, 310, 280);

  viewport11 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport11);
  gtk_object_set_data_full (GTK_OBJECT (diff_map_peaks_dialog), "viewport11", viewport11,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport11);
  gtk_container_add (GTK_CONTAINER (scrolledwindow18), viewport11);

  diff_map_peaks_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (diff_map_peaks_vbox);
  gtk_object_set_data_full (GTK_OBJECT (diff_map_peaks_dialog), "diff_map_peaks_vbox", diff_map_peaks_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (diff_map_peaks_vbox);
  gtk_container_add (GTK_CONTAINER (viewport11), diff_map_peaks_vbox);
  gtk_container_set_border_width (GTK_CONTAINER (diff_map_peaks_vbox), 2);

  dialog_action_area77 = GTK_DIALOG (diff_map_peaks_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (diff_map_peaks_dialog), "dialog_action_area77", dialog_action_area77);
  gtk_widget_show (dialog_action_area77);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area77), 10);

  diff_map_peaks_dialog_ok_button = gtk_button_new_with_label (_("   OK   "));
  gtk_widget_ref (diff_map_peaks_dialog_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (diff_map_peaks_dialog), "diff_map_peaks_dialog_ok_button", diff_map_peaks_dialog_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (diff_map_peaks_dialog_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area77), diff_map_peaks_dialog_ok_button, TRUE, TRUE, 2);

  gtk_signal_connect (GTK_OBJECT (diff_map_peaks_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_diff_map_peaks_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (diff_map_peaks_dialog_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_diff_map_peaks_dialog_ok_button_clicked),
                      NULL);

  return diff_map_peaks_dialog;
}

GtkWidget*
create_generate_diff_map_peaks_dialog (void)
{
  GtkWidget *generate_diff_map_peaks_dialog;
  GtkWidget *dialog_vbox79;
  GtkWidget *frame138;
  GtkWidget *vbox141;
  GtkWidget *frame139;
  GtkWidget *generate_diff_map_peaks_map_vbox;
  GtkWidget *no_difference_maps_frame;
  GtkWidget *label227;
  GtkWidget *frame140;
  GtkWidget *generate_diff_map_peaks_model_vbox;
  GtkWidget *no_models_frame;
  GtkWidget *label228;
  GtkWidget *frame141;
  GtkWidget *hbox117;
  GtkWidget *label229;
  GtkWidget *generate_diff_map_peaks_sigma_level_entry;
  GtkWidget *label230;
  GtkWidget *negative_level_frame;
  GtkWidget *vbox165;
  GtkWidget *generate_diff_map_peaks_positive_level_checkbutton;
  GtkWidget *generate_diff_map_peaks_negative_level_checkbutton;
  GtkWidget *dialog_action_area78;
  GtkWidget *hbox116;
  GtkWidget *generate_diff_map_peaks_ok_button;
  GtkWidget *generate_diff_map_peaks_cancel_button;

  generate_diff_map_peaks_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (generate_diff_map_peaks_dialog), "generate_diff_map_peaks_dialog", generate_diff_map_peaks_dialog);
  gtk_window_set_title (GTK_WINDOW (generate_diff_map_peaks_dialog), _("Difference Map Peak Analysis"));
  gtk_window_set_policy (GTK_WINDOW (generate_diff_map_peaks_dialog), TRUE, TRUE, FALSE);

  dialog_vbox79 = GTK_DIALOG (generate_diff_map_peaks_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (generate_diff_map_peaks_dialog), "dialog_vbox79", dialog_vbox79);
  gtk_widget_show (dialog_vbox79);

  frame138 = gtk_frame_new (NULL);
  gtk_widget_ref (frame138);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "frame138", frame138,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame138);
  gtk_box_pack_start (GTK_BOX (dialog_vbox79), frame138, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame138), 6);

  vbox141 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox141);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "vbox141", vbox141,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox141);
  gtk_container_add (GTK_CONTAINER (frame138), vbox141);

  frame139 = gtk_frame_new (_("Select Difference Map"));
  gtk_widget_ref (frame139);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "frame139", frame139,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame139);
  gtk_box_pack_start (GTK_BOX (vbox141), frame139, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame139), 6);

  generate_diff_map_peaks_map_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (generate_diff_map_peaks_map_vbox);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "generate_diff_map_peaks_map_vbox", generate_diff_map_peaks_map_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (generate_diff_map_peaks_map_vbox);
  gtk_container_add (GTK_CONTAINER (frame139), generate_diff_map_peaks_map_vbox);

  no_difference_maps_frame = gtk_frame_new (NULL);
  gtk_widget_ref (no_difference_maps_frame);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "no_difference_maps_frame", no_difference_maps_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (generate_diff_map_peaks_map_vbox), no_difference_maps_frame, TRUE, TRUE, 0);

  label227 = gtk_label_new (_("WARNING:: No Difference Maps Available!"));
  gtk_widget_ref (label227);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "label227", label227,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label227);
  gtk_container_add (GTK_CONTAINER (no_difference_maps_frame), label227);
  gtk_misc_set_padding (GTK_MISC (label227), 10, 0);

  frame140 = gtk_frame_new (_("Select Model"));
  gtk_widget_ref (frame140);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "frame140", frame140,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame140);
  gtk_box_pack_start (GTK_BOX (vbox141), frame140, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame140), 6);

  generate_diff_map_peaks_model_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (generate_diff_map_peaks_model_vbox);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "generate_diff_map_peaks_model_vbox", generate_diff_map_peaks_model_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (generate_diff_map_peaks_model_vbox);
  gtk_container_add (GTK_CONTAINER (frame140), generate_diff_map_peaks_model_vbox);

  no_models_frame = gtk_frame_new (NULL);
  gtk_widget_ref (no_models_frame);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "no_models_frame", no_models_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (generate_diff_map_peaks_model_vbox), no_models_frame, TRUE, TRUE, 0);

  label228 = gtk_label_new (_("WARNING:: No Models Available"));
  gtk_widget_ref (label228);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "label228", label228,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label228);
  gtk_container_add (GTK_CONTAINER (no_models_frame), label228);
  gtk_misc_set_padding (GTK_MISC (label228), 10, 0);

  frame141 = gtk_frame_new (_("Sigma Level"));
  gtk_widget_ref (frame141);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "frame141", frame141,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame141);
  gtk_box_pack_start (GTK_BOX (vbox141), frame141, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame141), 6);

  hbox117 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox117);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "hbox117", hbox117,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox117);
  gtk_container_add (GTK_CONTAINER (frame141), hbox117);

  label229 = gtk_label_new (_("  Find Peaks above "));
  gtk_widget_ref (label229);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "label229", label229,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label229);
  gtk_box_pack_start (GTK_BOX (hbox117), label229, FALSE, FALSE, 0);

  generate_diff_map_peaks_sigma_level_entry = gtk_entry_new ();
  gtk_widget_ref (generate_diff_map_peaks_sigma_level_entry);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "generate_diff_map_peaks_sigma_level_entry", generate_diff_map_peaks_sigma_level_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (generate_diff_map_peaks_sigma_level_entry);
  gtk_box_pack_start (GTK_BOX (hbox117), generate_diff_map_peaks_sigma_level_entry, FALSE, FALSE, 0);
  gtk_widget_set_usize (generate_diff_map_peaks_sigma_level_entry, 75, -2);

  label230 = gtk_label_new (_("  sigma  "));
  gtk_widget_ref (label230);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "label230", label230,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label230);
  gtk_box_pack_start (GTK_BOX (hbox117), label230, FALSE, FALSE, 0);

  negative_level_frame = gtk_frame_new (_("Which Peaks?"));
  gtk_widget_ref (negative_level_frame);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "negative_level_frame", negative_level_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (negative_level_frame);
  gtk_box_pack_start (GTK_BOX (vbox141), negative_level_frame, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (negative_level_frame), 6);

  vbox165 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox165);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "vbox165", vbox165,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox165);
  gtk_container_add (GTK_CONTAINER (negative_level_frame), vbox165);

  generate_diff_map_peaks_positive_level_checkbutton = gtk_check_button_new_with_label (_("Find Positive Peaks?"));
  gtk_widget_ref (generate_diff_map_peaks_positive_level_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "generate_diff_map_peaks_positive_level_checkbutton", generate_diff_map_peaks_positive_level_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (generate_diff_map_peaks_positive_level_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox165), generate_diff_map_peaks_positive_level_checkbutton, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (generate_diff_map_peaks_positive_level_checkbutton), TRUE);

  generate_diff_map_peaks_negative_level_checkbutton = gtk_check_button_new_with_label (_("Find Negative Peaks Also?"));
  gtk_widget_ref (generate_diff_map_peaks_negative_level_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "generate_diff_map_peaks_negative_level_checkbutton", generate_diff_map_peaks_negative_level_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (generate_diff_map_peaks_negative_level_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox165), generate_diff_map_peaks_negative_level_checkbutton, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (generate_diff_map_peaks_negative_level_checkbutton), TRUE);

  dialog_action_area78 = GTK_DIALOG (generate_diff_map_peaks_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (generate_diff_map_peaks_dialog), "dialog_action_area78", dialog_action_area78);
  gtk_widget_show (dialog_action_area78);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area78), 10);

  hbox116 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox116);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "hbox116", hbox116,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox116);
  gtk_box_pack_start (GTK_BOX (dialog_action_area78), hbox116, TRUE, TRUE, 0);

  generate_diff_map_peaks_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (generate_diff_map_peaks_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "generate_diff_map_peaks_ok_button", generate_diff_map_peaks_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (generate_diff_map_peaks_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox116), generate_diff_map_peaks_ok_button, TRUE, TRUE, 6);
  GTK_WIDGET_SET_FLAGS (generate_diff_map_peaks_ok_button, GTK_CAN_DEFAULT);

  generate_diff_map_peaks_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (generate_diff_map_peaks_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (generate_diff_map_peaks_dialog), "generate_diff_map_peaks_cancel_button", generate_diff_map_peaks_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (generate_diff_map_peaks_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox116), generate_diff_map_peaks_cancel_button, TRUE, TRUE, 6);
  GTK_WIDGET_SET_FLAGS (generate_diff_map_peaks_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (generate_diff_map_peaks_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_generate_diff_map_peaks_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (generate_diff_map_peaks_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_generate_diff_map_peaks_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_focus (generate_diff_map_peaks_ok_button);
  gtk_widget_grab_default (generate_diff_map_peaks_ok_button);
  return generate_diff_map_peaks_dialog;
}

GtkWidget*
create_ncs_maps_dialog (void)
{
  GtkWidget *ncs_maps_dialog;
  GtkWidget *dialog_vbox80;
  GtkWidget *frame143;
  GtkWidget *vbox147;
  GtkWidget *frame146;
  GtkWidget *vbox149;
  GtkWidget *no_models_frame;
  GtkWidget *label232;
  GtkWidget *ncs_maps_models_vbox;
  GtkWidget *frame144;
  GtkWidget *vbox148;
  GtkWidget *no_maps_frame;
  GtkWidget *label231;
  GtkWidget *ncs_maps_maps_vbox;
  GtkWidget *dialog_action_area79;
  GtkWidget *hbox118;
  GtkWidget *ncs_maps_ok_button;
  GtkWidget *ncs_maps_cancel_button;

  ncs_maps_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (ncs_maps_dialog), "ncs_maps_dialog", ncs_maps_dialog);
  gtk_window_set_title (GTK_WINDOW (ncs_maps_dialog), _("dialog1"));
  gtk_window_set_policy (GTK_WINDOW (ncs_maps_dialog), TRUE, TRUE, FALSE);

  dialog_vbox80 = GTK_DIALOG (ncs_maps_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (ncs_maps_dialog), "dialog_vbox80", dialog_vbox80);
  gtk_widget_show (dialog_vbox80);

  frame143 = gtk_frame_new (NULL);
  gtk_widget_ref (frame143);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "frame143", frame143,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame143);
  gtk_box_pack_start (GTK_BOX (dialog_vbox80), frame143, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame143), 6);

  vbox147 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox147);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "vbox147", vbox147,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox147);
  gtk_container_add (GTK_CONTAINER (frame143), vbox147);

  frame146 = gtk_frame_new (_("Select Model"));
  gtk_widget_ref (frame146);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "frame146", frame146,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame146);
  gtk_box_pack_start (GTK_BOX (vbox147), frame146, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame146), 6);

  vbox149 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox149);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "vbox149", vbox149,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox149);
  gtk_container_add (GTK_CONTAINER (frame146), vbox149);

  no_models_frame = gtk_frame_new (NULL);
  gtk_widget_ref (no_models_frame);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "no_models_frame", no_models_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (vbox149), no_models_frame, TRUE, TRUE, 0);

  label232 = gtk_label_new (_("WARNING:: No Models with NCS Available"));
  gtk_widget_ref (label232);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "label232", label232,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label232);
  gtk_container_add (GTK_CONTAINER (no_models_frame), label232);
  gtk_misc_set_padding (GTK_MISC (label232), 10, 0);

  ncs_maps_models_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (ncs_maps_models_vbox);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "ncs_maps_models_vbox", ncs_maps_models_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ncs_maps_models_vbox);
  gtk_box_pack_start (GTK_BOX (vbox149), ncs_maps_models_vbox, TRUE, TRUE, 0);

  frame144 = gtk_frame_new (_("Select Map"));
  gtk_widget_ref (frame144);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "frame144", frame144,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame144);
  gtk_box_pack_start (GTK_BOX (vbox147), frame144, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame144), 6);

  vbox148 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox148);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "vbox148", vbox148,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox148);
  gtk_container_add (GTK_CONTAINER (frame144), vbox148);

  no_maps_frame = gtk_frame_new (NULL);
  gtk_widget_ref (no_maps_frame);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "no_maps_frame", no_maps_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (vbox148), no_maps_frame, TRUE, TRUE, 0);

  label231 = gtk_label_new (_("WARNING:: No Maps Available!"));
  gtk_widget_ref (label231);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "label231", label231,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label231);
  gtk_container_add (GTK_CONTAINER (no_maps_frame), label231);
  gtk_misc_set_padding (GTK_MISC (label231), 10, 0);

  ncs_maps_maps_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (ncs_maps_maps_vbox);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "ncs_maps_maps_vbox", ncs_maps_maps_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ncs_maps_maps_vbox);
  gtk_box_pack_start (GTK_BOX (vbox148), ncs_maps_maps_vbox, TRUE, TRUE, 0);

  dialog_action_area79 = GTK_DIALOG (ncs_maps_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (ncs_maps_dialog), "dialog_action_area79", dialog_action_area79);
  gtk_widget_show (dialog_action_area79);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area79), 10);

  hbox118 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox118);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "hbox118", hbox118,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox118);
  gtk_box_pack_start (GTK_BOX (dialog_action_area79), hbox118, TRUE, TRUE, 0);

  ncs_maps_ok_button = gtk_button_new_with_label (_("   OK   "));
  gtk_widget_ref (ncs_maps_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "ncs_maps_ok_button", ncs_maps_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ncs_maps_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox118), ncs_maps_ok_button, TRUE, TRUE, 6);

  ncs_maps_cancel_button = gtk_button_new_with_label (_("   Cancel   "));
  gtk_widget_ref (ncs_maps_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (ncs_maps_dialog), "ncs_maps_cancel_button", ncs_maps_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ncs_maps_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox118), ncs_maps_cancel_button, TRUE, TRUE, 6);

  gtk_signal_connect (GTK_OBJECT (ncs_maps_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_ncs_maps_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ncs_maps_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_ncs_maps_cancel_button_clicked),
                      NULL);

  return ncs_maps_dialog;
}

GtkWidget*
create_popup_info_window (void)
{
  GtkWidget *popup_info_window;
  GtkWidget *frame147;
  GtkWidget *info_label;

  popup_info_window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
  gtk_object_set_data (GTK_OBJECT (popup_info_window), "popup_info_window", popup_info_window);
  gtk_window_set_title (GTK_WINDOW (popup_info_window), _("window2"));

  frame147 = gtk_frame_new (NULL);
  gtk_widget_ref (frame147);
  gtk_object_set_data_full (GTK_OBJECT (popup_info_window), "frame147", frame147,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame147);
  gtk_container_add (GTK_CONTAINER (popup_info_window), frame147);
  gtk_container_set_border_width (GTK_CONTAINER (frame147), 10);

  info_label = gtk_label_new (_("Sample text."));
  gtk_widget_ref (info_label);
  gtk_object_set_data_full (GTK_OBJECT (popup_info_window), "info_label", info_label,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (info_label);
  gtk_container_add (GTK_CONTAINER (frame147), info_label);
  gtk_misc_set_padding (GTK_MISC (info_label), 10, 10);

  return popup_info_window;
}

GtkWidget*
create_pointer_distances_dialog (void)
{
  GtkWidget *pointer_distances_dialog;
  GtkWidget *dialog_vbox81;
  GtkWidget *frame148;
  GtkWidget *vbox150;
  GtkWidget *pointer_distances_checkbutton;
  GtkWidget *pointer_distances_frame;
  GtkWidget *table2;
  GtkWidget *label233;
  GtkWidget *label234;
  GtkWidget *label235;
  GtkWidget *label236;
  GtkWidget *pointer_distances_min_dist_entry;
  GtkWidget *pointer_distances_max_dist_entry;
  GtkWidget *dialog_action_area80;
  GtkWidget *pointer_distances_ok_button;

  pointer_distances_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (pointer_distances_dialog), "pointer_distances_dialog", pointer_distances_dialog);
  gtk_window_set_title (GTK_WINDOW (pointer_distances_dialog), _("Pointer Distances"));
  gtk_window_set_policy (GTK_WINDOW (pointer_distances_dialog), TRUE, TRUE, FALSE);

  dialog_vbox81 = GTK_DIALOG (pointer_distances_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (pointer_distances_dialog), "dialog_vbox81", dialog_vbox81);
  gtk_widget_show (dialog_vbox81);

  frame148 = gtk_frame_new (NULL);
  gtk_widget_ref (frame148);
  gtk_object_set_data_full (GTK_OBJECT (pointer_distances_dialog), "frame148", frame148,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame148);
  gtk_box_pack_start (GTK_BOX (dialog_vbox81), frame148, TRUE, TRUE, 0);
  gtk_widget_set_usize (frame148, 225, -2);
  gtk_container_set_border_width (GTK_CONTAINER (frame148), 6);

  vbox150 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox150);
  gtk_object_set_data_full (GTK_OBJECT (pointer_distances_dialog), "vbox150", vbox150,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox150);
  gtk_container_add (GTK_CONTAINER (frame148), vbox150);

  pointer_distances_checkbutton = gtk_check_button_new_with_label (_(" Show Pointer Distances"));
  gtk_widget_ref (pointer_distances_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (pointer_distances_dialog), "pointer_distances_checkbutton", pointer_distances_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_distances_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox150), pointer_distances_checkbutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (pointer_distances_checkbutton), 6);

  pointer_distances_frame = gtk_frame_new (NULL);
  gtk_widget_ref (pointer_distances_frame);
  gtk_object_set_data_full (GTK_OBJECT (pointer_distances_dialog), "pointer_distances_frame", pointer_distances_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_distances_frame);
  gtk_box_pack_start (GTK_BOX (vbox150), pointer_distances_frame, TRUE, TRUE, 0);
  gtk_widget_set_usize (pointer_distances_frame, 36, -2);
  gtk_container_set_border_width (GTK_CONTAINER (pointer_distances_frame), 2);

  table2 = gtk_table_new (2, 3, FALSE);
  gtk_widget_ref (table2);
  gtk_object_set_data_full (GTK_OBJECT (pointer_distances_dialog), "table2", table2,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (table2);
  gtk_container_add (GTK_CONTAINER (pointer_distances_frame), table2);

  label233 = gtk_label_new (_("  Min Distance  "));
  gtk_widget_ref (label233);
  gtk_object_set_data_full (GTK_OBJECT (pointer_distances_dialog), "label233", label233,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label233);
  gtk_table_attach (GTK_TABLE (table2), label233, 0, 1, 0, 1,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_misc_set_alignment (GTK_MISC (label233), 0, 0.5);

  label234 = gtk_label_new (_("  Max Distance"));
  gtk_widget_ref (label234);
  gtk_object_set_data_full (GTK_OBJECT (pointer_distances_dialog), "label234", label234,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label234);
  gtk_table_attach (GTK_TABLE (table2), label234, 0, 1, 1, 2,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_misc_set_alignment (GTK_MISC (label234), 0, 0.5);

  label235 = gtk_label_new (_(" Angstroms "));
  gtk_widget_ref (label235);
  gtk_object_set_data_full (GTK_OBJECT (pointer_distances_dialog), "label235", label235,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label235);
  gtk_table_attach (GTK_TABLE (table2), label235, 2, 3, 0, 1,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_misc_set_alignment (GTK_MISC (label235), 0, 0.5);

  label236 = gtk_label_new (_(" Angstroms "));
  gtk_widget_ref (label236);
  gtk_object_set_data_full (GTK_OBJECT (pointer_distances_dialog), "label236", label236,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label236);
  gtk_table_attach (GTK_TABLE (table2), label236, 2, 3, 1, 2,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_misc_set_alignment (GTK_MISC (label236), 0, 0.5);

  pointer_distances_min_dist_entry = gtk_entry_new ();
  gtk_widget_ref (pointer_distances_min_dist_entry);
  gtk_object_set_data_full (GTK_OBJECT (pointer_distances_dialog), "pointer_distances_min_dist_entry", pointer_distances_min_dist_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_distances_min_dist_entry);
  gtk_table_attach (GTK_TABLE (table2), pointer_distances_min_dist_entry, 1, 2, 0, 1,
                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_widget_set_usize (pointer_distances_min_dist_entry, 36, -2);

  pointer_distances_max_dist_entry = gtk_entry_new ();
  gtk_widget_ref (pointer_distances_max_dist_entry);
  gtk_object_set_data_full (GTK_OBJECT (pointer_distances_dialog), "pointer_distances_max_dist_entry", pointer_distances_max_dist_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_distances_max_dist_entry);
  gtk_table_attach (GTK_TABLE (table2), pointer_distances_max_dist_entry, 1, 2, 1, 2,
                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_widget_set_usize (pointer_distances_max_dist_entry, 36, -2);

  dialog_action_area80 = GTK_DIALOG (pointer_distances_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (pointer_distances_dialog), "dialog_action_area80", dialog_action_area80);
  gtk_widget_show (dialog_action_area80);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area80), 10);

  pointer_distances_ok_button = gtk_button_new_with_label (_("   OK   "));
  gtk_widget_ref (pointer_distances_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (pointer_distances_dialog), "pointer_distances_ok_button", pointer_distances_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (pointer_distances_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area80), pointer_distances_ok_button, TRUE, FALSE, 6);

  gtk_signal_connect (GTK_OBJECT (pointer_distances_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_pointer_distances_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (pointer_distances_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_pointer_distances_ok_button_clicked),
                      NULL);

  return pointer_distances_dialog;
}

GtkWidget*
create_align_and_mutate_dialog (void)
{
  GtkWidget *align_and_mutate_dialog;
  GtkWidget *dialog_vbox82;
  GtkWidget *frame149;
  GtkWidget *vbox151;
  GtkWidget *label239;
  GtkWidget *align_and_mutate_molecule_optionmenu;
  GtkWidget *align_and_mutate_molecule_optionmenu_menu;
  GtkWidget *hbox121;
  GtkWidget *label240;
  GtkWidget *align_and_mutate_chain_optionmenu;
  GtkWidget *align_and_mutate_chain_optionmenu_menu;
  GtkWidget *label241;
  GtkWidget *scrolledwindow19;
  GtkWidget *align_and_mutate_sequence_text;
  GtkWidget *align_and_mutate_autofit_checkbutton;
  GtkWidget *dialog_action_area81;
  GtkWidget *hbox120;
  GtkWidget *align_and_mutate_ok_button;
  GtkWidget *align_and_mutate_cancel_button;

  align_and_mutate_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (align_and_mutate_dialog), "align_and_mutate_dialog", align_and_mutate_dialog);
  gtk_window_set_title (GTK_WINDOW (align_and_mutate_dialog), _("Align and Mutate"));
  gtk_window_set_policy (GTK_WINDOW (align_and_mutate_dialog), TRUE, TRUE, FALSE);

  dialog_vbox82 = GTK_DIALOG (align_and_mutate_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (align_and_mutate_dialog), "dialog_vbox82", dialog_vbox82);
  gtk_widget_show (dialog_vbox82);

  frame149 = gtk_frame_new (NULL);
  gtk_widget_ref (frame149);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "frame149", frame149,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame149);
  gtk_box_pack_start (GTK_BOX (dialog_vbox82), frame149, TRUE, TRUE, 0);
  gtk_widget_set_usize (frame149, 335, -2);
  gtk_container_set_border_width (GTK_CONTAINER (frame149), 6);

  vbox151 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox151);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "vbox151", vbox151,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox151);
  gtk_container_add (GTK_CONTAINER (frame149), vbox151);

  label239 = gtk_label_new (_("\n   Align and Mutate Molecule:\n"));
  gtk_widget_ref (label239);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "label239", label239,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label239);
  gtk_box_pack_start (GTK_BOX (vbox151), label239, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label239), 0, 0.5);

  align_and_mutate_molecule_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (align_and_mutate_molecule_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "align_and_mutate_molecule_optionmenu", align_and_mutate_molecule_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (align_and_mutate_molecule_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox151), align_and_mutate_molecule_optionmenu, FALSE, FALSE, 0);
  align_and_mutate_molecule_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (align_and_mutate_molecule_optionmenu), align_and_mutate_molecule_optionmenu_menu);

  hbox121 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox121);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "hbox121", hbox121,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox121);
  gtk_box_pack_start (GTK_BOX (vbox151), hbox121, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (hbox121), 2);

  label240 = gtk_label_new (_("   Chain ID: "));
  gtk_widget_ref (label240);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "label240", label240,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label240);
  gtk_box_pack_start (GTK_BOX (hbox121), label240, FALSE, FALSE, 0);

  align_and_mutate_chain_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (align_and_mutate_chain_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "align_and_mutate_chain_optionmenu", align_and_mutate_chain_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (align_and_mutate_chain_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox121), align_and_mutate_chain_optionmenu, FALSE, FALSE, 0);
  align_and_mutate_chain_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (align_and_mutate_chain_optionmenu), align_and_mutate_chain_optionmenu_menu);

  label241 = gtk_label_new (_("\n     to (single letter) sequence:\n"));
  gtk_widget_ref (label241);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "label241", label241,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label241);
  gtk_box_pack_start (GTK_BOX (vbox151), label241, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label241), 0, 0.5);

  scrolledwindow19 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow19);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "scrolledwindow19", scrolledwindow19,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow19);
  gtk_box_pack_start (GTK_BOX (vbox151), scrolledwindow19, TRUE, TRUE, 0);
  gtk_widget_set_usize (scrolledwindow19, -2, 90);

  align_and_mutate_sequence_text = gtk_text_new (NULL, NULL);
  gtk_widget_ref (align_and_mutate_sequence_text);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "align_and_mutate_sequence_text", align_and_mutate_sequence_text,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (align_and_mutate_sequence_text);
  gtk_container_add (GTK_CONTAINER (scrolledwindow19), align_and_mutate_sequence_text);
  gtk_text_set_editable (GTK_TEXT (align_and_mutate_sequence_text), TRUE);

  align_and_mutate_autofit_checkbutton = gtk_check_button_new_with_label (_(" Autofit the mutated residues?"));
  gtk_widget_ref (align_and_mutate_autofit_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "align_and_mutate_autofit_checkbutton", align_and_mutate_autofit_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (align_and_mutate_autofit_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox151), align_and_mutate_autofit_checkbutton, FALSE, FALSE, 0);

  dialog_action_area81 = GTK_DIALOG (align_and_mutate_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (align_and_mutate_dialog), "dialog_action_area81", dialog_action_area81);
  gtk_widget_show (dialog_action_area81);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area81), 10);

  hbox120 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox120);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "hbox120", hbox120,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox120);
  gtk_box_pack_start (GTK_BOX (dialog_action_area81), hbox120, TRUE, TRUE, 0);

  align_and_mutate_ok_button = gtk_button_new_with_label (_("  Apply Sequence to Model  "));
  gtk_widget_ref (align_and_mutate_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "align_and_mutate_ok_button", align_and_mutate_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (align_and_mutate_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox120), align_and_mutate_ok_button, FALSE, FALSE, 6);

  align_and_mutate_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (align_and_mutate_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (align_and_mutate_dialog), "align_and_mutate_cancel_button", align_and_mutate_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (align_and_mutate_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox120), align_and_mutate_cancel_button, FALSE, FALSE, 10);

  gtk_signal_connect (GTK_OBJECT (align_and_mutate_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_align_and_mutate_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (align_and_mutate_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_align_and_mutate_cancel_button_clicked),
                      NULL);

  return align_and_mutate_dialog;
}

GtkWidget*
create_ramachandran_plot_differences_dialog (void)
{
  GtkWidget *ramachandran_plot_differences_dialog;
  GtkWidget *dialog_vbox83;
  GtkWidget *vbox152;
  GtkWidget *label242;
  GtkWidget *frame150;
  GtkWidget *vbox153;
  GtkWidget *ramachandran_plot_differences_first_mol_optionmenu;
  GtkWidget *ramachandran_plot_differences_first_mol_optionmenu_menu;
  GtkWidget *frame151;
  GtkWidget *vbox154;
  GtkWidget *ramachandran_plot_differences_first_chain_checkbutton;
  GtkWidget *ramachandran_plot_differences_first_chain_optionmenu;
  GtkWidget *ramachandran_plot_differences_first_chain_optionmenu_menu;
  GtkWidget *label243;
  GtkWidget *frame152;
  GtkWidget *vbox155;
  GtkWidget *ramachandran_plot_differences_second_mol_optionmenu;
  GtkWidget *ramachandran_plot_differences_second_mol_optionmenu_menu;
  GtkWidget *frame153;
  GtkWidget *vbox156;
  GtkWidget *ramachandran_plot_differences_second_chain_checkbutton;
  GtkWidget *ramachandran_plot_differences_second_chain_optionmenu;
  GtkWidget *ramachandran_plot_differences_second_chain_optionmenu_menu;
  GtkWidget *dialog_action_area82;
  GtkWidget *hbox122;
  GtkWidget *ramachandran_plot_differences_ok_button;
  GtkWidget *ramachandran_plot_differences_cancel_button;

  ramachandran_plot_differences_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (ramachandran_plot_differences_dialog), "ramachandran_plot_differences_dialog", ramachandran_plot_differences_dialog);
  gtk_window_set_title (GTK_WINDOW (ramachandran_plot_differences_dialog), _("Ramachandran Plot Differences"));
  gtk_window_set_policy (GTK_WINDOW (ramachandran_plot_differences_dialog), TRUE, TRUE, FALSE);

  dialog_vbox83 = GTK_DIALOG (ramachandran_plot_differences_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (ramachandran_plot_differences_dialog), "dialog_vbox83", dialog_vbox83);
  gtk_widget_show (dialog_vbox83);

  vbox152 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox152);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "vbox152", vbox152,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox152);
  gtk_box_pack_start (GTK_BOX (dialog_vbox83), vbox152, TRUE, TRUE, 0);

  label242 = gtk_label_new (_("Ramachandran Plot Differences"));
  gtk_widget_ref (label242);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "label242", label242,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label242);
  gtk_box_pack_start (GTK_BOX (vbox152), label242, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label242), 0, 11);

  frame150 = gtk_frame_new (_("First Structure"));
  gtk_widget_ref (frame150);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "frame150", frame150,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame150);
  gtk_box_pack_start (GTK_BOX (vbox152), frame150, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame150), 4);

  vbox153 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox153);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "vbox153", vbox153,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox153);
  gtk_container_add (GTK_CONTAINER (frame150), vbox153);

  ramachandran_plot_differences_first_mol_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (ramachandran_plot_differences_first_mol_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "ramachandran_plot_differences_first_mol_optionmenu", ramachandran_plot_differences_first_mol_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ramachandran_plot_differences_first_mol_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox153), ramachandran_plot_differences_first_mol_optionmenu, FALSE, FALSE, 0);
  ramachandran_plot_differences_first_mol_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (ramachandran_plot_differences_first_mol_optionmenu), ramachandran_plot_differences_first_mol_optionmenu_menu);

  frame151 = gtk_frame_new (NULL);
  gtk_widget_ref (frame151);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "frame151", frame151,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame151);
  gtk_box_pack_start (GTK_BOX (vbox153), frame151, TRUE, TRUE, 0);

  vbox154 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox154);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "vbox154", vbox154,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox154);
  gtk_container_add (GTK_CONTAINER (frame151), vbox154);

  ramachandran_plot_differences_first_chain_checkbutton = gtk_check_button_new_with_label (_("Use Specific Chain"));
  gtk_widget_ref (ramachandran_plot_differences_first_chain_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "ramachandran_plot_differences_first_chain_checkbutton", ramachandran_plot_differences_first_chain_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ramachandran_plot_differences_first_chain_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox154), ramachandran_plot_differences_first_chain_checkbutton, FALSE, FALSE, 0);

  ramachandran_plot_differences_first_chain_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (ramachandran_plot_differences_first_chain_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "ramachandran_plot_differences_first_chain_optionmenu", ramachandran_plot_differences_first_chain_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ramachandran_plot_differences_first_chain_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox154), ramachandran_plot_differences_first_chain_optionmenu, FALSE, FALSE, 0);
  ramachandran_plot_differences_first_chain_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (ramachandran_plot_differences_first_chain_optionmenu), ramachandran_plot_differences_first_chain_optionmenu_menu);

  label243 = gtk_label_new ("");
  gtk_widget_ref (label243);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "label243", label243,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label243);
  gtk_box_pack_start (GTK_BOX (vbox152), label243, FALSE, FALSE, 0);

  frame152 = gtk_frame_new (_("Second Structure"));
  gtk_widget_ref (frame152);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "frame152", frame152,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame152);
  gtk_box_pack_start (GTK_BOX (vbox152), frame152, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame152), 4);

  vbox155 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox155);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "vbox155", vbox155,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox155);
  gtk_container_add (GTK_CONTAINER (frame152), vbox155);

  ramachandran_plot_differences_second_mol_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (ramachandran_plot_differences_second_mol_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "ramachandran_plot_differences_second_mol_optionmenu", ramachandran_plot_differences_second_mol_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ramachandran_plot_differences_second_mol_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox155), ramachandran_plot_differences_second_mol_optionmenu, FALSE, FALSE, 0);
  ramachandran_plot_differences_second_mol_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (ramachandran_plot_differences_second_mol_optionmenu), ramachandran_plot_differences_second_mol_optionmenu_menu);

  frame153 = gtk_frame_new (NULL);
  gtk_widget_ref (frame153);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "frame153", frame153,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame153);
  gtk_box_pack_start (GTK_BOX (vbox155), frame153, TRUE, TRUE, 0);

  vbox156 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox156);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "vbox156", vbox156,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox156);
  gtk_container_add (GTK_CONTAINER (frame153), vbox156);

  ramachandran_plot_differences_second_chain_checkbutton = gtk_check_button_new_with_label (_("Use Specific Chain"));
  gtk_widget_ref (ramachandran_plot_differences_second_chain_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "ramachandran_plot_differences_second_chain_checkbutton", ramachandran_plot_differences_second_chain_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ramachandran_plot_differences_second_chain_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox156), ramachandran_plot_differences_second_chain_checkbutton, FALSE, FALSE, 0);

  ramachandran_plot_differences_second_chain_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (ramachandran_plot_differences_second_chain_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "ramachandran_plot_differences_second_chain_optionmenu", ramachandran_plot_differences_second_chain_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ramachandran_plot_differences_second_chain_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox156), ramachandran_plot_differences_second_chain_optionmenu, FALSE, FALSE, 0);
  ramachandran_plot_differences_second_chain_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (ramachandran_plot_differences_second_chain_optionmenu), ramachandran_plot_differences_second_chain_optionmenu_menu);

  dialog_action_area82 = GTK_DIALOG (ramachandran_plot_differences_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (ramachandran_plot_differences_dialog), "dialog_action_area82", dialog_action_area82);
  gtk_widget_show (dialog_action_area82);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area82), 10);

  hbox122 = gtk_hbox_new (TRUE, 0);
  gtk_widget_ref (hbox122);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "hbox122", hbox122,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox122);
  gtk_box_pack_start (GTK_BOX (dialog_action_area82), hbox122, TRUE, TRUE, 0);

  ramachandran_plot_differences_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (ramachandran_plot_differences_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "ramachandran_plot_differences_ok_button", ramachandran_plot_differences_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ramachandran_plot_differences_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox122), ramachandran_plot_differences_ok_button, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (ramachandran_plot_differences_ok_button), 6);
  GTK_WIDGET_SET_FLAGS (ramachandran_plot_differences_ok_button, GTK_CAN_DEFAULT);

  ramachandran_plot_differences_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (ramachandran_plot_differences_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (ramachandran_plot_differences_dialog), "ramachandran_plot_differences_cancel_button", ramachandran_plot_differences_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ramachandran_plot_differences_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox122), ramachandran_plot_differences_cancel_button, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (ramachandran_plot_differences_cancel_button), 6);
  GTK_WIDGET_SET_FLAGS (ramachandran_plot_differences_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (ramachandran_plot_differences_first_chain_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_ramachandran_plot_differences_first_chain_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ramachandran_plot_differences_second_chain_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_ramachandran_plot_differences_second_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ramachandran_plot_differences_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_ramachandran_plot_differences_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ramachandran_plot_differences_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_ramachandran_plot_differences_cancel_button_clicked),
                      NULL);

  gtk_widget_grab_default (ramachandran_plot_differences_ok_button);
  return ramachandran_plot_differences_dialog;
}

GtkWidget*
create_checked_waters_baddies_dialog (void)
{
  GtkWidget *checked_waters_baddies_dialog;
  GtkWidget *dialog_vbox84;
  GtkWidget *scrolledwindow20;
  GtkWidget *viewport12;
  GtkWidget *checked_waters_baddies_vbox;
  GtkWidget *dialog_action_area83;
  GtkWidget *checked_waters_baddies_cancel_button;

  checked_waters_baddies_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (checked_waters_baddies_dialog), "checked_waters_baddies_dialog", checked_waters_baddies_dialog);
  gtk_window_set_title (GTK_WINDOW (checked_waters_baddies_dialog), _("Questionable Waters"));
  gtk_window_set_policy (GTK_WINDOW (checked_waters_baddies_dialog), TRUE, TRUE, FALSE);

  dialog_vbox84 = GTK_DIALOG (checked_waters_baddies_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (checked_waters_baddies_dialog), "dialog_vbox84", dialog_vbox84);
  gtk_widget_show (dialog_vbox84);

  scrolledwindow20 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow20);
  gtk_object_set_data_full (GTK_OBJECT (checked_waters_baddies_dialog), "scrolledwindow20", scrolledwindow20,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow20);
  gtk_box_pack_start (GTK_BOX (dialog_vbox84), scrolledwindow20, TRUE, TRUE, 0);
  gtk_widget_set_usize (scrolledwindow20, 300, 190);

  viewport12 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport12);
  gtk_object_set_data_full (GTK_OBJECT (checked_waters_baddies_dialog), "viewport12", viewport12,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport12);
  gtk_container_add (GTK_CONTAINER (scrolledwindow20), viewport12);

  checked_waters_baddies_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (checked_waters_baddies_vbox);
  gtk_object_set_data_full (GTK_OBJECT (checked_waters_baddies_dialog), "checked_waters_baddies_vbox", checked_waters_baddies_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (checked_waters_baddies_vbox);
  gtk_container_add (GTK_CONTAINER (viewport12), checked_waters_baddies_vbox);
  gtk_widget_set_usize (checked_waters_baddies_vbox, 26, -2);

  dialog_action_area83 = GTK_DIALOG (checked_waters_baddies_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (checked_waters_baddies_dialog), "dialog_action_area83", dialog_action_area83);
  gtk_widget_show (dialog_action_area83);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area83), 10);

  checked_waters_baddies_cancel_button = gtk_button_new_with_label (_("   Cancel   "));
  gtk_widget_ref (checked_waters_baddies_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (checked_waters_baddies_dialog), "checked_waters_baddies_cancel_button", checked_waters_baddies_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (checked_waters_baddies_cancel_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area83), checked_waters_baddies_cancel_button, TRUE, TRUE, 0);
  GTK_WIDGET_UNSET_FLAGS (checked_waters_baddies_cancel_button, GTK_CAN_FOCUS);

  gtk_signal_connect (GTK_OBJECT (checked_waters_baddies_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_checked_waters_baddies_cancel_button_clicked),
                      NULL);

  return checked_waters_baddies_dialog;
}

GtkWidget*
create_nucleic_acid_base_chooser_dialog (void)
{
  GtkWidget *nucleic_acid_base_chooser_dialog;
  GtkWidget *dialog_vbox85;
  GtkWidget *frame155;
  GtkWidget *vbox160;
  GtkWidget *base_chooser_A_button;
  GtkWidget *base_chooser_C_button;
  GtkWidget *base_chooser_G_button;
  GtkWidget *base_chooser_T_button;
  GtkWidget *base_chooser_U_button;
  GtkWidget *dialog_action_area84;
  GtkWidget *base_chooser_cancel_button;

  nucleic_acid_base_chooser_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (nucleic_acid_base_chooser_dialog), "nucleic_acid_base_chooser_dialog", nucleic_acid_base_chooser_dialog);
  gtk_window_set_title (GTK_WINDOW (nucleic_acid_base_chooser_dialog), _("Base"));
  gtk_window_set_policy (GTK_WINDOW (nucleic_acid_base_chooser_dialog), TRUE, TRUE, FALSE);

  dialog_vbox85 = GTK_DIALOG (nucleic_acid_base_chooser_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (nucleic_acid_base_chooser_dialog), "dialog_vbox85", dialog_vbox85);
  gtk_widget_show (dialog_vbox85);

  frame155 = gtk_frame_new (NULL);
  gtk_widget_ref (frame155);
  gtk_object_set_data_full (GTK_OBJECT (nucleic_acid_base_chooser_dialog), "frame155", frame155,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame155);
  gtk_box_pack_start (GTK_BOX (dialog_vbox85), frame155, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame155), 4);

  vbox160 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox160);
  gtk_object_set_data_full (GTK_OBJECT (nucleic_acid_base_chooser_dialog), "vbox160", vbox160,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox160);
  gtk_container_add (GTK_CONTAINER (frame155), vbox160);

  base_chooser_A_button = gtk_button_new_with_label (_("  Adenine (A)  "));
  gtk_widget_ref (base_chooser_A_button);
  gtk_object_set_data_full (GTK_OBJECT (nucleic_acid_base_chooser_dialog), "base_chooser_A_button", base_chooser_A_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (base_chooser_A_button);
  gtk_box_pack_start (GTK_BOX (vbox160), base_chooser_A_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (base_chooser_A_button), 2);

  base_chooser_C_button = gtk_button_new_with_label (_("  Cytosine (C)  "));
  gtk_widget_ref (base_chooser_C_button);
  gtk_object_set_data_full (GTK_OBJECT (nucleic_acid_base_chooser_dialog), "base_chooser_C_button", base_chooser_C_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (base_chooser_C_button);
  gtk_box_pack_start (GTK_BOX (vbox160), base_chooser_C_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (base_chooser_C_button), 2);

  base_chooser_G_button = gtk_button_new_with_label (_("  Guanine (G)  "));
  gtk_widget_ref (base_chooser_G_button);
  gtk_object_set_data_full (GTK_OBJECT (nucleic_acid_base_chooser_dialog), "base_chooser_G_button", base_chooser_G_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (base_chooser_G_button);
  gtk_box_pack_start (GTK_BOX (vbox160), base_chooser_G_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (base_chooser_G_button), 2);

  base_chooser_T_button = gtk_button_new_with_label (_("  Thymine (T)  "));
  gtk_widget_ref (base_chooser_T_button);
  gtk_object_set_data_full (GTK_OBJECT (nucleic_acid_base_chooser_dialog), "base_chooser_T_button", base_chooser_T_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (base_chooser_T_button);
  gtk_box_pack_start (GTK_BOX (vbox160), base_chooser_T_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (base_chooser_T_button), 2);

  base_chooser_U_button = gtk_button_new_with_label (_("  Uracil (U)  "));
  gtk_widget_ref (base_chooser_U_button);
  gtk_object_set_data_full (GTK_OBJECT (nucleic_acid_base_chooser_dialog), "base_chooser_U_button", base_chooser_U_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (base_chooser_U_button);
  gtk_box_pack_start (GTK_BOX (vbox160), base_chooser_U_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (base_chooser_U_button), 2);

  dialog_action_area84 = GTK_DIALOG (nucleic_acid_base_chooser_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (nucleic_acid_base_chooser_dialog), "dialog_action_area84", dialog_action_area84);
  gtk_widget_show (dialog_action_area84);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area84), 10);

  base_chooser_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (base_chooser_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (nucleic_acid_base_chooser_dialog), "base_chooser_cancel_button", base_chooser_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (base_chooser_cancel_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area84), base_chooser_cancel_button, TRUE, TRUE, 2);

  gtk_signal_connect (GTK_OBJECT (nucleic_acid_base_chooser_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_nucleic_acid_base_chooser_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (base_chooser_A_button), "clicked",
                      GTK_SIGNAL_FUNC (on_base_chooser_A_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (base_chooser_C_button), "clicked",
                      GTK_SIGNAL_FUNC (on_base_chooser_C_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (base_chooser_G_button), "clicked",
                      GTK_SIGNAL_FUNC (on_base_chooser_G_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (base_chooser_T_button), "clicked",
                      GTK_SIGNAL_FUNC (on_base_chooser_T_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (base_chooser_U_button), "clicked",
                      GTK_SIGNAL_FUNC (on_base_chooser_U_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (base_chooser_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_base_chooser_cancel_button_clicked),
                      NULL);

  return nucleic_acid_base_chooser_dialog;
}

GtkWidget*
create_change_chain_id_dialog (void)
{
  GtkWidget *change_chain_id_dialog;
  GtkWidget *dialog_vbox86;
  GtkWidget *frame156;
  GtkWidget *vbox161;
  GtkWidget *label246;
  GtkWidget *change_chain_id_molecule_optionmenu;
  GtkWidget *change_chain_id_molecule_optionmenu_menu;
  GtkWidget *label248;
  GtkWidget *hbox125;
  GtkWidget *label247;
  GtkWidget *change_chain_id_chain_optionmenu;
  GtkWidget *change_chain_id_chain_optionmenu_menu;
  GtkWidget *frame157;
  GtkWidget *vbox162;
  GtkWidget *hbox126;
  GSList *change_chain_residues_gr_group = NULL;
  GtkWidget *change_chain_residue_range_no_radiobutton;
  GtkWidget *hbox127;
  GtkWidget *change_chain_residue_range_yes_radiobutton;
  GtkWidget *change_chain_id_residue_range_hbox;
  GtkWidget *label249;
  GtkWidget *change_chain_residues_from_entry;
  GtkWidget *label250;
  GtkWidget *change_chains_residues_to_entry;
  GtkWidget *label256;
  GtkWidget *label251;
  GtkWidget *hbox129;
  GtkWidget *label252;
  GtkWidget *change_chains_new_chain_id;
  GtkWidget *dialog_action_area85;
  GtkWidget *hbox124;
  GtkWidget *change_chains_rechain_button;
  GtkWidget *change_chain_cancel_button;

  change_chain_id_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (change_chain_id_dialog), "change_chain_id_dialog", change_chain_id_dialog);
  gtk_window_set_title (GTK_WINDOW (change_chain_id_dialog), _("Change Chain ID"));
  gtk_window_set_policy (GTK_WINDOW (change_chain_id_dialog), TRUE, TRUE, FALSE);

  dialog_vbox86 = GTK_DIALOG (change_chain_id_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (change_chain_id_dialog), "dialog_vbox86", dialog_vbox86);
  gtk_widget_show (dialog_vbox86);

  frame156 = gtk_frame_new (NULL);
  gtk_widget_ref (frame156);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "frame156", frame156,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame156);
  gtk_box_pack_start (GTK_BOX (dialog_vbox86), frame156, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame156), 6);

  vbox161 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox161);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "vbox161", vbox161,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox161);
  gtk_container_add (GTK_CONTAINER (frame156), vbox161);

  label246 = gtk_label_new (_("Change Chain ID in Molecule:"));
  gtk_widget_ref (label246);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "label246", label246,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label246);
  gtk_box_pack_start (GTK_BOX (vbox161), label246, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label246), 0, 0.5);
  gtk_misc_set_padding (GTK_MISC (label246), 0, 4);

  change_chain_id_molecule_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (change_chain_id_molecule_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "change_chain_id_molecule_optionmenu", change_chain_id_molecule_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (change_chain_id_molecule_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox161), change_chain_id_molecule_optionmenu, FALSE, FALSE, 0);
  change_chain_id_molecule_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (change_chain_id_molecule_optionmenu), change_chain_id_molecule_optionmenu_menu);

  label248 = gtk_label_new (_("From:"));
  gtk_widget_ref (label248);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "label248", label248,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label248);
  gtk_box_pack_start (GTK_BOX (vbox161), label248, FALSE, FALSE, 2);
  gtk_misc_set_alignment (GTK_MISC (label248), 0, 0.5);

  hbox125 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox125);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "hbox125", hbox125,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox125);
  gtk_box_pack_start (GTK_BOX (vbox161), hbox125, TRUE, TRUE, 0);

  label247 = gtk_label_new (_("  Chain ID:   "));
  gtk_widget_ref (label247);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "label247", label247,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label247);
  gtk_box_pack_start (GTK_BOX (hbox125), label247, FALSE, FALSE, 0);

  change_chain_id_chain_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (change_chain_id_chain_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "change_chain_id_chain_optionmenu", change_chain_id_chain_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (change_chain_id_chain_optionmenu);
  gtk_box_pack_start (GTK_BOX (hbox125), change_chain_id_chain_optionmenu, FALSE, FALSE, 0);
  change_chain_id_chain_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (change_chain_id_chain_optionmenu), change_chain_id_chain_optionmenu_menu);

  frame157 = gtk_frame_new (_("Using Residue Selection:"));
  gtk_widget_ref (frame157);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "frame157", frame157,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame157);
  gtk_box_pack_start (GTK_BOX (vbox161), frame157, TRUE, TRUE, 2);

  vbox162 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox162);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "vbox162", vbox162,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox162);
  gtk_container_add (GTK_CONTAINER (frame157), vbox162);

  hbox126 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox126);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "hbox126", hbox126,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox126);
  gtk_box_pack_start (GTK_BOX (vbox162), hbox126, TRUE, TRUE, 0);

  change_chain_residue_range_no_radiobutton = gtk_radio_button_new_with_label (change_chain_residues_gr_group, _("Whole Chain"));
  change_chain_residues_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (change_chain_residue_range_no_radiobutton));
  gtk_widget_ref (change_chain_residue_range_no_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "change_chain_residue_range_no_radiobutton", change_chain_residue_range_no_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (change_chain_residue_range_no_radiobutton);
  gtk_box_pack_start (GTK_BOX (hbox126), change_chain_residue_range_no_radiobutton, FALSE, FALSE, 0);

  hbox127 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox127);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "hbox127", hbox127,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox127);
  gtk_box_pack_start (GTK_BOX (vbox162), hbox127, TRUE, TRUE, 0);

  change_chain_residue_range_yes_radiobutton = gtk_radio_button_new_with_label (change_chain_residues_gr_group, _("Use Residue Range"));
  change_chain_residues_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (change_chain_residue_range_yes_radiobutton));
  gtk_widget_ref (change_chain_residue_range_yes_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "change_chain_residue_range_yes_radiobutton", change_chain_residue_range_yes_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (change_chain_residue_range_yes_radiobutton);
  gtk_box_pack_start (GTK_BOX (hbox127), change_chain_residue_range_yes_radiobutton, FALSE, FALSE, 0);

  change_chain_id_residue_range_hbox = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (change_chain_id_residue_range_hbox);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "change_chain_id_residue_range_hbox", change_chain_id_residue_range_hbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (change_chain_id_residue_range_hbox);
  gtk_box_pack_start (GTK_BOX (hbox127), change_chain_id_residue_range_hbox, TRUE, TRUE, 0);
  gtk_widget_set_sensitive (change_chain_id_residue_range_hbox, FALSE);

  label249 = gtk_label_new (_("from  "));
  gtk_widget_ref (label249);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "label249", label249,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label249);
  gtk_box_pack_start (GTK_BOX (change_chain_id_residue_range_hbox), label249, FALSE, FALSE, 0);

  change_chain_residues_from_entry = gtk_entry_new ();
  gtk_widget_ref (change_chain_residues_from_entry);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "change_chain_residues_from_entry", change_chain_residues_from_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (change_chain_residues_from_entry);
  gtk_box_pack_start (GTK_BOX (change_chain_id_residue_range_hbox), change_chain_residues_from_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (change_chain_residues_from_entry, 40, -2);

  label250 = gtk_label_new (_("   to   "));
  gtk_widget_ref (label250);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "label250", label250,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label250);
  gtk_box_pack_start (GTK_BOX (change_chain_id_residue_range_hbox), label250, FALSE, FALSE, 0);

  change_chains_residues_to_entry = gtk_entry_new ();
  gtk_widget_ref (change_chains_residues_to_entry);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "change_chains_residues_to_entry", change_chains_residues_to_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (change_chains_residues_to_entry);
  gtk_box_pack_start (GTK_BOX (change_chain_id_residue_range_hbox), change_chains_residues_to_entry, FALSE, TRUE, 0);
  gtk_widget_set_usize (change_chains_residues_to_entry, 40, -2);

  label256 = gtk_label_new (_("   "));
  gtk_widget_ref (label256);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "label256", label256,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label256);
  gtk_box_pack_start (GTK_BOX (change_chain_id_residue_range_hbox), label256, FALSE, FALSE, 0);

  label251 = gtk_label_new (_("To:"));
  gtk_widget_ref (label251);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "label251", label251,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label251);
  gtk_box_pack_start (GTK_BOX (vbox161), label251, FALSE, FALSE, 4);
  gtk_misc_set_alignment (GTK_MISC (label251), 0, 0.5);

  hbox129 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox129);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "hbox129", hbox129,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox129);
  gtk_box_pack_start (GTK_BOX (vbox161), hbox129, TRUE, TRUE, 2);

  label252 = gtk_label_new (_("Chain ID: "));
  gtk_widget_ref (label252);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "label252", label252,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label252);
  gtk_box_pack_start (GTK_BOX (hbox129), label252, FALSE, FALSE, 0);

  change_chains_new_chain_id = gtk_entry_new ();
  gtk_widget_ref (change_chains_new_chain_id);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "change_chains_new_chain_id", change_chains_new_chain_id,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (change_chains_new_chain_id);
  gtk_box_pack_start (GTK_BOX (hbox129), change_chains_new_chain_id, FALSE, TRUE, 0);
  gtk_widget_set_usize (change_chains_new_chain_id, 40, -2);

  dialog_action_area85 = GTK_DIALOG (change_chain_id_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (change_chain_id_dialog), "dialog_action_area85", dialog_action_area85);
  gtk_widget_show (dialog_action_area85);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area85), 10);

  hbox124 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox124);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "hbox124", hbox124,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox124);
  gtk_box_pack_start (GTK_BOX (dialog_action_area85), hbox124, TRUE, TRUE, 0);

  change_chains_rechain_button = gtk_button_new_with_label (_("  Apply New Chain ID  "));
  gtk_widget_ref (change_chains_rechain_button);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "change_chains_rechain_button", change_chains_rechain_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (change_chains_rechain_button);
  gtk_box_pack_start (GTK_BOX (hbox124), change_chains_rechain_button, TRUE, TRUE, 20);

  change_chain_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (change_chain_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (change_chain_id_dialog), "change_chain_cancel_button", change_chain_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (change_chain_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox124), change_chain_cancel_button, TRUE, TRUE, 20);

  gtk_signal_connect (GTK_OBJECT (change_chain_residue_range_no_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_change_chain_residue_range_no_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (change_chain_residue_range_yes_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_change_chain_residue_range_yes_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (change_chains_rechain_button), "clicked",
                      GTK_SIGNAL_FUNC (on_change_chains_rechain_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (change_chain_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_change_chain_cancel_button_clicked),
                      NULL);

  return change_chain_id_dialog;
}

GtkWidget*
create_doc_urls_dialog (void)
{
  GtkWidget *doc_urls_dialog;
  GtkWidget *dialog_vbox87;
  GtkWidget *frame158;
  GtkWidget *table3;
  GtkWidget *label254;
  GtkWidget *label255;
  GtkWidget *doc_1_entry;
  GtkWidget *doc_2_entry;
  GtkWidget *coot_doc_url_monolithic_button;
  GtkWidget *coot_doc_url_sectioned_button;
  GtkWidget *label272;
  GtkWidget *hseparator12;
  GtkWidget *coot_online_doc_search_entry;
  GtkWidget *label273;
  GtkWidget *coot_online_doc_search_button;
  GtkWidget *label274;
  GtkWidget *dialog_action_area86;
  GtkWidget *on_line_documentation_ok_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  doc_urls_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (doc_urls_dialog), "doc_urls_dialog", doc_urls_dialog);
  gtk_window_set_title (GTK_WINDOW (doc_urls_dialog), _("On Line Documentation"));
  gtk_window_set_policy (GTK_WINDOW (doc_urls_dialog), TRUE, TRUE, FALSE);

  dialog_vbox87 = GTK_DIALOG (doc_urls_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (doc_urls_dialog), "dialog_vbox87", dialog_vbox87);
  gtk_widget_show (dialog_vbox87);

  frame158 = gtk_frame_new (NULL);
  gtk_widget_ref (frame158);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "frame158", frame158,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame158);
  gtk_box_pack_start (GTK_BOX (dialog_vbox87), frame158, TRUE, TRUE, 0);
  gtk_widget_set_usize (frame158, 570, -2);
  gtk_container_set_border_width (GTK_CONTAINER (frame158), 6);

  table3 = gtk_table_new (4, 3, FALSE);
  gtk_widget_ref (table3);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "table3", table3,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (table3);
  gtk_container_add (GTK_CONTAINER (frame158), table3);

  label254 = gtk_label_new (_("   All in one page   "));
  gtk_widget_ref (label254);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "label254", label254,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label254);
  gtk_table_attach (GTK_TABLE (table3), label254, 0, 1, 0, 1,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_misc_set_alignment (GTK_MISC (label254), 0, 0.5);

  label255 = gtk_label_new (_("   Sectioned   "));
  gtk_widget_ref (label255);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "label255", label255,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label255);
  gtk_table_attach (GTK_TABLE (table3), label255, 0, 1, 1, 2,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_misc_set_alignment (GTK_MISC (label255), 0, 0.5);

  doc_1_entry = gtk_entry_new ();
  gtk_widget_ref (doc_1_entry);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "doc_1_entry", doc_1_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (doc_1_entry);
  gtk_table_attach (GTK_TABLE (table3), doc_1_entry, 1, 2, 0, 1,
                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_entry_set_editable (GTK_ENTRY (doc_1_entry), FALSE);
  gtk_entry_set_text (GTK_ENTRY (doc_1_entry), _("http://www.ysbl.york.ac.uk/~emsley/coot/doc/user-manual.html"));

  doc_2_entry = gtk_entry_new ();
  gtk_widget_ref (doc_2_entry);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "doc_2_entry", doc_2_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (doc_2_entry);
  gtk_table_attach (GTK_TABLE (table3), doc_2_entry, 1, 2, 1, 2,
                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_entry_set_editable (GTK_ENTRY (doc_2_entry), FALSE);
  gtk_entry_set_text (GTK_ENTRY (doc_2_entry), _("http://www.ysbl.york.ac.uk/~emsley/coot/doc/chapters/user-manual_toc.html"));

  coot_doc_url_monolithic_button = gtk_button_new_with_label (_("  Open  "));
  gtk_widget_ref (coot_doc_url_monolithic_button);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "coot_doc_url_monolithic_button", coot_doc_url_monolithic_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (coot_doc_url_monolithic_button);
  gtk_table_attach (GTK_TABLE (table3), coot_doc_url_monolithic_button, 2, 3, 0, 1,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_tooltips_set_tip (tooltips, coot_doc_url_monolithic_button, _("Open URL in web browser"), NULL);

  coot_doc_url_sectioned_button = gtk_button_new_with_label (_("  Open  "));
  gtk_widget_ref (coot_doc_url_sectioned_button);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "coot_doc_url_sectioned_button", coot_doc_url_sectioned_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (coot_doc_url_sectioned_button);
  gtk_table_attach (GTK_TABLE (table3), coot_doc_url_sectioned_button, 2, 3, 1, 2,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_tooltips_set_tip (tooltips, coot_doc_url_sectioned_button, _("Open URL in Web Browser"), NULL);

  label272 = gtk_label_new ("");
  gtk_widget_ref (label272);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "label272", label272,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label272);
  gtk_table_attach (GTK_TABLE (table3), label272, 0, 1, 2, 3,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_misc_set_alignment (GTK_MISC (label272), 0, 0.5);

  hseparator12 = gtk_hseparator_new ();
  gtk_widget_ref (hseparator12);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "hseparator12", hseparator12,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hseparator12);
  gtk_table_attach (GTK_TABLE (table3), hseparator12, 1, 2, 2, 3,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (GTK_FILL), 0, 0);

  coot_online_doc_search_entry = gtk_entry_new ();
  gtk_widget_ref (coot_online_doc_search_entry);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "coot_online_doc_search_entry", coot_online_doc_search_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (coot_online_doc_search_entry);
  gtk_table_attach (GTK_TABLE (table3), coot_online_doc_search_entry, 1, 2, 3, 4,
                    (GtkAttachOptions) (GTK_EXPAND | GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);

  label273 = gtk_label_new ("");
  gtk_widget_ref (label273);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "label273", label273,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label273);
  gtk_table_attach (GTK_TABLE (table3), label273, 0, 1, 3, 4,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_misc_set_alignment (GTK_MISC (label273), 0, 0.5);

  coot_online_doc_search_button = gtk_button_new_with_label (_("  Search  "));
  gtk_widget_ref (coot_online_doc_search_button);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "coot_online_doc_search_button", coot_online_doc_search_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (coot_online_doc_search_button);
  gtk_table_attach (GTK_TABLE (table3), coot_online_doc_search_button, 2, 3, 3, 4,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_tooltips_set_tip (tooltips, coot_online_doc_search_button, _("Do a Google search"), NULL);

  label274 = gtk_label_new ("");
  gtk_widget_ref (label274);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "label274", label274,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label274);
  gtk_table_attach (GTK_TABLE (table3), label274, 2, 3, 2, 3,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);
  gtk_misc_set_alignment (GTK_MISC (label274), 0, 0.5);

  dialog_action_area86 = GTK_DIALOG (doc_urls_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (doc_urls_dialog), "dialog_action_area86", dialog_action_area86);
  gtk_widget_show (dialog_action_area86);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area86), 10);

  on_line_documentation_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (on_line_documentation_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (doc_urls_dialog), "on_line_documentation_ok_button", on_line_documentation_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (on_line_documentation_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area86), on_line_documentation_ok_button, TRUE, TRUE, 210);

  gtk_signal_connect (GTK_OBJECT (coot_doc_url_monolithic_button), "clicked",
                      GTK_SIGNAL_FUNC (on_coot_doc_url_monolithic_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (coot_doc_url_sectioned_button), "clicked",
                      GTK_SIGNAL_FUNC (on_coot_doc_url_sectioned_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (coot_online_doc_search_entry), "key_press_event",
                      GTK_SIGNAL_FUNC (on_coot_online_doc_search_entry_key_press_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (coot_online_doc_search_button), "clicked",
                      GTK_SIGNAL_FUNC (on_coot_online_doc_search_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (on_line_documentation_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_on_line_documentation_ok_button_clicked),
                      NULL);

  gtk_object_set_data (GTK_OBJECT (doc_urls_dialog), "tooltips", tooltips);

  return doc_urls_dialog;
}

GtkWidget*
create_save_state_fileselection (void)
{
  GtkWidget *save_state_fileselection;
  GtkWidget *save_state_ok_button1;
  GtkWidget *save_state_cancel_button1;

  save_state_fileselection = gtk_file_selection_new (_("Select File-name for State File"));
  gtk_object_set_data (GTK_OBJECT (save_state_fileselection), "save_state_fileselection", save_state_fileselection);
  gtk_container_set_border_width (GTK_CONTAINER (save_state_fileselection), 10);

  save_state_ok_button1 = GTK_FILE_SELECTION (save_state_fileselection)->ok_button;
  gtk_object_set_data (GTK_OBJECT (save_state_fileselection), "save_state_ok_button1", save_state_ok_button1);
  gtk_widget_show (save_state_ok_button1);
  GTK_WIDGET_SET_FLAGS (save_state_ok_button1, GTK_CAN_DEFAULT);

  save_state_cancel_button1 = GTK_FILE_SELECTION (save_state_fileselection)->cancel_button;
  gtk_object_set_data (GTK_OBJECT (save_state_fileselection), "save_state_cancel_button1", save_state_cancel_button1);
  gtk_widget_show (save_state_cancel_button1);
  GTK_WIDGET_SET_FLAGS (save_state_cancel_button1, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (save_state_fileselection), "destroy",
                      GTK_SIGNAL_FUNC (on_save_state_fileselection_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (save_state_ok_button1), "clicked",
                      GTK_SIGNAL_FUNC (on_save_state_ok_button1_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (save_state_cancel_button1), "clicked",
                      GTK_SIGNAL_FUNC (on_save_state_cancel_button1_clicked),
                      NULL);

  return save_state_fileselection;
}

GtkWidget*
create_other_model_tools_dialog (void)
{
  GtkWidget *other_model_tools_dialog;
  GtkWidget *dialog_vbox89;
  GtkWidget *frame160;
  GtkWidget *vbox163;
  GtkWidget *model_refine_dialog_find_ligands_button;
  GtkWidget *cis_trans_conversion_toggle_button;
  GtkWidget *model_refine_dialog_baton_button;
  GtkWidget *model_refine_dialog_db_main_togglebutton;
  GtkWidget *model_refine_dialog_add_OXT_button;
  GtkWidget *reverse_fragment_direction_togglebutton;
  GtkWidget *place_helix_here_button;
  GtkWidget *other_tools_RNA_button;
  GtkWidget *set_undo_molecule_button;
  GtkWidget *dialog_action_area88;
  GtkWidget *other_modelling_tools_close_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  other_model_tools_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (other_model_tools_dialog), "other_model_tools_dialog", other_model_tools_dialog);
  gtk_window_set_title (GTK_WINDOW (other_model_tools_dialog), _("Other Modelling Tools"));
  gtk_window_set_policy (GTK_WINDOW (other_model_tools_dialog), TRUE, TRUE, FALSE);

  dialog_vbox89 = GTK_DIALOG (other_model_tools_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (other_model_tools_dialog), "dialog_vbox89", dialog_vbox89);
  gtk_widget_show (dialog_vbox89);

  frame160 = gtk_frame_new (NULL);
  gtk_widget_ref (frame160);
  gtk_object_set_data_full (GTK_OBJECT (other_model_tools_dialog), "frame160", frame160,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame160);
  gtk_box_pack_start (GTK_BOX (dialog_vbox89), frame160, TRUE, TRUE, 0);

  vbox163 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox163);
  gtk_object_set_data_full (GTK_OBJECT (other_model_tools_dialog), "vbox163", vbox163,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox163);
  gtk_container_add (GTK_CONTAINER (frame160), vbox163);
  gtk_container_set_border_width (GTK_CONTAINER (vbox163), 6);

  model_refine_dialog_find_ligands_button = gtk_button_new_with_label (_("Find Ligands..."));
  gtk_widget_ref (model_refine_dialog_find_ligands_button);
  gtk_object_set_data_full (GTK_OBJECT (other_model_tools_dialog), "model_refine_dialog_find_ligands_button", model_refine_dialog_find_ligands_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_find_ligands_button);
  gtk_box_pack_start (GTK_BOX (vbox163), model_refine_dialog_find_ligands_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_find_ligands_button), 1);

  cis_trans_conversion_toggle_button = gtk_toggle_button_new_with_label (_("   Cis <-> Trans   "));
  gtk_widget_ref (cis_trans_conversion_toggle_button);
  gtk_object_set_data_full (GTK_OBJECT (other_model_tools_dialog), "cis_trans_conversion_toggle_button", cis_trans_conversion_toggle_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (cis_trans_conversion_toggle_button);
  gtk_box_pack_start (GTK_BOX (vbox163), cis_trans_conversion_toggle_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (cis_trans_conversion_toggle_button), 1);
  gtk_tooltips_set_tip (tooltips, cis_trans_conversion_toggle_button, _("Convert peptide: CIS -> TRANS or TRANS -> CIS... It depends on what you have currently"), NULL);

  model_refine_dialog_baton_button = gtk_button_new_with_label (_("Ca Baton Mode..."));
  gtk_widget_ref (model_refine_dialog_baton_button);
  gtk_object_set_data_full (GTK_OBJECT (other_model_tools_dialog), "model_refine_dialog_baton_button", model_refine_dialog_baton_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_baton_button);
  gtk_box_pack_start (GTK_BOX (vbox163), model_refine_dialog_baton_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_baton_button), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_baton_button, _("Make sure that you are about 3.8A away from where you wish to put your first atom before you start Baton Mode."), NULL);

  model_refine_dialog_db_main_togglebutton = gtk_toggle_button_new_with_label (_("Ca Zone -> Mainchain"));
  gtk_widget_ref (model_refine_dialog_db_main_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (other_model_tools_dialog), "model_refine_dialog_db_main_togglebutton", model_refine_dialog_db_main_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_db_main_togglebutton);
  gtk_box_pack_start (GTK_BOX (vbox163), model_refine_dialog_db_main_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_db_main_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, model_refine_dialog_db_main_togglebutton, _("Use database of fragments to convert a set of C-alphas to mainchain atoms"), NULL);

  model_refine_dialog_add_OXT_button = gtk_button_new_with_label (_("Add OXT to Residue..."));
  gtk_widget_ref (model_refine_dialog_add_OXT_button);
  gtk_object_set_data_full (GTK_OBJECT (other_model_tools_dialog), "model_refine_dialog_add_OXT_button", model_refine_dialog_add_OXT_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (model_refine_dialog_add_OXT_button);
  gtk_box_pack_start (GTK_BOX (vbox163), model_refine_dialog_add_OXT_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (model_refine_dialog_add_OXT_button), 1);

  reverse_fragment_direction_togglebutton = gtk_toggle_button_new_with_label (_("Reverse Direction"));
  gtk_widget_ref (reverse_fragment_direction_togglebutton);
  gtk_object_set_data_full (GTK_OBJECT (other_model_tools_dialog), "reverse_fragment_direction_togglebutton", reverse_fragment_direction_togglebutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (reverse_fragment_direction_togglebutton);
  gtk_box_pack_start (GTK_BOX (vbox163), reverse_fragment_direction_togglebutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (reverse_fragment_direction_togglebutton), 1);
  gtk_tooltips_set_tip (tooltips, reverse_fragment_direction_togglebutton, _("Reverse direction of fragment, leaving only CAs"), NULL);

  place_helix_here_button = gtk_button_new_with_label (_("Place Helix Here"));
  gtk_widget_ref (place_helix_here_button);
  gtk_object_set_data_full (GTK_OBJECT (other_model_tools_dialog), "place_helix_here_button", place_helix_here_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (place_helix_here_button);
  gtk_box_pack_start (GTK_BOX (vbox163), place_helix_here_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (place_helix_here_button), 1);
  gtk_tooltips_set_tip (tooltips, place_helix_here_button, _("Place an ideal alpha helix about here and try to optimize position and orientation.  Must have a map set for fitting."), NULL);

  other_tools_RNA_button = gtk_button_new_with_label (_("Ideal DNA/RNA..."));
  gtk_widget_ref (other_tools_RNA_button);
  gtk_object_set_data_full (GTK_OBJECT (other_model_tools_dialog), "other_tools_RNA_button", other_tools_RNA_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (other_tools_RNA_button);
  gtk_box_pack_start (GTK_BOX (vbox163), other_tools_RNA_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (other_tools_RNA_button), 1);

  set_undo_molecule_button = gtk_button_new_with_label (_(" Choose \"Undo\" Molecule... "));
  gtk_widget_ref (set_undo_molecule_button);
  gtk_object_set_data_full (GTK_OBJECT (other_model_tools_dialog), "set_undo_molecule_button", set_undo_molecule_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (set_undo_molecule_button);
  gtk_box_pack_start (GTK_BOX (vbox163), set_undo_molecule_button, FALSE, FALSE, 1);
  gtk_tooltips_set_tip (tooltips, set_undo_molecule_button, _("Choose the molecule number to which \"Undo\" actions occur."), NULL);

  dialog_action_area88 = GTK_DIALOG (other_model_tools_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (other_model_tools_dialog), "dialog_action_area88", dialog_action_area88);
  gtk_widget_show (dialog_action_area88);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area88), 10);

  other_modelling_tools_close_button = gtk_button_new_with_label (_("   Close   "));
  gtk_widget_ref (other_modelling_tools_close_button);
  gtk_object_set_data_full (GTK_OBJECT (other_model_tools_dialog), "other_modelling_tools_close_button", other_modelling_tools_close_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (other_modelling_tools_close_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area88), other_modelling_tools_close_button, FALSE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (other_model_tools_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_other_model_tools_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_find_ligands_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_find_ligands_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (cis_trans_conversion_toggle_button), "toggled",
                      GTK_SIGNAL_FUNC (on_cis_trans_conversion_toggle_button_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_baton_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_baton_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_db_main_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_db_main_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (model_refine_dialog_add_OXT_button), "clicked",
                      GTK_SIGNAL_FUNC (on_model_refine_dialog_add_OXT_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (reverse_fragment_direction_togglebutton), "toggled",
                      GTK_SIGNAL_FUNC (on_reverse_fragment_direction_togglebutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (place_helix_here_button), "clicked",
                      GTK_SIGNAL_FUNC (on_place_helix_here_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (other_tools_RNA_button), "clicked",
                      GTK_SIGNAL_FUNC (on_other_tools_RNA_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (set_undo_molecule_button), "clicked",
                      GTK_SIGNAL_FUNC (on_set_undo_molecule_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (other_modelling_tools_close_button), "clicked",
                      GTK_SIGNAL_FUNC (on_other_modelling_tools_close_button_clicked),
                      NULL);

  gtk_object_set_data (GTK_OBJECT (other_model_tools_dialog), "tooltips", tooltips);

  return other_model_tools_dialog;
}

GtkWidget*
create_screendump_fileselection (void)
{
  GtkWidget *screendump_fileselection;
  GtkWidget *screendump_image_ok_button;
  GtkWidget *screendump_image_cancel_button;

  screendump_fileselection = gtk_file_selection_new (_("Select File"));
  gtk_object_set_data (GTK_OBJECT (screendump_fileselection), "screendump_fileselection", screendump_fileselection);
  gtk_container_set_border_width (GTK_CONTAINER (screendump_fileselection), 10);

  screendump_image_ok_button = GTK_FILE_SELECTION (screendump_fileselection)->ok_button;
  gtk_object_set_data (GTK_OBJECT (screendump_fileselection), "screendump_image_ok_button", screendump_image_ok_button);
  gtk_widget_show (screendump_image_ok_button);
  GTK_WIDGET_SET_FLAGS (screendump_image_ok_button, GTK_CAN_DEFAULT);

  screendump_image_cancel_button = GTK_FILE_SELECTION (screendump_fileselection)->cancel_button;
  gtk_object_set_data (GTK_OBJECT (screendump_fileselection), "screendump_image_cancel_button", screendump_image_cancel_button);
  gtk_widget_show (screendump_image_cancel_button);
  GTK_WIDGET_SET_FLAGS (screendump_image_cancel_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (screendump_fileselection), "destroy",
                      GTK_SIGNAL_FUNC (on_screendump_fileselection_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (screendump_image_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_screendump_image_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (screendump_image_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_screendump_image_cancel_button_clicked),
                      NULL);

  return screendump_fileselection;
}

GtkWidget*
create_symmetry_controller_dialog (void)
{
  GtkWidget *symmetry_controller_dialog;
  GtkWidget *dialog_vbox90;
  GtkWidget *vbox167;
  GtkWidget *scrolledwindow24;
  GtkWidget *symmetry_control_viewport;
  GtkWidget *symmetry_controller_vbox;
  GtkWidget *molecule_0_frame;
  GtkWidget *vbox168;
  GtkWidget *molecule_0_checkbutton;
  GtkWidget *frame162;
  GtkWidget *table4;
  GSList *symm_display_mol_0_gr_group = NULL;
  GtkWidget *display_sphere_radiobutton_molecule_0;
  GtkWidget *display_all_radiobutton_molecule_0;
  GtkWidget *display_CA_radiobutton_molecule_0;
  GSList *symm_colour_mol_0_gr_group = NULL;
  GtkWidget *colour_symm_std_molecule_0;
  GtkWidget *colour_symm_by_symop_molecule_0;
  GtkWidget *colour_symm_by_molecule_molecule_0;
  GtkWidget *dialog_action_area89;
  GtkWidget *symmetry_controller_ok_button;

  symmetry_controller_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (symmetry_controller_dialog), "symmetry_controller_dialog", symmetry_controller_dialog);
  gtk_window_set_title (GTK_WINDOW (symmetry_controller_dialog), _("Symmetry Controller"));
  gtk_window_set_policy (GTK_WINDOW (symmetry_controller_dialog), TRUE, TRUE, FALSE);

  dialog_vbox90 = GTK_DIALOG (symmetry_controller_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (symmetry_controller_dialog), "dialog_vbox90", dialog_vbox90);
  gtk_widget_show (dialog_vbox90);

  vbox167 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox167);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "vbox167", vbox167,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox167);
  gtk_box_pack_start (GTK_BOX (dialog_vbox90), vbox167, TRUE, TRUE, 0);

  scrolledwindow24 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow24);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "scrolledwindow24", scrolledwindow24,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow24);
  gtk_box_pack_start (GTK_BOX (vbox167), scrolledwindow24, TRUE, TRUE, 0);
  gtk_widget_set_usize (scrolledwindow24, 328, 200);

  symmetry_control_viewport = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (symmetry_control_viewport);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "symmetry_control_viewport", symmetry_control_viewport,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (symmetry_control_viewport);
  gtk_container_add (GTK_CONTAINER (scrolledwindow24), symmetry_control_viewport);

  symmetry_controller_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (symmetry_controller_vbox);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "symmetry_controller_vbox", symmetry_controller_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (symmetry_controller_vbox);
  gtk_container_add (GTK_CONTAINER (symmetry_control_viewport), symmetry_controller_vbox);

  molecule_0_frame = gtk_frame_new (_("Molecule 0 (this frame not visible)"));
  gtk_widget_ref (molecule_0_frame);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "molecule_0_frame", molecule_0_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (symmetry_controller_vbox), molecule_0_frame, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (molecule_0_frame), 6);

  vbox168 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox168);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "vbox168", vbox168,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox168);
  gtk_container_add (GTK_CONTAINER (molecule_0_frame), vbox168);

  molecule_0_checkbutton = gtk_check_button_new_with_label (_(" Show Symmetry?"));
  gtk_widget_ref (molecule_0_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "molecule_0_checkbutton", molecule_0_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (molecule_0_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox168), molecule_0_checkbutton, FALSE, FALSE, 0);

  frame162 = gtk_frame_new (_("Display Options"));
  gtk_widget_ref (frame162);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "frame162", frame162,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame162);
  gtk_box_pack_start (GTK_BOX (vbox168), frame162, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame162), 4);

  table4 = gtk_table_new (3, 2, FALSE);
  gtk_widget_ref (table4);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "table4", table4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (table4);
  gtk_container_add (GTK_CONTAINER (frame162), table4);

  display_sphere_radiobutton_molecule_0 = gtk_radio_button_new_with_label (symm_display_mol_0_gr_group, _("Display Sphere"));
  symm_display_mol_0_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (display_sphere_radiobutton_molecule_0));
  gtk_widget_ref (display_sphere_radiobutton_molecule_0);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "display_sphere_radiobutton_molecule_0", display_sphere_radiobutton_molecule_0,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (display_sphere_radiobutton_molecule_0);
  gtk_table_attach (GTK_TABLE (table4), display_sphere_radiobutton_molecule_0, 0, 1, 0, 1,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);

  display_all_radiobutton_molecule_0 = gtk_radio_button_new_with_label (symm_display_mol_0_gr_group, _("Display All Molecule"));
  symm_display_mol_0_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (display_all_radiobutton_molecule_0));
  gtk_widget_ref (display_all_radiobutton_molecule_0);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "display_all_radiobutton_molecule_0", display_all_radiobutton_molecule_0,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (display_all_radiobutton_molecule_0);
  gtk_table_attach (GTK_TABLE (table4), display_all_radiobutton_molecule_0, 0, 1, 1, 2,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);

  display_CA_radiobutton_molecule_0 = gtk_radio_button_new_with_label (symm_display_mol_0_gr_group, _("Display as CAs"));
  symm_display_mol_0_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (display_CA_radiobutton_molecule_0));
  gtk_widget_ref (display_CA_radiobutton_molecule_0);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "display_CA_radiobutton_molecule_0", display_CA_radiobutton_molecule_0,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (display_CA_radiobutton_molecule_0);
  gtk_table_attach (GTK_TABLE (table4), display_CA_radiobutton_molecule_0, 0, 1, 2, 3,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);

  colour_symm_std_molecule_0 = gtk_radio_button_new_with_label (symm_colour_mol_0_gr_group, _("Standard Colouring"));
  symm_colour_mol_0_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (colour_symm_std_molecule_0));
  gtk_widget_ref (colour_symm_std_molecule_0);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "colour_symm_std_molecule_0", colour_symm_std_molecule_0,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (colour_symm_std_molecule_0);
  gtk_table_attach (GTK_TABLE (table4), colour_symm_std_molecule_0, 1, 2, 0, 1,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);

  colour_symm_by_symop_molecule_0 = gtk_radio_button_new_with_label (symm_colour_mol_0_gr_group, _("Colour by Symop"));
  symm_colour_mol_0_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (colour_symm_by_symop_molecule_0));
  gtk_widget_ref (colour_symm_by_symop_molecule_0);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "colour_symm_by_symop_molecule_0", colour_symm_by_symop_molecule_0,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (colour_symm_by_symop_molecule_0);
  gtk_table_attach (GTK_TABLE (table4), colour_symm_by_symop_molecule_0, 1, 2, 1, 2,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);

  colour_symm_by_molecule_molecule_0 = gtk_radio_button_new_with_label (symm_colour_mol_0_gr_group, _("Colour by Molecule"));
  symm_colour_mol_0_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (colour_symm_by_molecule_molecule_0));
  gtk_widget_ref (colour_symm_by_molecule_molecule_0);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "colour_symm_by_molecule_molecule_0", colour_symm_by_molecule_molecule_0,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (colour_symm_by_molecule_molecule_0);
  gtk_table_attach (GTK_TABLE (table4), colour_symm_by_molecule_molecule_0, 1, 2, 2, 3,
                    (GtkAttachOptions) (GTK_FILL),
                    (GtkAttachOptions) (0), 0, 0);

  dialog_action_area89 = GTK_DIALOG (symmetry_controller_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (symmetry_controller_dialog), "dialog_action_area89", dialog_action_area89);
  gtk_widget_show (dialog_action_area89);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area89), 10);

  symmetry_controller_ok_button = gtk_button_new_with_label (_("      OK      "));
  gtk_widget_ref (symmetry_controller_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (symmetry_controller_dialog), "symmetry_controller_ok_button", symmetry_controller_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (symmetry_controller_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area89), symmetry_controller_ok_button, FALSE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (molecule_0_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_molecule_0_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (display_sphere_radiobutton_molecule_0), "toggled",
                      GTK_SIGNAL_FUNC (on_display_sphere_radiobutton_molecule_0_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (display_all_radiobutton_molecule_0), "toggled",
                      GTK_SIGNAL_FUNC (on_display_all_radiobutton_molecule_0_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (display_CA_radiobutton_molecule_0), "toggled",
                      GTK_SIGNAL_FUNC (on_display_CA_radiobutton_molecule_0_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (colour_symm_std_molecule_0), "toggled",
                      GTK_SIGNAL_FUNC (on_colour_symm_std_molecule_0_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (colour_symm_by_symop_molecule_0), "toggled",
                      GTK_SIGNAL_FUNC (on_colour_symm_by_symop_molecule_0_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (colour_symm_by_molecule_molecule_0), "toggled",
                      GTK_SIGNAL_FUNC (on_colour_symm_by_molecule_molecule_0_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (symmetry_controller_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_symmetry_controller_ok_button_clicked),
                      NULL);

  return symmetry_controller_dialog;
}

GtkWidget*
create_ncs_control_dialog (void)
{
  GtkWidget *ncs_control_dialog;
  GtkWidget *dialog_vbox91;
  GtkWidget *vbox170;
  GtkWidget *label263;
  GtkWidget *scrolledwindow25;
  GtkWidget *viewport19;
  GtkWidget *ncs_control_vbox;
  GtkWidget *frame_molecule_N;
  GtkWidget *vbox176;
  GtkWidget *ncs_controller_molecule_n_display_ncs_checkbutton;
  GtkWidget *hseparator11;
  GtkWidget *hbox134;
  GtkWidget *vbox172;
  GtkWidget *label264;
  GtkWidget *ncs_controller_molecule_n_display_chain_vbox;
  GtkWidget *ncs_controller_molecule_n_display_chain_ich_checkbutton;
  GtkWidget *checkbutton4;
  GtkWidget *checkbutton5;
  GtkWidget *vbox174;
  GtkWidget *label265;
  GtkWidget *ncs_controller_molecule_n_vbox;
  GSList *molecule_n_ncs_master_chain_gr_group = NULL;
  GtkWidget *ncs_controller_ncs_master_chain_ich_radiobutton;
  GtkWidget *radiobutton4;
  GtkWidget *radiobutton5;
  GtkWidget *dialog_action_area90;
  GtkWidget *ncs_control_ok_button;
  GtkTooltips *tooltips;

  tooltips = gtk_tooltips_new ();

  ncs_control_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (ncs_control_dialog), "ncs_control_dialog", ncs_control_dialog);
  gtk_window_set_title (GTK_WINDOW (ncs_control_dialog), _("NCS Control"));
  gtk_window_set_policy (GTK_WINDOW (ncs_control_dialog), TRUE, TRUE, FALSE);

  dialog_vbox91 = GTK_DIALOG (ncs_control_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (ncs_control_dialog), "dialog_vbox91", dialog_vbox91);
  gtk_widget_show (dialog_vbox91);

  vbox170 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox170);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "vbox170", vbox170,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox170);
  gtk_box_pack_start (GTK_BOX (dialog_vbox91), vbox170, TRUE, TRUE, 0);

  label263 = gtk_label_new (_("NCS Controller"));
  gtk_widget_ref (label263);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "label263", label263,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label263);
  gtk_box_pack_start (GTK_BOX (vbox170), label263, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label263), 3, 4);

  scrolledwindow25 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow25);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "scrolledwindow25", scrolledwindow25,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow25);
  gtk_box_pack_start (GTK_BOX (vbox170), scrolledwindow25, TRUE, TRUE, 0);
  gtk_widget_set_usize (scrolledwindow25, 289, 170);

  viewport19 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport19);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "viewport19", viewport19,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport19);
  gtk_container_add (GTK_CONTAINER (scrolledwindow25), viewport19);

  ncs_control_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (ncs_control_vbox);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "ncs_control_vbox", ncs_control_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ncs_control_vbox);
  gtk_container_add (GTK_CONTAINER (viewport19), ncs_control_vbox);

  frame_molecule_N = gtk_frame_new (_("molecule N"));
  gtk_widget_ref (frame_molecule_N);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "frame_molecule_N", frame_molecule_N,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (ncs_control_vbox), frame_molecule_N, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame_molecule_N), 6);

  vbox176 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox176);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "vbox176", vbox176,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox176);
  gtk_container_add (GTK_CONTAINER (frame_molecule_N), vbox176);

  ncs_controller_molecule_n_display_ncs_checkbutton = gtk_check_button_new_with_label (_("Display Non-cystallographic Ghosts"));
  gtk_widget_ref (ncs_controller_molecule_n_display_ncs_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "ncs_controller_molecule_n_display_ncs_checkbutton", ncs_controller_molecule_n_display_ncs_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ncs_controller_molecule_n_display_ncs_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox176), ncs_controller_molecule_n_display_ncs_checkbutton, FALSE, FALSE, 0);

  hseparator11 = gtk_hseparator_new ();
  gtk_widget_ref (hseparator11);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "hseparator11", hseparator11,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hseparator11);
  gtk_box_pack_start (GTK_BOX (vbox176), hseparator11, TRUE, TRUE, 2);

  hbox134 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox134);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "hbox134", hbox134,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox134);
  gtk_box_pack_start (GTK_BOX (vbox176), hbox134, TRUE, TRUE, 0);

  vbox172 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox172);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "vbox172", vbox172,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox172);
  gtk_box_pack_start (GTK_BOX (hbox134), vbox172, TRUE, TRUE, 0);

  label264 = gtk_label_new (_("Displayed Chains"));
  gtk_widget_ref (label264);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "label264", label264,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label264);
  gtk_box_pack_start (GTK_BOX (vbox172), label264, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label264), 0.4, 0.5);

  ncs_controller_molecule_n_display_chain_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (ncs_controller_molecule_n_display_chain_vbox);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "ncs_controller_molecule_n_display_chain_vbox", ncs_controller_molecule_n_display_chain_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ncs_controller_molecule_n_display_chain_vbox);
  gtk_box_pack_start (GTK_BOX (vbox172), ncs_controller_molecule_n_display_chain_vbox, TRUE, TRUE, 0);

  ncs_controller_molecule_n_display_chain_ich_checkbutton = gtk_check_button_new_with_label (_("Chain A"));
  gtk_widget_ref (ncs_controller_molecule_n_display_chain_ich_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "ncs_controller_molecule_n_display_chain_ich_checkbutton", ncs_controller_molecule_n_display_chain_ich_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ncs_controller_molecule_n_display_chain_ich_checkbutton);
  gtk_box_pack_start (GTK_BOX (ncs_controller_molecule_n_display_chain_vbox), ncs_controller_molecule_n_display_chain_ich_checkbutton, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, ncs_controller_molecule_n_display_chain_ich_checkbutton, _("Show this chain as a ghost chain?"), NULL);

  checkbutton4 = gtk_check_button_new_with_label (_("checkbutton4"));
  gtk_widget_ref (checkbutton4);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "checkbutton4", checkbutton4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (checkbutton4);
  gtk_box_pack_start (GTK_BOX (ncs_controller_molecule_n_display_chain_vbox), checkbutton4, FALSE, FALSE, 0);

  checkbutton5 = gtk_check_button_new_with_label (_("checkbutton5"));
  gtk_widget_ref (checkbutton5);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "checkbutton5", checkbutton5,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (checkbutton5);
  gtk_box_pack_start (GTK_BOX (ncs_controller_molecule_n_display_chain_vbox), checkbutton5, FALSE, FALSE, 0);

  vbox174 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox174);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "vbox174", vbox174,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox174);
  gtk_box_pack_start (GTK_BOX (hbox134), vbox174, TRUE, TRUE, 0);

  label265 = gtk_label_new (_("NCS Master Chain"));
  gtk_widget_ref (label265);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "label265", label265,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label265);
  gtk_box_pack_start (GTK_BOX (vbox174), label265, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label265), 0.4, 0.5);

  ncs_controller_molecule_n_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (ncs_controller_molecule_n_vbox);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "ncs_controller_molecule_n_vbox", ncs_controller_molecule_n_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ncs_controller_molecule_n_vbox);
  gtk_box_pack_start (GTK_BOX (vbox174), ncs_controller_molecule_n_vbox, TRUE, TRUE, 0);

  ncs_controller_ncs_master_chain_ich_radiobutton = gtk_radio_button_new_with_label (molecule_n_ncs_master_chain_gr_group, _("Chain A"));
  molecule_n_ncs_master_chain_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (ncs_controller_ncs_master_chain_ich_radiobutton));
  gtk_widget_ref (ncs_controller_ncs_master_chain_ich_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "ncs_controller_ncs_master_chain_ich_radiobutton", ncs_controller_ncs_master_chain_ich_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ncs_controller_ncs_master_chain_ich_radiobutton);
  gtk_box_pack_start (GTK_BOX (ncs_controller_molecule_n_vbox), ncs_controller_ncs_master_chain_ich_radiobutton, FALSE, FALSE, 0);
  gtk_tooltips_set_tip (tooltips, ncs_controller_ncs_master_chain_ich_radiobutton, _("The chain to which operators and ghosts are generated from other chains"), NULL);

  radiobutton4 = gtk_radio_button_new_with_label (molecule_n_ncs_master_chain_gr_group, _("radiobutton4"));
  molecule_n_ncs_master_chain_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (radiobutton4));
  gtk_widget_ref (radiobutton4);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "radiobutton4", radiobutton4,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (radiobutton4);
  gtk_box_pack_start (GTK_BOX (ncs_controller_molecule_n_vbox), radiobutton4, FALSE, FALSE, 0);

  radiobutton5 = gtk_radio_button_new_with_label (molecule_n_ncs_master_chain_gr_group, _("radiobutton5"));
  molecule_n_ncs_master_chain_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (radiobutton5));
  gtk_widget_ref (radiobutton5);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "radiobutton5", radiobutton5,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (radiobutton5);
  gtk_box_pack_start (GTK_BOX (ncs_controller_molecule_n_vbox), radiobutton5, FALSE, FALSE, 0);

  dialog_action_area90 = GTK_DIALOG (ncs_control_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (ncs_control_dialog), "dialog_action_area90", dialog_action_area90);
  gtk_widget_show (dialog_action_area90);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area90), 10);

  ncs_control_ok_button = gtk_button_new_with_label (_("   OK   "));
  gtk_widget_ref (ncs_control_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (ncs_control_dialog), "ncs_control_ok_button", ncs_control_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ncs_control_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area90), ncs_control_ok_button, FALSE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (ncs_controller_molecule_n_display_ncs_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_ncs_controller_molecule_n_display_ncs_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ncs_controller_molecule_n_display_chain_ich_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_ncs_controller_molecule_n_display_chain_ich_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ncs_controller_ncs_master_chain_ich_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_ncs_controller_ncs_master_chain_ich_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ncs_control_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_ncs_control_ok_button_clicked),
                      NULL);

  gtk_object_set_data (GTK_OBJECT (ncs_control_dialog), "tooltips", tooltips);

  return ncs_control_dialog;
}

GtkWidget*
create_lsq_plane_dialog (void)
{
  GtkWidget *lsq_plane_dialog;
  GtkWidget *dialog_vbox92;
  GtkWidget *lsq_plane_frame;
  GtkWidget *vbox177;
  GSList *lsq_plane_atom_gr_group = NULL;
  GtkWidget *lsq_plane_add_atom_radiobutton;
  GtkWidget *hbox135;
  GtkWidget *label266;
  GtkWidget *lsq_plane_delete_last_atom_button;
  GtkWidget *label267;
  GtkWidget *lsq_plane_deviant_atom_radiobutton;
  GtkWidget *dialog_action_area91;
  GtkWidget *lsq_plane_ok_button;

  lsq_plane_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (lsq_plane_dialog), "lsq_plane_dialog", lsq_plane_dialog);
  gtk_window_set_title (GTK_WINDOW (lsq_plane_dialog), _("LSQ Plane "));
  gtk_window_set_policy (GTK_WINDOW (lsq_plane_dialog), TRUE, TRUE, FALSE);

  dialog_vbox92 = GTK_DIALOG (lsq_plane_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (lsq_plane_dialog), "dialog_vbox92", dialog_vbox92);
  gtk_widget_show (dialog_vbox92);

  lsq_plane_frame = gtk_frame_new (_("Lsq Plane"));
  gtk_widget_ref (lsq_plane_frame);
  gtk_object_set_data_full (GTK_OBJECT (lsq_plane_dialog), "lsq_plane_frame", lsq_plane_frame,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (lsq_plane_frame);
  gtk_box_pack_start (GTK_BOX (dialog_vbox92), lsq_plane_frame, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (lsq_plane_frame), 6);

  vbox177 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox177);
  gtk_object_set_data_full (GTK_OBJECT (lsq_plane_dialog), "vbox177", vbox177,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox177);
  gtk_container_add (GTK_CONTAINER (lsq_plane_frame), vbox177);

  lsq_plane_add_atom_radiobutton = gtk_radio_button_new_with_label (lsq_plane_atom_gr_group, _("Add Atom to Plane"));
  lsq_plane_atom_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (lsq_plane_add_atom_radiobutton));
  gtk_widget_ref (lsq_plane_add_atom_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (lsq_plane_dialog), "lsq_plane_add_atom_radiobutton", lsq_plane_add_atom_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (lsq_plane_add_atom_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox177), lsq_plane_add_atom_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (lsq_plane_add_atom_radiobutton), 6);

  hbox135 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox135);
  gtk_object_set_data_full (GTK_OBJECT (lsq_plane_dialog), "hbox135", hbox135,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox135);
  gtk_box_pack_start (GTK_BOX (vbox177), hbox135, FALSE, FALSE, 0);

  label266 = gtk_label_new (_("            "));
  gtk_widget_ref (label266);
  gtk_object_set_data_full (GTK_OBJECT (lsq_plane_dialog), "label266", label266,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label266);
  gtk_box_pack_start (GTK_BOX (hbox135), label266, FALSE, FALSE, 0);

  lsq_plane_delete_last_atom_button = gtk_button_new_with_label (_("  Delete Last Plane Atom  "));
  gtk_widget_ref (lsq_plane_delete_last_atom_button);
  gtk_object_set_data_full (GTK_OBJECT (lsq_plane_dialog), "lsq_plane_delete_last_atom_button", lsq_plane_delete_last_atom_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (lsq_plane_delete_last_atom_button);
  gtk_box_pack_start (GTK_BOX (hbox135), lsq_plane_delete_last_atom_button, FALSE, FALSE, 0);

  label267 = gtk_label_new (_("                "));
  gtk_widget_ref (label267);
  gtk_object_set_data_full (GTK_OBJECT (lsq_plane_dialog), "label267", label267,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label267);
  gtk_box_pack_start (GTK_BOX (hbox135), label267, FALSE, FALSE, 0);

  lsq_plane_deviant_atom_radiobutton = gtk_radio_button_new_with_label (lsq_plane_atom_gr_group, _("Deviation of Atom"));
  lsq_plane_atom_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (lsq_plane_deviant_atom_radiobutton));
  gtk_widget_ref (lsq_plane_deviant_atom_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (lsq_plane_dialog), "lsq_plane_deviant_atom_radiobutton", lsq_plane_deviant_atom_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (lsq_plane_deviant_atom_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox177), lsq_plane_deviant_atom_radiobutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (lsq_plane_deviant_atom_radiobutton), 6);

  dialog_action_area91 = GTK_DIALOG (lsq_plane_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (lsq_plane_dialog), "dialog_action_area91", dialog_action_area91);
  gtk_widget_show (dialog_action_area91);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area91), 10);

  lsq_plane_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (lsq_plane_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (lsq_plane_dialog), "lsq_plane_ok_button", lsq_plane_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (lsq_plane_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area91), lsq_plane_ok_button, TRUE, TRUE, 0);

  gtk_signal_connect (GTK_OBJECT (lsq_plane_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_lsq_plane_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (lsq_plane_add_atom_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_lsq_plane_add_atom_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (lsq_plane_delete_last_atom_button), "clicked",
                      GTK_SIGNAL_FUNC (on_lsq_plane_delete_last_atom_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (lsq_plane_deviant_atom_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_lsq_plane_deviant_atom_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (lsq_plane_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_lsq_plane_ok_button_clicked),
                      NULL);

  return lsq_plane_dialog;
}

GtkWidget*
create_coords_colour_control_dialog (void)
{
  GtkWidget *coords_colour_control_dialog;
  GtkWidget *dialog_vbox93;
  GtkWidget *vbox178;
  GtkWidget *label268;
  GtkWidget *scrolledwindow26;
  GtkWidget *viewport20;
  GtkWidget *coords_colours_vbox;
  GtkWidget *frame_molecule_N;
  GtkWidget *hbox136;
  GtkWidget *label269;
  GtkWidget *coords_colour_hscale_mol_N;
  GtkWidget *label270;
  GtkWidget *label271;
  GtkWidget *frame116;
  GtkWidget *vbox123;
  GtkWidget *frame173;
  GtkWidget *vbox192;
  GtkWidget *label201;
  GtkWidget *hbox119;
  GtkWidget *label237;
  GtkWidget *bond_parameters_colour_rotation_hscale;
  GtkWidget *label238;
  GtkWidget *frame172;
  GtkWidget *bond_parameters_rotate_colour_map_c_only_checkbutton;
  GtkWidget *dialog_action_area92;
  GtkWidget *coord_colour_control_ok_button;

  coords_colour_control_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (coords_colour_control_dialog), "coords_colour_control_dialog", coords_colour_control_dialog);
  gtk_window_set_title (GTK_WINDOW (coords_colour_control_dialog), _("Molecule Colours"));
  gtk_window_set_policy (GTK_WINDOW (coords_colour_control_dialog), TRUE, TRUE, FALSE);

  dialog_vbox93 = GTK_DIALOG (coords_colour_control_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (coords_colour_control_dialog), "dialog_vbox93", dialog_vbox93);
  gtk_widget_show (dialog_vbox93);

  vbox178 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox178);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "vbox178", vbox178,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox178);
  gtk_box_pack_start (GTK_BOX (dialog_vbox93), vbox178, TRUE, TRUE, 0);

  label268 = gtk_label_new (_("Molecule Colours"));
  gtk_widget_ref (label268);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "label268", label268,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label268);
  gtk_box_pack_start (GTK_BOX (vbox178), label268, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label268), 4, 5);

  scrolledwindow26 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow26);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "scrolledwindow26", scrolledwindow26,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow26);
  gtk_box_pack_start (GTK_BOX (vbox178), scrolledwindow26, TRUE, TRUE, 0);
  gtk_widget_set_usize (scrolledwindow26, -2, 130);

  viewport20 = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (viewport20);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "viewport20", viewport20,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (viewport20);
  gtk_container_add (GTK_CONTAINER (scrolledwindow26), viewport20);

  coords_colours_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (coords_colours_vbox);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "coords_colours_vbox", coords_colours_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (coords_colours_vbox);
  gtk_container_add (GTK_CONTAINER (viewport20), coords_colours_vbox);

  frame_molecule_N = gtk_frame_new (_("Molecule N"));
  gtk_widget_ref (frame_molecule_N);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "frame_molecule_N", frame_molecule_N,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_box_pack_start (GTK_BOX (coords_colours_vbox), frame_molecule_N, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame_molecule_N), 6);

  hbox136 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox136);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "hbox136", hbox136,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox136);
  gtk_container_add (GTK_CONTAINER (frame_molecule_N), hbox136);

  label269 = gtk_label_new (_("    "));
  gtk_widget_ref (label269);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "label269", label269,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label269);
  gtk_box_pack_start (GTK_BOX (hbox136), label269, FALSE, FALSE, 0);

  coords_colour_hscale_mol_N = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (coords_colour_hscale_mol_N);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "coords_colour_hscale_mol_N", coords_colour_hscale_mol_N,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (coords_colour_hscale_mol_N);
  gtk_box_pack_start (GTK_BOX (hbox136), coords_colour_hscale_mol_N, TRUE, TRUE, 0);

  label270 = gtk_label_new (_("  degrees  "));
  gtk_widget_ref (label270);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "label270", label270,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label270);
  gtk_box_pack_start (GTK_BOX (hbox136), label270, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label270), 0.5, 0.56);

  label271 = gtk_label_new ("");
  gtk_widget_ref (label271);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "label271", label271,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label271);
  gtk_box_pack_start (GTK_BOX (vbox178), label271, FALSE, FALSE, 0);

  frame116 = gtk_frame_new (_("Colour Map Rotation [Molecule Independent] "));
  gtk_widget_ref (frame116);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "frame116", frame116,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame116);
  gtk_box_pack_start (GTK_BOX (vbox178), frame116, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame116), 4);

  vbox123 = gtk_vbox_new (FALSE, 9);
  gtk_widget_ref (vbox123);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "vbox123", vbox123,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox123);
  gtk_container_add (GTK_CONTAINER (frame116), vbox123);

  frame173 = gtk_frame_new (NULL);
  gtk_widget_ref (frame173);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "frame173", frame173,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame173);
  gtk_box_pack_start (GTK_BOX (vbox123), frame173, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame173), 2);

  vbox192 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox192);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "vbox192", vbox192,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox192);
  gtk_container_add (GTK_CONTAINER (frame173), vbox192);

  label201 = gtk_label_new (_("  New molecule rotates colour map"));
  gtk_widget_ref (label201);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "label201", label201,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label201);
  gtk_box_pack_start (GTK_BOX (vbox192), label201, FALSE, FALSE, 0);

  hbox119 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox119);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "hbox119", hbox119,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox119);
  gtk_box_pack_start (GTK_BOX (vbox192), hbox119, TRUE, TRUE, 0);

  label237 = gtk_label_new (_("   by  "));
  gtk_widget_ref (label237);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "label237", label237,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label237);
  gtk_box_pack_start (GTK_BOX (hbox119), label237, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label237), 0.5, 0.95);

  bond_parameters_colour_rotation_hscale = gtk_hscale_new (GTK_ADJUSTMENT (gtk_adjustment_new (0, 0, 0, 0, 0, 0)));
  gtk_widget_ref (bond_parameters_colour_rotation_hscale);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "bond_parameters_colour_rotation_hscale", bond_parameters_colour_rotation_hscale,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (bond_parameters_colour_rotation_hscale);
  gtk_box_pack_start (GTK_BOX (hbox119), bond_parameters_colour_rotation_hscale, TRUE, TRUE, 0);
  gtk_widget_set_usize (bond_parameters_colour_rotation_hscale, 40, -2);

  label238 = gtk_label_new (_("  degrees   "));
  gtk_widget_ref (label238);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "label238", label238,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label238);
  gtk_box_pack_start (GTK_BOX (hbox119), label238, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label238), 0.5, 0.95);

  frame172 = gtk_frame_new (NULL);
  gtk_widget_ref (frame172);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "frame172", frame172,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame172);
  gtk_box_pack_start (GTK_BOX (vbox123), frame172, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame172), 2);

  bond_parameters_rotate_colour_map_c_only_checkbutton = gtk_check_button_new_with_label (_(" Change colour for Carbons only"));
  gtk_widget_ref (bond_parameters_rotate_colour_map_c_only_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "bond_parameters_rotate_colour_map_c_only_checkbutton", bond_parameters_rotate_colour_map_c_only_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (bond_parameters_rotate_colour_map_c_only_checkbutton);
  gtk_container_add (GTK_CONTAINER (frame172), bond_parameters_rotate_colour_map_c_only_checkbutton);
  gtk_container_set_border_width (GTK_CONTAINER (bond_parameters_rotate_colour_map_c_only_checkbutton), 5);

  dialog_action_area92 = GTK_DIALOG (coords_colour_control_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (coords_colour_control_dialog), "dialog_action_area92", dialog_action_area92);
  gtk_widget_show (dialog_action_area92);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area92), 10);

  coord_colour_control_ok_button = gtk_button_new_with_label (_("   OK   "));
  gtk_widget_ref (coord_colour_control_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (coords_colour_control_dialog), "coord_colour_control_ok_button", coord_colour_control_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (coord_colour_control_ok_button);
  gtk_box_pack_start (GTK_BOX (dialog_action_area92), coord_colour_control_ok_button, TRUE, TRUE, 0);
  GTK_WIDGET_SET_FLAGS (coord_colour_control_ok_button, GTK_CAN_DEFAULT);

  gtk_signal_connect (GTK_OBJECT (coords_colour_control_dialog), "destroy",
                      GTK_SIGNAL_FUNC (on_coords_colour_control_dialog_destroy),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (bond_parameters_rotate_colour_map_c_only_checkbutton), "toggled",
                      GTK_SIGNAL_FUNC (on_bond_parameters_rotate_colour_map_c_only_checkbutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (coord_colour_control_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_coord_colour_control_ok_button_clicked),
                      NULL);

  gtk_widget_grab_default (coord_colour_control_ok_button);
  return coords_colour_control_dialog;
}

GtkWidget*
create_nucleotide_builder_dialog (void)
{
  GtkWidget *nucleotide_builder_dialog;
  GtkWidget *dialog_vbox94;
  GtkWidget *vbox179;
  GtkWidget *label282;
  GtkWidget *frame164;
  GtkWidget *vbox180;
  GtkWidget *label283;
  GtkWidget *nucleotide_builder_type_optionmenu;
  GtkWidget *nucleotide_builder_type_optionmenu_menu;
  GtkWidget *glade_menuitem;
  GtkWidget *frame165;
  GtkWidget *vbox181;
  GtkWidget *label284;
  GtkWidget *nucleotide_builder_form_optionmenu;
  GtkWidget *nucleotide_builder_form_optionmenu_menu;
  GtkWidget *frame166;
  GtkWidget *vbox182;
  GtkWidget *label285;
  GtkWidget *nucleotide_builder_strand_optionmenu;
  GtkWidget *nucleotide_builder_strand_optionmenu_menu;
  GtkWidget *frame167;
  GtkWidget *vbox183;
  GtkWidget *label286;
  GtkWidget *nucleotide_sequence;
  GtkWidget *dialog_action_area93;
  GtkWidget *hbox142;
  GtkWidget *ideal_rna_ok_button;
  GtkWidget *ideal_rna_cancel_button;

  nucleotide_builder_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (nucleotide_builder_dialog), "nucleotide_builder_dialog", nucleotide_builder_dialog);
  gtk_window_set_title (GTK_WINDOW (nucleotide_builder_dialog), _("Nucleotide Builder"));
  gtk_window_set_policy (GTK_WINDOW (nucleotide_builder_dialog), TRUE, TRUE, FALSE);

  dialog_vbox94 = GTK_DIALOG (nucleotide_builder_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (nucleotide_builder_dialog), "dialog_vbox94", dialog_vbox94);
  gtk_widget_show (dialog_vbox94);

  vbox179 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox179);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "vbox179", vbox179,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox179);
  gtk_box_pack_start (GTK_BOX (dialog_vbox94), vbox179, TRUE, TRUE, 0);

  label282 = gtk_label_new (_("\nNucleotide Builder \n"));
  gtk_widget_ref (label282);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "label282", label282,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label282);
  gtk_box_pack_start (GTK_BOX (vbox179), label282, FALSE, FALSE, 0);

  frame164 = gtk_frame_new (NULL);
  gtk_widget_ref (frame164);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "frame164", frame164,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame164);
  gtk_box_pack_start (GTK_BOX (vbox179), frame164, TRUE, TRUE, 0);

  vbox180 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox180);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "vbox180", vbox180,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox180);
  gtk_container_add (GTK_CONTAINER (frame164), vbox180);

  label283 = gtk_label_new (_("  Nucleotide Type:"));
  gtk_widget_ref (label283);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "label283", label283,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label283);
  gtk_box_pack_start (GTK_BOX (vbox180), label283, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label283), 0, 0.5);

  nucleotide_builder_type_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (nucleotide_builder_type_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "nucleotide_builder_type_optionmenu", nucleotide_builder_type_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (nucleotide_builder_type_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox180), nucleotide_builder_type_optionmenu, FALSE, FALSE, 0);
  nucleotide_builder_type_optionmenu_menu = gtk_menu_new ();
  glade_menuitem = gtk_menu_item_new_with_label (_("RNA"));
  gtk_widget_show (glade_menuitem);
  gtk_menu_append (GTK_MENU (nucleotide_builder_type_optionmenu_menu), glade_menuitem);
  glade_menuitem = gtk_menu_item_new_with_label (_("DNA"));
  gtk_widget_show (glade_menuitem);
  gtk_menu_append (GTK_MENU (nucleotide_builder_type_optionmenu_menu), glade_menuitem);
  gtk_option_menu_set_menu (GTK_OPTION_MENU (nucleotide_builder_type_optionmenu), nucleotide_builder_type_optionmenu_menu);

  frame165 = gtk_frame_new (NULL);
  gtk_widget_ref (frame165);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "frame165", frame165,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame165);
  gtk_box_pack_start (GTK_BOX (vbox179), frame165, TRUE, TRUE, 0);

  vbox181 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox181);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "vbox181", vbox181,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox181);
  gtk_container_add (GTK_CONTAINER (frame165), vbox181);

  label284 = gtk_label_new (_("  Form:"));
  gtk_widget_ref (label284);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "label284", label284,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label284);
  gtk_box_pack_start (GTK_BOX (vbox181), label284, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label284), 0, 0.5);

  nucleotide_builder_form_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (nucleotide_builder_form_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "nucleotide_builder_form_optionmenu", nucleotide_builder_form_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (nucleotide_builder_form_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox181), nucleotide_builder_form_optionmenu, FALSE, FALSE, 0);
  nucleotide_builder_form_optionmenu_menu = gtk_menu_new ();
  glade_menuitem = gtk_menu_item_new_with_label (_("A"));
  gtk_widget_show (glade_menuitem);
  gtk_menu_append (GTK_MENU (nucleotide_builder_form_optionmenu_menu), glade_menuitem);
  glade_menuitem = gtk_menu_item_new_with_label (_("B"));
  gtk_widget_show (glade_menuitem);
  gtk_menu_append (GTK_MENU (nucleotide_builder_form_optionmenu_menu), glade_menuitem);
  gtk_option_menu_set_menu (GTK_OPTION_MENU (nucleotide_builder_form_optionmenu), nucleotide_builder_form_optionmenu_menu);

  frame166 = gtk_frame_new (NULL);
  gtk_widget_ref (frame166);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "frame166", frame166,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame166);
  gtk_box_pack_start (GTK_BOX (vbox179), frame166, TRUE, TRUE, 0);

  vbox182 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox182);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "vbox182", vbox182,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox182);
  gtk_container_add (GTK_CONTAINER (frame166), vbox182);

  label285 = gtk_label_new (_("  Strandedness:"));
  gtk_widget_ref (label285);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "label285", label285,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label285);
  gtk_box_pack_start (GTK_BOX (vbox182), label285, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label285), 0, 0.5);

  nucleotide_builder_strand_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (nucleotide_builder_strand_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "nucleotide_builder_strand_optionmenu", nucleotide_builder_strand_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (nucleotide_builder_strand_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox182), nucleotide_builder_strand_optionmenu, FALSE, FALSE, 0);
  nucleotide_builder_strand_optionmenu_menu = gtk_menu_new ();
  glade_menuitem = gtk_menu_item_new_with_label (_("Double Stranded"));
  gtk_widget_show (glade_menuitem);
  gtk_menu_append (GTK_MENU (nucleotide_builder_strand_optionmenu_menu), glade_menuitem);
  glade_menuitem = gtk_menu_item_new_with_label (_("Single Stranded"));
  gtk_widget_show (glade_menuitem);
  gtk_menu_append (GTK_MENU (nucleotide_builder_strand_optionmenu_menu), glade_menuitem);
  gtk_option_menu_set_menu (GTK_OPTION_MENU (nucleotide_builder_strand_optionmenu), nucleotide_builder_strand_optionmenu_menu);

  frame167 = gtk_frame_new (NULL);
  gtk_widget_ref (frame167);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "frame167", frame167,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame167);
  gtk_box_pack_start (GTK_BOX (vbox179), frame167, TRUE, TRUE, 0);

  vbox183 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox183);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "vbox183", vbox183,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox183);
  gtk_container_add (GTK_CONTAINER (frame167), vbox183);

  label286 = gtk_label_new (_("  Sequence:"));
  gtk_widget_ref (label286);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "label286", label286,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label286);
  gtk_box_pack_start (GTK_BOX (vbox183), label286, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label286), 0, 0.5);

  nucleotide_sequence = gtk_entry_new ();
  gtk_widget_ref (nucleotide_sequence);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "nucleotide_sequence", nucleotide_sequence,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (nucleotide_sequence);
  gtk_box_pack_start (GTK_BOX (vbox183), nucleotide_sequence, FALSE, FALSE, 0);

  dialog_action_area93 = GTK_DIALOG (nucleotide_builder_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (nucleotide_builder_dialog), "dialog_action_area93", dialog_action_area93);
  gtk_widget_show (dialog_action_area93);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area93), 10);

  hbox142 = gtk_hbox_new (TRUE, 0);
  gtk_widget_ref (hbox142);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "hbox142", hbox142,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox142);
  gtk_box_pack_start (GTK_BOX (dialog_action_area93), hbox142, TRUE, TRUE, 0);

  ideal_rna_ok_button = gtk_button_new_with_label (_("  OK  "));
  gtk_widget_ref (ideal_rna_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "ideal_rna_ok_button", ideal_rna_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ideal_rna_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox142), ideal_rna_ok_button, FALSE, FALSE, 0);

  ideal_rna_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (ideal_rna_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (nucleotide_builder_dialog), "ideal_rna_cancel_button", ideal_rna_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (ideal_rna_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox142), ideal_rna_cancel_button, FALSE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (ideal_rna_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_ideal_rna_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (ideal_rna_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_ideal_rna_cancel_button_clicked),
                      NULL);

  return nucleotide_builder_dialog;
}

GtkWidget*
create_move_molecule_here_dialog (void)
{
  GtkWidget *move_molecule_here_dialog;
  GtkWidget *dialog_vbox95;
  GtkWidget *vbox184;
  GtkWidget *label287;
  GtkWidget *move_molecule_here_optionmenu;
  GtkWidget *move_molecule_here_optionmenu_menu;
  GtkWidget *dialog_action_area94;
  GtkWidget *hbox143;
  GtkWidget *move_molecule_here_ok_button;
  GtkWidget *move_molecule_here_cancel_button;

  move_molecule_here_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (move_molecule_here_dialog), "move_molecule_here_dialog", move_molecule_here_dialog);
  gtk_window_set_title (GTK_WINDOW (move_molecule_here_dialog), _("Move Molecule Here"));
  gtk_window_set_policy (GTK_WINDOW (move_molecule_here_dialog), TRUE, TRUE, FALSE);

  dialog_vbox95 = GTK_DIALOG (move_molecule_here_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (move_molecule_here_dialog), "dialog_vbox95", dialog_vbox95);
  gtk_widget_show (dialog_vbox95);

  vbox184 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox184);
  gtk_object_set_data_full (GTK_OBJECT (move_molecule_here_dialog), "vbox184", vbox184,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox184);
  gtk_box_pack_start (GTK_BOX (dialog_vbox95), vbox184, TRUE, TRUE, 0);

  label287 = gtk_label_new (_("\nMove Molecule Here:"));
  gtk_widget_ref (label287);
  gtk_object_set_data_full (GTK_OBJECT (move_molecule_here_dialog), "label287", label287,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label287);
  gtk_box_pack_start (GTK_BOX (vbox184), label287, FALSE, FALSE, 0);

  move_molecule_here_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (move_molecule_here_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (move_molecule_here_dialog), "move_molecule_here_optionmenu", move_molecule_here_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (move_molecule_here_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox184), move_molecule_here_optionmenu, FALSE, FALSE, 6);
  move_molecule_here_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (move_molecule_here_optionmenu), move_molecule_here_optionmenu_menu);

  dialog_action_area94 = GTK_DIALOG (move_molecule_here_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (move_molecule_here_dialog), "dialog_action_area94", dialog_action_area94);
  gtk_widget_show (dialog_action_area94);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area94), 10);

  hbox143 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox143);
  gtk_object_set_data_full (GTK_OBJECT (move_molecule_here_dialog), "hbox143", hbox143,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox143);
  gtk_box_pack_start (GTK_BOX (dialog_action_area94), hbox143, TRUE, TRUE, 0);

  move_molecule_here_ok_button = gtk_button_new_with_label (_("   Move It   "));
  gtk_widget_ref (move_molecule_here_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (move_molecule_here_dialog), "move_molecule_here_ok_button", move_molecule_here_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (move_molecule_here_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox143), move_molecule_here_ok_button, FALSE, FALSE, 6);

  move_molecule_here_cancel_button = gtk_button_new_with_label (_("   Cancel  "));
  gtk_widget_ref (move_molecule_here_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (move_molecule_here_dialog), "move_molecule_here_cancel_button", move_molecule_here_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (move_molecule_here_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox143), move_molecule_here_cancel_button, FALSE, FALSE, 6);

  gtk_signal_connect (GTK_OBJECT (move_molecule_here_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_move_molecule_here_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (move_molecule_here_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_move_molecule_here_cancel_button_clicked),
                      NULL);

  return move_molecule_here_dialog;
}

GtkWidget*
create_monomer_search_dialog (void)
{
  GtkWidget *monomer_search_dialog;
  GtkWidget *dialog_vbox96;
  GtkWidget *vbox185;
  GtkWidget *frame168;
  GtkWidget *vbox186;
  GtkWidget *label288;
  GtkWidget *hbox145;
  GtkWidget *label291;
  GtkWidget *label289;
  GtkWidget *monomer_search_entry;
  GtkWidget *monomer_library_search_button;
  GtkWidget *label290;
  GtkWidget *monomer_search_minimal_descriptions_checkbutton;
  GtkWidget *scrolledwindow27;
  GtkWidget *monomer_search_results_viewport;
  GtkWidget *monomer_search_results_vbox;
  GtkWidget *dialog_action_area95;
  GtkWidget *hbox144;
  GtkWidget *monomer_library_search_dialog_cancel_button;

  monomer_search_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (monomer_search_dialog), "monomer_search_dialog", monomer_search_dialog);
  gtk_window_set_title (GTK_WINDOW (monomer_search_dialog), _("Search Monomer Library"));
  gtk_window_set_policy (GTK_WINDOW (monomer_search_dialog), TRUE, TRUE, FALSE);

  dialog_vbox96 = GTK_DIALOG (monomer_search_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (monomer_search_dialog), "dialog_vbox96", dialog_vbox96);
  gtk_widget_show (dialog_vbox96);

  vbox185 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox185);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "vbox185", vbox185,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox185);
  gtk_box_pack_start (GTK_BOX (dialog_vbox96), vbox185, TRUE, TRUE, 0);

  frame168 = gtk_frame_new (NULL);
  gtk_widget_ref (frame168);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "frame168", frame168,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame168);
  gtk_box_pack_start (GTK_BOX (vbox185), frame168, FALSE, FALSE, 0);

  vbox186 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox186);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "vbox186", vbox186,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox186);
  gtk_container_add (GTK_CONTAINER (frame168), vbox186);

  label288 = gtk_label_new (_("Search the Monomer Library"));
  gtk_widget_ref (label288);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "label288", label288,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label288);
  gtk_box_pack_start (GTK_BOX (vbox186), label288, FALSE, FALSE, 0);
  gtk_misc_set_padding (GTK_MISC (label288), 4, 5);

  hbox145 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox145);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "hbox145", hbox145,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox145);
  gtk_box_pack_start (GTK_BOX (vbox186), hbox145, TRUE, TRUE, 0);

  label291 = gtk_label_new (_("  "));
  gtk_widget_ref (label291);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "label291", label291,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label291);
  gtk_box_pack_start (GTK_BOX (hbox145), label291, FALSE, FALSE, 0);

  label289 = gtk_label_new (_("Text: "));
  gtk_widget_ref (label289);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "label289", label289,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label289);
  gtk_box_pack_start (GTK_BOX (hbox145), label289, FALSE, FALSE, 0);

  monomer_search_entry = gtk_entry_new ();
  gtk_widget_ref (monomer_search_entry);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "monomer_search_entry", monomer_search_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (monomer_search_entry);
  gtk_box_pack_start (GTK_BOX (hbox145), monomer_search_entry, TRUE, TRUE, 0);

  monomer_library_search_button = gtk_button_new_with_label (_("  Search  "));
  gtk_widget_ref (monomer_library_search_button);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "monomer_library_search_button", monomer_library_search_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (monomer_library_search_button);
  gtk_box_pack_start (GTK_BOX (hbox145), monomer_library_search_button, FALSE, FALSE, 0);

  label290 = gtk_label_new (_("  "));
  gtk_widget_ref (label290);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "label290", label290,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label290);
  gtk_box_pack_start (GTK_BOX (hbox145), label290, FALSE, FALSE, 0);

  monomer_search_minimal_descriptions_checkbutton = gtk_check_button_new_with_label (_("Include Monomers with Minimal Descriptions"));
  gtk_widget_ref (monomer_search_minimal_descriptions_checkbutton);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "monomer_search_minimal_descriptions_checkbutton", monomer_search_minimal_descriptions_checkbutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (monomer_search_minimal_descriptions_checkbutton);
  gtk_box_pack_start (GTK_BOX (vbox186), monomer_search_minimal_descriptions_checkbutton, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (monomer_search_minimal_descriptions_checkbutton), 3);

  scrolledwindow27 = gtk_scrolled_window_new (NULL, NULL);
  gtk_widget_ref (scrolledwindow27);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "scrolledwindow27", scrolledwindow27,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (scrolledwindow27);
  gtk_box_pack_start (GTK_BOX (vbox185), scrolledwindow27, TRUE, TRUE, 0);

  monomer_search_results_viewport = gtk_viewport_new (NULL, NULL);
  gtk_widget_ref (monomer_search_results_viewport);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "monomer_search_results_viewport", monomer_search_results_viewport,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (monomer_search_results_viewport);
  gtk_container_add (GTK_CONTAINER (scrolledwindow27), monomer_search_results_viewport);
  gtk_widget_set_usize (monomer_search_results_viewport, 300, 80);

  monomer_search_results_vbox = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (monomer_search_results_vbox);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "monomer_search_results_vbox", monomer_search_results_vbox,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (monomer_search_results_vbox);
  gtk_container_add (GTK_CONTAINER (monomer_search_results_viewport), monomer_search_results_vbox);

  dialog_action_area95 = GTK_DIALOG (monomer_search_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (monomer_search_dialog), "dialog_action_area95", dialog_action_area95);
  gtk_widget_show (dialog_action_area95);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area95), 10);

  hbox144 = gtk_hbox_new (TRUE, 0);
  gtk_widget_ref (hbox144);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "hbox144", hbox144,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox144);
  gtk_box_pack_start (GTK_BOX (dialog_action_area95), hbox144, FALSE, TRUE, 0);

  monomer_library_search_dialog_cancel_button = gtk_button_new_with_label (_("   Cancel   "));
  gtk_widget_ref (monomer_library_search_dialog_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (monomer_search_dialog), "monomer_library_search_dialog_cancel_button", monomer_library_search_dialog_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (monomer_library_search_dialog_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox144), monomer_library_search_dialog_cancel_button, FALSE, FALSE, 0);

  gtk_signal_connect (GTK_OBJECT (monomer_search_entry), "key_press_event",
                      GTK_SIGNAL_FUNC (on_monomer_search_entry_key_press_event),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (monomer_library_search_button), "clicked",
                      GTK_SIGNAL_FUNC (on_monomer_library_search_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (monomer_library_search_dialog_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_monomer_library_search_dialog_cancel_button_clicked),
                      NULL);

  return monomer_search_dialog;
}

GtkWidget*
create_least_squares_dialog (void)
{
  GtkWidget *least_squares_dialog;
  GtkWidget *dialog_vbox97;
  GtkWidget *vbox187;
  GtkWidget *frame170;
  GtkWidget *vbox189;
  GtkWidget *label292;
  GtkWidget *least_squares_reference_molecule_optionmenu;
  GtkWidget *least_squares_reference_molecule_optionmenu_menu;
  GtkWidget *label293;
  GtkWidget *least_squares_moving_molecule_optionmenu;
  GtkWidget *least_squares_moving_molecule_optionmenu_menu;
  GtkWidget *frame171;
  GtkWidget *vbox190;
  GtkWidget *hbox147;
  GtkWidget *label294;
  GtkWidget *least_squares_reference_range_1_entry;
  GtkWidget *label295;
  GtkWidget *least_squares_reference_range_2_entry;
  GtkWidget *label296;
  GtkWidget *least_squares_reference_chain_id;
  GtkWidget *least_squares_reference_chain_id_menu;
  GtkWidget *hbox148;
  GtkWidget *label297;
  GtkWidget *least_squares_moving_range_1_entry;
  GtkWidget *label298;
  GtkWidget *least_squares_moving_range_2_entry;
  GtkWidget *label299;
  GtkWidget *least_squares_moving_chain_id;
  GtkWidget *least_squares_moving_chain_id_menu;
  GtkWidget *frame169;
  GtkWidget *vbox188;
  GSList *least_square_fit_match_type_gr_group = NULL;
  GtkWidget *least_squares_match_type_all_radiobutton;
  GtkWidget *least_squares_match_type_main_radiobutton;
  GtkWidget *least_squares_match_type_calpha_radiobutton;
  GtkWidget *dialog_action_area96;
  GtkWidget *hbox146;
  GtkWidget *least_squares_ok_button;
  GtkWidget *least_squares_cancel_button;

  least_squares_dialog = gtk_dialog_new ();
  gtk_object_set_data (GTK_OBJECT (least_squares_dialog), "least_squares_dialog", least_squares_dialog);
  gtk_window_set_title (GTK_WINDOW (least_squares_dialog), _("Least Squares Fit"));
  gtk_window_set_policy (GTK_WINDOW (least_squares_dialog), TRUE, TRUE, FALSE);

  dialog_vbox97 = GTK_DIALOG (least_squares_dialog)->vbox;
  gtk_object_set_data (GTK_OBJECT (least_squares_dialog), "dialog_vbox97", dialog_vbox97);
  gtk_widget_show (dialog_vbox97);

  vbox187 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox187);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "vbox187", vbox187,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox187);
  gtk_box_pack_start (GTK_BOX (dialog_vbox97), vbox187, TRUE, TRUE, 0);

  frame170 = gtk_frame_new (NULL);
  gtk_widget_ref (frame170);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "frame170", frame170,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame170);
  gtk_box_pack_start (GTK_BOX (vbox187), frame170, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame170), 6);

  vbox189 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox189);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "vbox189", vbox189,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox189);
  gtk_container_add (GTK_CONTAINER (frame170), vbox189);

  label292 = gtk_label_new (_("Reference Molecule:"));
  gtk_widget_ref (label292);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "label292", label292,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label292);
  gtk_box_pack_start (GTK_BOX (vbox189), label292, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label292), 0, 0.5);

  least_squares_reference_molecule_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (least_squares_reference_molecule_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "least_squares_reference_molecule_optionmenu", least_squares_reference_molecule_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (least_squares_reference_molecule_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox189), least_squares_reference_molecule_optionmenu, FALSE, FALSE, 0);
  least_squares_reference_molecule_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (least_squares_reference_molecule_optionmenu), least_squares_reference_molecule_optionmenu_menu);

  label293 = gtk_label_new (_("Moving Molecule:"));
  gtk_widget_ref (label293);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "label293", label293,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label293);
  gtk_box_pack_start (GTK_BOX (vbox189), label293, FALSE, FALSE, 0);
  gtk_misc_set_alignment (GTK_MISC (label293), 0, 0.5);

  least_squares_moving_molecule_optionmenu = gtk_option_menu_new ();
  gtk_widget_ref (least_squares_moving_molecule_optionmenu);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "least_squares_moving_molecule_optionmenu", least_squares_moving_molecule_optionmenu,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (least_squares_moving_molecule_optionmenu);
  gtk_box_pack_start (GTK_BOX (vbox189), least_squares_moving_molecule_optionmenu, FALSE, FALSE, 0);
  least_squares_moving_molecule_optionmenu_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (least_squares_moving_molecule_optionmenu), least_squares_moving_molecule_optionmenu_menu);

  frame171 = gtk_frame_new (NULL);
  gtk_widget_ref (frame171);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "frame171", frame171,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame171);
  gtk_box_pack_start (GTK_BOX (vbox187), frame171, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame171), 6);

  vbox190 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox190);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "vbox190", vbox190,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox190);
  gtk_container_add (GTK_CONTAINER (frame171), vbox190);

  hbox147 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox147);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "hbox147", hbox147,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox147);
  gtk_box_pack_start (GTK_BOX (vbox190), hbox147, TRUE, TRUE, 0);

  label294 = gtk_label_new (_("Reference Residue Range "));
  gtk_widget_ref (label294);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "label294", label294,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label294);
  gtk_box_pack_start (GTK_BOX (hbox147), label294, FALSE, FALSE, 0);

  least_squares_reference_range_1_entry = gtk_entry_new ();
  gtk_widget_ref (least_squares_reference_range_1_entry);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "least_squares_reference_range_1_entry", least_squares_reference_range_1_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (least_squares_reference_range_1_entry);
  gtk_box_pack_start (GTK_BOX (hbox147), least_squares_reference_range_1_entry, TRUE, TRUE, 0);
  gtk_widget_set_usize (least_squares_reference_range_1_entry, 40, -2);

  label295 = gtk_label_new (_(" to "));
  gtk_widget_ref (label295);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "label295", label295,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label295);
  gtk_box_pack_start (GTK_BOX (hbox147), label295, FALSE, FALSE, 0);

  least_squares_reference_range_2_entry = gtk_entry_new ();
  gtk_widget_ref (least_squares_reference_range_2_entry);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "least_squares_reference_range_2_entry", least_squares_reference_range_2_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (least_squares_reference_range_2_entry);
  gtk_box_pack_start (GTK_BOX (hbox147), least_squares_reference_range_2_entry, TRUE, TRUE, 0);
  gtk_widget_set_usize (least_squares_reference_range_2_entry, 40, -2);

  label296 = gtk_label_new (_("  Chain "));
  gtk_widget_ref (label296);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "label296", label296,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label296);
  gtk_box_pack_start (GTK_BOX (hbox147), label296, FALSE, FALSE, 0);

  least_squares_reference_chain_id = gtk_option_menu_new ();
  gtk_widget_ref (least_squares_reference_chain_id);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "least_squares_reference_chain_id", least_squares_reference_chain_id,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (least_squares_reference_chain_id);
  gtk_box_pack_start (GTK_BOX (hbox147), least_squares_reference_chain_id, FALSE, FALSE, 0);
  least_squares_reference_chain_id_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (least_squares_reference_chain_id), least_squares_reference_chain_id_menu);

  hbox148 = gtk_hbox_new (FALSE, 0);
  gtk_widget_ref (hbox148);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "hbox148", hbox148,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox148);
  gtk_box_pack_start (GTK_BOX (vbox190), hbox148, TRUE, TRUE, 0);

  label297 = gtk_label_new (_("   Moving Residue Range  "));
  gtk_widget_ref (label297);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "label297", label297,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label297);
  gtk_box_pack_start (GTK_BOX (hbox148), label297, FALSE, FALSE, 0);

  least_squares_moving_range_1_entry = gtk_entry_new ();
  gtk_widget_ref (least_squares_moving_range_1_entry);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "least_squares_moving_range_1_entry", least_squares_moving_range_1_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (least_squares_moving_range_1_entry);
  gtk_box_pack_start (GTK_BOX (hbox148), least_squares_moving_range_1_entry, TRUE, TRUE, 0);
  gtk_widget_set_usize (least_squares_moving_range_1_entry, 40, -2);

  label298 = gtk_label_new (_(" to "));
  gtk_widget_ref (label298);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "label298", label298,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label298);
  gtk_box_pack_start (GTK_BOX (hbox148), label298, FALSE, FALSE, 0);

  least_squares_moving_range_2_entry = gtk_entry_new ();
  gtk_widget_ref (least_squares_moving_range_2_entry);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "least_squares_moving_range_2_entry", least_squares_moving_range_2_entry,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (least_squares_moving_range_2_entry);
  gtk_box_pack_start (GTK_BOX (hbox148), least_squares_moving_range_2_entry, TRUE, TRUE, 0);
  gtk_widget_set_usize (least_squares_moving_range_2_entry, 40, -2);

  label299 = gtk_label_new (_("  Chain "));
  gtk_widget_ref (label299);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "label299", label299,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (label299);
  gtk_box_pack_start (GTK_BOX (hbox148), label299, FALSE, FALSE, 0);

  least_squares_moving_chain_id = gtk_option_menu_new ();
  gtk_widget_ref (least_squares_moving_chain_id);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "least_squares_moving_chain_id", least_squares_moving_chain_id,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (least_squares_moving_chain_id);
  gtk_box_pack_start (GTK_BOX (hbox148), least_squares_moving_chain_id, FALSE, FALSE, 0);
  least_squares_moving_chain_id_menu = gtk_menu_new ();
  gtk_option_menu_set_menu (GTK_OPTION_MENU (least_squares_moving_chain_id), least_squares_moving_chain_id_menu);

  frame169 = gtk_frame_new (_("Match Atoms"));
  gtk_widget_ref (frame169);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "frame169", frame169,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (frame169);
  gtk_box_pack_start (GTK_BOX (vbox187), frame169, TRUE, TRUE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (frame169), 6);

  vbox188 = gtk_vbox_new (FALSE, 0);
  gtk_widget_ref (vbox188);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "vbox188", vbox188,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (vbox188);
  gtk_container_add (GTK_CONTAINER (frame169), vbox188);

  least_squares_match_type_all_radiobutton = gtk_radio_button_new_with_label (least_square_fit_match_type_gr_group, _("All Atoms"));
  least_square_fit_match_type_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (least_squares_match_type_all_radiobutton));
  gtk_widget_ref (least_squares_match_type_all_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "least_squares_match_type_all_radiobutton", least_squares_match_type_all_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (least_squares_match_type_all_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox188), least_squares_match_type_all_radiobutton, FALSE, FALSE, 0);
  gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (least_squares_match_type_all_radiobutton), TRUE);

  least_squares_match_type_main_radiobutton = gtk_radio_button_new_with_label (least_square_fit_match_type_gr_group, _("Mainchain"));
  least_square_fit_match_type_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (least_squares_match_type_main_radiobutton));
  gtk_widget_ref (least_squares_match_type_main_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "least_squares_match_type_main_radiobutton", least_squares_match_type_main_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (least_squares_match_type_main_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox188), least_squares_match_type_main_radiobutton, FALSE, FALSE, 0);

  least_squares_match_type_calpha_radiobutton = gtk_radio_button_new_with_label (least_square_fit_match_type_gr_group, _("C-alphas"));
  least_square_fit_match_type_gr_group = gtk_radio_button_group (GTK_RADIO_BUTTON (least_squares_match_type_calpha_radiobutton));
  gtk_widget_ref (least_squares_match_type_calpha_radiobutton);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "least_squares_match_type_calpha_radiobutton", least_squares_match_type_calpha_radiobutton,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (least_squares_match_type_calpha_radiobutton);
  gtk_box_pack_start (GTK_BOX (vbox188), least_squares_match_type_calpha_radiobutton, FALSE, FALSE, 0);

  dialog_action_area96 = GTK_DIALOG (least_squares_dialog)->action_area;
  gtk_object_set_data (GTK_OBJECT (least_squares_dialog), "dialog_action_area96", dialog_action_area96);
  gtk_widget_show (dialog_action_area96);
  gtk_container_set_border_width (GTK_CONTAINER (dialog_action_area96), 10);

  hbox146 = gtk_hbox_new (TRUE, 0);
  gtk_widget_ref (hbox146);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "hbox146", hbox146,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (hbox146);
  gtk_box_pack_start (GTK_BOX (dialog_action_area96), hbox146, TRUE, TRUE, 0);

  least_squares_ok_button = gtk_button_new_with_label (_("   Fit   "));
  gtk_widget_ref (least_squares_ok_button);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "least_squares_ok_button", least_squares_ok_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (least_squares_ok_button);
  gtk_box_pack_start (GTK_BOX (hbox146), least_squares_ok_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (least_squares_ok_button), 2);

  least_squares_cancel_button = gtk_button_new_with_label (_("  Cancel  "));
  gtk_widget_ref (least_squares_cancel_button);
  gtk_object_set_data_full (GTK_OBJECT (least_squares_dialog), "least_squares_cancel_button", least_squares_cancel_button,
                            (GtkDestroyNotify) gtk_widget_unref);
  gtk_widget_show (least_squares_cancel_button);
  gtk_box_pack_start (GTK_BOX (hbox146), least_squares_cancel_button, FALSE, FALSE, 0);
  gtk_container_set_border_width (GTK_CONTAINER (least_squares_cancel_button), 2);

  gtk_signal_connect (GTK_OBJECT (least_squares_match_type_all_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_least_squares_match_type_all_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (least_squares_match_type_main_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_least_squares_match_type_main_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (least_squares_match_type_calpha_radiobutton), "toggled",
                      GTK_SIGNAL_FUNC (on_least_squares_match_type_all_radiobutton_toggled),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (least_squares_ok_button), "clicked",
                      GTK_SIGNAL_FUNC (on_least_squares_ok_button_clicked),
                      NULL);
  gtk_signal_connect (GTK_OBJECT (least_squares_cancel_button), "clicked",
                      GTK_SIGNAL_FUNC (on_least_squares_cancel_button_clicked),
                      NULL);

  return least_squares_dialog;
}

#endif
